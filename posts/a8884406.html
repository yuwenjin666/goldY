<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>云计算方向-2023年金砖大赛 | GoldY</title><meta name="author" content="GoldY"><meta name="copyright" content="GoldY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2023年金砖大赛">
<meta property="og:type" content="article">
<meta property="og:title" content="云计算方向-2023年金砖大赛">
<meta property="og:url" content="https://www.geekgold.xyz/posts/a8884406.html">
<meta property="og:site_name" content="GoldY">
<meta property="og:description" content="2023年金砖大赛">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.geekgold.xyz/img/cloud-com.jpg">
<meta property="article:published_time" content="2025-05-14T02:48:32.000Z">
<meta property="article:modified_time" content="2025-05-14T03:16:03.868Z">
<meta property="article:author" content="GoldY">
<meta property="article:tag" content="云计算">
<meta property="article:tag" content="云计算职业技能大赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.geekgold.xyz/img/cloud-com.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "云计算方向-2023年金砖大赛",
  "url": "https://www.geekgold.xyz/posts/a8884406.html",
  "image": "https://www.geekgold.xyz/img/cloud-com.jpg",
  "datePublished": "2025-05-14T02:48:32.000Z",
  "dateModified": "2025-05-14T03:16:03.868Z",
  "author": [
    {
      "@type": "Person",
      "name": "GoldY",
      "url": "https://www.geekgold.xyz/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.geekgold.xyz/posts/a8884406.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="bing-site-verification" content="E05CD8D6921B8F2AA32324DF2B267557"/><meta name="baidu-site-verification" content="codeva-tCktTl1n17"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '云计算方向-2023年金砖大赛',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cloud-com.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.png" alt="Logo"><span class="site-name">GoldY</span></a><a class="nav-page-title" href="/"><span class="site-name">云计算方向-2023年金砖大赛</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">云计算方向-2023年金砖大赛</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-14T02:48:32.000Z" title="发表于 2025-05-14 10:48:32">2025-05-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-14T03:16:03.868Z" title="更新于 2025-05-14 11:16:03">2025-05-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E6%B1%87%E6%80%BB/">技能大赛汇总</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">15.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>80分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="A模块题目：OpenStack-平台部署与运维"><a href="#A模块题目：OpenStack-平台部署与运维" class="headerlink" title="A模块题目：OpenStack 平台部署与运维"></a>A模块题目：OpenStack 平台部署与运维</h1><p>业务场景：</p>
<p>某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化、弹性分配、集中管理、性能优化以及统一安全认证等。系统结构如下图：</p>
<p>企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：</p>
<p>表1 IP地址规划</p>
<table>
<thead>
<tr>
<th>设备名称</th>
<th>主机名</th>
<th>接口</th>
<th>IP地址</th>
</tr>
</thead>
<tbody><tr>
<td>云服务器1</td>
<td>controller</td>
<td>eth0</td>
<td>公网IP: 私网IP:192.168.100.&#x2F;24</td>
</tr>
<tr>
<td></td>
<td></td>
<td>eth1</td>
<td>私网IP:192.168.200. *&#x2F;24</td>
</tr>
<tr>
<td>云服务器2</td>
<td>compute</td>
<td>eth0</td>
<td>公网IP: 私网IP:192.168.100. *&#x2F;24</td>
</tr>
<tr>
<td></td>
<td></td>
<td>eth1</td>
<td>私网IP:192.168.200. *&#x2F;24</td>
</tr>
</tbody></table>
<p>说明：</p>
<p>1.选手自行检查工位pc机硬件及网络是否正常；</p>
<p>2.竞赛使用集群模式进行，给每个参赛队提供华为云账号和密码及考试系统的账号和密码。选手通过用户名与密码分别登录华为云和考试系统；</p>
<p>3.竞赛用到的软件包都在云主机&#x2F;root下。</p>
<p>4.表1中的公网IP和私网IP以自己云主机显示为准，每个人的公网IP和私网IP不同。使用第三方软件远程连接云主机，使用公网IP连接。</p>
<h2 id="任务1-1私有云平台环境初始化（5-分）"><a href="#任务1-1私有云平台环境初始化（5-分）" class="headerlink" title="任务1 1私有云平台环境初始化（5 分）"></a>任务1 1私有云平台环境初始化（5 分）</h2><h3 id="1-配置主机名"><a href="#1-配置主机名" class="headerlink" title="1.配置主机名"></a>1.配置主机名</h3><p>​	把controller节点主机名设置为controller,compute 节点主机名设置为compute,修改hosts文件将IP地址映射为主机名</p>
<p> 在controller节点将cat &#x2F;etc&#x2F;hosts命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: controller&amp;&amp;compute&amp;&amp;192.168.100</strong></p>
<p>解法:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# hostnamectl set-hostname controller</span><br><span class="line">[root@localhost ~]# bash</span><br><span class="line">[root@localhost ~]# hostnamectl set-hostname compute</span><br><span class="line">[root@localhost ~]# bash</span><br><span class="line">[root@controller ~]# hostname</span><br><span class="line">controller</span><br><span class="line">[root@compute ~]# hostname</span><br><span class="line">compute</span><br><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.100.10 controller</span><br><span class="line">192.168.100.20 compute</span><br><span class="line">[root@compute ~]# <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.100.10 controller</span><br><span class="line">192.168.100.20 compute</span><br></pre></td></tr></table></figure>

<h3 id="2-挂载光盘镜像"><a href="#2-挂载光盘镜像" class="headerlink" title="2.挂载光盘镜像"></a>2.挂载光盘镜像</h3><p>在controller节点的root目录下有CentOS-7-x86_64-DVD-2009.iso和openstack-train.tar.gz，在&#x2F;opt下创建centos目录，将镜像文件CentOS-7-x86_64-DVD-2009.iso挂载到&#x2F;opt&#x2F;centos下，将openstack-train.tar.gz解压到&#x2F;opt目录下，并创建本地yum源local.repo。</p>
<p>在controller节点将yum list | grep glance命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: openstack-glance&amp;&amp;python2-glance&amp;&amp;python2-glance-store</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# mv /opt/CentOS-7-x86_64-DVD-2009.iso /root/</span><br><span class="line">[root@controller ~]# mkdir /opt/centos</span><br><span class="line">[root@controller ~]# tar -zxvf /root/openstack-train.tar.gz -C /opt/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进行挂载</span></span><br><span class="line">[root@controller ~]# mount /root/CentOS-7-x86_64-DVD-2009.iso /opt/centos/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置controller 本地yum源</span></span><br><span class="line">[root@controller ~]# vim /etc/yum.repos.d/local.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///opt/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[openstack]</span><br><span class="line">name=openstack</span><br><span class="line">baseurl=file:///opt/openstack</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[root@controller ~]# yum list | grep glance</span><br><span class="line">openstack-glance.noarch                    1:19.0.4-1.el7              openstack</span><br><span class="line">python2-glance.noarch                      1:19.0.4-1.el7              openstack</span><br><span class="line">python2-glance-store.noarch                1.0.1-1.el7                 openstack</span><br><span class="line">python2-glanceclient.noarch                1:2.17.1-1.el7              openstack</span><br></pre></td></tr></table></figure>

<h3 id="3-搭建ftp服务器"><a href="#3-搭建ftp服务器" class="headerlink" title="3.搭建ftp服务器"></a>3.搭建ftp服务器</h3><p>在controller节点上安装vsftp服务,将&#x2F;opt目录设为共享，并设置为开机自启动，然后重启服务生效；在compute节点创建FTP源ftp.repo，使用controller节点为FTP服务器，配置文件中的FTP地址使用主机名。</p>
<p>在compute节点将cat &#x2F;etc&#x2F;yum.repos.d&#x2F;ftp.repo命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: controller&#x2F;centos&amp;&amp;controller&#x2F;openstack</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装vsftpd</span></span><br><span class="line">[root@controller ~]# yum install vsftpd -y</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置/opt目录进行共享</span></span><br><span class="line">[root@controller ~]# echo anon_root=/opt &gt;&gt; /etc/vsftpd/vsftpd.conf</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启并设置开机自启动</span></span><br><span class="line">[root@controller ~]# systemctl restart vsftpd</span><br><span class="line">[root@controller ~]# systemctl enable vsftpd</span><br><span class="line"></span><br><span class="line">[root@controller ~]# cat /etc/vsftpd/vsftpd.conf | grep /opt  </span><br><span class="line">anon_root=/opt</span><br><span class="line">[root@controller ~]# systemctl status vsftpd | grep -P Loaded\|Active</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/vsftpd.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Wed 2023-02-22 22:01:15 CST; 9min ago</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置compute ftp源</span></span><br><span class="line">[root@compute ~]# vim /etc/yum.repos.d/ftp.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=ftp://controller/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[openstack]</span><br><span class="line">name=openstack</span><br><span class="line">baseurl=ftp://controller/openstack</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>

<h3 id="4-分区"><a href="#4-分区" class="headerlink" title="4.分区"></a>4.分区</h3><p>在compute节点将vdb分为两个区分别为vdb1和vdb2,大小自定义(如果是sdb,则分为sdb1和sdb2)。要求分区格式为gpt,使用mkfs.xfs命令对文件系统格式化。</p>
<p>将lsblk -f命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: db1&amp;&amp;db2&amp;&amp;xfs</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# parted /dev/vdb mklabel gpt</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line">[root@compute ~]# parted /dev/vdb</span><br><span class="line">(parted) mkpart        </span><br><span class="line">Partition name?  []? f1</span><br><span class="line">File system type?  [ext2]? xfs</span><br><span class="line">Start? 0G              </span><br><span class="line">End? 20G</span><br><span class="line"> (parted) mkpart</span><br><span class="line">Partition name?  []? f2</span><br><span class="line">File system type?  [ext2]? xfs</span><br><span class="line">Start? 20G             </span><br><span class="line">End? 100G</span><br><span class="line">(parted) quit</span><br><span class="line">[root@compute ~]# mkfs.xfs /dev/vdb1</span><br><span class="line">[root@compute ~]# mkfs.xfs /dev/vdb2</span><br><span class="line"></span><br><span class="line">[root@compute ~]# lsblk -f</span><br><span class="line">NAME   FSTYPE LABEL UUID                                 MOUNTPOINT</span><br><span class="line">vda                                                     </span><br><span class="line">└─sda1 xfs          5f1871e2-c19c-4f86-8d6c-04d5fda71a0a /</span><br><span class="line">sdb                                                     </span><br><span class="line">├─vdb1 xfs          91b262c1-1767-4968-9563-8174e3accdeb</span><br><span class="line">└─vdb2 xfs          721a62f9-a00b-4ddf-9454-24bb65090b8b</span><br></pre></td></tr></table></figure>

<h3 id="5-系统调优-脏数据回写"><a href="#5-系统调优-脏数据回写" class="headerlink" title="5.系统调优-脏数据回写"></a>5.系统调优-脏数据回写</h3><p>Linux系统内存中会存在脏数据，一般系统默认脏数据占用内存30%时会回写磁盘，修改系统配置文件，要求将回写磁盘的大小调整为60%。</p>
<p>在controller节点将sysctl -p命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: vm.dirty_ratio&amp;&amp;60</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# echo vm.dirty_ratio = 60 &gt;&gt; /etc/sysctl.conf</span><br><span class="line"></span><br><span class="line">[root@controller ~]# sysctl -p</span><br><span class="line">vm.dirty_ratio = 60</span><br></pre></td></tr></table></figure>

<h2 id="任务2-OpenStack搭建任务-8分"><a href="#任务2-OpenStack搭建任务-8分" class="headerlink" title="任务2 OpenStack搭建任务 (8分)"></a>任务2 OpenStack搭建任务 (8分)</h2><h3 id="1-修改脚本文件"><a href="#1-修改脚本文件" class="headerlink" title="1.修改脚本文件"></a>1.修改脚本文件</h3><p>在controller节点和compute节点分别安装sh-guoji软件包，修改脚本文件基本变量（脚本文件为&#x2F;root&#x2F;variable.sh），修改完成后使用命令生效该脚本文件并替换到compute节点对应位置。</p>
<p>在controller节点请将echo $HOST_NAME $HOST_NAME_NODE命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: controller&amp;&amp;compute</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# yum install sh-guoji -y</span><br><span class="line">[root@compute ~]# yum install sh-guoji -y</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置</span></span><br><span class="line">[root@controller ~]# cat /root/variable.sh | grep -Ev &quot;^$|#&quot;                     </span><br><span class="line">HOST_IP=192.168.100.x</span><br><span class="line">HOST_PASS=000000</span><br><span class="line">HOST_NAME=controller</span><br><span class="line">HOST_IP_NODE=192.168.100.x</span><br><span class="line">HOST_PASS_NODE=000000</span><br><span class="line">HOST_NAME_NODE=compute</span><br><span class="line">network_segment_IP=192.168.100.0/24</span><br><span class="line">RABBIT_USER=openstack</span><br><span class="line">RABBIT_PASS=000000</span><br><span class="line">DB_PASS=000000</span><br><span class="line">ADMIN_PASS=000000</span><br><span class="line">DEMO_PASS=000000</span><br><span class="line">KEYSTONE_DBPASS=000000</span><br><span class="line">GLANCE_DBPASS=000000</span><br><span class="line">GLANCE_PASS=000000</span><br><span class="line">NOVA_DBPASS=000000</span><br><span class="line">NOVA_PASS=000000</span><br><span class="line">NEUTRON_DBPASS=000000</span><br><span class="line">NEUTRON_PASS=000000</span><br><span class="line">METADATA_SECRET=000000</span><br><span class="line">INTERFACE_IP_HOST=192.168.100.x</span><br><span class="line">INTERFACE_IP_NODE=192.168.100.x</span><br><span class="line">INTERFACE_NAME_HOST=eth0</span><br><span class="line">INTERFACE_NAME_NODE=eth0</span><br><span class="line">Physical_NAME=provider</span><br><span class="line">minvlan=100</span><br><span class="line">maxvlan=200</span><br><span class="line">CINDER_DBPASS=000000</span><br><span class="line">CINDER_PASS=000000</span><br><span class="line">BLOCK_DISK=vdb1</span><br><span class="line">SWIFT_PASS=000000</span><br><span class="line">OBJECT_DISK=vdb2</span><br><span class="line">STORAGE_LOCAL_NET_IP=192.168.100.x</span><br><span class="line">HEAT_DBPASS=000000</span><br><span class="line">HEAT_PASS=000000</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">复制到compute节点</span></span><br><span class="line">[root@controller ~]# scp /root/variable.sh compute:/root/</span><br><span class="line">[root@controller ~]# source /root/variable.sh</span><br><span class="line"></span><br><span class="line">[root@controller ~]# echo $HOST_NAME $HOST_NAME_NODE</span><br><span class="line">controller compute</span><br></pre></td></tr></table></figure>

<h3 id="2-安装openstack基础组件"><a href="#2-安装openstack基础组件" class="headerlink" title="2.安装openstack基础组件"></a>2.安装openstack基础组件</h3><p>分别在controller节点和compute节点执行openstack-completion.sh文件(执行完闭需重连终端)。</p>
<p>在controller节点将openstack –version命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: openstack&amp;&amp;4.0.2</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-completion.sh</span><br><span class="line">[root@compute ~]# openstack-completion.sh</span><br><span class="line"></span><br><span class="line">[root@controller ~]# openstack --version</span><br><span class="line">openstack 4.0.2</span><br></pre></td></tr></table></figure>

<h3 id="3-搭建数据库组件"><a href="#3-搭建数据库组件" class="headerlink" title="3.搭建数据库组件"></a>3.搭建数据库组件</h3><p>在controller节点执行openstack-controller-mysql.sh脚本，会自行安装mariadb、memcached、rabbitmq等服务和完成相关配置。执行完成后修改配置文件将缓存CACHESIZE修改为128,并重启相应服务。</p>
<p>将ps aux|grep memcached命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: memcached&amp;&amp;128</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行mysql脚本</span></span><br><span class="line">[root@controller ~]# openstack-controller-mysql.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改memcached缓存CACHESIZE</span></span><br><span class="line">[root@controller ~]# vim /etc/sysconfig/memcached</span><br><span class="line">PORT=&quot;11211&quot;</span><br><span class="line">USER=&quot;memcached&quot;</span><br><span class="line">MAXCONN=&quot;1024&quot;</span><br><span class="line">CACHESIZE=&quot;128&quot;</span><br><span class="line">OPTIONS=&quot;-l 127.0.0.1,::1,controller&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启服务</span></span><br><span class="line">[root@controller ~]# systemctl restart memcached</span><br><span class="line"></span><br><span class="line">[root@controller ~]# ps aux|grep memcached</span><br><span class="line">memcach+  14171  0.0  0.0 443060  2164 ?        Ssl  23:43   0:00 /usr/bin/memcached -p 11211 -u memcached -m 128 -c 1024 -l 127.0.0.1,::1,controller</span><br><span class="line">root      14186  0.0  0.0 112808   968 pts/0    S+   23:43   0:00 grep --color=auto memcached</span><br></pre></td></tr></table></figure>

<h3 id="4-搭建认证服务组件"><a href="#4-搭建认证服务组件" class="headerlink" title="4.搭建认证服务组件"></a>4.搭建认证服务组件</h3><p>在controller节点执行openstack-controller-keystone.sh脚本，会自行安装keystone服务和完成相关配置。使用openstack命令，创建一个名为tom的账户，密码为tompassword123,邮箱为<a href="mailto:&#x74;&#111;&#109;&#64;&#101;&#120;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#109;">&#x74;&#111;&#109;&#64;&#101;&#120;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#109;</a>。</p>
<p>将openstack user show tom命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: id&amp;&amp;<a href="mailto:&#116;&#x6f;&#x6d;&#x40;&#x65;&#120;&#x61;&#109;&#112;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;">&#116;&#x6f;&#x6d;&#x40;&#x65;&#120;&#x61;&#109;&#112;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;</a>&amp;&amp;password_expires_at</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-keystone.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建账户</span></span><br><span class="line">[root@controller ~]# source admin-openrc</span><br><span class="line">[root@controller ~]# openstack user create --password tompassword123 --email tom@example.com tom</span><br><span class="line"></span><br><span class="line">[root@controller ~]# openstack user show tom</span><br><span class="line">+---------------------+----------------------------------+</span><br><span class="line">| Field               | Value                            |</span><br><span class="line">+---------------------+----------------------------------+</span><br><span class="line">| domain_id           | default                          |</span><br><span class="line">| email               | tom@example.com                  |</span><br><span class="line">| enabled             | True                             |</span><br><span class="line">| id                  | e20fb9c5f8ec4e4d98b5e1848d6c8b26 |</span><br><span class="line">| name                | tom                              |</span><br><span class="line">| options             | &#123;&#125;                               |</span><br><span class="line">| password_expires_at | None                             |</span><br><span class="line">+---------------------+----------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="5-搭建镜像服务组件"><a href="#5-搭建镜像服务组件" class="headerlink" title="5.搭建镜像服务组件"></a>5.搭建镜像服务组件</h3><p>在controller节点执行openstack-controller-glance.sh脚本，会自行安装glance服务和完成相关配置。完成后使用openstack命令,创建一个qcow2格式，名为cirros_0.3.4的镜像，镜像文件使用cirros-0.3.4-x86_64-disk.img。</p>
<p>将openstack image show cirros_0.3.4命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准:  disk_format&amp;&amp;qcow2&amp;&amp;cirros_0.3.4&amp;&amp;13287936</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-glance.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建镜像</span></span><br><span class="line">[root@controller ~]# source admin-openrc</span><br><span class="line">[root@controller ~]# openstack image create --container-format bare --disk-format qcow2 --file /root/cirros-0.3.4-x86_64-disk.img --public cirros_0.3.4</span><br><span class="line"></span><br><span class="line">[root@controller ~]# openstack image show cirros_0.3.4</span><br><span class="line">+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Field            | Value                                                                                                                                                                                      |</span><br><span class="line">+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| checksum         | ee1eca47dc88f4879d8a229cc70a07c6                                                                                                                                                           |</span><br><span class="line">| container_format | bare                                                                                                                                                                                       |</span><br><span class="line">| created_at       | 2023-03-07T06:15:49Z                                                                                                                                                                       |</span><br><span class="line">| disk_format      | qcow2                                                                                                                                                                                      |</span><br><span class="line">| file             | /v2/images/07d1a62d-7d20-4564-ba78-75841308ce59/file                                                                                                                                       |</span><br><span class="line">| id               | 07d1a62d-7d20-4564-ba78-75841308ce59                                                                                                                                                       |</span><br><span class="line">| min_disk         | 0                                                                                                                                                                                          |</span><br><span class="line">| min_ram          | 0                                                                                                                                                                                          |</span><br><span class="line">| name             | cirros_0.3.4                                                                                                                                                                               |</span><br><span class="line">| owner            | de20c5e28ce6426fb23f764019b47a54                                                                                                                                                           |</span><br><span class="line">| properties       | os_hash_algo=&#x27;sha512&#x27;, os_hash_value=&#x27;1b03ca1bc3fafe448b90583c12f367949f8b0e665685979d95b004e48574b953316799e23240f4f739d1b5eb4c4ca24d38fdc6f4f9d8247a2bc64db25d6bbdb2&#x27;, os_hidden=&#x27;False&#x27; |</span><br><span class="line">| protected        | False                                                                                                                                                                                      |</span><br><span class="line">| schema           | /v2/schemas/image                                                                                                                                                                          |</span><br><span class="line">| size             | 13287936                                                                                                                                                                                   |</span><br><span class="line">| status           | active                                                                                                                                                                                     |</span><br><span class="line">| tags             |                                                                                                                                                                                            |</span><br><span class="line">| updated_at       | 2023-03-07T06:15:49Z                                                                                                                                                                       |</span><br><span class="line">| virtual_size     | None                                                                                                                                                                                       |</span><br><span class="line">| visibility       | public                 </span><br></pre></td></tr></table></figure>



<h3 id="6-搭建计算服务组件"><a href="#6-搭建计算服务组件" class="headerlink" title="6.搭建计算服务组件"></a>6.搭建计算服务组件</h3><p>在controller节点执行openstack-controller-nova.sh，compute节点执行openstack-compute-nova.sh，会自行安装nova服务和完成相关配置。使用openstack命令创建一个名为m1,ID为56，内存为2048MB,磁盘容量为20GB,vCPU数量为2的云主机类型。</p>
<p>在controller节点将openstack flavor show m1命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准:disk&amp;&amp;20&amp;&amp;name&amp;&amp;m1&amp;&amp;ram&amp;&amp;2048&amp;&amp;id&amp;&amp;56&amp;&amp;vcpus&amp;&amp;properties</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-nova.sh  </span><br><span class="line">[root@compute ~]# openstack-compute-nova.sh </span><br><span class="line">[root@controller ~]# source admin-openrc</span><br><span class="line">[root@controller ~]# openstack flavor create --id 56 --ram 2048 --disk 20 --vcpus 2 m1</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| Field                      | Value |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| OS-FLV-DISABLED:disabled   | False |</span><br><span class="line">| OS-FLV-EXT-DATA:ephemeral  | 0     |</span><br><span class="line">| disk                       | 20    |</span><br><span class="line">| id                         | 56    |</span><br><span class="line">| name                       | m1    |</span><br><span class="line">| os-flavor-access:is_public | True  |</span><br><span class="line">| properties                 |       |</span><br><span class="line">| ram                        | 2048  |</span><br><span class="line">| rxtx_factor                | 1.0   |</span><br><span class="line">| swap                       |       |</span><br><span class="line">| vcpus                      | 2     |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line"></span><br><span class="line">[root@controller ~]# openstack flavor show m1</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| Field                      | Value |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| OS-FLV-DISABLED:disabled   | False |</span><br><span class="line">| OS-FLV-EXT-DATA:ephemeral  | 0     |</span><br><span class="line">| access_project_ids         | None  |</span><br><span class="line">| disk                       | 20    |</span><br><span class="line">| id                         | 56    |</span><br><span class="line">| name                       | m1    |</span><br><span class="line">| os-flavor-access:is_public | True  |</span><br><span class="line">| properties                 |       |</span><br><span class="line">| ram                        | 2048  |</span><br><span class="line">| rxtx_factor                | 1.0   |</span><br><span class="line">| swap                       |       |</span><br><span class="line">| vcpus                      | 2     |</span><br><span class="line">+----------------------------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="7-搭建网络组件并初始化网络"><a href="#7-搭建网络组件并初始化网络" class="headerlink" title="7.搭建网络组件并初始化网络"></a>7.搭建网络组件并初始化网络</h3><p>在controller节点执行openstack-controller-neutron.sh,compute节点执行openstack-compute-neutron.sh，会自行安装neutron服务并完成配置。创建云主机外部网络ext-net，子网为ext-subnet，云主机浮动 IP 可用网段为 192.168.200.100~192.168.200.200，网关为 192.168.200.1。</p>
<p>在controller节点将openstack subnet show ext-subnet命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: 192.168.200.100-192.168.200.200&amp;&amp;allocation_pools&amp;&amp;gateway_ip&amp;&amp;192.168.200.1&amp;&amp;ext-subnet&amp;&amp;project_id</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-neutron.sh</span><br><span class="line">[root@compute ~]# openstack-compute-neutron.sh   </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建网络</span></span><br><span class="line">[root@controller ~]# source admin-openrc</span><br><span class="line">[root@controller ~]# openstack network create --external ext-net</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建子网</span></span><br><span class="line">[root@controller ~]# openstack subnet create --ip-version 4 --gateway 192.168.200.1 --allocation-pool start=192.168.200.100,end=192.168.200.200 --network ext-net --subnet-range 192.168.200.0/24 ext-subnet</span><br><span class="line"></span><br><span class="line">[root@controller ~]# openstack subnet show ext-subnet</span><br><span class="line">+-------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Field             | Value                                                                                                                                                   |</span><br><span class="line">+-------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| allocation_pools  | 192.168.200.100-192.168.200.200                                                                                                                         |</span><br><span class="line">| cidr              | 192.168.200.0/24                                                                                                                                        |</span><br><span class="line">| created_at        | 2023-02-22T16:29:20Z                                                                                                                                    |</span><br><span class="line">| description       |                                                                                                                                                         |</span><br><span class="line">| dns_nameservers   |                                                                                                                                                         |</span><br><span class="line">| enable_dhcp       | True                                                                                                                                                    |</span><br><span class="line">| gateway_ip        | 192.168.200.1                                                                                                                                           |</span><br><span class="line">| host_routes       |                                                                                                                                                         |</span><br><span class="line">| id                | 6ab2ab75-3a82-44d5-9bc8-c2c0a65872d6                                                                                                                    |</span><br><span class="line">| ip_version        | 4                                                                                                                                                       |</span><br><span class="line">| ipv6_address_mode | None                                                                                                                                                    |</span><br><span class="line">| ipv6_ra_mode      | None                                                                                                                                                    |</span><br><span class="line">| location          | cloud=&#x27;&#x27;, project.domain_id=, project.domain_name=&#x27;Default&#x27;, project.id=&#x27;ce21284fd468495995218ea6e1aeea2a&#x27;, project.name=&#x27;admin&#x27;, region_name=&#x27;&#x27;, zone= |</span><br><span class="line">| name              | ext-subnet                                                                                                                                              |</span><br><span class="line">| network_id        | bc39443b-9ef8-4a4d-91b3-fd2637ada43f                                                                                                                    |</span><br><span class="line">| prefix_length     | None                                                                                                                                                    |</span><br><span class="line">| project_id        | ce21284fd468495995218ea6e1aeea2a                                                                                                                        |</span><br><span class="line">| revision_number   | 0                                                                                                                                                       |</span><br><span class="line">| segment_id        | None                                                                                                                                                    |</span><br><span class="line">| service_types     |                                                                                                                                                         |</span><br><span class="line">| subnetpool_id     | None                                                                                                                                                    |</span><br><span class="line">| tags              |                                                                                                                                                         |</span><br><span class="line">| updated_at        | 2023-02-22T16:29:20Z </span><br></pre></td></tr></table></figure>

<h3 id="8-搭建图形化界面"><a href="#8-搭建图形化界面" class="headerlink" title="8.搭建图形化界面"></a>8.搭建图形化界面</h3><p>在 controller节点执行openstack-controller-dashboard.sh脚本，会自行安装 dashboard服务并完成配置。请修改compute节点nova配置文件，使之后创建的实例可以在网页通过公网访问控制台页面。</p>
<p>在compute节点请将cat &#x2F;etc&#x2F;nova&#x2F;nova.conf | grep 公网IP 命令的返回结果提交到答题框。（例:cat &#x2F;etc&#x2F;nova&#x2F;nova.conf | grep 121.36.12.138）【1分】</p>
<p><strong>标准: novncproxy_base_url&amp;&amp;vnc_auto.html</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-dashboard.sh</span><br><span class="line">[root@compute ~]# vim /etc/nova/nova.conf</span><br><span class="line">修改内容如下</span><br><span class="line">novncproxy_base_url = http://公网IP:6080/vnc_auto.html</span><br><span class="line"></span><br><span class="line">[root@compute ~]# cat /etc/nova/nova.conf | grep 公网IP</span><br><span class="line">novncproxy_base_url = http://公网IP:6080/vnc_auto.html</span><br></pre></td></tr></table></figure>

<h2 id="任务3-OpenStack运维任务（11分）"><a href="#任务3-OpenStack运维任务（11分）" class="headerlink" title="任务3 OpenStack运维任务（11分）"></a>任务3 OpenStack运维任务（11分）</h2><p>某公司构建了一套内部私有云系统，这套私有云系统将为公司内部提供计算服务。你将作为该私有云的维护人员，请完成以下运维工作。</p>
<h3 id="1-数据库管理"><a href="#1-数据库管理" class="headerlink" title="1.数据库管理"></a>1.数据库管理</h3><p>请使用数据库命令将所有数据库备份到&#x2F;root路径下,备份文件名为openstack.sql，完成后使用命令查看文件属性其中文件大小以mb显示。</p>
<p>请将所有命令和返回结果提交到答题框。【1分】</p>
<p><strong>标准: 1.6M&amp;&amp;openstack.sql</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# mysqldump -uroot -p000000 --all-databases &gt; /root/openstack.sql</span><br><span class="line">[root@controller ~]# du -h /root/openstack.sql</span><br><span class="line">1.6M    /root/openstack.sql</span><br></pre></td></tr></table></figure>

<h3 id="2-数据库管理"><a href="#2-数据库管理" class="headerlink" title="2.数据库管理"></a>2.数据库管理</h3><p>进入数据库，创建本地用户examuser，密码为 000000，然后查询mysql数据库中的 user 表的user,host,password字段。然后赋予这个用户所有数据库的“查询”“删除”“更新”“创建”的权限。</p>
<p>将select User, Select_priv,Update_priv,Delete_priv,Create_priv from user;命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: keystone&amp;&amp;glance&amp;&amp;nova&amp;&amp;placement&amp;&amp;examuser&amp;&amp;Y</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# mysql -uroot -p</span><br><span class="line">MariaDB [(none)]&gt; create user examuser@&#x27;localhost&#x27; identified by &#x27;000000&#x27;;</span><br><span class="line">Query OK, 0 rows affected (0.005 sec)</span><br><span class="line">MariaDB [(none)]&gt; use mysql</span><br><span class="line">Database changed</span><br><span class="line">MariaDB [mysql]&gt; select user,host,password from user;</span><br><span class="line">+-----------+------------+-------------------------------------------+</span><br><span class="line">| user      | host       | password                                  |</span><br><span class="line">+-----------+------------+-------------------------------------------+</span><br><span class="line">| root      | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| root      | controller | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| root      | 127.0.0.1  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| root      | ::1        | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| keystone  | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| keystone  | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| glance    | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| glance    | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| nova      | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| nova      | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| placement | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| placement | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| neutron   | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| neutron   | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| cinder    | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| cinder    | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| examuser  | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">+-----------+------------+-------------------------------------------+</span><br><span class="line">17 rows in set (0.000 sec)</span><br><span class="line">MariaDB [mysql]&gt; grant select,delete,update,create on *.* to examuser@&#x27;localhost&#x27;; </span><br><span class="line">Query OK, 0 rows affected (0.000 sec)</span><br><span class="line">MariaDB [mysql]&gt; select User, Select_priv,Update_priv,Delete_priv,Create_priv from user;</span><br><span class="line">+-----------+-------------+-------------+-------------+-------------+</span><br><span class="line">| User      | Select_priv | Update_priv | Delete_priv | Create_priv |</span><br><span class="line">+-----------+-------------+-------------+-------------+-------------+</span><br><span class="line">| root      | Y           | Y           | Y           | Y           |</span><br><span class="line">| root      | Y           | Y           | Y           | Y           |</span><br><span class="line">| root      | Y           | Y           | Y           | Y           |</span><br><span class="line">| root      | Y           | Y           | Y           | Y           |</span><br><span class="line">| keystone  | N           | N           | N           | N           |</span><br><span class="line">| keystone  | N           | N           | N           | N           |</span><br><span class="line">| glance    | N           | N           | N           | N           |</span><br><span class="line">| glance    | N           | N           | N           | N           |</span><br><span class="line">| nova      | N           | N           | N           | N           |</span><br><span class="line">| nova      | N           | N           | N           | N           |</span><br><span class="line">| placement | N           | N           | N           | N           |</span><br><span class="line">| placement | N           | N           | N           | N           |</span><br><span class="line">| neutron   | N           | N           | N           | N           |</span><br><span class="line">| neutron   | N           | N           | N           | N           |</span><br><span class="line">| examuser  | Y           | Y           | Y           | Y           |</span><br><span class="line">+-----------+-------------+-------------+-------------+-------------+</span><br><span class="line">15 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure>

<h3 id="3-安全组管理"><a href="#3-安全组管理" class="headerlink" title="3.安全组管理"></a>3.安全组管理</h3><p>使用openstack命令创建名称为group_web的安全组该安全组的描述为”Custom security group”，用openstack命令为安全组添加icmp规则和ssh规则允许任意ip地址访问web,完成后使用openstack命令查看该安全组的详细信息。</p>
<p>将openstack security group show group_web命令的返回结果提交到答题框。【1分】</p>
<p>*<em>标准: created_at&amp;&amp;rules&amp;&amp;port_range_max&amp;&amp;22&amp;&amp;protocol&amp;&amp;icmp</em></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建描述为Custom security group的安全组</span></span><br><span class="line">[root@controller ~]# openstack security group create --description &quot;Custom security group&quot; group_web</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加访问80</span></span><br><span class="line">[root@controller ~]# openstack security group rule create --ingress --ethertype IPv4 --protocol tcp --dst-port 80:80 group_web</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加访问ssh(22)</span></span><br><span class="line">[root@controller ~]# openstack security group rule create --ingress --ethertype IPv4 --protocol tcp --dst-port 22:22 group_web</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加访问icmp</span></span><br><span class="line">[root@controller ~]# openstack security group rule create --ingress --protocol icmp group_web</span><br><span class="line">[root@controller ~]# openstack security group show group_web</span><br><span class="line">+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Field           | Value                                                                                                                                                                                                                                          |</span><br><span class="line">+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| created_at      | 2023-02-23T08:46:51Z                                                                                                                                                                                                                           |</span><br><span class="line">| description     | Custom security group                                                                                                                                                                                                                          |</span><br><span class="line">| id              | 66376557-a4b3-46ac-aae3-174b0d12d687                                                                                                                                                                                                           |</span><br><span class="line">| location        | cloud=&#x27;&#x27;, project.domain_id=, project.domain_name=&#x27;Default&#x27;, project.id=&#x27;ce21284fd468495995218ea6e1aeea2a&#x27;, project.name=&#x27;admin&#x27;, region_name=&#x27;&#x27;, zone=                                                                                        |</span><br><span class="line">| name            | group_web                                                                                                                                                                                                                                      |</span><br><span class="line">| project_id      | ce21284fd468495995218ea6e1aeea2a                                                                                                                                                                                                               |</span><br><span class="line">| revision_number | 4                                                                                                                                                                                                                                              |</span><br><span class="line">| rules           | created_at=&#x27;2023-02-23T08:48:42Z&#x27;, direction=&#x27;ingress&#x27;, ethertype=&#x27;IPv4&#x27;, id=&#x27;3eccfa5c-3886-4873-92b5-c19e653ef2c8&#x27;, port_range_max=&#x27;80&#x27;, port_range_min=&#x27;80&#x27;, protocol=&#x27;tcp&#x27;, remote_ip_prefix=&#x27;0.0.0.0/0&#x27;, updated_at=&#x27;2023-02-23T08:48:42Z&#x27; |</span><br><span class="line">|                 | created_at=&#x27;2023-02-23T08:50:59Z&#x27;, direction=&#x27;ingress&#x27;, ethertype=&#x27;IPv4&#x27;, id=&#x27;6ad68ada-ca6f-4905-b78a-3f53607333d8&#x27;, port_range_max=&#x27;22&#x27;, port_range_min=&#x27;22&#x27;, protocol=&#x27;tcp&#x27;, remote_ip_prefix=&#x27;0.0.0.0/0&#x27;, updated_at=&#x27;2023-02-23T08:50:59Z&#x27; |</span><br><span class="line">|                 | created_at=&#x27;2023-02-23T08:51:27Z&#x27;, direction=&#x27;ingress&#x27;, ethertype=&#x27;IPv4&#x27;, id=&#x27;b09e5950-ee02-4531-91c8-7fcb3cc427a0&#x27;, protocol=&#x27;tcp&#x27;, remote_ip_prefix=&#x27;0.0.0.0/0&#x27;, updated_at=&#x27;2023-02-23T08:51:27Z&#x27;                                           |</span><br><span class="line">|                 | created_at=&#x27;2023-02-23T08:46:51Z&#x27;, direction=&#x27;egress&#x27;, ethertype=&#x27;IPv4&#x27;, id=&#x27;bb5ce76b-75f1-41ab-aa5b-8cb50702f9d4&#x27;, updated_at=&#x27;2023-02-23T08:46:51Z&#x27;                                                                                          |</span><br><span class="line">|                 | created_at=&#x27;2023-02-23T08:46:51Z&#x27;, direction=&#x27;egress&#x27;, ethertype=&#x27;IPv6&#x27;, id=&#x27;f52f4f79-2e9f-479f-abdf-1baee9d56f14&#x27;, updated_at=&#x27;2023-02-23T08:46:51Z&#x27;                                                                                          |</span><br><span class="line">| tags            | []                                                                                                                                                                                                                                             |</span><br><span class="line">| updated_at      | 2023-02-23T08:51:27Z </span><br></pre></td></tr></table></figure>

<h3 id="4-项目管理"><a href="#4-项目管理" class="headerlink" title="4.项目管理"></a>4.项目管理</h3><p>在 keystone 中使用openstack创建shop项目添加描述为”Hello shop”，完成后使用openstack命令禁用该项目，然后使用openstack命令查看该项目的详细信息。</p>
<p>将openstack project show shop命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: enabled&amp;&amp;False&amp;&amp;name&amp;&amp;shop</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack project create --description &quot;Hello shop&quot; shop</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| Field       | Value                            |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| description | Hello shop                       |</span><br><span class="line">| domain_id   | default                          |</span><br><span class="line">| enabled     | True                             |</span><br><span class="line">| id          | 0e37ad8443764f759f6691a1f0dbff9d |</span><br><span class="line">| is_domain   | False                            |</span><br><span class="line">| name        | shop                             |</span><br><span class="line">| options     | &#123;&#125;                               |</span><br><span class="line">| parent_id   | default                          |</span><br><span class="line">| tags        | []                               |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">禁用shop项目</span></span><br><span class="line">[root@controller ~]# openstack project set --disable shop</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看</span></span><br><span class="line">[root@controller ~]# openstack project show shop</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| Field       | Value                            |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| description | Hello shop                       |</span><br><span class="line">| domain_id   | default                          |</span><br><span class="line">| enabled     | False                            |</span><br><span class="line">| id          | 0e37ad8443764f759f6691a1f0dbff9d |</span><br><span class="line">| is_domain   | False                            |</span><br><span class="line">| name        | shop                             |</span><br><span class="line">| options     | &#123;&#125;                               |</span><br><span class="line">| parent_id   | default                          |</span><br><span class="line">| tags        | []                               |</span><br></pre></td></tr></table></figure>

<h3 id="5-用户管理"><a href="#5-用户管理" class="headerlink" title="5.用户管理"></a>5.用户管理</h3><p>使用openstack命令查看admin租户的当前配额值、将admin租户的实例配额提升到13，然后查看修改后admin租户的配额值。</p>
<p>将openstack quota show admin命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: instances&amp;&amp;13&amp;&amp;project_name&amp;&amp;admin&amp;&amp;routers&amp;&amp;ram</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack quota show admin</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改</span></span><br><span class="line">[root@controller ~]# openstack quota set --instances 13 admin</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看</span></span><br><span class="line">[root@controller ~]# openstack quota show admin</span><br><span class="line">+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Field                | Value                                                                                                                                                                              |</span><br><span class="line">+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| cores                | 20                                                                                                                                                                                 |</span><br><span class="line">| fixed-ips            | -1                                                                                                                                                                                 |</span><br><span class="line">| floating-ips         | 50                                                                                                                                                                                 |</span><br><span class="line">| health_monitors      | None                                                                                                                                                                               |</span><br><span class="line">| injected-file-size   | 10240                                                                                                                                                                              |</span><br><span class="line">| injected-files       | 5                                                                                                                                                                                  |</span><br><span class="line">| injected-path-size   | 255                                                                                                                                                                                |</span><br><span class="line">| instances            | 13                                                                                                                                                                                 |</span><br><span class="line">| key-pairs            | 100                                                                                                                                                                                |</span><br><span class="line">| l7_policies          | None                                                                                                                                                                               |</span><br><span class="line">| listeners            | None                                                                                                                                                                               |</span><br><span class="line">| load_balancers       | None                                                                                                                                                                               |</span><br><span class="line">| location             | Munch(&#123;&#x27;project&#x27;: Munch(&#123;&#x27;domain_name&#x27;: &#x27;Default&#x27;, &#x27;domain_id&#x27;: None, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;id&#x27;: u&#x27;ce21284fd468495995218ea6e1aeea2a&#x27;&#125;), &#x27;cloud&#x27;: &#x27;&#x27;, &#x27;region_name&#x27;: &#x27;&#x27;, &#x27;zone&#x27;: None&#125;) |</span><br><span class="line">| name                 | None                                                                                                                                                                               |</span><br><span class="line">| networks             | 100                                                                                                                                                                                |</span><br><span class="line">| pools                | None                                                                                                                                                                               |</span><br><span class="line">| ports                | 500                                                                                                                                                                                |</span><br><span class="line">| project              | ce21284fd468495995218ea6e1aeea2a                                                                                                                                                   |</span><br><span class="line">| project_name         | admin                                                                                                                                                                              |</span><br><span class="line">| properties           | 128                                                                                                                                                                                |</span><br><span class="line">| ram                  | 51200                                                                                                                                                                              |</span><br><span class="line">| rbac_policies        | 10                                                                                                                                                                                 |</span><br><span class="line">| routers              | 10                                                                                                                                                                                 |</span><br><span class="line">| secgroup-rules       | 100                                                                                                                                                                                |</span><br><span class="line">| secgroups            | 10                                                                                                                                                                                 |</span><br><span class="line">| server-group-members | 10                                                                                                                                                                                 |</span><br><span class="line">| server-groups        | 10                                                                                                                                                                                 |</span><br><span class="line">| subnet_pools         | -1                                                                                                                                                                                 |</span><br><span class="line">| subnets              | 100</span><br></pre></td></tr></table></figure>

<h3 id="6-heat模板管理"><a href="#6-heat模板管理" class="headerlink" title="6.heat模板管理"></a>6.heat模板管理</h3><p>执行脚本openstack-controller-heat.sh安装完heat服务后，编写Heat模板create_flavor.yaml，创建名为“m2.flavor”、ID为 1234、内存为1024MB、硬盘为20GB、vcpu数量为1的云主机类型，创建完成后使用openstack命令查看堆栈列表。</p>
<p>将openstack stack list命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: Stack&amp;&amp;Status&amp;&amp;CREATE_COMPLETE</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cat create_flavor.yaml</span><br><span class="line">heat_template_version: 2018-08-31</span><br><span class="line">description: Generated template</span><br><span class="line">resources:</span><br><span class="line">  nova_flavor:</span><br><span class="line">    type: OS::Nova::Flavor</span><br><span class="line">    properties:</span><br><span class="line">      name: m2.flavor</span><br><span class="line">      disk: 20</span><br><span class="line">      is_public: True</span><br><span class="line">      ram: 1024</span><br><span class="line">      vcpus: 1</span><br><span class="line">      flavorid: 1234</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">执行heat模板</span></span><br><span class="line">[root@controller ~]# openstack stack create -t create_flavor.yaml test</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">| Field               | Value                                |</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">| id                  | ffd515d5-9d06-4ead-872e-e698ceb77959 |</span><br><span class="line">| stack_name          | test                                 |</span><br><span class="line">| description         | Generated template                   |</span><br><span class="line">| creation_time       | 2023-02-27T10:19:40Z                 |</span><br><span class="line">| updated_time        | None                                 |</span><br><span class="line">| stack_status        | CREATE_IN_PROGRESS                   |</span><br><span class="line">| stack_status_reason | Stack CREATE started                 |</span><br><span class="line">+---------------------+--------------------------------------+.</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看列表</span></span><br><span class="line">[root@controller ~]# openstack stack list</span><br><span class="line">+--------------------------------------+------------+----------------------------------+----------------+----------------------+--------------+</span><br><span class="line">| ID                                   | Stack Name | Project                          | Stack Status   | Creation Time        | Updated Time |</span><br><span class="line">+--------------------------------------+------------+----------------------------------+----------------+----------------------+--------------+</span><br><span class="line">| ffd515d5-9d06-4ead-872e-e698ceb77959 | test       | ce21284fd468495995218ea6e1aeea2a | CHECK_COMPLETE | 2023-02-27T10:19:40Z | None         |</span><br></pre></td></tr></table></figure>

<h3 id="7-后端配置文件管理"><a href="#7-后端配置文件管理" class="headerlink" title="7.后端配置文件管理"></a>7.后端配置文件管理</h3><p>修改glance后端配置文件，将项目的映像存储限制为10GB,完成后重启glance服务。</p>
<p>将cat &#x2F;etc&#x2F;glance&#x2F;glance-api.conf |grep _quota命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: user_storage_quota&amp;&amp;10737418240</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# vim /etc/glance/glance-api.conf</span><br><span class="line">user_storage_quota = 10737418240</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启</span></span><br><span class="line">[root@controller ~]# systemctl restart openstack-glance-*</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查询</span></span><br><span class="line">[root@controller ~]# cat /etc/glance/glance-api.conf |grep _quota</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">``image_property_quota`` configuration option.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">     * image_property_quota</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">image_member_quota = 128</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">image_property_quota = 128</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">image_tag_quota = 128</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">image_location_quota = 10</span></span><br><span class="line">user_storage_quota = 10737418240</span><br></pre></td></tr></table></figure>

<h3 id="8-存储服务管理"><a href="#8-存储服务管理" class="headerlink" title="8.存储服务管理"></a>8.存储服务管理</h3><p>在controller节点执行openstack-controller-cinder.sh,compute节点执行openstack-compute-cinder.sh，在controller和compute节点上会自行安装cinder服务并完成配置。使用openstack命令创建一个名为lvm的卷类型，使用cinder命令创建该类型规格键值对，要求lvm卷类型对应cinder后端驱动lvm所管理的存储资源,名字lvm_test，大小1G的云硬盘并查询该云硬盘的详细信息。</p>
<p>将cinder show lvm_test命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: name&amp;&amp;lvm_test&amp;&amp;size&amp;&amp;1&amp;&amp;volume_type&amp;&amp;lvm</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-cinder.sh </span><br><span class="line">[root@compute ~]# openstack-compute-cinder.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建卷类型lvm</span></span><br><span class="line">[root@controller ~]# source admin-openrc</span><br><span class="line">[root@controller ~]# openstack volume type create lvm</span><br><span class="line">+-------------+--------------------------------------+</span><br><span class="line">| Field       | Value                                |</span><br><span class="line">+-------------+--------------------------------------+</span><br><span class="line">| description | None                                 |</span><br><span class="line">| id          | 5a1ac113-b226-4646-9a7c-46eee3f6346f |</span><br><span class="line">| is_public   | True                                 |</span><br><span class="line">| name        | lvm                                  |</span><br><span class="line">+-------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# cinder type-key lvm set volume_backend_name=LVM</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建云硬盘</span></span><br><span class="line">[root@controller ~]# cinder create --volume-type lvm --name lvm_test 1</span><br><span class="line">略                                               </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看详细信息</span></span><br><span class="line">[root@controller ~]# cinder show lvm_test</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| Property                       | Value                                |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| attached_servers               | []                                   |</span><br><span class="line">| attachment_ids                 | []                                   |</span><br><span class="line">| availability_zone              | nova                                 |</span><br><span class="line">| bootable                       | false                                |</span><br><span class="line">| consistencygroup_id            | None                                 |</span><br><span class="line">| created_at                     | 2022-10-25T12:28:55.000000           |</span><br><span class="line">| description                    | None                                 |</span><br><span class="line">| encrypted                      | False                                |</span><br><span class="line">| id                             | 39f131c3-6ee2-432a-8096-e13173307339 |</span><br><span class="line">| metadata                       |                                      |</span><br><span class="line">| migration_status               | None                                 |</span><br><span class="line">| multiattach                    | False                                |</span><br><span class="line">| name                           | lvm_test                             |</span><br><span class="line">| os-vol-host-attr:host          | compute@lvm#LVM                      |</span><br><span class="line">| os-vol-mig-status-attr:migstat | None                                 |</span><br><span class="line">| os-vol-mig-status-attr:name_id | None                                 |</span><br><span class="line">| os-vol-tenant-attr:tenant_id   | 4885b78813a5466d9d6d483026f2067c     |</span><br><span class="line">| replication_status             | None                                 |</span><br><span class="line">| size                           | 1                                    |</span><br><span class="line">| snapshot_id                    | None                                 |</span><br><span class="line">| source_volid                   | None                                 |</span><br><span class="line">| status                         | available                            |</span><br><span class="line">| updated_at                     | 2022-10-25T12:28:56.000000           |</span><br><span class="line">| user_id                        | b4a6c1eb18c247edba11b57be18ec752     |</span><br><span class="line">| volume_type                    | lvm                                  |</span><br></pre></td></tr></table></figure>

<h3 id="9-存储管理"><a href="#9-存储管理" class="headerlink" title="9.存储管理"></a>9.存储管理</h3><p>为了减缓来自实例的数据访问速度的变慢，OpenStack Block Storage 支持对卷数据复制带宽的速率限制。请修改cinder后端配置文件将卷复制带宽限制为最高100MiB&#x2F;s（对应数值修改为104857600）。</p>
<p>将cat &#x2F;etc&#x2F;cinder&#x2F;cinder.conf | grep 104857600命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: volume_copy_bps_limit&amp;&amp;104857600</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# vim /etc/cinder/cinder.conf</span><br><span class="line">[lvmdriver-1]</span><br><span class="line">volume_group=cinder-volumes-1</span><br><span class="line">volume_driver=cinder.volume.drivers.lvm.LVMVolumeDriver</span><br><span class="line">volume_backend_name=LVM</span><br><span class="line">volume_copy_bps_limit=104857600</span><br><span class="line">[root@controller ~]# systemctl restart openstack-cinder-*</span><br><span class="line">[root@controller ~]# cat /etc/cinder/cinder.conf | grep 104857600</span><br><span class="line">volume_copy_bps_limit=104857600</span><br></pre></td></tr></table></figure>

<h3 id="10-存储管理"><a href="#10-存储管理" class="headerlink" title="10.存储管理"></a>10.存储管理</h3><p>在controller节点执行openstack-controller-swift.sh,compute节点执行openstack-compute-swift.sh，在controller和compute节点上会自行安装swift服务并完成配置。使用swift命令创建一个名为file的容器并查看，然后把cirros-0.3.4-x86_64-disk.img上传到file容器中。</p>
<p>将swift stat file命令的返回结果提交到答题框。【1分】</p>
<p><strong>标准: Container&amp;&amp;file&amp;&amp;Objects&amp;&amp;1&amp;&amp;Bytes&amp;&amp;13287936</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack-controller-swift.sh</span><br><span class="line">[root@compute ~]# openstack-compute-swift.sh</span><br><span class="line">[root@controller ~]# swift post file</span><br><span class="line">[root@controller ~]# swift upload file /root/cirros-0.3.4-x86_64-disk.img</span><br><span class="line">root/cirros-0.3.4-x86_64-disk.img</span><br><span class="line">[root@controller ~]# swift stat file</span><br><span class="line">               Account: AUTH_d23ad8b534f44b02ad30c9f7847267df</span><br><span class="line">             Container: file</span><br><span class="line">               Objects: 1</span><br><span class="line">                 Bytes: 13287936</span><br><span class="line">              Read ACL:</span><br><span class="line">             Write ACL:</span><br><span class="line">               Sync To:</span><br><span class="line">              Sync Key:</span><br><span class="line">         Accept-Ranges: bytes</span><br><span class="line">      X-Storage-Policy: Policy-0</span><br><span class="line">         Last-Modified: Fri, 10 Mar 2023 02:43:07 GMT</span><br><span class="line">           X-Timestamp: 1678416180.44884</span><br><span class="line">            X-Trans-Id: txfdc2fb777c4641d3a9292-00640a9941</span><br><span class="line">          Content-Type: application/json; charset=utf-8</span><br><span class="line">X-Openstack-Request-Id: txfdc2fb777c4641d3a9292-00640a9941</span><br></pre></td></tr></table></figure>

<h3 id="11-OpenStack-API-管理"><a href="#11-OpenStack-API-管理" class="headerlink" title="11.OpenStack API 管理"></a>11.OpenStack API 管理</h3><p>使用curl的方式获取admin用户token值；使用已获取的token值通过curl的方式获取domain为default所有用户名（ip使用主机名）。</p>
<p>将获取到的所有用户名提交到答题框。【1分】</p>
<p><strong>标准: admin&amp;&amp;myuser&amp;&amp;tom&amp;&amp;glance&amp;&amp;nova&amp;&amp;placement&amp;&amp;neutron&amp;&amp;heat&amp;&amp;cinder&amp;&amp;swift</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# curl -i -X POST http://controller:5000/v3/auth/tokens -H &quot;Content-type: application/json&quot; -d &#x27;&#123;&quot;auth&quot;: &#123;&quot;identity&quot;: &#123;&quot;methods&quot;:[&quot;password&quot;],&quot;password&quot;: &#123;&quot;user&quot;: &#123;&quot;domain&quot;: &#123;&quot;name&quot;: &quot;default&quot;&#125;,&quot;name&quot;: &quot;admin&quot;,&quot;password&quot;: &quot;000000&quot;&#125;&#125;&#125;,&quot;scope&quot;: &#123;&quot;project&quot;: &#123;&quot;domain&quot;: &#123;&quot;name&quot;: &quot;default&quot;&#125;,&quot;name&quot;: &quot;admin&quot;&#125;&#125;&#125;&#125;&#x27; | grep X-Subject-Token</span><br><span class="line"><span class="meta prompt_">  % </span><span class="language-bash">Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100  6821  100  6612  100   209  21381    675 --:--:-- --:--:-- --:--:-- 21398</span><br><span class="line">X-Subject-Token: gAAAAABkB9xoMQZNnMcPh_gB4T0Pmo4TUO1ezwBZtFSjAR68fUOppadNTTCpcOGjMpN3al9FM8MHma9FCSoWxQHSuG9vbxOxkELeKBqF_I2_uzmouvxGQ7a35oJ5IvGwNp4hap5doeXt-2dG5LvPyqxW7hndEAQDjuTKbnqVlwHbjXVpT4zoYuc</span><br><span class="line">[root@controller ~]# curl http://controller:5000/v3/users?domain_id=default -H &quot;X-Auth-Token: gAAAAABkB9xoMQZNnMcPh_gB4T0Pmo4TUO1ezwBZtFSjAR68fUOppadNTTCpcOGjMpN3al9FM8MHma9FCSoWxQHSuG9vbxOxkELeKBqF_I2_uzmouvxGQ7a35oJ5IvGwNp4hap5doeXt-2dG5LvPyqxW7hndEAQDjuTKbnqVlwHbjXVpT4zoYuc&quot; | python -m json.tool | grep name</span><br><span class="line"><span class="meta prompt_">  % </span><span class="language-bash">Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100  2479  100  2479    0     0  22848      0 --:--:-- --:--:-- --:--:-- 22953</span><br><span class="line">            &quot;name&quot;: &quot;admin&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;myuser&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;tom&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;glance&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;nova&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;placement&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;neutron&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;cinder&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;swift&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;heat&quot;,</span><br></pre></td></tr></table></figure>

<h2 id="任务四-OpenStack架构任务（6分）"><a href="#任务四-OpenStack架构任务（6分）" class="headerlink" title="任务四 OpenStack架构任务（6分）"></a>任务四 OpenStack架构任务（6分）</h2><h3 id="1-安装python3环境"><a href="#1-安装python3环境" class="headerlink" title="1.安装python3环境"></a>1.安装python3环境</h3><p>在controller节点安装python3环境。安装完之后查看python3版本，使用提供的whl文件安装依赖。</p>
<p>将pip3 list命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: certifi&amp;&amp;2019.11.28&amp;&amp;pip&amp;&amp;9.0.3&amp;&amp;urllib3&amp;&amp;1.25.11&amp;&amp;setuptools&amp;&amp;39.2.0</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@controller python-depend]# yum install python3 –y</span><br><span class="line">[root@controller python-depend]# pip3 install certifi-2019.11.28-py2.py3-none-any.whl</span><br><span class="line">[root@controller python-depend]# pip3 install urllib3-1.25.11-py3-none-any.whl</span><br><span class="line">[root@controller python-depend]# pip3 install idna-2.8-py2.py3-none-any.whl</span><br><span class="line">[root@controller python-depend]# pip3 install chardet-3.0.4-py2.py3-none-any.whl</span><br><span class="line">[root@controller python-depend]# pip3 install requests-2.24.0-py2.py3-none-any.whl</span><br><span class="line">[root@controller ~]# python3 --version</span><br><span class="line">Python 3.6.8</span><br><span class="line">[root@controller ~]# pip3 list</span><br><span class="line">DEPRECATION: The default format will switch to columns in the future. You can use --format=(legacy|columns) (or define a format=(legacy|columns) in your pip.conf under the [list] section) to disable this warning.</span><br><span class="line">certifi (2019.11.28)</span><br><span class="line">chardet (3.0.4)</span><br><span class="line">idna (2.8)</span><br><span class="line">pip (9.0.3)</span><br><span class="line">requests (2.24.0)</span><br><span class="line">setuptools (39.2.0)</span><br><span class="line">urllib3 (1.25.11)</span><br></pre></td></tr></table></figure>

<h3 id="2-python对接OpenStack-API创建image镜像"><a href="#2-python对接OpenStack-API创建image镜像" class="headerlink" title="2.python对接OpenStack API创建image镜像"></a>2.python对接OpenStack API创建image镜像</h3><p>编写python代码对接OpenStack API，完成镜像的上传。在controller节点的&#x2F;root目录下创建create_image.py文件，在该文件中编写python代码对接openstack api（需在py文件中获取token），要求在openstack私有云平台中上传镜像cirros-0.3.4-x86_64-disk.img，名字为cirros001，disk_format为qcow2，container_format为bare。执行完代码要求输出“创建镜像成功，id为：xxxxxx”。</p>
<p>分别将cat &#x2F;root&#x2F;create_image.py命令和python3 create_image.py命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: import&amp;&amp;requests&amp;&amp;:5000&#x2F;v3&#x2F;auth&#x2F;tokens&amp;&amp;:9292&#x2F;v2&#x2F;images&amp;&amp;password&amp;&amp;admin&amp;&amp;000000&amp;&amp;X-Auth-Token&amp;&amp;container_format&amp;&amp;bare&amp;&amp;disk_format&amp;&amp;qcow2&amp;&amp;&#x2F;file&amp;&amp;cirros-0.3.4-x86_64-disk.img&amp;&amp;application</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">[root@controller python3]# python3 create_image.py</span><br><span class="line">请输入访问openstack平台控制节点IP地址：（xx.xx.xx.xx)</span><br><span class="line">192.168.100.x</span><br><span class="line">创建镜像成功，id为：0591f693-a7c7-4e7f-ac6c-957b7bccffc9</span><br><span class="line">镜像文件上传成功</span><br><span class="line">[root@controller ~]# cat create_image.py</span><br><span class="line">import requests,json,time</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">*******************全局变量IP*****************************</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">执行代码前，请修改controller_ip的IP地址，与指定router，IP可以input，也可以写成静态</span></span><br><span class="line">controller_ip = input(&quot;请输入访问openstack平台控制节点IP地址：（xx.xx.xx.xx)\n&quot;)</span><br><span class="line"></span><br><span class="line">image_name = &quot;cirros001&quot;</span><br><span class="line">file_path = &quot;/root/cirros-0.3.4-x86_64-disk.img&quot;</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    url  = f&quot;http://&#123;controller_ip&#125;:5000/v3/auth/tokens&quot;</span><br><span class="line">    body = &#123;</span><br><span class="line">       &quot;auth&quot;: &#123;</span><br><span class="line">           &quot;identity&quot;: &#123;</span><br><span class="line">              &quot;methods&quot;:[&quot;password&quot;],</span><br><span class="line">              &quot;password&quot;: &#123;</span><br><span class="line">                  &quot;user&quot;: &#123;</span><br><span class="line">                     &quot;domain&quot;:&#123;</span><br><span class="line">                         &quot;name&quot;: &quot;Default&quot;</span><br><span class="line">                     &#125;,</span><br><span class="line">                     &quot;name&quot;: &quot;admin&quot;,</span><br><span class="line">                     &quot;password&quot;: &quot;000000&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;,</span><br><span class="line">           &quot;scope&quot;: &#123;</span><br><span class="line">              &quot;project&quot;: &#123;</span><br><span class="line">                  &quot;domain&quot;: &#123;</span><br><span class="line">                     &quot;name&quot;: &quot;Default&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &quot;name&quot;: &quot;admin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    headers = &#123;&quot;Content-Type&quot;: &quot;application/json&quot;&#125;</span><br><span class="line">    Token = requests.post(url, data=json.dumps(body), headers=headers).headers[&#x27;X-Subject-Token&#x27;]</span><br><span class="line">    headers = &#123;&quot;X-Auth-Token&quot;: Token&#125;</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(f&quot;获取Token值失败，请检查访问云主机控制节点IP是否正确？输出错误信息如下：&#123;str(e)&#125;&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line"></span><br><span class="line">class glance_api:</span><br><span class="line">    def __init__(self, headers: dict, resUrl: str):</span><br><span class="line">       self.headers = headers</span><br><span class="line">       self.resUrl = resUrl</span><br><span class="line">    #创建glance镜像</span><br><span class="line">    def create_glance(self, container_format=&quot;bare&quot;, disk_format=&quot;qcow2&quot;):</span><br><span class="line">       body = &#123;</span><br><span class="line">           &quot;container_format&quot;: container_format,</span><br><span class="line">           &quot;disk_format&quot;: disk_format,</span><br><span class="line">           &quot;name&quot;: image_name,</span><br><span class="line">        &#125;</span><br><span class="line">       status_code = requests.post(self.resUrl, data=json.dumps(body), headers=self.headers).status_code</span><br><span class="line">       if(status_code == 201):</span><br><span class="line">           return f&quot;创建镜像成功，id为：&#123;glance_api.get_glance_id()&#125;&quot;</span><br><span class="line">       else:</span><br><span class="line">           return &quot;创建镜像失败&quot;</span><br><span class="line">    #获取glance镜像id</span><br><span class="line">    def get_glance_id(self):</span><br><span class="line">       result = json.loads(requests.get(self.resUrl,headers=self.headers).text)</span><br><span class="line">       for item in result[&#x27;images&#x27;]:</span><br><span class="line">           if(item[&#x27;name&#x27;] == image_name):</span><br><span class="line">              return item[&#x27;id&#x27;]</span><br><span class="line">    #上传glance镜像</span><br><span class="line">    def update_glance(self):</span><br><span class="line">       self.resUrl=self.resUrl+&quot;/&quot;+self.get_glance_id()+&quot;/file&quot;</span><br><span class="line">       self.headers[&#x27;Content-Type&#x27;] = &quot;application/octet-stream&quot;</span><br><span class="line">       status_code = requests.put(self.resUrl,data=open(file_path,&#x27;rb&#x27;).read(),headers=self.headers).status_code</span><br><span class="line">       if(status_code == 204):</span><br><span class="line">           return &quot;镜像文件上传成功&quot;</span><br><span class="line">       else:</span><br><span class="line">           return &quot;镜像文件上传失败&quot;</span><br><span class="line">glance_api = glance_api(headers,f&quot;http://&#123;controller_ip&#125;:9292/v2/images&quot;)</span><br><span class="line">print(glance_api.create_glance())  #调用glance-api中创建镜像方法</span><br><span class="line">print(glance_api.update_glance())</span><br></pre></td></tr></table></figure>

<h3 id="3-python对接OpenStack-API创建用户"><a href="#3-python对接OpenStack-API创建用户" class="headerlink" title="3.python对接OpenStack API创建用户"></a>3.python对接OpenStack API创建用户</h3><p>编写python代码对接OpenStack API，完成用户的创建。在controller节点的&#x2F;root目录下创建create_user.py文件，在该文件中编写python代码对接openstack api（需在py文件中获取token），要求在openstack私有云平台中创建用户guojibeisheng。</p>
<p>将cat &#x2F;root&#x2F;create_user.py命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: import&amp;&amp;requests&amp;&amp;:5000&#x2F;v3&#x2F;auth&#x2F;tokens&amp;&amp;:5000&#x2F;v3&#x2F;users&amp;&amp;password&amp;&amp;admin&amp;&amp;000000&amp;&amp;X-Auth-Token&amp;&amp;domain_id&amp;&amp;name&amp;&amp;application&amp;&amp;:5000&#x2F;v3&#x2F;users</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">[root@controller python3]# python3 create_user.py</span><br><span class="line">请输入访问openstack平台控制节点IP地址：（xx.xx.xx.xx)</span><br><span class="line">192.168.100.x</span><br><span class="line">用户 guojibeisheng 创建成功,ID为dcb0fc7bacf54038b624463921123aed</span><br><span class="line">该平台的用户为：</span><br><span class="line">guojibeisheng</span><br><span class="line">admin</span><br><span class="line">myuser</span><br><span class="line">tom</span><br><span class="line">glance</span><br><span class="line">nova</span><br><span class="line">placement</span><br><span class="line">neutron</span><br><span class="line">heat</span><br><span class="line">heat_domain_admin</span><br><span class="line">cinder</span><br><span class="line">swift</span><br><span class="line">用户 guojibeisheng 已删除！</span><br><span class="line">[root@controller python3]# cat create_user.py</span><br><span class="line">import requests,json,time</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">*******************全局变量IP*****************************</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">执行代码前，请修改controller_ip的IP地址，与指定router，IP可以input，也可以写成静态</span></span><br><span class="line">controller_ip = input(&quot;请输入访问openstack平台控制节点IP地址：（xx.xx.xx.xx)\n&quot;)</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    url  = f&quot;http://&#123;controller_ip&#125;:5000/v3/auth/tokens&quot;</span><br><span class="line">    body = &#123;</span><br><span class="line">       &quot;auth&quot;: &#123;</span><br><span class="line">           &quot;identity&quot;: &#123;</span><br><span class="line">              &quot;methods&quot;:[&quot;password&quot;],</span><br><span class="line">              &quot;password&quot;: &#123;</span><br><span class="line">                  &quot;user&quot;: &#123;</span><br><span class="line">                     &quot;domain&quot;:&#123;</span><br><span class="line">                         &quot;name&quot;: &quot;Default&quot;</span><br><span class="line">                     &#125;,</span><br><span class="line">                      &quot;name&quot;: &quot;admin&quot;,</span><br><span class="line">                     &quot;password&quot;: &quot;000000&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;,</span><br><span class="line">           &quot;scope&quot;: &#123;</span><br><span class="line">              &quot;project&quot;: &#123;</span><br><span class="line">                  &quot;domain&quot;: &#123;</span><br><span class="line">                     &quot;name&quot;: &quot;Default&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &quot;name&quot;: &quot;admin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    headers = &#123;&quot;Content-Type&quot;: &quot;application/json&quot;&#125;</span><br><span class="line">    Token = requests.post(url, data=json.dumps(body), headers=headers).headers[&#x27;X-Subject-Token&#x27;]</span><br><span class="line">    headers = &#123;&quot;X-Auth-Token&quot;: Token&#125;</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(f&quot;获取Token值失败，请检查访问云主机控制节点IP是否正确？输出错误信息如下：&#123;str(e)&#125;&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line"></span><br><span class="line">class openstack_user_api:</span><br><span class="line">    def __init__(self, handers: dict, resUrl: str):</span><br><span class="line">        self.headers = handers</span><br><span class="line">        self.resUrl = resUrl</span><br><span class="line">    def create_users(self, user_name):</span><br><span class="line">        body = &#123;</span><br><span class="line">            &quot;user&quot;: &#123;</span><br><span class="line">                &quot;description&quot;: &quot;API create user!&quot;,</span><br><span class="line">                &quot;domain_id&quot;: &quot;default&quot;,</span><br><span class="line">                &quot;name&quot;: user_name</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        status_code = requests.post(self.resUrl, data=json.dumps(body), headers=self.headers).text</span><br><span class="line">        result = json.loads(requests.get(self.resUrl, headers=self.headers).text)</span><br><span class="line">        user_name = user_name</span><br><span class="line">        for i in result[&#x27;users&#x27;]:</span><br><span class="line">            if i[&#x27;name&#x27;] == user_name:</span><br><span class="line">                return f&quot;用户 &#123;user_name&#125; 创建成功,ID为&#123;i[&#x27;id&#x27;]&#125;&quot;</span><br><span class="line">    def list_users(self):</span><br><span class="line">        result = json.loads(requests.get(self.resUrl, headers=self.headers).text)</span><br><span class="line">        roles = []</span><br><span class="line">        for i in result[&#x27;users&#x27;]:</span><br><span class="line">            if i[&#x27;name&#x27;] not in roles:</span><br><span class="line">                roles.append(i[&#x27;name&#x27;])</span><br><span class="line">        return &quot;该平台的用户为：\n&quot;+&#x27;\n&#x27;.join(roles)</span><br><span class="line"></span><br><span class="line">    def get_user_id(self, user_name):</span><br><span class="line">        result = json.loads(requests.get(self.resUrl, headers=self.headers).text)</span><br><span class="line">        user_name = user_name</span><br><span class="line">        for i in result[&#x27;users&#x27;]:</span><br><span class="line">            if i[&#x27;name&#x27;] == user_name:</span><br><span class="line">                return (f&quot;用户 &#123;user_name&#125; 的ID为&#123;i[&#x27;id&#x27;]&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    def delete_user(self, user_name):</span><br><span class="line">        result = json.loads(requests.get(self.resUrl, headers=self.headers).text)</span><br><span class="line">        for i in result[&#x27;users&#x27;]:</span><br><span class="line">            if i[&#x27;name&#x27;] == user_name:</span><br><span class="line">                i = i[&#x27;id&#x27;]</span><br><span class="line">                status_code = requests.delete(f&#x27;http://&#123;controller_ip&#125;:5000/v3/users/&#123;i&#125;&#x27;, headers=self.headers)</span><br><span class="line">                return f&quot;用户 &#123;user_name&#125; 已删除！&quot;</span><br><span class="line"></span><br><span class="line">openstack_user_api = openstack_user_api(headers, f&quot;http://&#123;controller_ip&#125;:5000/v3/users&quot;)</span><br><span class="line"></span><br><span class="line">print(openstack_user_api.create_users(&quot;guojibeisheng&quot;))</span><br><span class="line">print(openstack_user_api.list_users())</span><br><span class="line">print(openstack_user_api.delete_user(&quot;guojibeisheng&quot;))</span><br></pre></td></tr></table></figure>

<h1 id="B模块题目：容器的编排与运维"><a href="#B模块题目：容器的编排与运维" class="headerlink" title="B模块题目：容器的编排与运维"></a>B模块题目：容器的编排与运维</h1><p>某企业计划使用k8s平台搭建微服务系统，现在先使用简单的微服务项目进行测试，请按照要求完成相应任务。</p>
<p>表1 IP地址规划</p>
<table>
<thead>
<tr>
<th>设备名称</th>
<th>主机名</th>
<th>接口</th>
<th>IP地址</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>云服务器1</td>
<td>master</td>
<td>eth0</td>
<td>公网IP:*******<em>私网IP:192.168.100.</em>&#x2F;24</td>
<td>Harbor也是使用该云服务器</td>
</tr>
<tr>
<td>云服务器2</td>
<td>node</td>
<td>eth0</td>
<td>公网IP:*******<em>私网IP:192.168.100.</em>&#x2F;24</td>
<td></td>
</tr>
</tbody></table>
<p>说明：</p>
<p>1.表1中的公网IP和私网IP以自己云主机显示为准，每个人的公网IP和私网IP不同。使用第三方软件远程连接云主机，使用公网IP连接。</p>
<p>2.华为云中云主机名字已命好，直接使用对应名字的云主机即可。</p>
<p> 3.竞赛用到的软件包都在云主机&#x2F;root下。</p>
<h2 id="任务-1容器云平台环境初始化（10-5分）"><a href="#任务-1容器云平台环境初始化（10-5分）" class="headerlink" title="任务 1容器云平台环境初始化（10.5分）"></a>任务 1容器云平台环境初始化（10.5分）</h2><h3 id="1-容器云平台的初始化"><a href="#1-容器云平台的初始化" class="headerlink" title="1.容器云平台的初始化"></a>1.容器云平台的初始化</h3><p>master节点主机名设置为master、node节点主机名设置为node，所有节点root密码设置为000000,所有节点关闭swap，并配置hosts映射。</p>
<p>请在master节点将ping node -c 3命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: icmp_seq&amp;&amp;0%</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">（1）修改主机名并配置映射</span><br><span class="line">master节点：</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hostnamectl set-hostname master</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">passwd root</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /etc/hosts</span></span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.100.91 master</span><br><span class="line">192.168.100.23 node</span><br><span class="line">node1节点：</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hostnamectl set-hostname node</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">passwd root</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /etc/hosts</span></span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.100.91 master</span><br><span class="line">192.168.100.23 node</span><br><span class="line">（2）关闭swap</span><br><span class="line">master和node节点关闭swap：</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">swapoff -a</span></span><br><span class="line">[root@master ~]# free -m</span><br><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:       7821         129        7548          16         143        7468</span><br><span class="line">Swap:         0           0           0</span><br><span class="line">[root@master ~]# ping node -c 3</span><br><span class="line">PING node (192.168.100.23) 56(84) bytes of data.</span><br><span class="line">64 bytes from node (192.168.100.23): icmp_seq=1 ttl=64 time=0.228 ms</span><br><span class="line">64 bytes from node (192.168.100.23): icmp_seq=2 ttl=64 time=0.242 ms</span><br><span class="line">64 bytes from node (192.168.100.23): icmp_seq=3 ttl=64 time=0.151 ms</span><br><span class="line"></span><br><span class="line">--- node ping statistics ---</span><br><span class="line">3 packets transmitted, 3 received, 0% packet loss, time 1999ms</span><br><span class="line">rtt min/avg/max/mdev = 0.151/0.207/0.242/0.040 ms</span><br></pre></td></tr></table></figure>

<h3 id="2-镜像文件的复制"><a href="#2-镜像文件的复制" class="headerlink" title="2.镜像文件的复制"></a>2.镜像文件的复制</h3><p>&#x2F;root目录存放有CentOS-7-x86_64-DVD-2009.iso和kubernetes_V1.2.iso光盘镜像文件，在&#x2F;opt目录下使用命令创建centos目录，并将镜像文件CentOS-7-x86_64-DVD-2009.iso中的内容复制到centos目录下，将镜像文件kubernetes_V1.2.iso中的内容复制到 &#x2F;opt目录下。</p>
<p>请在master节点将du -h &#x2F;opt&#x2F; –max-depth&#x3D;1命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: 4.5G&amp;¢os&amp;&amp;2.8G&amp;&amp;images</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">master节点：</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> /opt/centos</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mount -o loop CentOS-7-x86_64-DVD-2009.iso /mnt/</span></span><br><span class="line">mount: /dev/loop0 is write-protected, mounting read-only</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> -rvf /mnt/* /opt/centos/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">umount /mnt</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mount -o loop kubernetes_V1.2.iso /mnt/</span></span><br><span class="line">mount: /dev/loop0 is write-protected, mounting read-only</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> -rvf /mnt/* /opt/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">umount /mnt</span></span><br><span class="line">[root@master ~]# du -h /opt/ --max-depth=1</span><br><span class="line">4.5G    /opt/centos</span><br><span class="line">77M /opt/cri</span><br><span class="line">25M /opt/docker-compose</span><br><span class="line">630M    /opt/harbor</span><br><span class="line">2.8G    /opt/images</span><br><span class="line">172M    /opt/kubernetes-repo</span><br><span class="line">20K /opt/yaml</span><br><span class="line">8.1G    /opt/</span><br></pre></td></tr></table></figure>

<h3 id="3-Yum源的编写"><a href="#3-Yum源的编写" class="headerlink" title="3.Yum源的编写"></a>3.Yum源的编写</h3><p>在master节点首先将系统自带的yum源移动到&#x2F;home目录，然后为master节点配置本地yum源，yum源文件名为local.repo。</p>
<p>将yum repolist命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: 4070&amp;&amp;45</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> /etc/yum.repos.d/CentOS-* /home</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">[root@master ~] <span class="built_in">cat</span> /etc/yum.repos.d/local.repo</span></span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///opt/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[k8s]</span><br><span class="line">name=k8s</span><br><span class="line">baseurl=file:///opt/kubernetes-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[root@master ~]# yum repolist</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">repo id                       repo name                    status</span><br><span class="line">centos                        centos                       4,070</span><br><span class="line">k8s                           k8s                             45</span><br><span class="line">repolist: 4,115</span><br></pre></td></tr></table></figure>

<h3 id="4-安装ftp服务"><a href="#4-安装ftp服务" class="headerlink" title="4.安装ftp服务"></a><strong>4.安装ftp服务</strong></h3><p>在master节点安装ftp服务，将ftp共享目录设置为 &#x2F;opt。</p>
<p>将ps -ef | grep ftp命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: vsftpd.conf</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum install -y vsftpd</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vi /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">anon_root=/opt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl start vsftpd &amp;&amp; systemctl <span class="built_in">enable</span> vsftpd</span></span><br><span class="line">[root@master ~]# ps -ef | grep ftp</span><br><span class="line">root      8112     1  0 07:32 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf</span><br><span class="line">root      8171  7670  0 07:36 pts/0    00:00:00 grep --color=auto ftp</span><br></pre></td></tr></table></figure>

<h3 id="5-ftp源的编写"><a href="#5-ftp源的编写" class="headerlink" title="5.ftp源的编写"></a>5.ftp源的编写</h3><p>为node节点配置ftp源，ftp源文件名称为ftp.repo，其中ftp服务器地址为master节点,配置ftp源时不要写IP地址。</p>
<p>在node节点请将curl <a href="ftp://master命令的返回结果提交到答题框.【1.5分】/">ftp://master命令的返回结果提交到答题框。【1.5分】</a></p>
<p><strong>标准: harbor&amp;&amp;centos</strong></p>
<p>解法: </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# rm -rf /etc/yum.repos.d/*</span><br><span class="line"> [root@node1 ~]# cat  /etc/yum.repos.d/ftp.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=ftp://master/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[k8s]</span><br><span class="line">name=k8s</span><br><span class="line">baseurl=ftp://master/kubernetes-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[root@node ~]# curl ftp://master</span><br><span class="line">drwxr-xr-x    8 0        0             220 Mar 15 07:14 centos</span><br><span class="line">dr-xr-xr-x    2 0        0             131 Mar 15 07:15 cri</span><br><span class="line">dr-xr-xr-x    2 0        0              49 Mar 15 07:15 docker-compose</span><br><span class="line">dr-xr-xr-x    2 0        0              49 Mar 15 07:15 harbor</span><br><span class="line">dr-xr-xr-x    2 0        0              72 Mar 15 07:16 images</span><br><span class="line">dr-xr-xr-x    3 0        0            4096 Mar 15 07:16 kubernetes-repo</span><br></pre></td></tr></table></figure>

<h3 id="6-设置时间同步服务器"><a href="#6-设置时间同步服务器" class="headerlink" title="6.设置时间同步服务器"></a>6.设置时间同步服务器</h3><p>在master节点上部署chrony服务器，允许其它节点同步时间，启动服务并设置为开机自启动；在其他节点上指定master节点为上游NTP服务器，重启服务并设为开机自启动。（配置文件IP用计算机名代替）</p>
<p>在node节点将chronyc  sources命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: master&amp;&amp;us</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">master节点：</span><br><span class="line"> yum install -y chrony</span><br><span class="line"> vi /etc/chrony.conf</span><br><span class="line">server  master  iburst</span><br><span class="line">allow  all</span><br><span class="line">local stratum 10</span><br><span class="line">systemctl start chronyd</span><br><span class="line"> systemctl enable chronyd</span><br><span class="line">node节点：</span><br><span class="line"> yum install -y chrony</span><br><span class="line"> vi /etc/chrony.conf</span><br><span class="line">server master  iburst</span><br><span class="line">systemctl start chronyd</span><br><span class="line">systemctl enable chronyd</span><br><span class="line">[root@node ~]# chronyc sources</span><br><span class="line">210 Number of sources = 1</span><br><span class="line">MS Name/IP address         Stratum Poll Reach LastRx Last sample              </span><br><span class="line">===============================================================================</span><br><span class="line">^* master                       10   6     7    15  -1014ns[ -999us] +/-  134us</span><br></pre></td></tr></table></figure>

<h3 id="7-设置免密登录"><a href="#7-设置免密登录" class="headerlink" title="7.设置免密登录"></a>7.设置免密登录</h3><p>为两台台服务器设置免密登录，保证服务器之间能够互相免密登录。</p>
<p>在master节点将ssh node命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: Last&amp;&amp;login&amp;&amp;from&amp;&amp;successful</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id  master</span><br><span class="line">ssh-copy-id  node</span><br><span class="line">   其它节点的命令和上面一样</span><br><span class="line">[root@harbor ~]# ssh node</span><br><span class="line">Last failed login: Wed Mar 15 09:30:02 UTC 2023 from 170.210.208.108 on ssh:notty</span><br><span class="line">There were 17 failed login attempts since the last successful login.</span><br><span class="line">Last login: Wed Mar 15 02:57:03 2023 from 58.240.20.122</span><br></pre></td></tr></table></figure>

<h2 id="任务2-k8s搭建任务（19-5分）"><a href="#任务2-k8s搭建任务（19-5分）" class="headerlink" title="任务2 k8s搭建任务（19.5分）"></a>任务2 k8s搭建任务（19.5分）</h2><h3 id="1-安装docker应用"><a href="#1-安装docker应用" class="headerlink" title="1.安装docker应用"></a>1.安装docker应用</h3><p>在所有节点上安装dokcer-ce,并设置为开机自启动。</p>
<p>在master节点请将docker version命令的返回结果提交到答题框。【1.5分】</p>
<p>标准: 20.10.22&amp;&amp;1.41&amp;&amp;go1.18.9</p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum install -y yum-utils device-mapper-persistent-data lvm2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum install -y docker-ce</span></span><br><span class="line">启动Docker：</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl start docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl <span class="built_in">enable</span> docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker version</span></span><br><span class="line">[root@master ~]# docker version</span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           20.10.22</span><br><span class="line"> API version:       1.41</span><br><span class="line"> Go version:        go1.18.9</span><br><span class="line"> Git commit:        3a2c30b</span><br><span class="line"> Built:             Thu Dec 15 22:30:24 2022</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"> Experimental:      true</span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          20.10.22</span><br><span class="line">  API version:      1.41 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.18.9</span><br><span class="line">  Git commit:       42c8b31</span><br><span class="line">  Built:            Thu Dec 15 22:28:33 2022</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     false</span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.6.14</span><br><span class="line">  GitCommit:        9ba4b250366a5ddde94bb7c9d1def331423aa323</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.1.4</span><br><span class="line">  GitCommit:        v1.1.4-0-g5fd4c4d</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.19.0</span><br><span class="line">  GitCommit:        de40ad0</span><br></pre></td></tr></table></figure>

<h3 id="2-安装docker应用"><a href="#2-安装docker应用" class="headerlink" title="2.安装docker应用"></a>2.安装docker应用</h3><p>所有节点配置阿里云镜像加速地址(<a target="_blank" rel="noopener" href="https://d8b3zdiw.mirror.aliyuncs.com)并把启动引擎设置为systemd,配置成功后加载配置文件并重启docker服务./">https://d8b3zdiw.mirror.aliyuncs.com)并把启动引擎设置为systemd，配置成功后加载配置文件并重启docker服务。</a></p>
<p>将docker pull ubuntu命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: complete&amp;&amp;docker.io&#x2F;library&#x2F;ubuntu:latest</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# vi /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;insecure-registries&quot; : [&quot;0.0.0.0/0&quot;],</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://d8b3zdiw.mirror.aliyuncs.com&quot;],</span><br><span class="line">  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl restart docker</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">systemctl daemon-reload</span></span><br><span class="line">[root@master ~]# docker pull ubuntu</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/ubuntu</span><br><span class="line">7b1a6ab2e44d: Pull complete</span><br><span class="line">Digest: sha256:626ffe58f6e7566e00254b638eb7e0f3b11d4da9675088f4781a50ae288f3322</span><br><span class="line">Status: Downloaded newer image for ubuntu:latest</span><br><span class="line">docker.io/library/ubuntu:latest</span><br></pre></td></tr></table></figure>

<h3 id="3-载入镜像"><a href="#3-载入镜像" class="headerlink" title="3.载入镜像"></a>3.载入镜像</h3><p> 在master节点&#x2F;opt&#x2F;images目录下使用tar归档文件载入镜像。</p>
<p>   将docker images | grep mysql命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: mysql&amp;&amp;5.6&amp;&amp;303MB</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker load -i images/httpd.tar</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker load -i images/Kubernetes_Base.tar</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker load -i images/Resource-1.tar</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker images | grep mysql</span></span><br><span class="line">mysql  5.6   dd3b2a5dcb48   14 months ago   303MB</span><br></pre></td></tr></table></figure>

<h3 id="4-安装docker-compose"><a href="#4-安装docker-compose" class="headerlink" title="4.安装docker-compose"></a>4.安装docker-compose</h3><p>在master节点使用 &#x2F;opt&#x2F;docker-compose&#x2F;v2.10.2-docker-compose-linux-x86_64文件安装docker-compose。安装完成后执行docker-compose version命令。</p>
<p>将docker-compose version命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: Compose&amp;&amp;v2.10.2</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">chmod</span> +x /opt/docker-compose/v2.10.2-docker-compose-linux-x86_64</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> /opt/docker-compose/v2.10.2-docker-compose-linux-x86_64 /usr/local/bin/docker-compose</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker-compose version</span></span><br><span class="line">Docker Compose version v2.10.2</span><br></pre></td></tr></table></figure>

<h3 id="5-搭建horbor仓库"><a href="#5-搭建horbor仓库" class="headerlink" title="5.搭建horbor仓库"></a>5.搭建horbor仓库</h3><p>在master节点解压&#x2F;opt&#x2F;harbor&#x2F; harbor-offline-installer-v2.5.3.tgz离线安装包，然后安装harbor仓库，并修改相应的yml文件，使各节点默认docker仓库为harbor仓库地址。</p>
<p>在master节点请将docker-compose ps命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: harbor-core&amp;&amp;nginx&amp;®istry&amp;&amp;running&amp;&amp;(healthy)</strong></p>
<p>解法: </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /opt/harbor/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar -zxvf harbor-offline-installer-v2.5.3.tgz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> harbor</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> harbor.yml.tmpl harbor.yml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vi harbor.yml</span></span><br><span class="line">hostname: 192.168.100.10  # 将域名修改为本机IP</span><br><span class="line">harbor_admin_password: Harbor12345</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed -i <span class="string">&quot;13s/^/#/g&quot;</span> harbor.yml</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed -i <span class="string">&quot;15,18s/^/#/g&quot;</span> harbor.yml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker load -i harbor.v2.5.3.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./prepare</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./install.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker-compose ps</span></span><br></pre></td></tr></table></figure>

<h3 id="6-上传docker镜像"><a href="#6-上传docker镜像" class="headerlink" title="6.上传docker镜像"></a>6.上传docker镜像</h3><p>在master节点执行&#x2F;opt&#x2F;k8s_image_push.sh将所有镜像上传至docker仓库。</p>
<p>将docker login master命令的返回结果提交到答题框(填写完整提示输入的内容)。【1.5分】</p>
<p><strong>标准: Login&amp;&amp;Succeeded</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /opt/images/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./k8s_image_push.sh</span></span><br><span class="line">输入镜像仓库地址(不加http/https):192.168.100.91</span><br><span class="line">输入镜像仓库用户名: admin</span><br><span class="line">输入镜像仓库用户密码: Harbor12345</span><br><span class="line">您设置的仓库地址为: 192.168.100.10,用户名: admin,密码: xxx</span><br><span class="line">是否确认(Y/N): Y</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker login master</span></span><br><span class="line">Username: admin</span><br><span class="line">Password:</span><br><span class="line">WARNING! Your password will be stored unencrypted in /root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br><span class="line"></span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure>

<h3 id="7-部署Kubeadm、containerd、nerdctl和buildkit"><a href="#7-部署Kubeadm、containerd、nerdctl和buildkit" class="headerlink" title="7.部署Kubeadm、containerd、nerdctl和buildkit"></a>7.部署Kubeadm、containerd、nerdctl和buildkit</h3><p> 执行&#x2F;opt&#x2F;k8s_con_ner_bui_install.sh部署Kubeadm、containerd、nerdctl和buildkit。</p>
<p>   将ctr version命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: 1.6.14&amp;&amp;go1.18.9</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">/opt/k8s_con_ner_bui_install.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ctr version</span></span><br><span class="line">Client:</span><br><span class="line">  Version:  1.6.14</span><br><span class="line">  Revision: 9ba4b250366a5ddde94bb7c9d1def331423aa323</span><br><span class="line">  Go version: go1.18.9</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line">  Version:  1.6.14</span><br><span class="line">  Revision: 9ba4b250366a5ddde94bb7c9d1def331423aa323</span><br><span class="line">  UUID: ce069adb-c580-4c0d-b451-f22d0df0bae6</span><br></pre></td></tr></table></figure>

<h3 id="8-初始化集群"><a href="#8-初始化集群" class="headerlink" title="8.初始化集群"></a>8.初始化集群</h3><p>在master节点kubeadm命令初始化集群，使用本地Harbor仓库。</p>
<p>   将kubectl get nodes命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: master&amp;&amp;NotReady&amp;&amp;v1.25.0</strong></p>
<p>解法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubeadm init --kubernetes-version=1.25.0 --apiserver-advertise-address=192.168.100.91 --image-repository 192.168.100.91/library --pod-network-cidr=10.244.0.0/16</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">  kubectl get nodes</span></span><br><span class="line">NAME     STATUS     ROLES           AGE     VERSION</span><br><span class="line">master   NotReady   control-plane   9m42s   v1.25.0</span><br></pre></td></tr></table></figure>

<h3 id="9-安装kubernetes网络插件"><a href="#9-安装kubernetes网络插件" class="headerlink" title="9.安装kubernetes网络插件"></a>9.安装kubernetes网络插件</h3><p>修改提供的&#x2F;opt&#x2F;yaml&#x2F;flannel&#x2F;kube-flannel.yaml,使其镜像来源为本地Harbor仓库，然后安装kubernetes网络插件，安装完成后使用命令查看节点状态。</p>
<p>将kubectl get pods -A命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: etcd-master&amp;&amp;kube-controller-manager-master&amp;&amp;Running</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">eval</span> sed -i <span class="string">&#x27;s@docker.io/flannel@192.168.100.91/library@g&#x27;</span> /opt/yaml/flannel/kube-flannel.yaml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">[root@master ~]# kubectl apply -f /opt/yaml/flannel/kube-flannel.yaml</span></span><br><span class="line">[root@master opt]# kubectl get pods -A</span><br><span class="line">NAMESPACE      NAME                             READY   STATUS    RESTARTS   AGE</span><br><span class="line">kube-flannel   kube-flannel-ds-bqd2x            1/1     Running   0          74s</span><br><span class="line">kube-system    coredns-7f474965b8-88ckf         1/1     Running   0          34m</span><br><span class="line">kube-system    coredns-7f474965b8-rzh2x         1/1     Running   0          34m</span><br><span class="line">kube-system    etcd-master                      1/1     Running   0          34m</span><br><span class="line">kube-system    kube-apiserver-master            1/1     Running   0          34m</span><br><span class="line">kube-system    kube-controller-manager-master   1/1     Running   0          34m</span><br><span class="line">kube-system    kube-proxy-fb29c                 1/1     Running   0          34m</span><br><span class="line">kube-system    kube-scheduler-master            1/1     Running   0          34m</span><br></pre></td></tr></table></figure>

<h3 id="10-创建证书"><a href="#10-创建证书" class="headerlink" title="10.创建证书"></a>10.创建证书</h3><p> 给kubernetes创建证书,命名空间为kubernetes-dashboard,涉及到的所有文件命名为dashboard例如dashboard.crt。</p>
<p>将kubectl get csr命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准:kubernetes.io&#x2F;kube-apiserver-client-kubelet&amp;&amp;system:node:master</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> /opt/dashboard-certs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /opt/dashboard-certs/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl create namespace kubernetes-dashboard</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">openssl genrsa -out dashboard.key 2048</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">openssl req -days 36000 -new -out dashboard.csr -key dashboard.key -subj <span class="string">&#x27;/CN=dashboard-cert&#x27;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">openssl x509 -req -<span class="keyword">in</span> dashboard.csr -signkey dashboard.key -out dashboard.crt</span></span><br><span class="line">Signature ok</span><br><span class="line">subject=/CN=dashboard-cert</span><br><span class="line">Getting Private key</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl create secret generic kubernetes-dashboard-certs --from-file=dashboard.key --from-file=dashboard.crt -n kubernetes-dashboard</span></span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">kubectl get csr</span></span><br><span class="line">NAME        AGE   SIGNERNAME                                    REQUESTOR            REQUESTEDDURATION   CONDITION</span><br><span class="line">csr-s5d6s   63m   kubernetes.io/kube-apiserver-client-kubelet   system:node:master   &lt;none&gt;              Approved,Issued</span><br></pre></td></tr></table></figure>

<h3 id="11-kubernetes-图形化界面的安装"><a href="#11-kubernetes-图形化界面的安装" class="headerlink" title="11.kubernetes 图形化界面的安装"></a>11.kubernetes 图形化界面的安装</h3><p>修改&#x2F;opt&#x2F;yaml&#x2F;dashboard&#x2F;recommended.yaml的镜像来源为本地Harbor仓库，然后使用&#x2F;opt&#x2F;yaml&#x2F;dashboard&#x2F;recommended.yaml和&#x2F;opt&#x2F;yaml&#x2F;dashboard&#x2F;dashadmin-user.yaml安装kubernetes dashboard界面，完成后查看首页。</p>
<p>将kubectl get svc -n kubernetes-dashboard命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: dashboard-metrics-scraper&amp;&amp;kubernetes-dashboard&amp;&amp;NodePort&amp;&amp;ClusterIP</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">eval</span> sed -i <span class="string">&quot;s/kubernetesui/192.168.100.91\/library/g&quot;</span> /opt/yaml/dashboard/recommended.yaml</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">kubectl apply -f /opt/yaml/dashboard/recommended.yaml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl apply -f /opt/yaml/dashboard/dashadmin-user.yaml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl get svc -n kubernetes-dashboard</span></span><br><span class="line">NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)         AGE</span><br><span class="line">dashboard-metrics-scraper   ClusterIP   10.105.211.63    &lt;none&gt;        8000/TCP        23m</span><br><span class="line">kubernetes-dashboard        NodePort    10.104.143.162   &lt;none&gt;        443:30001/TCP   23m</span><br></pre></td></tr></table></figure>

<h3 id="12-删除污点"><a href="#12-删除污点" class="headerlink" title="12.删除污点"></a>12.删除污点</h3><p>为了能使pod调度到master节点,用命令删除污点。在浏览器访问dashboard（<a href="https://IP:30001）">https://IP:30001）</a></p>
<p>将kubectl describe nodes master | grep Taints命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准:Taints&amp;&amp;none</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl describe nodes master | grep Taints</span></span><br><span class="line">kubectl taint nodes master node-role.kubernetes.io/control-plane-</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl describe nodes master | grep Taints</span></span><br><span class="line">Taints:             &lt;none&gt;</span><br></pre></td></tr></table></figure>

<h3 id="13-扩展计算节点"><a href="#13-扩展计算节点" class="headerlink" title="13.扩展计算节点"></a>13.扩展计算节点</h3><p>在node节点执行k8s_node_install.sh，将该节点加入kubernetes集群。完成后在master节点上查看所有节点状态。</p>
<p>在master节点请将kubectl get nodes命令的返回结果提交到答题框。【1.5分】</p>
<p><strong>标准: master&amp;&amp;node&amp;&amp;v1.25.0</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node opt]# ./k8s_node_install.sh</span><br><span class="line">[root@master opt]# kubectl get nodes</span><br><span class="line">NAME     STATUS   ROLES           AGE     VERSION</span><br><span class="line">master   Ready    control-plane   151m    v1.25.0</span><br><span class="line">node     Ready    &lt;none&gt;          4m50s   v1.25.0</span><br></pre></td></tr></table></figure>

<h2 id="任务3部署Owncloud网盘服务（10-分）"><a href="#任务3部署Owncloud网盘服务（10-分）" class="headerlink" title="任务3部署Owncloud网盘服务（10 分）"></a>任务3部署Owncloud网盘服务（10 分）</h2><p>ownCloud 是一个开源免费专业的私有云存储项目，它能帮你快速在个人电脑或服务器上架设一套专属的私有云文件同步网盘，可以像 百度云那样实现文件跨平台同步、共享、版本控制、团队协作等。</p>
<h3 id="1-创建PV和PVC"><a href="#1-创建PV和PVC" class="headerlink" title="1.创建PV和PVC"></a>1.创建PV和PVC</h3><p> 编写yaml文件(文件名自定义)创建PV和PVC来提供持久化存储，以便保存 ownCloud 服务中的文件和数据。</p>
<p>要求：PV（访问模式为读写，只能被单个节点挂载;存储为5Gi;存储类型为hostPath,存储路径自定义）</p>
<p>   PVC（访问模式为读写，只能被单个节点挂载;申请存储空间大小为5Gi）</p>
<p>​    将kubectl get pv,pvc命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: persistentvolume&#x2F;owncloud-pv&amp;&amp;RWO&amp;&amp;persistentvolumeclaim&#x2F;owncloud-pvc&amp;&amp;Bound</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> owncloud-pvc.yaml</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: PersistentVolume</span><br><span class="line">metadata:</span><br><span class="line">  name: owncloud-pv</span><br><span class="line">spec:</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteOnce</span><br><span class="line">  capacity:</span><br><span class="line">    storage: 5Gi</span><br><span class="line">  hostPath:</span><br><span class="line">    path: /data/owncloud</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: PersistentVolumeClaim</span><br><span class="line">metadata:</span><br><span class="line">  name: owncloud-pvc</span><br><span class="line">spec:</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteOnce</span><br><span class="line">  resources:</span><br><span class="line">    requests:</span><br><span class="line">      storage: 5Gi</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl apply -f /opt/owncloud-pvc.yaml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl get pv,pvc</span></span><br><span class="line">NAME                           CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                  STORAGECLASS   REASON   AGE</span><br><span class="line">persistentvolume/owncloud-pv   5Gi        RWO            Retain           Bound    default/owncloud-pvc                           2m41s</span><br><span class="line">NAME                                 STATUS   VOLUME        CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span><br><span class="line">persistentvolumeclaim/owncloud-pvc   Bound    owncloud-pv   5Gi        RWO                           2m41s</span><br></pre></td></tr></table></figure>

<h3 id="2-配置ConfigMap"><a href="#2-配置ConfigMap" class="headerlink" title="2. 配置ConfigMap"></a>2. 配置ConfigMap</h3><p> 编写yaml文件(文件名自定义)创建一个configMap对象，指定OwnCloud的环境变量。登录账号对应的环境变量为OWNCLOUD_ADMIN_USERNAME,密码对应的环境变量为OWNCLOUD_ADMIN_PASSWORD。（变量值自定义）</p>
<p>  将kubectl get ConfigMap命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: kube-root-ca.crt&amp;&amp;1&amp;&amp;2</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> owncloud-configmap.yaml</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ConfigMap</span><br><span class="line">metadata:</span><br><span class="line">  name: owncloud-config</span><br><span class="line">data:</span><br><span class="line">  OWNCLOUD_ADMIN_USERNAME: “admin”</span><br><span class="line">  OWNCLOUD_ADMIN_PASSWORD: “123456”</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl apply -f  owncloud-configmap.yaml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl get ConfigMap</span></span><br><span class="line">NAME               DATA   AGE</span><br><span class="line">kube-root-ca.crt   1      20h</span><br><span class="line">owncloud-config    2      2m11s</span><br></pre></td></tr></table></figure>

<h3 id="3-创建Secret"><a href="#3-创建Secret" class="headerlink" title="3.创建Secret"></a>3.创建Secret</h3><p>编写yaml文件(文件名自定义)创建一个Secret对象，以保存OwnCloud数据库的密码。对原始密码采用base64编码格式进行加密。</p>
<p> 将kubectl get Secret命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准:Opaque&amp;&amp;1</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> 123456 | <span class="built_in">base64</span></span></span><br><span class="line">MTIzNDU2Cg==</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> owncloud-secret.yaml</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: owncloud-db-password</span><br><span class="line">type: Opaque</span><br><span class="line">data:</span><br><span class="line">  password: MTIzNDU2Cg==</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl apply -f /opt/owncloud-secret.yaml</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">kubectl get Secret</span></span><br><span class="line">NAME                   TYPE     DATA   AGE</span><br><span class="line">owncloud-db-password   Opaque   1      46s</span><br></pre></td></tr></table></figure>

<h3 id="4-部署owncloud-Deployment应用"><a href="#4-部署owncloud-Deployment应用" class="headerlink" title="4.部署owncloud Deployment应用"></a>4.部署owncloud Deployment应用</h3><p>编写yaml文件(文件名自定义) 创建Deployment对象, 指定OwnCloud的容器和相关的环境变量。(Deployment资源命名为owncloud-deployment,镜像为Harbor仓库中的owncloud:latest，存储的挂载路径为&#x2F;var&#x2F;www&#x2F;html,其它根据具体情况进行配置)</p>
<p>将kubectl describe pod命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: ReplicaSet&#x2F;owncloud-deployment&amp;&amp;owncloud@sha256&amp;&amp;kube-root-ca.crt&amp;&amp;Successfully&amp;&amp;Started</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> owncloud-deploy.yaml</span></span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: owncloud-deployment</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: owncloud</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: owncloud</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: owncloud</span><br><span class="line">        image: 192.168.100.91/library/owncloud:latest</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        envFrom:</span><br><span class="line">        - configMapRef:</span><br><span class="line">            name: owncloud-config</span><br><span class="line">        env:</span><br><span class="line">        - name: OWNCLOUD_DB_PASSWORD</span><br><span class="line">          valueFrom:</span><br><span class="line">            secretKeyRef:</span><br><span class="line">              name: owncloud-db-password</span><br><span class="line">              key: password</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 80</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: owncloud-pv</span><br><span class="line">          mountPath: /var/www/html</span><br><span class="line">      volumes:</span><br><span class="line">      - name: owncloud-pv</span><br><span class="line">        persistentVolumeClaim:</span><br><span class="line">          claimName: owncloud-pvc</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl apply -f /opt/owncloud-deploy.yaml</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl describe pod</span></span><br><span class="line">Name:             owncloud-deployment-845c85cfcb-6ptqr</span><br><span class="line">Namespace:        default</span><br><span class="line">Priority:         0</span><br><span class="line">Service Account:  default</span><br><span class="line">Node:             node/192.168.100.23</span><br><span class="line">Start Time:       Fri, 17 Mar 2023 02:56:31 +0000</span><br><span class="line">Labels:           app=owncloud</span><br><span class="line">                  pod-template-hash=845c85cfcb</span><br><span class="line">Annotations:      &lt;none&gt;</span><br><span class="line">Status:           Running</span><br><span class="line">IP:               10.244.1.3</span><br><span class="line">IPs:</span><br><span class="line">  IP:           10.244.1.3</span><br><span class="line">Controlled By:  ReplicaSet/owncloud-deployment-845c85cfcb</span><br><span class="line">Containers:</span><br><span class="line">  owncloud:</span><br><span class="line">    Container ID:   containerd://d60dc4426c06cef6525e4e37f0ee37dcef762c2806c19efcd666f951d66a5c84</span><br><span class="line">    Image:          192.168.100.91/library/owncloud:latest</span><br><span class="line">    Image ID:       192.168.100.91/library/owncloud@sha256:5c77bfdf8cfaf99ec94309be2687032629f4f985d6bd388354dfd85475aa5f21</span><br><span class="line">    Port:           80/TCP</span><br><span class="line">    Host Port:      0/TCP</span><br><span class="line">    State:          Running</span><br><span class="line">      Started:      Fri, 17 Mar 2023 02:56:39 +0000</span><br><span class="line">    Ready:          True</span><br><span class="line">    Restart Count:  0</span><br><span class="line">    Environment Variables from:</span><br><span class="line">      owncloud-config  ConfigMap  Optional: false</span><br><span class="line">    Environment:</span><br><span class="line">      OWNCLOUD_DB_PASSWORD:  &lt;set to the key &#x27;password&#x27; in secret &#x27;owncloud-db-password&#x27;&gt;  Optional: false</span><br><span class="line">    Mounts:</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-vtpd9 (ro)</span><br><span class="line">      /var/www/html from owncloud-pv (rw)</span><br><span class="line">Conditions:</span><br><span class="line">  Type              Status</span><br><span class="line">  Initialized       True</span><br><span class="line">  Ready             True</span><br><span class="line">  ContainersReady   True</span><br><span class="line">  PodScheduled      True</span><br><span class="line">Volumes:</span><br><span class="line">  owncloud-pv:</span><br><span class="line">    Type:       PersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)</span><br><span class="line">    ClaimName:  owncloud-pvc</span><br><span class="line">    ReadOnly:   false</span><br><span class="line">  kube-api-access-vtpd9:</span><br><span class="line">    Type:                    Projected (a volume that contains injected data from multiple sources)</span><br><span class="line">    TokenExpirationSeconds:  3607</span><br><span class="line">    ConfigMapName:           kube-root-ca.crt</span><br><span class="line">    ConfigMapOptional:       &lt;nil&gt;</span><br><span class="line">    DownwardAPI:             true</span><br><span class="line">QoS Class:                   BestEffort</span><br><span class="line">Node-Selectors:              &lt;none&gt;</span><br><span class="line">Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s</span><br><span class="line">                             node.kubernetes.io/unreachable:NoExecute op=Exists for 300s</span><br><span class="line">Events:</span><br><span class="line">  Type    Reason     Age   From               Message</span><br><span class="line">  ----    ------     ----  ----               -------</span><br><span class="line">  Normal  Scheduled  14m   default-scheduler  Successfully assigned default/owncloud-deployment-845c85cfcb-6ptqr to node</span><br><span class="line">  Normal  Pulling    14m   kubelet            Pulling image &quot;192.168.100.91/library/owncloud:latest&quot;</span><br><span class="line">  Normal  Pulled     14m   kubelet            Successfully pulled image &quot;192.168.100.91/library/owncloud:latest&quot; in 7.266482912s</span><br><span class="line">  Normal  Created    14m   kubelet            Created container owncloud</span><br><span class="line">  Normal  Started    14m   kubelet            Started container owncloud</span><br></pre></td></tr></table></figure>

<h3 id="5-创建Service"><a href="#5-创建Service" class="headerlink" title="5.创建Service"></a>5.创建Service</h3><p>编写yaml文件(文件名自定义)创建一个Service对象将OwnCloud公开到集群外部。通过<a target="_blank" rel="noopener" href="http://ip/">http://IP</a>:端口号可查看owncloud。</p>
<p>  将kubectl get svc -A命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: ClusterIP&amp;&amp;NodePort&amp;&amp;443&amp;&amp;53&amp;&amp;9153&amp;&amp;8000&amp;&amp;80:</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> owncloud-svc.yaml</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: owncloud-service</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    app: owncloud</span><br><span class="line">  ports:</span><br><span class="line">    - name: http</span><br><span class="line">      port: 80</span><br><span class="line">  type: NodePort</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl apply -f /opt/owncloud-svc.yaml</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">kubectl get svc -A</span></span><br><span class="line">NAMESPACE              NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                  AGE</span><br><span class="line">default                kubernetes                  ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP                  24h</span><br><span class="line">default                owncloud-service            NodePort    10.98.228.242    &lt;none&gt;        80:31024/TCP             17m</span><br><span class="line">kube-system            kube-dns                    ClusterIP   10.96.0.10       &lt;none&gt;        53/UDP,53/TCP,9153/TCP   24h</span><br><span class="line">kubernetes-dashboard   dashboard-metrics-scraper   ClusterIP   10.105.211.63    &lt;none&gt;        8000/TCP                 22h</span><br><span class="line">kubernetes-dashboard   kubernetes-dashboard        NodePort    10.104.143.162   &lt;none&gt;        443:30001/TCP            22h</span><br></pre></td></tr></table></figure>

<h1 id="C模块题目：企业级应用的自动化部署和运维"><a href="#C模块题目：企业级应用的自动化部署和运维" class="headerlink" title="C模块题目：企业级应用的自动化部署和运维"></a>C模块题目：企业级应用的自动化部署和运维</h1><p><em><strong>*虚拟机与环境规划*</strong></em></p>
<p>表3</p>
<table>
<thead>
<tr>
<th>设备名称</th>
<th>主机名</th>
<th>接口</th>
<th>IP地址</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>云服务器1</td>
<td>zabbix_server</td>
<td>eth0</td>
<td>公网IP:*******<em>私网IP:192.168.100.</em>&#x2F;24</td>
<td>ansible,zabbix_server</td>
</tr>
<tr>
<td>云服务器2</td>
<td>zabbix_agent</td>
<td>eth0</td>
<td>公网IP:*******<em>私网IP:192.168.100.</em>&#x2F;24</td>
<td>zabbix_agent</td>
</tr>
</tbody></table>
<p>\1. 上表中的公网IP以自己云主机显示为准，每个人的公网IP不同。使用第三方软件远程连接云主机，使用公网IP连接。</p>
<p>2.华为云中云主机名字已命好，直接使用对应名字的云主机即可。</p>
<p>3.竞赛用到的软件包都在云主机&#x2F;root下。</p>
<h2 id="企业级应用的自动化部署（30分）"><a href="#企业级应用的自动化部署（30分）" class="headerlink" title="企业级应用的自动化部署（30分）"></a>企业级应用的自动化部署（30分）</h2><p> 部署方式：监控主机zabbix_server节点采用手动部署，被监控主机zabbix_agent采用Playbook部署。</p>
<h3 id="1-安装ansible"><a href="#1-安装ansible" class="headerlink" title="1.安装ansible"></a>1.安装ansible</h3><p>修改主机名zabbix_server节点主机名为zabbix_server,zabbix_agent节点主机名为Zabbix_agent,使用提供的软件包&#x2F;root&#x2F;autoDeployment.tar在zabbix_server节点安装ansible。</p>
<p>将ansible –version 命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准:2.9.27&amp;&amp;2.7.5</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# hostnamectl set-hostname zabbix_server</span><br><span class="line">[root@master ~]# bash</span><br><span class="line">[root@node ~]# hostnamectl set-hostname zabbix_agent</span><br><span class="line">[root@node ~]# bash</span><br><span class="line">[root@zabbix_server ~]# mv autoDeployment.tar  /opt/</span><br><span class="line">[root@zabbix_server ~]# cd /opt/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar  -xvf autoDeployment.tar</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mount CentOS-7-x86_64-DVD-2009.iso /mnt/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">rm</span> -rf /etc/yum.repos.d/*</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vi /etc/yum.repos.d/local.repo</span></span><br><span class="line">[auto]</span><br><span class="line">name=auto</span><br><span class="line">baseurl=file:///opt/autoDeployment</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///mnt/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum -y install ansible</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ansible --version</span></span><br><span class="line">ansible 2.9.27</span><br><span class="line">  config file = /etc/ansible/ansible.cfg</span><br><span class="line">  configured module search path = [u&#x27;/root/.ansible/plugins/modules&#x27;, u&#x27;/usr/share/ansible/plugins/modules&#x27;]</span><br><span class="line">  ansible python module location = /usr/lib/python2.7/site-packages/ansible</span><br><span class="line">  executable location = /usr/bin/ansible</span><br><span class="line">  python version = 2.7.5 (default, Oct 14 2020, 14:45:30) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]</span><br></pre></td></tr></table></figure>

<h3 id="2-配置免密登录"><a href="#2-配置免密登录" class="headerlink" title="2.配置免密登录"></a>2.配置免密登录</h3><p>在zabbix_server节点配置hosts文件，并将该文件远程发送给zabbix_agent节点，并配置免密登录。</p>
<p>在zabbix_server节点将ssh zabbix_agent命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: login&amp;&amp;Welcome</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /etc/hosts</span></span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.100.91 zabbix_server</span><br><span class="line">192.168.100.23 zabbix_agent</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">scp /etc/hosts 192.168.100.23:/etc/</span></span><br><span class="line">[root@ansible Zabbix_server ~]# ssh-keygen</span><br><span class="line">[root@ansible Zabbix_server ~]# ssh-copy-id Zabbix_agent</span><br><span class="line">[root@ zabbix_server ~]# ssh zabbix_agent</span><br><span class="line">Last failed login: Fri Mar 17 12:56:03 UTC 2023 from 58.33.154.106 on ssh:notty</span><br><span class="line">There were 20 failed login attempts since the last successful login.</span><br><span class="line">Last login: Fri Mar 17 11:58:03 2023 from 121.229.222.70</span><br><span class="line"></span><br><span class="line">  ******************************</span><br><span class="line">  *  Welcome to GuoJiBeiSheng  *</span><br><span class="line">  ******************************</span><br><span class="line"></span><br><span class="line">[root@ zabbix_agent ~]# exit</span><br></pre></td></tr></table></figure>

<h3 id="3-配置主机清单"><a href="#3-配置主机清单" class="headerlink" title="3.配置主机清单"></a>3.配置主机清单</h3><p>在Zabbix_server节点配置ansible主机清单，在清单中创建agent主机组。</p>
<p> 将ansible agent –m ping命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: zabbix_agent&amp;&amp;SUCCESS&amp;&amp;pong</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">tail</span> -2 /etc/ansible/hosts</span></span><br><span class="line">[agent]</span><br><span class="line">zabbix_agent</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ansible agent -m ping</span></span><br><span class="line">zabbix_agent | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;changed&quot;: false,</span><br><span class="line">    &quot;ping&quot;: &quot;pong&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-安装nginx和php"><a href="#4-安装nginx和php" class="headerlink" title="4.安装nginx和php"></a>4.安装nginx和php</h3><p>配置基础环境，安装nginx和php74（根据实际需要安装相关php74扩展包），并开启相关服务。</p>
<p>将nginx -v &amp;&amp; php74 –v命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: nginx&#x2F;1.22.1&amp;&amp;7.4.33&amp;&amp;v3.4.0</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix_server opt]# yum -y install nginx</span><br><span class="line">[root@zabbix_server ~]# systemctl start nginx</span><br><span class="line">[root@zabbix_server ~]# yum -y install php74-php-fpm php74-php-common php74-php-cli php74-php-gd php74-php-ldap php74-php-mbstring php74-php-mysqlnd php74-php-xml php74-php-bcmath php74-php</span><br><span class="line">[root@zabbix_server ~]#systemctl start php74-php-fpm</span><br><span class="line">[root@zabbix_server ~]#  nginx -v &amp;&amp; php74 -v</span><br><span class="line">nginx version: nginx/1.22.1</span><br><span class="line">PHP 7.4.33 (cli) (built: Feb 14 2023 08:49:52) ( NTS )</span><br><span class="line">Copyright (c) The PHP Group</span><br><span class="line">Zend Engine v3.4.0, Copyright (c) Zend Technologies</span><br></pre></td></tr></table></figure>

<h3 id="5-安装zabbix服务器端和客户端"><a href="#5-安装zabbix服务器端和客户端" class="headerlink" title="5.安装zabbix服务器端和客户端"></a>5.安装zabbix服务器端和客户端</h3><p>在zabbix_server节点安装zabbix服务器、代理和web前端，安装前注意查看rpm包的名字,并分别启动zabbix-server和zabbix-agent。</p>
<p>  将systemctl status zabbix-server&amp;&amp; systemctl status zabbix-agent命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: zabbix-server-mysql.service&amp;&amp;zabbix-agent.service&amp;&amp;active (running)&amp;&amp;SUCCESS</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum -y install zabbix6.0-server  zabbix6.0-web-mysql zabbix-agent</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl start zabbix-server&amp;&amp; systemctl start zabbix-agent</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl status zabbix-server&amp;&amp; systemctl status zabbix-agent</span></span><br><span class="line">● zabbix-server-mysql.service - Zabbix Server with MySQL DB</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/zabbix-server-mysql.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Sat 2023-03-18 04:36:50 UTC; 4min 5s ago</span><br><span class="line"> Main PID: 20737 (zabbix_server)</span><br><span class="line">   CGroup: /system.slice/zabbix-server-mysql.service</span><br><span class="line">           └─20737 /usr/sbin/zabbix_server -f</span><br><span class="line"></span><br><span class="line">Mar 18 04:36:50 zabbix_server systemd[1]: Started Zabbix Serve...</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show in full.</span><br><span class="line">● zabbix-agent.service - Zabbix Agent</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/zabbix-agent.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Sat 2023-03-18 04:37:47 UTC; 3min 8s ago</span><br><span class="line">  Process: 20752 ExecStart=/usr/sbin/zabbix_agentd -c $CONFFILE (code=exited, status=0/SUCCESS)</span><br><span class="line">  Main PID: 20754 (zabbix_agentd)</span><br><span class="line">   CGroup: /system.slice/zabbix-agent.service</span><br><span class="line">           ├─20754 /usr/sbin/zabbix_agentd -c /etc/zabbix/zabb...</span><br><span class="line">           ├─20755 /usr/sbin/zabbix_agentd: collector [idle 1 ...</span><br><span class="line">           ├─20756 /usr/sbin/zabbix_agentd: listener #1 [waiti...</span><br><span class="line">           ├─20757 /usr/sbin/zabbix_agentd: listener #2 [waiti...</span><br><span class="line">           ├─20758 /usr/sbin/zabbix_agentd: listener #3 [waiti...</span><br><span class="line">           └─20759 /usr/sbin/zabbix_agentd: active checks #1 [...</span><br><span class="line"></span><br><span class="line">Mar 18 04:37:47 zabbix_server systemd[1]: Starting Zabbix Agen...</span><br><span class="line">Mar 18 04:37:47 zabbix_server systemd[1]: Started Zabbix Agent.</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show in full.</span><br></pre></td></tr></table></figure>

<h3 id="6-安装数据库"><a href="#6-安装数据库" class="headerlink" title="6.安装数据库"></a>6.安装数据库</h3><p>安装数据库MariaDB，启动数据库并设置为开机自启动。</p>
<p>将systemctl status mariadb命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准:mariadb.service&amp;&amp;active&amp;&amp;(running)&amp;&amp;SUCCESS&amp;&amp;mariadb-wait-ready</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum -y install mariadb-server</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl start mariadb</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl status mariadb</span></span><br><span class="line">● mariadb.service - MariaDB database server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Sat 2023-03-18 04:52:20 UTC; 1min 2s ago</span><br><span class="line">  Process: 20907 ExecStartPost=/usr/libexec/mariadb-wait-ready $MAINPID (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 20822 ExecStartPre=/usr/libexec/mariadb-prepare-db-dir %n (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 20905 (mysqld_safe)</span><br><span class="line">   CGroup: /system.slice/mariadb.service</span><br><span class="line">           ├─20905 /bin/sh /usr/bin/mysqld_safe --basedir=/usr...</span><br><span class="line">           └─21071 /usr/libexec/mysqld --basedir=/usr --datadi...</span><br><span class="line"></span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: M...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: P...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: T...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: Y...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: h...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: C...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mariadb-prepare-db-dir[20822]: h...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mysqld_safe[20905]: 230318 04:52...</span><br><span class="line">Mar 18 04:52:18 zabbix_server mysqld_safe[20905]: 230318 04:52...</span><br><span class="line">Mar 18 04:52:20 zabbix_server systemd[1]: Started MariaDB data...</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show in full.</span><br></pre></td></tr></table></figure>

<h3 id="7-配置数据库"><a href="#7-配置数据库" class="headerlink" title="7.配置数据库"></a>7.配置数据库</h3><p>登录mysql,创建数据库zabbix和用户zabbix密码自定义，并授权zabbix用户拥有zabbix数据库的所有权限。</p>
<p>  将show grants for ‘zabbix‘@’localhost’;命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: ALL&amp;&amp;PRIVILEGES</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql -uroot -p</span></span><br><span class="line">MariaDB [(none)]&gt; create database zabbix character set utf8mb4 collate utf8mb4_general_ci;</span><br><span class="line">MariaDB [(none)]&gt; grant all privileges on zabbix.* to zabbix@localhost identified by &#x27;password&#x27;;</span><br><span class="line">MariaDB [zabbix]&gt; show grants for &#x27;zabbix&#x27;@&#x27;localhost&#x27;;</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants for zabbix@localhost                                                                                   |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT USAGE ON *.* TO &#x27;zabbix&#x27;@&#x27;localhost&#x27; IDENTIFIED BY PASSWORD &#x27;*2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19&#x27; |</span><br><span class="line">| GRANT ALL PRIVILEGES ON `zabbix`.* TO &#x27;zabbix&#x27;@&#x27;localhost&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="8-导入数据库架构"><a href="#8-导入数据库架构" class="headerlink" title="8.导入数据库架构"></a>8.导入数据库架构</h3><p>分别导入数据库架构及数据，对应的文件分别为schema.sql、images.sql和data.sql（文件顺便不能乱）。</p>
<p>  登录数据库将select username from users;命令的返回结果提交到答题框（用zabbix数据库）。【2分】</p>
<p><strong>标准:Admin&amp;&amp;guest</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix_server ~]# mysql -uroot -ppassword zabbix &lt; /usr/share/zabbix-mysql/schema.sql</span><br><span class="line">[root@zabbix_server ~]# mysql -uroot -ppassword zabbix &lt; /usr/share/zabbix-mysql/images.sql</span><br><span class="line">[root@zabbix_server ~]# mysql -uroot -ppassword zabbix &lt; /usr/share/zabbix-mysql/data.sql</span><br><span class="line">[root@zabbix_server ~]# mysql -uzabbix -p</span><br><span class="line">Enter password:</span><br><span class="line">MariaDB [(none)]&gt; use zabbix;</span><br><span class="line">MariaDB [zabbix]&gt; select username from users;</span><br><span class="line">+----------+</span><br><span class="line">| username |</span><br><span class="line">+----------+</span><br><span class="line">| Admin    |</span><br><span class="line">| guest    |</span><br></pre></td></tr></table></figure>

<h3 id="9-配置文件"><a href="#9-配置文件" class="headerlink" title="9.配置文件"></a>9.配置文件</h3><p>配置default.conf。</p>
<p>   将cat &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default.conf命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: index.php</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nginx/conf.d/default.conf</span><br><span class="line">修改内容如下</span><br><span class="line">root /usr/share/zabbix/;</span><br><span class="line">index index.php index.html index.htm;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">cat</span> /etc/nginx/conf.d/default.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line">server_name localhost;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">access_log /var/log/nginx/host.access.log main;</span></span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">root /usr/share/zabbix/;</span><br><span class="line">index index.php index.html index.htm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_page 404 /404.html;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">redirect server error pages to the static page /50x.html</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">error_page 500 502 503 504 /50x.html;</span></span><br><span class="line">location = /50x.html &#123;</span><br><span class="line">root /usr/share/nginx/html;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#location ~ \.php$ &#123;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">proxy_pass http://127.0.0.1;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&#125;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">location ~ \.php$ &#123;</span></span><br><span class="line">root /usr/share/zabbix;</span><br><span class="line">fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">fastcgi_index index.php;</span><br><span class="line">fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">include fastcgi_params;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deny access to .htaccess files, <span class="keyword">if</span> Apache<span class="string">&#x27;s document root</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">concurs with nginx&#x27;</span>s one</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#location ~ /\.ht &#123;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deny all;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-配置文件"><a href="#10-配置文件" class="headerlink" title="10.配置文件"></a>10.配置文件</h3><p>分别修改配置文件zabbix_server.conf(修改数据库密码)和zabbix_agentd.conf（修改服务器IP，活动服务器IP和主机名），并重启对应服务使配置生效。</p>
<p>   将cat &#x2F;etc&#x2F;zabbix_agentd.conf | grep -v ‘^#|^$’命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: Server&#x3D;192.168.100&amp;&amp;ServerActive&#x3D;192.168.100</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix_server ~]# vim /etc/zabbix_server.conf</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=password</span><br><span class="line">[root@zabbix_server ~]# vim /etc/zabbix_agentd.conf</span><br><span class="line">Server=192.168.100.91</span><br><span class="line">ServerActive=192.168.100.91</span><br><span class="line">Hostname=zabbix_server</span><br><span class="line">[root@zabbix_server ~]# cat /etc/zabbix_agentd.conf | grep -v &#x27;^#\|^$&#x27;</span><br><span class="line">PidFile=/run/zabbix/zabbix_agentd.pid</span><br><span class="line">LogFile=/var/log/zabbix/zabbix_agentd.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">Server=192.168.100.91</span><br><span class="line">ServerActive=192.168.100.91</span><br><span class="line">Hostname=zabbix_server</span><br><span class="line">[root@master ~]# systemctl restart zabbix-server</span><br><span class="line">[root@master ~]# systemctl restart zabbix-agent</span><br></pre></td></tr></table></figure>

<h3 id="11-配置文件"><a href="#11-配置文件" class="headerlink" title="11.配置文件"></a>11.配置文件</h3><p>修改php.ini文件,其中最大POST数据限制为16M,程序执行时间限制为300，PHP页面接受数据所需最大时间限制为300，把时区设为Asia&#x2F;Shanghai,并重启相关服务。</p>
<p>  将cat &#x2F;etc&#x2F;php.ini | grep -v ‘^#|^$’命令的返回结果提交到答题框。【2分】</p>
<p>标准: Server&#x3D;192.168.100&amp;&amp;ServerActive&#x3D;192.168.100</p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix_server ~]# vim /etc/php.ini</span><br><span class="line">post_max_size = 16M</span><br><span class="line">max_execution_time = 300</span><br><span class="line">max_input_time = 300</span><br><span class="line">date.timezone = Asia/Shanghai</span><br><span class="line">[root@zabbix_server ~]# systemctl restart php74-php-fpm</span><br></pre></td></tr></table></figure>

<h3 id="12-配置文件"><a href="#12-配置文件" class="headerlink" title="12.配置文件"></a>12.配置文件</h3><p>修改<a target="_blank" rel="noopener" href="http://www.conf/">www.conf</a>文件,把用户和组都设置为nginx.</p>
<p>将cat &#x2F;etc&#x2F;php-fpm.d&#x2F;<a target="_blank" rel="noopener" href="http://www.conf/">www.conf</a> | grep -v ‘^;|^$’命令的返回结果提交到答题框。【2分】</p>
<p>标准: user&amp;&amp;nginx&amp;&amp;group</p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> [root@zabbix_server ~]# vim /etc/php-fpm.d/www.conf</span><br><span class="line">user = nginx</span><br><span class="line">group = nginx</span><br><span class="line">[root@zabbix_server ~]# cat /etc/php-fpm.d/www.conf | grep -v &#x27;^;\|^$&#x27;</span><br><span class="line">[www]</span><br><span class="line">listen = 127.0.0.1:9000</span><br><span class="line"> </span><br><span class="line">listen.allowed_clients = 127.0.0.1</span><br><span class="line">user = nginx</span><br><span class="line">group = nginx</span><br><span class="line">pm = dynamic</span><br><span class="line">pm.max_children = 50</span><br><span class="line">pm.start_servers = 5</span><br><span class="line">pm.min_spare_servers = 5</span><br><span class="line">pm.max_spare_servers = 35</span><br><span class="line">slowlog = /var/log/php-fpm/www-slow.log</span><br><span class="line">php_admin_value[error_log] = /var/log/php-fpm/www-error.log</span><br><span class="line">php_admin_flag[log_errors] = on</span><br><span class="line">php_value[session.save_handler] = files</span><br><span class="line">php_value[session.save_path] = /var/lib/php/session</span><br></pre></td></tr></table></figure>

<h3 id="13-配置文件"><a href="#13-配置文件" class="headerlink" title="13.配置文件"></a>13.配置文件</h3><p>修改zabbix.conf文件,把用户和组都设置为nginx,并将index.php所在的目录和php.ini文件拥有者和用户组改为nginx。重启相关服务，在浏览器中输入http:&#x2F;&#x2F;公网IP&#x2F; setup.php即可看到zabbix 6.0界面。</p>
<p>将curl http:&#x2F;&#x2F; 公网IP &#x2F;setup.php命令的返回结果提交到答题框。【2分】</p>
<p><strong>标准: SIA&amp;&amp;favicon.ico&amp;&amp;msapplication-config</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/php-fpm.d/zabbix.conf</span><br><span class="line">[zabbix]</span><br><span class="line">user = nginx</span><br><span class="line">group = nginx</span><br><span class="line">[root@zabbix_server ~]# chown -R nginx:nginx /usr/share/zabbix/</span><br><span class="line">[root@zabbix_server ~]# chown -R nginx:nginx /etc/opt/remi/php74/php.ini</span><br><span class="line">[root@zabbix_server ~]# chmod +x /usr/share/zabbix</span><br><span class="line">[root@zabbix_server ~]# systemctl restart nginx</span><br><span class="line">[root@zabbix_server ~]# systemctl restart zabbix-server</span><br><span class="line">[root@zabbix_server ~]# systemctl restart zabbix-agent</span><br><span class="line">[root@zabbix_server ~]# systemctl restart php74-php-fpm </span><br><span class="line">[root@zabbix_server ~]# curl http://123.249.10.60/setup.php</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">       &lt;head&gt;</span><br><span class="line">              &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=Edge&quot;/&gt;</span><br><span class="line">              &lt;meta charset=&quot;utf-8&quot; /&gt;</span><br><span class="line">              &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">              &lt;meta name=&quot;Author&quot; content=&quot;Zabbix SIA&quot; /&gt;</span><br><span class="line">              &lt;title&gt;Installation&lt;/title&gt;</span><br><span class="line">              &lt;link rel=&quot;icon&quot; href=&quot;favicon.ico&quot;&gt;</span><br><span class="line">              &lt;link rel=&quot;apple-touch-icon-precomposed&quot; sizes=&quot;76x76&quot; href=&quot;assets/img/apple-touch-icon-76x76-precomposed.png&quot;&gt;</span><br><span class="line">              &lt;link rel=&quot;apple-touch-icon-precomposed&quot; sizes=&quot;120x120&quot; href=&quot;assets/img/apple-touch-icon-120x120-precomposed.png&quot;&gt;</span><br><span class="line">              &lt;link rel=&quot;apple-touch-icon-precomposed&quot; sizes=&quot;152x152&quot; href=&quot;assets/img/apple-touch-icon-152x152-precomposed.png&quot;&gt;</span><br><span class="line">              &lt;link rel=&quot;apple-touch-icon-precomposed&quot; sizes=&quot;180x180&quot; href=&quot;assets/img/apple-touch-icon-180x180-precomposed.png&quot;&gt;</span><br><span class="line">              &lt;link rel=&quot;icon&quot; sizes=&quot;192x192&quot; href=&quot;assets/img/touch-icon-192x192.png&quot;&gt;</span><br><span class="line">              &lt;meta name=&quot;csrf-token&quot; content=&quot;5d4324e81318a310&quot;/&gt;</span><br><span class="line">              &lt;meta name=&quot;msapplication-TileImage&quot; content=&quot;assets/img/ms-tile-144x144.png&quot;&gt;</span><br><span class="line">              &lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#d40000&quot;&gt;</span><br><span class="line">              &lt;meta name=&quot;msapplication-config&quot; content=&quot;none&quot;/&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;assets/styles/blue-theme.css?1675235994&quot; /&gt;</span><br><span class="line">&lt;script src=&quot;js/browsers.js?1674462826&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;jsLoader.php?ver=6.0.13&amp;amp;lang=en_US&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;jsLoader.php?ver=6.0.13&amp;amp;lang=en_US&amp;amp;files%5B0%5D=setup.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;&lt;div class=&quot;wrapper&quot;&gt;&lt;main&gt;&lt;form method=&quot;post&quot; action=&quot;setup.php&quot; accept-charset=&quot;utf-8&quot; id=&quot;setup-form&quot;&gt;&lt;div class=&quot;setup-container&quot;&gt;&lt;div class=&quot;setup-left&quot;&gt;&lt;div class=&quot;setup-logo&quot;&gt;&lt;div class=&quot;zabbix-logo&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;ul&gt;&lt;li class=&quot;setup-left-current&quot;&gt;Welcome&lt;/li&gt;&lt;li&gt;Check of pre-requisites&lt;/li&gt;&lt;li&gt;Configure DB connection&lt;/li&gt;&lt;li&gt;Settings&lt;/li&gt;&lt;li&gt;Pre-installation summary&lt;/li&gt;&lt;li&gt;Install&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class=&quot;setup-right&quot;&gt;&lt;div class=&quot;setup-right-body&quot;&gt;&lt;div class=&quot;setup-title&quot;&gt;&lt;span&gt;Welcome to&lt;/span&gt;Zabbix 6.0&lt;/div&gt;&lt;ul class=&quot;table-forms&quot;&gt;&lt;li&gt;&lt;div class=&quot;table-forms-td-left&quot;&gt;&lt;label for=&quot;label-default-lang&quot;&gt;Default language&lt;/label&gt;&lt;/div&gt;&lt;div class=&quot;table-forms-td-right&quot;&gt;&lt;z-select id=&quot;default-lang&quot; value=&quot;en_US&quot; focusable-element-id=&quot;label-default-lang&quot; autofocus=&quot;autofocus&quot; name=&quot;default_lang&quot; data-options=&quot;[&#123;&amp;quot;value&amp;quot;:&amp;quot;en_GB&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;English (en_GB)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;en_US&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;English (en_US)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;ca_ES&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Catalan (ca_ES)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;zh_CN&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Chinese (zh_CN)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;cs_CZ&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Czech (cs_CZ)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;fr_FR&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;French (fr_FR)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;de_DE&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;German (de_DE)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;he_IL&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Hebrew (he_IL)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;it_IT&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Italian (it_IT)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;ko_KR&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Korean (ko_KR)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;ja_JP&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Japanese (ja_JP)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;nb_NO&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Norwegian (nb_NO)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;pl_PL&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Polish (pl_PL)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;pt_BR&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Portuguese (pt_BR)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;pt_PT&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Portuguese (pt_PT)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;ro_RO&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Romanian (ro_RO)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;ru_RU&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Russian (ru_RU)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;sk_SK&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Slovak (sk_SK)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;tr_TR&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Turkish (tr_TR)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;uk_UA&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Ukrainian (uk_UA)&amp;quot;&#125;,&#123;&amp;quot;value&amp;quot;:&amp;quot;vi_VN&amp;quot;,&amp;quot;label&amp;quot;:&amp;quot;Vietnamese (vi_VN)&amp;quot;&#125;]&quot; tabindex=&quot;-1&quot;&gt;&lt;/z-select&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;setup-footer&quot;&gt;&lt;div&gt;&lt;button type=&quot;submit&quot; id=&quot;next_1&quot; name=&quot;next[1]&quot; value=&quot;Next step&quot;&gt;Next step&lt;/button&gt;&lt;button type=&quot;submit&quot; id=&quot;back_1&quot; name=&quot;back[1]&quot; value=&quot;Back&quot; class=&quot;btn-alt float-left&quot; disabled=&quot;disabled&quot;&gt;Back&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/form&gt;&lt;div class=&quot;signin-links&quot;&gt;Licensed under &lt;a target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; class=&quot;grey link-alt&quot; href=&quot;https://www.zabbix.com/license&quot;&gt;GPL v2&lt;/a&gt;&lt;/div&gt;&lt;/main&gt;&lt;footer role=&quot;contentinfo&quot;&gt;Zabbix 6.0.13. &amp;copy; 2001&amp;ndash;2023, &lt;a class=&quot;grey link-alt&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; href=&quot;https://www.zabbix.com/&quot;&gt;Zabbix SIA&lt;/a&gt;&lt;/footer&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="14-编写playbook"><a href="#14-编写playbook" class="headerlink" title="14.编写playbook"></a>14.编写playbook</h3><p>随机找一目录，在其下分别创建tasks和file目录，把autoDeployment.tar、编写好的repo文件和zabbix_agentd.conf传至file目录，在tasks目录下编写agent.yaml文件，要求在被监控机能远程部署zabbix-agent服务。</p>
<p>将cat agent.yaml命令的返回结果提交到答题框。【4分】</p>
<p><strong>标准: copy&amp;&amp;src&amp;&amp;dest&amp;&amp;yum&amp;&amp;name&amp;&amp;zabbix-agent&amp;&amp;state</strong></p>
<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix_server opt]# cat agent.yaml</span><br><span class="line">---</span><br><span class="line">- hosts: agent</span><br><span class="line">  become: true</span><br><span class="line">  tasks:</span><br><span class="line">  - name: copy local.repo</span><br><span class="line">    copy:</span><br><span class="line">      src: local.repo</span><br><span class="line">      dest: /etc/yum.repos.d/local.repo</span><br><span class="line">  - name: Copy autoDeployment.tar</span><br><span class="line">    copy:</span><br><span class="line">      src: autoDeployment.tar</span><br><span class="line">      dest: /opt</span><br><span class="line">  - name: Copy zabbix_agentd.conf file</span><br><span class="line">    copy:</span><br><span class="line">      src: zabbix_agentd.conf</span><br><span class="line">      dest: /etc/zabbix/zabbix_agentd.conf</span><br><span class="line">      owner: zabbix</span><br><span class="line">      group: zabbix</span><br><span class="line">      mode: &#x27;0644&#x27;</span><br><span class="line">  - name: tar autoDeployment.tar</span><br><span class="line">    shell:</span><br><span class="line">      cmd: tar -vxf autoDeployment.tar  -C /opt</span><br><span class="line">  - name: Install Zabbix Agent</span><br><span class="line">    yum:</span><br><span class="line">      name: zabbix-agent</span><br><span class="line">      state: present</span><br><span class="line">  - name: Start and enable Zabbix Agent</span><br><span class="line">    service:</span><br><span class="line">      name: zabbix-agent</span><br><span class="line">      state: started</span><br><span class="line">      enabled: true</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz">GoldY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz/posts/a8884406.html">https://www.geekgold.xyz/posts/a8884406.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.geekgold.xyz" target="_blank">GoldY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/">云计算职业技能大赛</a></div><div class="post-share"><div class="social-share" data-image="/img/cloud-com.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src="/img/zhifubao.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">云计算方向-2023年GZ075 云计算应用赛项赛题</div></div><div class="info-2"><div class="info-item-1">模块一 私有云（30分）企业首先完成私有云平台搭建和运维，私有云平台提供云主机、云网络、云存储等基础架构云服务，并开发自动化运维程序。 任务1 私有云服务搭建（5分）1.1.1 基础环境配置1.控制节点主机名为controller，设置计算节点主机名为compute； 12345678910#控制节点[root@localhost ~]# hostnamectl set-hostname controller[root@localhost ~]# bash[root@controller ~]##计算节点[root@localhost ~]# hostnamectl set-hostname compute[root@localhost ~]# bash[root@compute ~]#    2.hosts文件将IP地址映射为主机名。 123456#全部节点[root@controller ~]# cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4...</div></div></div></a><a class="pagination-related" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">云计算方向-2023年一带一路职业技能大赛云计算(样题)</div></div><div class="info-2"><div class="info-item-1">A模块题目OpenStack平台部署与运维任务 1 私有云平台环境初始化（6 分）   IP 主机名    192.168.157.30 controller   192.168.157.31 compute   1.配置主机名 把 controller 节点主机名设置为 controller, compute 节点主机名设置为 compute。  分别在 controller 节点和 compute 节点将 hostname 命令的返回结果提交到答题框。【0.5 分】 123456[root@controller ~]# hostnamecontroller[root@compute ~]# hostnamecompute  解法: 123hostnamectl set-hostname controllerhostnamectl set-hostname compute  2.配置 hosts 文件分别在 controller 节点和 compute 节点修改 hosts 文件将 IP 地址映射为主机名。 请在 controller 节点将 cat...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/6bf8b7d7.html" title="云计算方向-2022年云计算职业技能大赛国赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算职业技能大赛国赛题</div></div><div class="info-2"><div class="info-item-1">第一套【任务 1】私有云服务搭建[10分]【题目 1】基础环境配置[0.5 分]使用提供的用户名密码，登录提供的 OpenStack 私有云平台，在当前租户下，使用CentOS7.9 镜像，创建两台云主机，云主机类型使用 4vCPU&#x2F;12G&#x2F;100G_50G 类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至 controller 和 compute 节点（第二张网卡的网段为 10.10.X.0&#x2F;24，X 为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与 ssh 连接，然后按以下要求配置服务器： （1）设置控制节点主机名为 controller，设置计算节点主机名为 compute；  （2）修改 hosts 文件将 IP 地址映射为主机名； 1231.查看控制节点名字为 controller 正确计 0.2 分2.查看 hosts 文件中有正确的主机名和 IP 映射计 0.2 分3.控制节点正确使用两块网卡计 0.1...</div></div></div></a><a class="pagination-related" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</div></div><div class="info-2"><div class="info-item-1">A场次题目：Openstack 平台部署与运维任务1 私有云平台环境初始化1.初始化操作系统 使用提供的用户名密码，登录竞赛云平台。根据表 1 中的 IP 地址规划，设置各服务器节点的 IP 地址，确保网络正常通信，设置控制节点主机名为 Contro ller，计算节点主机名为 Compute，并修改 hosts 文件将 IP 地址映射为主机名， 关闭防火墙并设置为开机不启动，设置 SELinux 为 Permissive 模式并设置永久 关闭。请查看控制节点和计算节点主机名，使用命令查看 SELinux 状态，使用 head 命令、tail 命令和 cut 命令提取出永久关闭 SELinux 的关键信息。 将以上命令及返回结果提交到答题框  配置host 123456vi /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6...</div></div></div></a><a class="pagination-related" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-Ansible搭建wordpress</div></div><div class="info-2"><div class="info-item-1">一.ansible搭建wordpress基于lamp构建wordpress    master 192.168.200.100 控制节点    node1 192.168.200.101 web服务器   node2 192.168.200.102 mysql服务器   vi &#x2F;etc&#x2F;ansible&#x2F;host 12345678[master]master[web]192.168.200.101node1[database]192.168.200.102node2  vi wordpress.yaml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354---# hosts: 后面可写主机组名或主机名- hosts: all  remote_user: root  # 定义变量  vars:    db_pkgs:      # 以下的-为变量“值”，也就是在引用db_pkgs变量时，可取变量中的值   ...</div></div></div></a><a class="pagination-related" href="/posts/840d388d.html" title="云计算方向-2023年金砖大赛山东选拔题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖大赛山东选拔题</div></div><div class="info-2"><div class="info-item-1">A场次题目：OpenStack平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化，弹性分配，集中管理，性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：    设备名称 主机名 接口 ip地址    云服务器1 controller eth0，eth1 私网：192.168.100.10&#x2F;24           私网：192.168.200.10&#x2F;24   云服务器2 compute eth0，eth1 私网：192.168.100.20&#x2F;24        ...</div></div></div></a><a class="pagination-related" href="/posts/c134dd26.html" title="云计算方向-2022年云计算技能大赛样题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算技能大赛样题</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年GZ075 云计算应用赛项赛题</div></div><div class="info-2"><div class="info-item-1">模块一 私有云（30分）企业首先完成私有云平台搭建和运维，私有云平台提供云主机、云网络、云存储等基础架构云服务，并开发自动化运维程序。 任务1 私有云服务搭建（5分）1.1.1 基础环境配置1.控制节点主机名为controller，设置计算节点主机名为compute； 12345678910#控制节点[root@localhost ~]# hostnamectl set-hostname controller[root@localhost ~]# bash[root@controller ~]##计算节点[root@localhost ~]# hostnamectl set-hostname compute[root@localhost ~]# bash[root@compute ~]#    2.hosts文件将IP地址映射为主机名。 123456#全部节点[root@controller ~]# cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">GoldY</div><div class="author-info-description">不经一番寒彻骨，怎得梅花扑鼻香。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuwenjin666"><i class="fab fa-github"></i><span>Github主页</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">联系我V：GoldY_66</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#A%E6%A8%A1%E5%9D%97%E9%A2%98%E7%9B%AE%EF%BC%9AOpenStack-%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%BF%90%E7%BB%B4"><span class="toc-number">1.</span> <span class="toc-text">A模块题目：OpenStack 平台部署与运维</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A11-1%E7%A7%81%E6%9C%89%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%885-%E5%88%86%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">任务1 1私有云平台环境初始化（5 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AE%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.配置主机名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%8C%82%E8%BD%BD%E5%85%89%E7%9B%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">2.挂载光盘镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BAftp%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">3.搭建ftp服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%86%E5%8C%BA"><span class="toc-number">1.1.4.</span> <span class="toc-text">4.分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98-%E8%84%8F%E6%95%B0%E6%8D%AE%E5%9B%9E%E5%86%99"><span class="toc-number">1.1.5.</span> <span class="toc-text">5.系统调优-脏数据回写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-OpenStack%E6%90%AD%E5%BB%BA%E4%BB%BB%E5%8A%A1-8%E5%88%86"><span class="toc-number">1.2.</span> <span class="toc-text">任务2 OpenStack搭建任务 (8分)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.修改脚本文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85openstack%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.安装openstack基础组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.搭建数据库组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%90%AD%E5%BB%BA%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.搭建认证服务组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%90%AD%E5%BB%BA%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.搭建镜像服务组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%90%AD%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.6.</span> <span class="toc-text">6.搭建计算服务组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%90%AD%E5%BB%BA%E7%BD%91%E7%BB%9C%E7%BB%84%E4%BB%B6%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E7%BD%91%E7%BB%9C"><span class="toc-number">1.2.7.</span> <span class="toc-text">7.搭建网络组件并初始化网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2"><span class="toc-number">1.2.8.</span> <span class="toc-text">8.搭建图形化界面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-OpenStack%E8%BF%90%E7%BB%B4%E4%BB%BB%E5%8A%A1%EF%BC%8811%E5%88%86%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">任务3 OpenStack运维任务（11分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.数据库管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.数据库管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%89%E5%85%A8%E7%BB%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.安全组管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.4.</span> <span class="toc-text">4.项目管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.5.</span> <span class="toc-text">5.用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-heat%E6%A8%A1%E6%9D%BF%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.6.</span> <span class="toc-text">6.heat模板管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.7.</span> <span class="toc-text">7.后端配置文件管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.8.</span> <span class="toc-text">8.存储服务管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.9.</span> <span class="toc-text">9.存储管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.10.</span> <span class="toc-text">10.存储管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-OpenStack-API-%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.11.</span> <span class="toc-text">11.OpenStack API 管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E5%9B%9B-OpenStack%E6%9E%B6%E6%9E%84%E4%BB%BB%E5%8A%A1%EF%BC%886%E5%88%86%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">任务四 OpenStack架构任务（6分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85python3%E7%8E%AF%E5%A2%83"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.安装python3环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-python%E5%AF%B9%E6%8E%A5OpenStack-API%E5%88%9B%E5%BB%BAimage%E9%95%9C%E5%83%8F"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.python对接OpenStack API创建image镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-python%E5%AF%B9%E6%8E%A5OpenStack-API%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.python对接OpenStack API创建用户</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#B%E6%A8%A1%E5%9D%97%E9%A2%98%E7%9B%AE%EF%BC%9A%E5%AE%B9%E5%99%A8%E7%9A%84%E7%BC%96%E6%8E%92%E4%B8%8E%E8%BF%90%E7%BB%B4"><span class="toc-number">2.</span> <span class="toc-text">B模块题目：容器的编排与运维</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-1%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8810-5%E5%88%86%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">任务 1容器云平台环境初始化（10.5分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.容器云平台的初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%8D%E5%88%B6"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.镜像文件的复制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Yum%E6%BA%90%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.1.3.</span> <span class="toc-text">3.Yum源的编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%89%E8%A3%85ftp%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.1.4.</span> <span class="toc-text">4.安装ftp服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-ftp%E6%BA%90%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.1.5.</span> <span class="toc-text">5.ftp源的编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.1.6.</span> <span class="toc-text">6.设置时间同步服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%AE%BE%E7%BD%AE%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95"><span class="toc-number">2.1.7.</span> <span class="toc-text">7.设置免密登录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-k8s%E6%90%AD%E5%BB%BA%E4%BB%BB%E5%8A%A1%EF%BC%8819-5%E5%88%86%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">任务2 k8s搭建任务（19.5分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85docker%E5%BA%94%E7%94%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.安装docker应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85docker%E5%BA%94%E7%94%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.安装docker应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%BD%BD%E5%85%A5%E9%95%9C%E5%83%8F"><span class="toc-number">2.2.3.</span> <span class="toc-text">3.载入镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%89%E8%A3%85docker-compose"><span class="toc-number">2.2.4.</span> <span class="toc-text">4.安装docker-compose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%90%AD%E5%BB%BAhorbor%E4%BB%93%E5%BA%93"><span class="toc-number">2.2.5.</span> <span class="toc-text">5.搭建horbor仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E4%B8%8A%E4%BC%A0docker%E9%95%9C%E5%83%8F"><span class="toc-number">2.2.6.</span> <span class="toc-text">6.上传docker镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E9%83%A8%E7%BD%B2Kubeadm%E3%80%81containerd%E3%80%81nerdctl%E5%92%8Cbuildkit"><span class="toc-number">2.2.7.</span> <span class="toc-text">7.部署Kubeadm、containerd、nerdctl和buildkit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%9B%86%E7%BE%A4"><span class="toc-number">2.2.8.</span> <span class="toc-text">8.初始化集群</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%AE%89%E8%A3%85kubernetes%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6"><span class="toc-number">2.2.9.</span> <span class="toc-text">9.安装kubernetes网络插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E5%88%9B%E5%BB%BA%E8%AF%81%E4%B9%A6"><span class="toc-number">2.2.10.</span> <span class="toc-text">10.创建证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-kubernetes-%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.11.</span> <span class="toc-text">11.kubernetes 图形化界面的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E5%88%A0%E9%99%A4%E6%B1%A1%E7%82%B9"><span class="toc-number">2.2.12.</span> <span class="toc-text">12.删除污点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E6%89%A9%E5%B1%95%E8%AE%A1%E7%AE%97%E8%8A%82%E7%82%B9"><span class="toc-number">2.2.13.</span> <span class="toc-text">13.扩展计算节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13%E9%83%A8%E7%BD%B2Owncloud%E7%BD%91%E7%9B%98%E6%9C%8D%E5%8A%A1%EF%BC%8810-%E5%88%86%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">任务3部署Owncloud网盘服务（10 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BAPV%E5%92%8CPVC"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.创建PV和PVC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AEConfigMap"><span class="toc-number">2.3.2.</span> <span class="toc-text">2. 配置ConfigMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BASecret"><span class="toc-number">2.3.3.</span> <span class="toc-text">3.创建Secret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%83%A8%E7%BD%B2owncloud-Deployment%E5%BA%94%E7%94%A8"><span class="toc-number">2.3.4.</span> <span class="toc-text">4.部署owncloud Deployment应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%88%9B%E5%BB%BAService"><span class="toc-number">2.3.5.</span> <span class="toc-text">5.创建Service</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#C%E6%A8%A1%E5%9D%97%E9%A2%98%E7%9B%AE%EF%BC%9A%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E5%92%8C%E8%BF%90%E7%BB%B4"><span class="toc-number">3.</span> <span class="toc-text">C模块题目：企业级应用的自动化部署和运维</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%EF%BC%8830%E5%88%86%EF%BC%89"><span class="toc-number">3.1.</span> <span class="toc-text">企业级应用的自动化部署（30分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85ansible"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.安装ansible</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.配置免密登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AE%E4%B8%BB%E6%9C%BA%E6%B8%85%E5%8D%95"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.配置主机清单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%89%E8%A3%85nginx%E5%92%8Cphp"><span class="toc-number">3.1.4.</span> <span class="toc-text">4.安装nginx和php</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%AE%89%E8%A3%85zabbix%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">3.1.5.</span> <span class="toc-text">5.安装zabbix服务器端和客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%AE%89%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.1.6.</span> <span class="toc-text">6.安装数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.1.7.</span> <span class="toc-text">7.配置数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="toc-number">3.1.8.</span> <span class="toc-text">8.导入数据库架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.9.</span> <span class="toc-text">9.配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.10.</span> <span class="toc-text">10.配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.11.</span> <span class="toc-text">11.配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.12.</span> <span class="toc-text">12.配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.13.</span> <span class="toc-text">13.配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E7%BC%96%E5%86%99playbook"><span class="toc-number">3.1.14.</span> <span class="toc-text">14.编写playbook</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-Ansible搭建wordpress"/></a><div class="content"><a class="title" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress">云计算方向-Ansible搭建wordpress</a><time datetime="2025-05-14T02:48:38.000Z" title="发表于 2025-05-14 10:48:38">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"/></a><div class="content"><a class="title" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</a><time datetime="2025-05-14T02:48:37.000Z" title="发表于 2025-05-14 10:48:37">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年一带一路职业技能大赛云计算(样题)"/></a><div class="content"><a class="title" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)">云计算方向-2023年一带一路职业技能大赛云计算(样题)</a><time datetime="2025-05-14T02:48:35.000Z" title="发表于 2025-05-14 10:48:35">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖大赛"/></a><div class="content"><a class="title" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛">云计算方向-2023年金砖大赛</a><time datetime="2025-05-14T02:48:32.000Z" title="发表于 2025-05-14 10:48:32">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年GZ075 云计算应用赛项赛题"/></a><div class="content"><a class="title" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题">云计算方向-2023年GZ075 云计算应用赛项赛题</a><time datetime="2025-05-14T02:47:38.000Z" title="发表于 2025-05-14 10:47:38">2025-05-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/bottom-bg.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2025 By GoldY</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=yuwenjin666";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="yuwenjin666";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/about'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>