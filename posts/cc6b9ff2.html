<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>云计算方向-2023年GZ075 云计算应用赛项赛题 | GoldY</title><meta name="author" content="GoldY"><meta name="copyright" content="GoldY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2023年GZ075 云计算应用赛项赛题">
<meta property="og:type" content="article">
<meta property="og:title" content="云计算方向-2023年GZ075 云计算应用赛项赛题">
<meta property="og:url" content="https://www.geekgold.xyz/posts/cc6b9ff2.html">
<meta property="og:site_name" content="GoldY">
<meta property="og:description" content="2023年GZ075 云计算应用赛项赛题">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.geekgold.xyz/img/cloud-com.jpg">
<meta property="article:published_time" content="2025-05-14T02:47:38.000Z">
<meta property="article:modified_time" content="2025-05-14T03:16:03.865Z">
<meta property="article:author" content="GoldY">
<meta property="article:tag" content="云计算">
<meta property="article:tag" content="云计算职业技能大赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.geekgold.xyz/img/cloud-com.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "云计算方向-2023年GZ075 云计算应用赛项赛题",
  "url": "https://www.geekgold.xyz/posts/cc6b9ff2.html",
  "image": "https://www.geekgold.xyz/img/cloud-com.jpg",
  "datePublished": "2025-05-14T02:47:38.000Z",
  "dateModified": "2025-05-14T03:16:03.865Z",
  "author": [
    {
      "@type": "Person",
      "name": "GoldY",
      "url": "https://www.geekgold.xyz/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.geekgold.xyz/posts/cc6b9ff2.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="bing-site-verification" content="E05CD8D6921B8F2AA32324DF2B267557"/><meta name="baidu-site-verification" content="codeva-tCktTl1n17"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":2,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '云计算方向-2023年GZ075 云计算应用赛项赛题',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cloud-com.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.png" alt="Logo"><span class="site-name">GoldY</span></a><a class="nav-page-title" href="/"><span class="site-name">云计算方向-2023年GZ075 云计算应用赛项赛题</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">云计算方向-2023年GZ075 云计算应用赛项赛题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-14T02:47:38.000Z" title="发表于 2025-05-14 10:47:38">2025-05-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-14T03:16:03.865Z" title="更新于 2025-05-14 11:16:03">2025-05-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E6%B1%87%E6%80%BB/">技能大赛汇总</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">8.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>39分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="模块一-私有云（30分）"><a href="#模块一-私有云（30分）" class="headerlink" title="模块一 私有云（30分）"></a><strong>模块一 私有云（30分）</strong></h1><p>企业首先完成私有云平台搭建和运维，私有云平台提供云主机、云网络、云存储等基础架构云服务，并开发自动化运维程序。</p>
<h2 id="任务1-私有云服务搭建（5分）"><a href="#任务1-私有云服务搭建（5分）" class="headerlink" title="任务1 私有云服务搭建（5分）"></a><strong>任务1 私有云服务搭建（5分）</strong></h2><h3 id="1-1-1-基础环境配置"><a href="#1-1-1-基础环境配置" class="headerlink" title="1.1.1 基础环境配置"></a>1.1.1 基础环境配置</h3><p>1.控制节点主机名为controller，设置计算节点主机名为compute；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">控制节点</span></span><br><span class="line">[root@localhost ~]# hostnamectl set-hostname controller</span><br><span class="line">[root@localhost ~]# bash</span><br><span class="line">[root@controller ~]#</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">计算节点</span></span><br><span class="line">[root@localhost ~]# hostnamectl set-hostname compute</span><br><span class="line">[root@localhost ~]# bash</span><br><span class="line">[root@compute ~]#</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.hosts文件将IP地址映射为主机名。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">全部节点</span></span><br><span class="line">[root@controller ~]# cat /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">172.129.1.10 controller</span><br><span class="line">172.129.1.11 compute</span><br></pre></td></tr></table></figure>



<p>1.1.2  yum源配置</p>
<p>使用提供的http服务地址，分别设置controller节点和compute节点的yum源文件http.repo。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#因为环境原因 自己上传镜像使用即可,自行挂载使用</span></span></span><br><span class="line">[root@controller ~]# cat /etc/yum.repos.d/local.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///opt/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[iaas]</span><br><span class="line">name=openstack</span><br><span class="line">baseurl=file:///opt/openstack/iaas-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[root@compute yum.repos.d]# cat /etc/yum.repos.d/fto.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=ftp://controller/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[iaas]</span><br><span class="line">name=openstack</span><br><span class="line">baseurl=ftp://controller/openstack/iaas-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>1.1.3 配置无秘钥ssh</p>
<p>配置controller节点可以无秘钥访问compute节点。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa):</span><br><span class="line">Created directory &#x27;/root/.ssh&#x27;.</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:gyXwgY44hJYX3AgT2fexXMrZm2h5PSO7gjKvLkqaUdQ root@controller</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|.+B.=..          |</span><br><span class="line">|.=.*.= o .       |</span><br><span class="line">|o.ooE * O        |</span><br><span class="line">|o.. .  @ .       |</span><br><span class="line">| ..   . S +      |</span><br><span class="line">| .     + * +     |</span><br><span class="line">|..    o . o o    |</span><br><span class="line">|o+ o . . .       |</span><br><span class="line">|= oo=.  ...      |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">[root@controller ~]# ssh-copy-id root@compute</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/root/.ssh/id_rsa.pub&quot;</span><br><span class="line">The authenticity of host &#x27;compute (172.129.1.11)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:WgjZdcpq8bqsV/iKGbAQHGzRcdjUspMRWZBqg3iXV28.</span><br><span class="line">ECDSA key fingerprint is MD5:fc:3a:85:49:87:63:d6:7f:f4:19:b5:cd:ce:f7:f2:88.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span><br><span class="line">root@compute&#x27;s password:</span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   &quot;ssh &#x27;root@compute&#x27;&quot;</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>1.1.4 基础安装</strong></p>
<p>在控制节点和计算节点上分别安装openstack-iaas软件包。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# yum install -y openstack-iaas</span><br></pre></td></tr></table></figure>



<p><strong>1.1.5 数据库安装与调优</strong></p>
<p>在控制节点上使用安装Mariadb、RabbitMQ等服务。并进行相关操作。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-mysql.sh</span><br></pre></td></tr></table></figure>

<p>扩展</p>
<p>数据库调优:</p>
<p>在 controller 节点上使用 iaas-install-mysql.sh 脚本安装 Mariadb、Memcached、RabbitMQ<br>等服务。安装服务完毕后，修改&#x2F;etc&#x2F;my.cnf 文件，完成下列要求：</p>
<p>1.设置数据库支持大小写；<br>2.设置数据库缓存 innodb 表的索引，数据，插入数据时的缓冲为 4G； </p>
<p>3.设置数据库的 log buffer 为 64MB；<br>4.设置数据库的 redo log 大小为 256MB；<br>5.设置数据库的 redo log 文件组为 2。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# vim /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">lower_case_table_names =1   #数据库支持大小写</span><br><span class="line">innodb_buffer_pool_size = 4G  #数据库缓存</span><br><span class="line">innodb_log_buffer_size = 64MB  #设置数据库的log buffer即redo日志缓冲</span><br><span class="line">innodb_log_file_size = 256MB   #设置数据库的redo log即redo日志大小</span><br><span class="line">innodb_log_files_in_group = 2   #数据库的redo log文件组即redo日志的个数配置</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p><strong>1.1.6  Keystone服务安装与使用</strong></p>
<p>在控制节点上安装Keystone服务并创建用户。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-keystone.sh</span><br></pre></td></tr></table></figure>



<p><strong>1.1.7 Glance安装与使用</strong></p>
<p>在控制节点上安装Glance 服务。上传镜像至平台，并设置镜像启动的要求参数。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-glance.sh</span><br></pre></td></tr></table></figure>



<p><strong>1.1.8 Nova安装</strong></p>
<p>在控制节点和计算节点上分别安装Nova服务。安装完成后，完成Nova相关配置。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#注意要在安装nova之前安装此脚本</span></span></span><br><span class="line"></span><br><span class="line">[root@controller ~]# iaas-install-placement.sh</span><br><span class="line"></span><br><span class="line">[root@controller ~]# iaas-install-nova-controller.sh</span><br><span class="line"></span><br><span class="line">[root@compute ~]# iaas-install-nova-compute.sh</span><br></pre></td></tr></table></figure>

<p>拓展</p>
<p>安装完成后，请修改 nova 相关配置文件，解决因等待时间过长而导致虚拟机启动超时从而获取不</p>
<p>到 IP 地址而报错失败的问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-placement.sh</span><br><span class="line">[root@controller ~]# iaas-install-nova-controller.sh</span><br><span class="line">[root@controller ~]# vim /etc/nova/nova.conf</span><br><span class="line">​</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">vif_plugging_is_fatal=<span class="literal">true</span></span></span><br><span class="line">​</span><br><span class="line">改为</span><br><span class="line">​</span><br><span class="line">vif_plugging_is_fatal=false</span><br><span class="line">​</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启nova-*</span></span><br><span class="line">systemctl restart openstack-nova*</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>1.1.9 Neutron安装</strong></p>
<p>在控制和计算节点上正确安装Neutron服务。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-neutron-controller.sh</span><br><span class="line">[root@compute ~]# iaas-install-neutron-compute.sh</span><br></pre></td></tr></table></figure>



<p>1.1.10 Dashboard安装</p>
<p>在控制节点上安装Dashboard服务。安装完成后，将Dashboard中的 Django数据修改为存储在文件中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-dashboard.sh</span><br><span class="line">[root@controller ~]# vim /etc/openstack-dashboard/local_settings</span><br><span class="line">SESSION_ENGINE = &#x27;django.contrib.sessions.backends.cache&#x27;</span><br><span class="line">改为</span><br><span class="line">SESSION_ENGINE = &#x27;django.contrib.sessions.backends.file&#x27;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">验证</span></span><br><span class="line">systemctl restart httpd</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>1.1.11 Swift安装</p>
<p>在控制节点和计算节点上分别安装Swift服务。安装完成后，将cirros镜像进行分片存储。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-swift-controller.sh</span><br><span class="line"></span><br><span class="line">[root@compute ~]# iaas-install-swift-compute.sh</span><br></pre></td></tr></table></figure>

<p> 拓展:</p>
<p>在 控 制 节 点 和 计 算 节 点 上 分 别 使 用 iaas-install-swift-controller.sh 和iaas-install-swift-compute.sh 脚本安装 Swift 服务。安装完成后，使用命令创建一个名叫examcontainer 的容器，将 cirros-0.3.4-x86_64-disk.img 镜像上传到 examcontainer 容器中，并设置分段存放，每一段大小为 10M</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# ls</span><br><span class="line">anaconda-ks.cfg  cirros-0.3.4-x86_64-disk.img  logininfo.txt</span><br><span class="line">[root@controller ~]# swift post examcontainers</span><br><span class="line">[root@controller ~]# swift upload examcontaiers -S 10485760 cirros-0.3.4-x86_64-disk.img</span><br><span class="line">cirros-0.3.4-x86_64-disk.img segment 1</span><br><span class="line">cirros-0.3.4-x86_64-disk.img segment 0</span><br><span class="line">cirros-0.3.4-x86_64-disk.img</span><br><span class="line">[root@controller ~]# du -sh cirros-0.3.4-x86_64-disk.img</span><br><span class="line">13M     cirros-0.3.4-x86_64-disk.img</span><br><span class="line">[root@controller ~]#</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">因为镜像就13M，所有存储为两段</span></span><br></pre></td></tr></table></figure>





<p><strong>1.1.12 Cinder创建硬盘</strong></p>
<p>在控制节点和计算节点分别安装Cinder服务，请在计算节点，对块存储进行扩容操作。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@cobtroller ~]# iaas-install-cinder-controller.sh</span><br><span class="line">[root@compute ~]# iaas-install-cinder-compute.sh</span><br></pre></td></tr></table></figure>

<p>扩展</p>
<p>请在计算节点，对块存储进行扩容操作， 即在计算节点再分出一个 5G 的分区，加入到 cinder 块存储的后端存储中去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#创建物理卷</span><br><span class="line">pvcreate /dev/vdb4</span><br><span class="line"></span><br><span class="line">#扩展cinder-volume卷组</span><br><span class="line">vgextend cinder-volumes /dev/vdb4</span><br><span class="line"></span><br><span class="line">#验证</span><br><span class="line">[root@compute ~]# vgdisplay</span><br></pre></td></tr></table></figure>

<p>1.1.13 Manila服务安装与使用</p>
<p>在控制和计算节点上分别在控制节点和计算节点安装Manila服务。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-manila-controller.sh</span><br><span class="line">[root@compute ~]# iaas-install-manila-compute.sh</span><br></pre></td></tr></table></figure>



<h3 id="任务2-私有云服务运维（15分"><a href="#任务2-私有云服务运维（15分" class="headerlink" title="任务2 私有云服务运维（15分)"></a><strong>任务2 私有云服务运维（15分)</strong></h3><p>1.2.1 OpenStack开放镜像权限</p>
<p>在admin项目中存在glance-cirros镜像文件，将glance-cirros镜像指定demo项目进行共享使用。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack image set glance-cirros --shared</span><br></pre></td></tr></table></figure>



<p><strong>1.2.2	SkyWalking 应用部署</strong></p>
<p>申请一台云主机，使用提供的软件包安装Elasticsearch服务和SkyWalking服务。再申请一台云主机，用于搭建gpmall商城应用，并配置SkyWalking 监控gpmall主机。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将所需要的包进行上传</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">elasticsearch部署</span></span><br><span class="line">[root@controller ~]# rpm -ivh elasticsearch-7.0.0-x86_64.rpm</span><br><span class="line">[root@controller ~]# vi /etc/elasticsearch/elasticsearch.yml</span><br><span class="line">需要配置的地方：</span><br><span class="line">cluster.name: yutao – 这个需要和skywalking中的elasticsearch配置保持一致</span><br><span class="line">node.name: node-1</span><br><span class="line">network.host: 0.0.0.0</span><br><span class="line">http.port: 9200 （默认就是，可以不解开注释，我解开了）</span><br><span class="line">discovery.seed_hosts: [“127.0.0.1”] 一定要配置，不然找不到主节点</span><br><span class="line">cluster.initial_master_nodes: [“node-1”] 一定要配置，不然找不到主节点</span><br><span class="line"></span><br><span class="line">[root@controller ~]# systemctl enable --now elasticsearch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">skywalking部署</span></span><br><span class="line">storage:</span><br><span class="line">  selector: elasticsearch7</span><br><span class="line">  elasticsearch:</span><br><span class="line">    nameSpace: $&#123;SW_NAMESPACE:&quot;yutao&quot;&#125;</span><br><span class="line">    clusterNodes: $&#123;SW_STORAGE_ES_CLUSTER_NODES:localhost:9200&#125;</span><br><span class="line">    protocol: $&#123;SW_STORAGE_ES_HTTP_PROTOCOL:&quot;http&quot;&#125;</span><br><span class="line">    trustStorePath: $&#123;SW_SW_STORAGE_ES_SSL_JKS_PATH:&quot;../es_keystore.jks&quot;&#125;</span><br><span class="line">    trustStorePass: $&#123;SW_SW_STORAGE_ES_SSL_JKS_PASS:&quot;&quot;&#125;</span><br><span class="line">    user: $&#123;SW_ES_USER:&quot;&quot;&#125;</span><br><span class="line">    password: $&#123;SW_ES_PASSWORD:&quot;&quot;&#125;</span><br><span class="line">    secretsManagementFile: $&#123;SW_ES_SECRETS_MANAGEMENT_FILE:&quot;&quot;&#125; # Secrets management file in the properties format includes the username, password, which are managed by 3rd party tool.</span><br><span class="line">    enablePackedDownsampling: $&#123;SW_STORAGE_ENABLE_PACKED_DOWNSAMPLING:true&#125; # Hour and Day metrics will be merged into minute index.</span><br><span class="line">    dayStep: $&#123;SW_STORAGE_DAY_STEP:1&#125; # Represent the number of days in the one minute/hour/day index.</span><br><span class="line">    indexShardsNumber: $&#123;SW_STORAGE_ES_INDEX_SHARDS_NUMBER:2&#125;</span><br><span class="line">    indexReplicasNumber: $&#123;SW_STORAGE_ES_INDEX_REPLICAS_NUMBER:0&#125;</span><br><span class="line">    # Those data TTL settings will override the same settings in core module.</span><br><span class="line">    recordDataTTL: $&#123;SW_STORAGE_ES_RECORD_DATA_TTL:7&#125; # Unit is day</span><br><span class="line">    otherMetricsDataTTL: $&#123;SW_STORAGE_ES_OTHER_METRIC_DATA_TTL:45&#125; # Unit is day</span><br><span class="line">    monthMetricsDataTTL: $&#123;SW_STORAGE_ES_MONTH_METRIC_DATA_TTL:18&#125; # Unit is month</span><br><span class="line">    # Batch process setting, refer to https://www.elastic.co/guide/en/elasticsearch/client/java-api/5.5/java-docs-bulk-processor.html</span><br><span class="line">    bulkActions: $&#123;SW_STORAGE_ES_BULK_ACTIONS:1000&#125; # Execute the bulk every 1000 requests</span><br><span class="line">    flushInterval: $&#123;SW_STORAGE_ES_FLUSH_INTERVAL:10&#125; # flush the bulk every 10 seconds whatever the number of requests</span><br><span class="line">    concurrentRequests: $&#123;SW_STORAGE_ES_CONCURRENT_REQUESTS:2&#125; # the number of concurrent requests</span><br><span class="line">    resultWindowMaxSize: $&#123;SW_STORAGE_ES_QUERY_MAX_WINDOW_SIZE:10000&#125;</span><br><span class="line">    metadataQueryMaxSize: $&#123;SW_STORAGE_ES_QUERY_MAX_SIZE:5000&#125;</span><br><span class="line">    segmentQueryMaxSize: $&#123;SW_STORAGE_ES_QUERY_SEGMENT_SIZE:200&#125;</span><br><span class="line">    profileTaskQueryMaxSize: $&#123;SW_STORAGE_ES_QUERY_PROFILE_TASK_SIZE:200&#125;</span><br><span class="line">    advanced: $&#123;SW_STORAGE_ES_ADVANCED:&quot;&quot;&#125;</span><br><span class="line">  elasticsearch7:</span><br><span class="line">    nameSpace: $&#123;SW_NAMESPACE:&quot;yutao&quot;&#125;</span><br><span class="line">    clusterNodes: $&#123;SW_STORAGE_ES_CLUSTER_NODES:localhost:9200&#125;</span><br><span class="line">    protocol: $&#123;SW_STORAGE_ES_HTTP_PROTOCOL:&quot;http&quot;&#125;</span><br><span class="line">    trustStorePath: $&#123;SW_SW_STORAGE_ES_SSL_JKS_PATH:&quot;../es_keystore.jks&quot;&#125;</span><br><span class="line">    trustStorePass: $&#123;SW_SW_STORAGE_ES_SSL_JKS_PASS:&quot;&quot;&#125;</span><br><span class="line">    enablePackedDownsampling: $&#123;SW_STORAGE_ENABLE_PACKED_DOWNSAMPLING:true&#125; # Hour and Day metrics will be merged into minute index.</span><br><span class="line">    dayStep: $&#123;SW_STORAGE_DAY_STEP:1&#125; # Represent the number of days in the one minute/hour/day index.</span><br><span class="line">    user: $&#123;SW_ES_USER:&quot;&quot;&#125;</span><br><span class="line">    password: $&#123;SW_ES_PASSWORD:&quot;&quot;&#125;</span><br><span class="line">    secretsManagementFile: $&#123;SW_ES_SECRETS_MANAGEMENT_FILE:&quot;&quot;&#125; # Secrets management file in the properties format includes the username, password, which are managed by 3rd party tool.</span><br><span class="line">    indexShardsNumber: $&#123;SW_STORAGE_ES_INDEX_SHARDS_NUMBER:2&#125;</span><br><span class="line">    indexReplicasNumber: $&#123;SW_STORAGE_ES_INDEX_REPLICAS_NUMBER:0&#125;</span><br><span class="line">    # Those data TTL settings will override the same settings in core module.</span><br><span class="line">    recordDataTTL: $&#123;SW_STORAGE_ES_RECORD_DATA_TTL:7&#125; # Unit is day</span><br><span class="line">    otherMetricsDataTTL: $&#123;SW_STORAGE_ES_OTHER_METRIC_DATA_TTL:45&#125; # Unit is day</span><br><span class="line">    monthMetricsDataTTL: $&#123;SW_STORAGE_ES_MONTH_METRIC_DATA_TTL:18&#125; # Unit is month</span><br><span class="line">    # Batch process setting, refer to https://www.elastic.co/guide/en/elasticsearch/client/java-api/5.5/java-docs-bulk-processor.html</span><br><span class="line">    bulkActions: $&#123;SW_STORAGE_ES_BULK_ACTIONS:1000&#125; # Execute the bulk every 1000 requests</span><br><span class="line">    flushInterval: $&#123;SW_STORAGE_ES_FLUSH_INTERVAL:10&#125; # flush the bulk every 10 seconds whatever the number of requests</span><br><span class="line">    concurrentRequests: $&#123;SW_STORAGE_ES_CONCURRENT_REQUESTS:2&#125; # the number of concurrent requests</span><br><span class="line">    resultWindowMaxSize: $&#123;SW_STORAGE_ES_QUERY_MAX_WINDOW_SIZE:10000&#125;</span><br><span class="line">    metadataQueryMaxSize: $&#123;SW_STORAGE_ES_QUERY_MAX_SIZE:5000&#125;</span><br><span class="line">    segmentQueryMaxSize: $&#123;SW_STORAGE_ES_QUERY_SEGMENT_SIZE:200&#125;</span><br><span class="line">    profileTaskQueryMaxSize: $&#123;SW_STORAGE_ES_QUERY_PROFILE_TASK_SIZE:200&#125;</span><br><span class="line">    advanced: $&#123;SW_STORAGE_ES_ADVANCED:&quot;&quot;&#125;</span><br><span class="line"><span class="meta prompt_">  #</span><span class="language-bash">h2:</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"> driver: <span class="variable">$&#123;SW_STORAGE_H2_DRIVER:org.h2.jdbcx.JdbcDataSource&#125;</span></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"> url: <span class="variable">$&#123;SW_STORAGE_H2_URL:jdbc:h2:mem:skywalking-oap-db&#125;</span></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"> user: <span class="variable">$&#123;SW_STORAGE_H2_USER:sa&#125;</span></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"> metadataQueryMaxSize: <span class="variable">$&#123;SW_STORAGE_H2_QUERY_MAX_SIZE:5000&#125;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#注意的地方</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">因为安装的是elasticsearch7所以这里选的是elasticsearch7</span></span><br><span class="line">storage:</span><br><span class="line">  selector: elasticsearch7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearch7:</span><br><span class="line">    nameSpace: $&#123;SW_NAMESPACE:&quot;yutao&quot;&#125; # 这和上面elasticsearch配置中的cluster.name保存一直</span><br><span class="line"></span><br><span class="line">[root@controller ~]# bin/oapService.sh </span><br><span class="line">SkyWalking OAP started successfully!</span><br><span class="line">[root@controller ~]# bin/webappService.sh</span><br><span class="line">SkyWalking Web Application started successfully!</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#注意修改端口 二进制文件</span></span></span><br><span class="line">[root@controller apache-skywalking-apm-bin-es7]# vi webapp/webapp.yml</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>1.2.3 OpenStack镜像压缩</p>
<p>在HTTP文件服务器中存在一个镜像为CentOS7.5-compress.qcow2的镜像，请对该镜像进行压缩操作。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# du -sh CentOS7.5-compress.qcow2</span><br><span class="line">892M CentOS7.5-compress.qcow2</span><br><span class="line">[root@controller ~]# qemu-img convert -c -O qcow2 CentOS7.5-compress.qcow2 CentOS7.5-compress2.qcow2</span><br><span class="line"></span><br><span class="line">-c 压缩</span><br><span class="line">-O qcow2 输出格式为 qcow2</span><br><span class="line">CentOS7.5-compress.qcow2   被压缩的文件</span><br><span class="line">CentOS7.5-compress2.qcow2 压缩完成后文件</span><br><span class="line"></span><br><span class="line">[root@controller ~]# du -sh CentOS7.5-compress2.qcow2</span><br><span class="line">405M CentOS7.5-compress2.qcow2</span><br></pre></td></tr></table></figure>



<p>1.2.4 Glance对接Cinder存储</p>
<p>在自行搭建的OpenStack平台中修改相关参数，使Glance可以使用Cinder作为后端存储。</p>
<p>1.2.5 使用Heat模板创建容器</p>
<p>在自行搭建的OpenStack私有云平台上，在&#x2F;root目录下编写Heat模板文件，要求执行yaml文件可以创建名为heat-swift的容器。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cat create_swift.yaml</span><br><span class="line">heat_template_version: 2018-08-31</span><br><span class="line">resources:</span><br><span class="line">  user:</span><br><span class="line">    type: OS::Swift::Container</span><br><span class="line">    properties:</span><br><span class="line">      name: heat-swift</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">执行yaml文件</span></span><br><span class="line">[root@controller ~]# openstack stack create heat-swift  -t create_swift.yaml</span><br></pre></td></tr></table></figure>



<p>1.2.6 Nova清除缓存</p>
<p>在OpenStack平台上，修改相关配置，让长时间不用的镜像缓存在过一定的时间后会被自动删除。</p>
<p>1.2.7 Redis集群部署。</p>
<p>部署Redis集群，Redis的一主二从三哨兵架构。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置redis</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">本实验通过epel源下载redis</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#放行相关的安全策略和防火墙</span></span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]# yum install -y redis</span><br><span class="line">[root@localhost ~]# vi /etc/redis.conf</span><br><span class="line"></span><br><span class="line">1.先在网络部分注释掉单机连接那一行,即注释掉bind 127.0.0.1 </span><br><span class="line">2.同样我们要将后台运行打开：daemonize no，设置为yes。</span><br><span class="line">3.将 保护模式关闭：protected-mode yes 改为：protected-mode no </span><br><span class="line">4.配置密码requirepass的密码改为123456</span><br><span class="line">5.配置连接master的密码masterauth 123456</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置连接master(主节点无需)</span></span><br><span class="line">[root@localhost ~]# redis-cli -p 6379</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">slaveof 127.0.0.1 6379</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">info replication</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">主节点查看状态</span></span><br><span class="line">[root@localhost ~]# redis-cli -p 6379</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">info replication</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置哨兵</span></span><br><span class="line">[root@localhost ~]# vi /etc/redis-sentinel.conf</span><br><span class="line"></span><br><span class="line">protected-mode no</span><br><span class="line">daemonize yes</span><br><span class="line">sentinel monitor mymaster 主节点ip 6379 2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#启动哨兵</span></span></span><br><span class="line">[root@localhost ~]# redis-sentinel /etc/redis-sentinel.conf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">验证</span></span><br><span class="line">[root@localhost ~]# redis-cli -p 26379</span><br><span class="line">127.0.0.1:26379&gt; info sentinel</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Sentinel</span></span><br><span class="line">sentinel_masters:1</span><br><span class="line">sentinel_tilt:0</span><br><span class="line">sentinel_running_scripts:0</span><br><span class="line">sentinel_scripts_queue_length:0</span><br><span class="line">sentinel_simulate_failure_flags:0</span><br><span class="line">master0:name=mymaster,status=sdown,address=172.129.1.50:6379,slaves=2,sentinels=3</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>1.2.8 Redis AOF调优</p>
<p>修改在Redis相关配置，避免AOF文件过大，Redis会进行AOF重写。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# vim /etc/redis.conf</span><br><span class="line"></span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连个参数分别改为</span></span><br><span class="line"></span><br><span class="line">aof-rewrite-incremental-fsync no</span><br><span class="line">no-appendfsync-on-rewrite yes</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置就是设置为<span class="built_in">yes</span>时候，在aof重写期间会停止aof的fsync操作</span></span><br><span class="line">[root@master ~]# systemctl restart redis</span><br></pre></td></tr></table></figure>



<p>1.2.9 JumpServer堡垒机部署</p>
<p>使用提供的软件包安装JumpServer堡垒机服务，并配置使用该堡垒机对接自己安装的控制和计算节点。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># ls</span></span><br><span class="line">anaconda<span class="literal">-ks</span>.cfg  jumpserver.tar.gz  original<span class="literal">-ks</span>.cfg</span><br></pre></td></tr></table></figure>
<p>解压软件包jumpserver.tar.gz至&#x2F;opt目录下</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># tar -zxvf jumpserver.tar.gz -C /opt/</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># ls /opt/</span></span><br><span class="line">compose  config  docker  docker.service  images  jumpserver<span class="literal">-repo</span>  static.env</span><br></pre></td></tr></table></figure>
<p>将默认Yum源移至其他目录，创建本地Yum源文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># mv /etc/yum.repos.d/* /mnt/</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># cat &gt;&gt; /etc/yum.repos.d/jumpserver.repo &lt;&lt; EOF</span></span><br><span class="line">[<span class="type">jumpserver</span>]</span><br><span class="line">name=jumpserver</span><br><span class="line">baseurl=file:///opt/jumpserver<span class="literal">-repo</span></span><br><span class="line">gpgcheck=<span class="number">0</span></span><br><span class="line">enabled=<span class="number">1</span></span><br><span class="line">EOF</span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># yum repolist</span></span><br><span class="line">repo id		repo name		status</span><br><span class="line">jumpserver	jumpserver		<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>安装Python数据库</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> ~]<span class="comment"># yum install python2 -y</span></span><br></pre></td></tr></table></figure>
<p>安装配置Docker环境</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># cp -rf /opt/docker/* /usr/bin/</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># chmod 775 /usr/bin/docker*</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># cp -rf /opt/docker.service /etc/systemd/system</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># chmod 775 /etc/systemd/system/docker.service </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># systemctl enable docker --now</span></span><br><span class="line">Created symlink from /etc/systemd/system/multi<span class="literal">-user</span>.target.wants/docker.service to /etc/systemd/system/dock</span><br><span class="line">er.service.</span><br></pre></td></tr></table></figure>
<p>验证服务状态</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># docker -v</span></span><br><span class="line">Docker version <span class="number">18.06</span>.<span class="number">3</span><span class="literal">-ce</span>, build d7080c1</span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># docker-compose -v</span></span><br><span class="line">docker<span class="literal">-compose</span> version <span class="number">1.27</span>.<span class="number">4</span>, build <span class="number">40524192</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">opt</span>]<span class="comment"># </span></span><br></pre></td></tr></table></figure>
<p>安装Jumpserver服务</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">images</span>]<span class="comment"># ls</span></span><br><span class="line">jumpserver_core_v2.<span class="number">11.4</span>.tar  jumpserver_lion_v2.<span class="number">11.4</span>.tar  jumpserver_nginx_alpine2.tar</span><br><span class="line">jumpserver_koko_v2.<span class="number">11.4</span>.tar  jumpserver_luna_v2.<span class="number">11.4</span>.tar  jumpserver_redis_6<span class="literal">-alpine</span>.tar</span><br><span class="line">jumpserver_lina_v2.<span class="number">11.4</span>.tar  jumpserver_mysql_5.tar       load.sh</span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">images</span>]<span class="comment"># cat load.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_core_v2.<span class="number">11.4</span>.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_koko_v2.<span class="number">11.4</span>.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_lina_v2.<span class="number">11.4</span>.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_lion_v2.<span class="number">11.4</span>.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_luna_v2.<span class="number">11.4</span>.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_mysql_5.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_nginx_alpine2.tar</span><br><span class="line">docker load <span class="literal">-i</span> jumpserver_redis_6<span class="literal">-alpine</span>.tar</span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">images</span>]<span class="comment"># sh load.sh </span></span><br></pre></td></tr></table></figure>
<p>创建Jumpserver服务组件目录</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">images</span>]<span class="comment"># mkdir -p /opt/jumpserver/&#123;core,koko,lion,mysql,nginx,redis&#125;</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">images</span>]<span class="comment"># cp -rf /opt/config /opt/jumpserver/</span></span><br></pre></td></tr></table></figure>
<p>生效环境变量static.env，使用所提供的脚本up.sh启动Jumpserver服务</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">compose</span>]<span class="comment"># ls</span></span><br><span class="line">config_static                docker<span class="literal">-compose-lb</span>.yml              docker<span class="literal">-compose-network</span>.yml         down.sh</span><br><span class="line">docker<span class="literal">-compose-app</span>.yml       docker<span class="literal">-compose-mysql-internal</span>.yml  docker<span class="literal">-compose-redis-internal</span>.yml  up.sh</span><br><span class="line">docker<span class="literal">-compose-es</span>.yml        docker<span class="literal">-compose-mysql</span>.yml           docker<span class="literal">-compose-redis</span>.yml</span><br><span class="line">docker<span class="literal">-compose-external</span>.yml  docker<span class="literal">-compose-network_ipv6</span>.yml    docker<span class="literal">-compose-task</span>.yml</span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">compose</span>]<span class="comment"># source /opt/static.env </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">compose</span>]<span class="comment"># sh up.sh </span></span><br><span class="line">Creating network <span class="string">&quot;jms_net&quot;</span> with driver <span class="string">&quot;bridge&quot;</span></span><br><span class="line">Creating jms_redis ... done</span><br><span class="line">Creating jms_mysql ... done</span><br><span class="line">Creating jms_core  ... done</span><br><span class="line">Creating jms_lina   ... done</span><br><span class="line">Creating jms_nginx  ... done</span><br><span class="line">Creating jms_celery ... done</span><br><span class="line">Creating jms_lion   ... done</span><br><span class="line">Creating jms_luna   ... done</span><br><span class="line">Creating jms_koko   ... done</span><br><span class="line">[<span class="type">root</span>@<span class="type">jumpserver</span> <span class="type">compose</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>浏览器访问<a target="_blank" rel="noopener" href="http://10.24.193.142,jumpserver/">http://10.24.193.142，Jumpserver</a> Web登录（admin&#x2F;admin）<br><img src="https://img-blog.csdnimg.cn/9c6d08ac6cbc413782c571a509762d33.png" alt="图1 Web登录.png"></p>
<p>图1 Web登录</p>
<p>登录成功后，会提示设置新密码，如图2所示：</p>
<p><img src="https://img-blog.csdnimg.cn/526c4bb658cd4ed28200391a45669b8f.png" alt="图2 修改密码.png"></p>
<p>图2 修改密码</p>
<p>登录平台后，单击页面右上角下拉菜单切换中文字符设置，如图3所示：</p>
<p><img src="https://img-blog.csdnimg.cn/4a359b9369fd421ab5363d195ceb370b.png" alt="图3 登录成功.png"></p>
<p>图3 登录成功</p>
<p>至此Jumpserver安装完成。</p>
<p>（6）管理资产</p>
<p>使用管理员admin用户登录Jumpserver管理平台，单击左侧导航栏，展开“资产管理”项目，选择“管理用户”，单击右侧“创建”按钮，如图4所示：</p>
<p><img src="https://img-blog.csdnimg.cn/0543340f279c4063b85a9cfcdc5c200d.png" alt="图4 管理用户.png"></p>
<p>图4 管理用户</p>
<p>创建远程连接用户，用户名为root密码为“Abc@1234”，单击“提交”按钮进行创建，如图5所示：</p>
<p><img src="https://img-blog.csdnimg.cn/b045cd27415a42c3980aac90453bd6b1.png" alt="图5 创建管理用户.png"></p>
<p>图5 创建管理用户</p>
<p>选择“系统用户”，单击右侧“创建”按钮，创建系统用户，选择主机协议“SSH”，设置用户名root，密码为服务器SSH密码并单击“提交”按钮，如图6所示：</p>
<p><img src="https://img-blog.csdnimg.cn/94b16f90dddf48589bd702e4254a7726.png" alt="图6 创建系统用户.png"></p>
<p>图6 创建系统用户</p>
<p>单击左侧导航栏，展开“资产管理”项目，选择“资产列表”，单击右侧“创建”按钮，如图7所示：</p>
<p><img src="https://img-blog.csdnimg.cn/d89596e2187b484c8ab56493cceec414.png" alt="图7 管理资产.png"></p>
<p>图7 管理资产</p>
<p>创建资产，将云平台主机（controller）加入资产内，如图8、图9所示：</p>
<p><img src="https://img-blog.csdnimg.cn/cb24b23b657f4f9b95749958c9f1bec3.png" alt="图8 创建资产controller.png"></p>
<p>图8 创建资产controller</p>
<p><img src="https://img-blog.csdnimg.cn/ca09c35ba686489c821a5c68fdef9c4d.png" alt="图9 创建成功.png"></p>
<p>图9 创建成功</p>
<p>（7）资产授权</p>
<p>单击左侧导航栏，展开“权限管理”项目，选择“资产授权”，单击右侧“创建”按钮，创建资产授权规则，如图10所示：</p>
<p><img src="https://img-blog.csdnimg.cn/887b01cf50214882be0efead1ba24b80.png" alt="图10 创建资产授权规则.png"></p>
<p>图10 创建资产授权规则</p>
<p>（8）测试连接</p>
<p>单击右上角管理员用户下拉菜单，选择“用户界面”，如图11所示：</p>
<p><img src="https://img-blog.csdnimg.cn/710a1447beb7445681332c825fa43e10.png" alt="图11 创建资产授权规则.png"></p>
<p>图11 创建资产授权规则</p>
<p>如果未出现Default项目下的资产主机，单击收藏夹后“刷新”按钮进行刷新，如图12所示：</p>
<p><img src="https://img-blog.csdnimg.cn/961fdae7c68e46efbe525d5cab17934a.png" alt="图12 查看资产.png"></p>
<p>图12 查看资产</p>
<p>单击左侧导航栏，选择“Web终端”进入远程连接页面，如图13所示：</p>
<p><img src="https://img-blog.csdnimg.cn/245f50fdd2ad4877aa2aeb3da44c9913.png" alt="图13 进入远程连接终端.png"></p>
<p>图13 进入远程连接终端</p>
<p>单击左侧Default，展开文件夹，单击controller主机，右侧成功连接主机，如图14所示：</p>
<p><img src="https://img-blog.csdnimg.cn/bf3b1559815f49bfa9a73bff930664d0.png" alt="图14 测试连接.png"></p>
<p>图14 测试连接</p>
<p>至此OpenStack对接堡垒机案例操作成功。</p>
<p>1.2.10 完成私有云平台的调优或排错工作。（本任务只公布考试范围，不公布赛题）ss</p>
<h3 id="任务3-私有云运维开发（10分）"><a href="#任务3-私有云运维开发（10分）" class="headerlink" title="*任务3 私有云运维开发（10分）*"></a><em><strong>*任务3 私有云运维开发（10分）*</strong></em></h3><p>1.3.1 编写Shell一键部署脚本</p>
<p>编写一键部署脚本，要求可以一键部署gpmall商城应用系统。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">inital hostname</span></span><br><span class="line">hostnamectl set-hostname mall</span><br><span class="line">ip=`ip a | sed -nr &quot;s/^ .*inet ([0-9].+)\/24 .*/\1/p&quot;`</span><br><span class="line">cat &gt;&gt; /etc/hosts &lt;&lt;EOF</span><br><span class="line">127.0.0.1 mysql.mall</span><br><span class="line">127.0.0.1 redis.mall</span><br><span class="line">127.0.0.1 zk1.mall</span><br><span class="line">127.0.0.1 kafka.mall</span><br><span class="line">127.0.0.1 zookeeper.mall</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">config yum ignore</span></span><br><span class="line">mkdir /etc/yum.repos.d/repo</span><br><span class="line">mv /etc/yum.repos.d/Centos* /etc/yum.repos.d/repo</span><br><span class="line">cat &gt;&gt; /etc/yum.repos.d/local.repo &lt;&lt;EOF</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///opt/centos</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">[gpmall-repo]</span><br><span class="line">name=gpmall</span><br><span class="line">baseurl=file:///root/gpmall_allinone/gpmall-repo</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">mkdir /opt/centos</span><br><span class="line">mount /dev/cdrom /opt/centos</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">intal enviroment</span></span><br><span class="line">yum install -y java-1.8.0-openjdk*</span><br><span class="line">yum install -y redis</span><br><span class="line">yum install -y nginx</span><br><span class="line">yum install -y mariadb-server</span><br><span class="line">tar -zxvf zookeeper-3.4.14.tar.gz</span><br><span class="line">tar -zxvf kafka_2.11-1.1.1.tgz</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#started zookeeper</span></span></span><br><span class="line">mv zookeeper-3.4.14/conf/zoo_sample.cfg zookeeper-3.4.14/conf/zoo.cfg</span><br><span class="line">./bin/zkServer.sh start</span><br><span class="line">echo $?</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">started kafka</span></span><br><span class="line">kafka_2.11-1.1.1/bin/kafka-server-start.sh -daemon kafka_2.11-1.1.1/config/server.properties</span><br><span class="line">echo $?</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">config mairadb</span></span><br><span class="line">mysqladmin -uroot password 123456</span><br><span class="line">mysql -uroot -p000000 -e &#x27;create database gpmall;&#x27;</span><br><span class="line">mysql -uroot -p000000 -e &#x27;use gpmall;source gpmall/gpmall.sql;&#x27;</span><br><span class="line">systemctl enable --now mariadb</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">config redis</span></span><br><span class="line">sed -i &#x27;s/bind 127.0.0.1/#bind 127.0.0.1/&#x27; /etc/redis.conf</span><br><span class="line">sed -i &#x27;s/protected-mode yes/protected-mode no/&#x27; /etc/redis.conf</span><br><span class="line">systemctl enable --now redis</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">arrange front</span></span><br><span class="line">rm -rf /usr/share/nginx/html/*</span><br><span class="line">cp -rvf gpmall/dist/* /usr/share/nginx/html/</span><br><span class="line">rm -rf /etc/nginx/conf.d/default.conf</span><br><span class="line">cp -rvf gpmall/default.conf /etc/nginx/conf.d/default.conf</span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">jar jar</span></span><br><span class="line">cd gpmall</span><br><span class="line">nohup java -jar shopping-provider-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 2</span><br><span class="line">nohup java -jar user-provider-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 1</span><br><span class="line">nohup java -jar gpmall-shopping-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 1</span><br><span class="line">nohup java -jar gpmall-user-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#可能kafka和zookeeper起不来重启即可</span></span></span><br></pre></td></tr></table></figure>



<p>1.3.2  Ansible部署FTP服务</p>
<p>编写Ansible脚本，部署FTP服务。</p>
<p>1.3.3  Ansible部署Kafka服务</p>
<p>编写Playbook，部署的ZooKeeper和Kafka。</p>
<p>1.3.4 编写OpenStack容器云平台自动化运维工具。（本任务只公布考试范围，不公布赛题）</p>
<h2 id="模块二-容器云（30分）"><a href="#模块二-容器云（30分）" class="headerlink" title="模块二 容器云（30分）"></a><strong>模块二 容器云（30分）</strong></h2><p>企业构建Kubernetes容器云集群，引入KubeVirt实现OpenStack到Kubernetes的全面转型，用Kubernetes来管一切虚拟化运行时，包含裸金属、VM、容器。同时研发团队决定搭建基于Kubernetes 的CI&#x2F;CD环境，基于这个平台来实现DevOps流程。引入服务网格Istio，实现业务系统的灰度发布，治理和优化公司各种微服务，并开发自动化运维程序。</p>
<h3 id="任务1-容器云服务搭建（5分）"><a href="#任务1-容器云服务搭建（5分）" class="headerlink" title="任务1 容器云服务搭建（5分）"></a><strong>任务1 容器云服务搭建（5分）</strong></h3><p>2.1.1 部署容器云平台</p>
<p>使用OpenStack私有云平台创建两台云主机，分别作为Kubernetes集群的master节点和node节点，然后完成Kubernetes集群的部署，并完成Istio服务网格、KubeVirt虚拟化和Harbor镜像仓库的部署。</p>
<h3 id="任务2-容器云服务运维（15分）"><a href="#任务2-容器云服务运维（15分）" class="headerlink" title="任务2 容器云服务运维（15分）"></a><strong>任务2 容器云服务运维（15分）</strong></h3><p>2.2.1 容器化部署Node-Exporter</p>
<p>编写Dockerfile文件构建exporter镜像，要求基于centos完成Node-Exporter服务的安装与配置，并设置服务开机自启。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将安装包上传到指定目录</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编写Dockerfile文件</span></span><br><span class="line">[root@k8s-master-node1 node-export]# cat Dockerfile</span><br><span class="line">FROM centos:7</span><br><span class="line">WORKDIR /opt</span><br><span class="line">COPY node_exporter-1.3.1.linux-amd64.tar.gz /opt</span><br><span class="line">RUN tar -zxvf node_exporter-1.3.1.linux-amd64.tar.gz -C /opt</span><br><span class="line">EXPOSE 9100</span><br><span class="line">CMD [&quot;/opt/node_exporter-1.3.1.linux-amd64/node_exporter&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.2.2 容器化部署Alertmanager</p>
<p>编写Dockerfile文件构建alert镜像，要求基于centos：latest完成Alertmanager服务的安装与配置，并设置服务开机自启。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将安装包上传到指定目录</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编写Dockerfile文件</span></span><br><span class="line">[root@k8s-master-node1 alertmanager]# cat Dockerfile</span><br><span class="line">FROM centos:7</span><br><span class="line">WORKDIR /opt</span><br><span class="line">COPY alertmanager-0.21.0.linux-amd64.tar.gz /opt</span><br><span class="line">RUN tar -zxvf alertmanager-0.21.0.linux-amd64.tar.gz -C /opt</span><br><span class="line">EXPOSE 9093</span><br><span class="line">CMD [&quot;/opt/alertmanager-0.21.0.linux-amd64/alertmanager&quot;,&quot;--config.file=/opt/alertmanager-0.21.0.linux-amd64/alertmanager.yml&quot;]</span><br></pre></td></tr></table></figure>



<p>2.2.3 容器化部署Grafana</p>
<p>编写Dockerfile文件构建grafana镜像，要求基于centos完成Grafana服务的安装与配置，并设置服务开机自启。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将安装包上传到指定目录 ,若联网则忽略,本实验联网</span></span><br><span class="line">[root@k8s-master-node1 grafana]# cat Dockerfile</span><br><span class="line">FROM centos:7</span><br><span class="line">WORKDIR /opt</span><br><span class="line">COPY grafana-8.1.2-1.x86_64.rpm /opt</span><br><span class="line">RUN yum install -y fontconfig urw-fonts grafana</span><br><span class="line">CMD [&quot;grafana-server&quot;,&quot;--config /etc/sysconfig/grafana-server&quot;,&quot;--homepath /usr/share/grafana&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.2.4 容器化部署Prometheus</p>
<p>编写Dockerfile文件构建prometheus镜像，要求基于centos完成Promethues服务的安装与配置，并设置服务开机自启。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将安装包上传到指定目录</span></span><br><span class="line">[root@k8s-master-node1 prometheus]# cat</span><br><span class="line">Dockerfile                            prometheus-2.37.0.linux-amd64.tar.gz  prometheus.yml</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编写Dockerfile文件</span></span><br><span class="line">Dockerfile  prometheus-2.37.0.linux-amd64.tar.gz  prometheus.yml</span><br><span class="line">[root@k8s-master-node1 prometheus]# cat Dockerfile</span><br><span class="line">FROM centos:7</span><br><span class="line">WORKDIR /opt</span><br><span class="line">COPY prometheus-2.37.0.linux-amd64.tar.gz /opt</span><br><span class="line">RUN tar zxvf prometheus-2.37.0.linux-amd64.tar.gz -C /opt</span><br><span class="line">COPY prometheus.yml /opt/prometheus-2.37.0.linux-amd64/prometheus.yml</span><br><span class="line">EXPOSE 9090</span><br><span class="line">CMD [&quot;/opt/prometheus-2.37.0.linux-amd64/prometheus&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.2.5 编排部署监控系统</p>
<p>编写docker-compose.yaml文件，使用镜像exporter、alert、grafana和prometheus完成监控系统的编排部署。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master-node1 monitor]# cat docker-compose.yml</span><br><span class="line">version: &quot;3&quot;</span><br><span class="line">services:</span><br><span class="line">  prometheus:</span><br><span class="line">    image: prometheus:v1</span><br><span class="line">    ports:</span><br><span class="line">      - 9090:9090</span><br><span class="line">  node_export:</span><br><span class="line">    image: node_exporter:v1</span><br><span class="line">    ports:</span><br><span class="line">      - 9100:9100</span><br><span class="line">    depends_on:</span><br><span class="line">      - prometheus</span><br><span class="line">  grafana:</span><br><span class="line">    image: grafana:v1</span><br><span class="line">    ports:</span><br><span class="line">      - 3000:3000</span><br><span class="line">    depends_on:</span><br><span class="line">      - prometheus</span><br><span class="line">  alertmanager:</span><br><span class="line">    image: 7e39952d313b</span><br><span class="line">    ports:</span><br><span class="line">      - 9103:9103</span><br><span class="line">    depends_on:</span><br><span class="line">      - prometheus</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.2.6 安装Jenkins</p>
<p>将Jenkins部署到default命名空间下。要求完成离线插件的安装，设置Jenkins的登录信息和授权策略。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建serviceAccount,授权角色</span></span><br><span class="line">[root@k8s-master-node1 jenkins]# cat rbac.yml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins</span><br><span class="line">---</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: Role</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins</span><br><span class="line">rules:</span><br><span class="line">- apiGroups:</span><br><span class="line">  - &quot;&quot;</span><br><span class="line">  resources:</span><br><span class="line">  - pods</span><br><span class="line">  - events</span><br><span class="line">  verbs:</span><br><span class="line">  - get</span><br><span class="line">  - list</span><br><span class="line">  - watch</span><br><span class="line">  - create</span><br><span class="line">  - update</span><br><span class="line">  - delete</span><br><span class="line">- apiGroups:</span><br><span class="line">  - &quot;&quot;</span><br><span class="line">  resources:</span><br><span class="line">  - pods/exec</span><br><span class="line">  verbs:</span><br><span class="line">  - get</span><br><span class="line">  - list</span><br><span class="line">  - watch</span><br><span class="line">  - create</span><br><span class="line">  - update</span><br><span class="line">  - delete</span><br><span class="line">- apiGroups:</span><br><span class="line">  - &quot;&quot;</span><br><span class="line">  resources:</span><br><span class="line">  - pods/log</span><br><span class="line">  verbs:</span><br><span class="line">  - get</span><br><span class="line">  - list</span><br><span class="line">  - watch</span><br><span class="line">  - create</span><br><span class="line">  - update</span><br><span class="line">  - delete</span><br><span class="line">- apiGroups:</span><br><span class="line">  - &quot;&quot;</span><br><span class="line">  resources:</span><br><span class="line">  - secrets,events</span><br><span class="line">  verbs:</span><br><span class="line">  - get</span><br><span class="line">---</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: RoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: Role</span><br><span class="line">  name: jenkins</span><br><span class="line">subjects:</span><br><span class="line">- kind: ServiceAccount</span><br><span class="line">  name: jenkins</span><br><span class="line">  namespace: default</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编写deploymen文件</span></span><br><span class="line">[root@k8s-master-node1 jenkins]# cat jenkins-deploy.yaml</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app: jenkins</span><br><span class="line">  name: jenkins</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: jenkins</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: jenkins</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: jenkins</span><br><span class="line">      containers:</span><br><span class="line">      - image: jenkins/jenkins</span><br><span class="line">        name: jenkins</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 8080</span><br><span class="line">        - containerPort: 50000</span><br><span class="line">        env:</span><br><span class="line">        - name: JAVA_OPTS</span><br><span class="line">          value: -Djava.util.logging.config.file=/var/jenkins_home/log.properties</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: jenkins-home</span><br><span class="line">          mountPath: /var/jenkins_home</span><br><span class="line">      volumes:</span><br><span class="line">      - name: jenkins-home</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /var/jenkins_home  ##注意改权限777 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建svc,暴露端口</span></span><br><span class="line">[root@k8s-master-node1 jenkins]# cat jenkins-svc.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app: jenkins</span><br><span class="line">  name: jenkins</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 80</span><br><span class="line">    name: http</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: 8080</span><br><span class="line">  - port: 5000</span><br><span class="line">    name: agent</span><br><span class="line">    protocol: TCP</span><br><span class="line">  selector:</span><br><span class="line">    app: jenkins</span><br><span class="line">  type: NodePort</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>若插件获取失败,可通过修改&#x2F;etc&#x2F;resove.conf 修改后重启jenkins</p>
</blockquote>
<p>2.2.7 安装GitLab</p>
<p>将GitLab部署到default命名空间下，要求设置root用户密码，新建公开项目，并将提供的代码上传到该项目。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">部署deploy文件</span></span><br><span class="line">[root@k8s-master-node1 gitlab]# cat gitlab-deploy.yaml</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app: gitlab</span><br><span class="line">  name: gitlab</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: gitlab</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: gitlab</span><br><span class="line">    spec:</span><br><span class="line">      nodeName: k8s-master-node1</span><br><span class="line">      containers:</span><br><span class="line">      - image: gitlab/gitlab-ce</span><br><span class="line">        name: gitlab</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 80</span><br><span class="line">        - containerPort: 22</span><br><span class="line">        - containerPort: 443</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: gitlab-config</span><br><span class="line">          mountPath: /etc/gitlab</span><br><span class="line">        - name: gitlab-logs</span><br><span class="line">          mountPath: /var/log/gitlab</span><br><span class="line">        - name: gitlab-data</span><br><span class="line">          mountPath: /var/opt/gitlab</span><br><span class="line">      volumes:</span><br><span class="line">      - name: gitlab-config</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /data/gitlab/config</span><br><span class="line">      - name: gitlab-logs</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /data/gitlab/logs</span><br><span class="line">      - name: gitlab-data</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /data/gitlab/data</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">部署svc服务,暴露端口</span></span><br><span class="line">[root@k8s-master-node1 gitlab]# cat gitlab-svc.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: gitlab-svc</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 80</span><br><span class="line">    targetPort: 80</span><br><span class="line">    nodePort: 30001</span><br><span class="line">  selector:</span><br><span class="line">    app: gitlab</span><br><span class="line">  type: NodePort</span><br><span class="line">  </span><br><span class="line">  </span><br></pre></td></tr></table></figure>



<p>2.2.8 配置Jenkins连接GitLab</p>
<p>在Jenkins中新建流水线任务，配置GitLab连接Jenkins，并完成WebHook的配置。</p>
<p>2.2.9 构建CI&#x2F;CD</p>
<p>在流水线任务中编写流水线脚本，完成后触发构建，要求基于GitLab中的项目自动完成代码编译、镜像构建与推送、并自动发布服务到Kubernetes集群中。</p>
<p>2.2.10 服务网格：创建Ingress Gateway</p>
<p>将Bookinfo应用部署到default命名空间下，请为Bookinfo应用创建一个网关，使外部可以访问Bookinfo应用。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进行istio注入</span></span><br><span class="line">kubectl label namespace default istio-injection=enabled</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Bookinfo部署</span></span><br><span class="line">[root@k8s-master-node1 istio-1.13.4]# cat samples/bookinfo/platform/kube/bookinfo.yaml</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Copyright Istio Authors</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#   Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  you may not use this file except <span class="keyword">in</span> compliance with the License.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  You may obtain a copy of the License at</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#       http://www.apache.org/licenses/LICENSE-2.0</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#   Unless required by applicable law or agreed to in writing, software</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  distributed under the License is distributed on an <span class="string">&quot;AS IS&quot;</span> BASIS,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  See the License <span class="keyword">for</span> the specific language governing permissions and</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  limitations under the License.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This file defines the services, service accounts, and deployments <span class="keyword">for</span> the Bookinfo sample.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># To apply all 4 Bookinfo services, their corresponding service accounts, and deployments:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#   kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Alternatively, you can deploy any resource separately:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#   kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml -l service=reviews # reviews Service</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml -l account=reviews <span class="comment"># reviews ServiceAccount</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml -l app=reviews,version=v3 <span class="comment"># reviews-v3 Deployment</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Details service</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: details</span><br><span class="line">  labels:</span><br><span class="line">    app: details</span><br><span class="line">    service: details</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 9080</span><br><span class="line">    name: http</span><br><span class="line">  selector:</span><br><span class="line">    app: details</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: bookinfo-details</span><br><span class="line">  labels:</span><br><span class="line">    account: details</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: details-v1</span><br><span class="line">  labels:</span><br><span class="line">    app: details</span><br><span class="line">    version: v1</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: details</span><br><span class="line">      version: v1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: details</span><br><span class="line">        version: v1</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: bookinfo-details</span><br><span class="line">      containers:</span><br><span class="line">      - name: details</span><br><span class="line">        image: docker.io/istio/examples-bookinfo-details-v1:1.16.2</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 9080</span><br><span class="line">        securityContext:</span><br><span class="line">          runAsUser: 1000</span><br><span class="line">---</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ratings service</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: ratings</span><br><span class="line">  labels:</span><br><span class="line">    app: ratings</span><br><span class="line">    service: ratings</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 9080</span><br><span class="line">    name: http</span><br><span class="line">  selector:</span><br><span class="line">    app: ratings</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: bookinfo-ratings</span><br><span class="line">  labels:</span><br><span class="line">    account: ratings</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: ratings-v1</span><br><span class="line">  labels:</span><br><span class="line">    app: ratings</span><br><span class="line">    version: v1</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: ratings</span><br><span class="line">      version: v1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: ratings</span><br><span class="line">        version: v1</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: bookinfo-ratings</span><br><span class="line">      containers:</span><br><span class="line">      - name: ratings</span><br><span class="line">        image: docker.io/istio/examples-bookinfo-ratings-v1:1.16.2</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 9080</span><br><span class="line">        securityContext:</span><br><span class="line">          runAsUser: 1000</span><br><span class="line">---</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Reviews service</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: reviews</span><br><span class="line">  labels:</span><br><span class="line">    app: reviews</span><br><span class="line">    service: reviews</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 9080</span><br><span class="line">    name: http</span><br><span class="line">  selector:</span><br><span class="line">    app: reviews</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: bookinfo-reviews</span><br><span class="line">  labels:</span><br><span class="line">    account: reviews</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: reviews-v1</span><br><span class="line">  labels:</span><br><span class="line">    app: reviews</span><br><span class="line">    version: v1</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: reviews</span><br><span class="line">      version: v1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: reviews</span><br><span class="line">        version: v1</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: bookinfo-reviews</span><br><span class="line">      containers:</span><br><span class="line">      - name: reviews</span><br><span class="line">        image: docker.io/istio/examples-bookinfo-reviews-v1:1.16.2</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        env:</span><br><span class="line">        - name: LOG_DIR</span><br><span class="line">          value: &quot;/tmp/logs&quot;</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 9080</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: tmp</span><br><span class="line">          mountPath: /tmp</span><br><span class="line">        - name: wlp-output</span><br><span class="line">          mountPath: /opt/ibm/wlp/output</span><br><span class="line">        securityContext:</span><br><span class="line">          runAsUser: 1000</span><br><span class="line">      volumes:</span><br><span class="line">      - name: wlp-output</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">      - name: tmp</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: reviews-v2</span><br><span class="line">  labels:</span><br><span class="line">    app: reviews</span><br><span class="line">    version: v2</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: reviews</span><br><span class="line">      version: v2</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: reviews</span><br><span class="line">        version: v2</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: bookinfo-reviews</span><br><span class="line">      containers:</span><br><span class="line">      - name: reviews</span><br><span class="line">        image: docker.io/istio/examples-bookinfo-reviews-v2:1.16.2</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        env:</span><br><span class="line">        - name: LOG_DIR</span><br><span class="line">          value: &quot;/tmp/logs&quot;</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 9080</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: tmp</span><br><span class="line">          mountPath: /tmp</span><br><span class="line">        - name: wlp-output</span><br><span class="line">          mountPath: /opt/ibm/wlp/output</span><br><span class="line">        securityContext:</span><br><span class="line">          runAsUser: 1000</span><br><span class="line">      volumes:</span><br><span class="line">      - name: wlp-output</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">      - name: tmp</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: reviews-v3</span><br><span class="line">  labels:</span><br><span class="line">    app: reviews</span><br><span class="line">    version: v3</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: reviews</span><br><span class="line">      version: v3</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: reviews</span><br><span class="line">        version: v3</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: bookinfo-reviews</span><br><span class="line">      containers:</span><br><span class="line">      - name: reviews</span><br><span class="line">        image: docker.io/istio/examples-bookinfo-reviews-v3:1.16.2</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        env:</span><br><span class="line">        - name: LOG_DIR</span><br><span class="line">          value: &quot;/tmp/logs&quot;</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 9080</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: tmp</span><br><span class="line">          mountPath: /tmp</span><br><span class="line">        - name: wlp-output</span><br><span class="line">          mountPath: /opt/ibm/wlp/output</span><br><span class="line">        securityContext:</span><br><span class="line">          runAsUser: 1000</span><br><span class="line">      volumes:</span><br><span class="line">      - name: wlp-output</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">      - name: tmp</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">---</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Productpage services</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#################################################################################################</span></span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: productpage</span><br><span class="line">  labels:</span><br><span class="line">    app: productpage</span><br><span class="line">    service: productpage</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - port: 9080</span><br><span class="line">    name: http</span><br><span class="line">  selector:</span><br><span class="line">    app: productpage</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: bookinfo-productpage</span><br><span class="line">  labels:</span><br><span class="line">    account: productpage</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: productpage-v1</span><br><span class="line">  labels:</span><br><span class="line">    app: productpage</span><br><span class="line">    version: v1</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: productpage</span><br><span class="line">      version: v1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: productpage</span><br><span class="line">        version: v1</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: bookinfo-productpage</span><br><span class="line">      containers:</span><br><span class="line">      - name: productpage</span><br><span class="line">        image: docker.io/istio/examples-bookinfo-productpage-v1:1.16.2</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 9080</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: tmp</span><br><span class="line">          mountPath: /tmp</span><br><span class="line">        securityContext:</span><br><span class="line">          runAsUser: 1000</span><br><span class="line">      volumes:</span><br><span class="line">      - name: tmp</span><br><span class="line">        emptyDir: &#123;&#125;</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">部署svc</span><br><span class="line">[root@k8s-master-node1 networking]# cat bookinfo-gateway.yaml</span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: Gateway</span><br><span class="line">metadata:</span><br><span class="line">  name: bookinfo-gateway</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    istio: ingressgateway # use istio default controller</span><br><span class="line">  servers:</span><br><span class="line">  - port:</span><br><span class="line">      number: 80</span><br><span class="line">      name: http</span><br><span class="line">      protocol: HTTP</span><br><span class="line">    hosts:</span><br><span class="line">    - &quot;*&quot;</span><br><span class="line">---</span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">  name: bookinfo</span><br><span class="line">spec:</span><br><span class="line">  hosts:</span><br><span class="line">  - &quot;*&quot;</span><br><span class="line">  gateways:</span><br><span class="line">  - bookinfo-gateway</span><br><span class="line">  http:</span><br><span class="line">  - match:</span><br><span class="line">    - uri:</span><br><span class="line">        exact: /productpage</span><br><span class="line">    - uri:</span><br><span class="line">        prefix: /static</span><br><span class="line">    - uri:</span><br><span class="line">        exact: /login</span><br><span class="line">    - uri:</span><br><span class="line">        exact: /logout</span><br><span class="line">    - uri:</span><br><span class="line">        prefix: /api/v1/products</span><br><span class="line">    route:</span><br><span class="line">    - destination:</span><br><span class="line">        host: productpage</span><br><span class="line">        port:</span><br><span class="line">          number: 9080</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2.2.11 KubeVirt运维：创建VM</p>
<p>使用提供的镜像在default命名空间下创建一台VM，名称为exam，指定VM的内存、CPU、网卡和磁盘等配置。</p>
<blockquote>
<p>在使用vmware虚拟机时,需要开启vmware虚拟化</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">服务启动完成后启动这个命令</span></span><br><span class="line">[root@master ~]# kubectl -n kubevirt wait kv kubevirt --for condition=Available</span><br><span class="line">kubevirt.kubevirt.io/kubevirt condition met</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@k8s-master-node1 vm]# cat virtual.yaml</span><br><span class="line">apiVersion: kubevirt.io/v1</span><br><span class="line">kind: VirtualMachine</span><br><span class="line">metadata:</span><br><span class="line">  name: exam</span><br><span class="line">spec:</span><br><span class="line">  running: false</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        kubevirt.io/size: small</span><br><span class="line">        kubevirt.io/domain: exam</span><br><span class="line">    spec:</span><br><span class="line">      domain:</span><br><span class="line">        devices:</span><br><span class="line">          disks:</span><br><span class="line">            - name: containerdisk</span><br><span class="line">              disk:</span><br><span class="line">                bus: virtio</span><br><span class="line">            - name: cloudinitdisk</span><br><span class="line">              disk:</span><br><span class="line">                bus: virtio</span><br><span class="line">          interfaces:</span><br><span class="line">          - name: default</span><br><span class="line">            masquerade: &#123;&#125;</span><br><span class="line">        resources:</span><br><span class="line">          requests:</span><br><span class="line">            memory: 64M</span><br><span class="line">      networks:</span><br><span class="line">      - name: default</span><br><span class="line">        pod: &#123;&#125;</span><br><span class="line">      volumes:</span><br><span class="line">        - name: containerdisk</span><br><span class="line">          containerDisk:</span><br><span class="line">            image: quay.io/kubevirt/cirros-container-disk-demo</span><br><span class="line">        - name: cloudinitdisk</span><br><span class="line">          cloudInitNoCloud:</span><br><span class="line">            userDataBase64: SGkuXG4=</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@master kubevirt]# kubectl apply -f virtual.yaml</span><br><span class="line">virtualmachine.kubevirt.io/exam created</span><br><span class="line"></span><br><span class="line">[root@master kubevirt]# kubectl get vm</span><br><span class="line">NAME        AGE   VOLUME</span><br><span class="line">exam	   21m</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用方法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动实例</span></span><br><span class="line">[root@master kubevirt]# virtctl start exam</span><br><span class="line">VM exam was scheduled to start</span><br><span class="line"></span><br><span class="line">[root@master kubevirt]# kubectl get vmi</span><br><span class="line">NAME        AGE   PHASE     IP            NODENAME</span><br><span class="line">exam   62s   Running   10.244.0.15   master</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入虚拟机</span></span><br><span class="line">[root@master kubevirt]# virtctl console exam </span><br><span class="line">Successfully connected to vm-cirros console. The escape sequence is ^]</span><br><span class="line"></span><br><span class="line">login as &#x27;cirros&#x27; user. default password: &#x27;gocubsgo&#x27;. use &#x27;sudo&#x27; for root.</span><br><span class="line">vm-cirros login: cirros</span><br><span class="line">Password:</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1450 qdisc pfifo_fast qlen 1000</span><br><span class="line">    link/ether 2e:3e:2a:46:29:94 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.244.0.16/24 brd 10.244.0.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::2c3e:2aff:fe46:2994/64 scope link tentative flags 08</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">       </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">   <span class="comment">#  按 ctrl+]  退出虚拟机</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动和停止命令</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Start the virtual machine:  启动虚拟机</span></span></span><br><span class="line">virtctl start vm   </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Stop the virtual machine:  停止虚拟机</span></span></span><br><span class="line">virtctl stop vm</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">vm作为服务公开 VirtualMachine可以作为服务公开。实际服务将在 VirtualMachineInstance 启动后可用。</span></span><br><span class="line">[root@master kubevirt]# virtctl expose virtualmachine  exam --name vmiservice-node  --target-port 22  --port 24 --type NodePort</span><br><span class="line">Service vmiservice-node successfully exposed for virtualmachine vm-cirros</span><br><span class="line">[root@master kubevirt]# kubectl get svc</span><br><span class="line">NAME              TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE</span><br><span class="line">kubernetes        ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP        95d</span><br><span class="line">vmiservice-node   NodePort    10.106.62.191   &lt;none&gt;        24:31912/TCP   3s</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>2.2.12 完成容器云平台的调优或排错工作。（本任务只公布考试范围，不公布赛题）</p>
<h3 id="任务3-容器云运维开发（10分）"><a href="#任务3-容器云运维开发（10分）" class="headerlink" title="任务3 容器云运维开发（10分）"></a>任务3 容器云运维开发（10分）</h3><p>2.3.1 管理job服务</p>
<p>Kubernetes Python运维脚本开发-使用SDK方式管理job服务。</p>
<p>2.3.2 自定义调度器</p>
<p>Kubernetes Python运维脚本开发-使用Restful API方式管理调度器。</p>
<p>2.3.3 编写Kubernetes容器云平台自动化运维工具。（本任务只公布考试范围，不公布赛题）</p>
<h2 id="模块三-公有云（40分）"><a href="#模块三-公有云（40分）" class="headerlink" title="模块三 公有云（40分）"></a>模块三 公有云（40分）</h2><p>企业选择国内公有云提供商，选择云主机、云网络、云硬盘、云防火墙、负载均衡等服务，可创建Web服务，共享文件存储服务，数据库服务，数据库集群等服务。搭建基于云原生的DevOps相关服务，构建云、边、端一体化的边缘计算系统，并开发云应用程序。</p>
<p>根据上述公有云平台的特性，完成公有云中的各项运维工作。</p>
<h3 id="任务1-公有云服务搭建（5分）"><a href="#任务1-公有云服务搭建（5分）" class="headerlink" title="*任务1 公有云服务搭建（5分）*"></a><em><strong>*任务1 公有云服务搭建（5分）*</strong></em></h3><p>3.1.1 私有网络管理</p>
<p>在公有云中完成虚拟私有云网络的创建。</p>
<p>3.1.2 云实例管理</p>
<p>登录公有云平台，创建两台云实例虚拟机。</p>
<p>3.1.3 管理数据库</p>
<p>使用intnetX-mysql网络创建两台chinaskill-sql-1和chinaskill-sql-2云服务器，并完成MongoDB安装。</p>
<p>3.1.4 主从数据库</p>
<p>在chinaskill-sql-1和chinaskill-sql-2云服务器中配置MongoDB主从数据库。</p>
<p>3.1.5 node环境管理</p>
<p>使用提供的压缩文件，安装Node.js环境。</p>
<p>3.1.6 安全组管理</p>
<p>根据要求，创建一个安全组。</p>
<p>3.1.7 RocketChat上云</p>
<p>使用http服务器提供文件，将Rocket.Chat应用部署上云。</p>
<p>3.1.8 NAT网关</p>
<p>根据要求创建一个公网NAT网关。</p>
<p>3.1.9云服务器备份</p>
<p>创建一个云服务器备份存储库名为server_backup，容量为100G。将ChinaSkill-node-1云服务器制作镜像文件chinaskill-image。</p>
<p>3.1.10 负载均衡器</p>
<p>根据要求创建一个负载均衡器chinaskill-elb。</p>
<p>3.1.11 弹性伸缩管理</p>
<p>根据要求新建一个弹性伸缩启动配置。</p>
<h3 id="任务2-公有云服务运维（10分）"><a href="#任务2-公有云服务运维（10分）" class="headerlink" title="*任务2 公有云服务运维（10分）*"></a><em><strong>*任务2 公有云服务运维（10分）*</strong></em></h3><p>3.2.1 云容器引擎</p>
<p>在公有云上，按照要求创建一个x86架构的容器云集群。</p>
<p>3.2.2 云容器管理</p>
<p>使用插件管理在kcloud容器集群中安装Dashboard可视化监控界面。</p>
<p>3.2.3 使用kubectl操作集群</p>
<p>在kcloud集群中安装kubectl命令，使用kubectl命令管理kcloud集群。</p>
<p>3.2.4 安装Helm</p>
<p>使用提供的Helm软件包，在kcloud集群中安装Helm服务。</p>
<p>3.2.5 根据提供的chart包mariadb-7.3.14.tgz部署mariadb服务，修改mariadb使用NodePort模式对其进行访问。</p>
<p>3.2.6 在k8s集群中创建mariadb命名空间，根据提供的chart包mariadb-7.3.14.tgz修改其配置，使用NodePort模式对其进行访问。</p>
<h3 id="任务3-公有云运维开发（10分）"><a href="#任务3-公有云运维开发（10分）" class="headerlink" title="任务3 公有云运维开发（10分）"></a><strong>任务3 公有云运维开发（10分）</strong></h3><p>3.3.1 开发环境搭建</p>
<p>创建一台云主机，并登录此云服务器，安装Python3.68运行环境与SDK依赖库。</p>
<p>3.3.2 安全组管理</p>
<p>调用api安全组的接口，实现安全组的增删查改。</p>
<p>3.3.3 安全组规则管理</p>
<p>调用SDK安全组规则的方法，实现安全组规则的增删查改。</p>
<p>3.3.4 云主机管理</p>
<p>调用SDK云主机管理的方法，实现云主机的的增删查改。</p>
<p>3.3.5 完成公有云平台自动化运维程序开发。（本任务只公布考试范围，不公布赛题）</p>
<h3 id="任务4-边缘计算系统运维（10分）"><a href="#任务4-边缘计算系统运维（10分）" class="headerlink" title="*任务4 边缘计算系统运维（10分）*"></a><em><strong>*任务4 边缘计算系统运维（10分）*</strong></em></h3><p>3.4.1 云端部署</p>
<p>构建Kubernetes容器云平台，云端部署KubeEdge CloudCore云测模块，并启动cloudcore服务。</p>
<p>3.4.2 边端部署</p>
<p>在边侧部署KubeEdge EdgeCore边侧模块，并启动edgecore服务。</p>
<p>3.4.3 边缘应用部署</p>
<p>通过边缘计算平台完成应用场景镜像部署与调试。（本任务只公布考试范围，不公布赛题）</p>
<h3 id="任务5-边缘计算云应用开发（5分）"><a href="#任务5-边缘计算云应用开发（5分）" class="headerlink" title="*任务5 边缘计算云应用开发（5分）*"></a><em><strong>*任务5 边缘计算云应用开发（5分）*</strong></em></h3><p>3.5.1 对接边缘计算系统，完成云应用微服务开发。（本任务只公布考试范围，不公布赛题） </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz">GoldY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz/posts/cc6b9ff2.html">https://www.geekgold.xyz/posts/cc6b9ff2.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.geekgold.xyz" target="_blank">GoldY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/">云计算职业技能大赛</a></div><div class="post-share"><div class="social-share" data-image="/img/cloud-com.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src="/img/zhifubao.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/840d388d.html" title="云计算方向-2023年金砖大赛山东选拔题"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">云计算方向-2023年金砖大赛山东选拔题</div></div><div class="info-2"><div class="info-item-1">A场次题目：OpenStack平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化，弹性分配，集中管理，性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：    设备名称 主机名 接口 ip地址    云服务器1 controller eth0，eth1 私网：192.168.100.10&#x2F;24           私网：192.168.200.10&#x2F;24   云服务器2 compute eth0，eth1 私网：192.168.100.20&#x2F;24        ...</div></div></div></a><a class="pagination-related" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">云计算方向-2023年金砖大赛</div></div><div class="info-2"><div class="info-item-1">A模块题目：OpenStack 平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化、弹性分配、集中管理、性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表： 表1 IP地址规划    设备名称 主机名 接口 IP地址    云服务器1 controller eth0 公网IP: 私网IP:192.168.100.&#x2F;24     eth1 私网IP:192.168.200. *&#x2F;24   云服务器2 compute eth0 公网IP: 私网IP:192.168.100. *&#x2F;24     eth1 私网IP:192.168.200....</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/6bf8b7d7.html" title="云计算方向-2022年云计算职业技能大赛国赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算职业技能大赛国赛题</div></div><div class="info-2"><div class="info-item-1">第一套【任务 1】私有云服务搭建[10分]【题目 1】基础环境配置[0.5 分]使用提供的用户名密码，登录提供的 OpenStack 私有云平台，在当前租户下，使用CentOS7.9 镜像，创建两台云主机，云主机类型使用 4vCPU&#x2F;12G&#x2F;100G_50G 类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至 controller 和 compute 节点（第二张网卡的网段为 10.10.X.0&#x2F;24，X 为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与 ssh 连接，然后按以下要求配置服务器： （1）设置控制节点主机名为 controller，设置计算节点主机名为 compute；  （2）修改 hosts 文件将 IP 地址映射为主机名； 1231.查看控制节点名字为 controller 正确计 0.2 分2.查看 hosts 文件中有正确的主机名和 IP 映射计 0.2 分3.控制节点正确使用两块网卡计 0.1...</div></div></div></a><a class="pagination-related" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</div></div><div class="info-2"><div class="info-item-1">A场次题目：Openstack 平台部署与运维任务1 私有云平台环境初始化1.初始化操作系统 使用提供的用户名密码，登录竞赛云平台。根据表 1 中的 IP 地址规划，设置各服务器节点的 IP 地址，确保网络正常通信，设置控制节点主机名为 Contro ller，计算节点主机名为 Compute，并修改 hosts 文件将 IP 地址映射为主机名， 关闭防火墙并设置为开机不启动，设置 SELinux 为 Permissive 模式并设置永久 关闭。请查看控制节点和计算节点主机名，使用命令查看 SELinux 状态，使用 head 命令、tail 命令和 cut 命令提取出永久关闭 SELinux 的关键信息。 将以上命令及返回结果提交到答题框  配置host 123456vi /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6...</div></div></div></a><a class="pagination-related" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-Ansible搭建wordpress</div></div><div class="info-2"><div class="info-item-1">一.ansible搭建wordpress基于lamp构建wordpress    master 192.168.200.100 控制节点    node1 192.168.200.101 web服务器   node2 192.168.200.102 mysql服务器   vi &#x2F;etc&#x2F;ansible&#x2F;host 12345678[master]master[web]192.168.200.101node1[database]192.168.200.102node2  vi wordpress.yaml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354---# hosts: 后面可写主机组名或主机名- hosts: all  remote_user: root  # 定义变量  vars:    db_pkgs:      # 以下的-为变量“值”，也就是在引用db_pkgs变量时，可取变量中的值   ...</div></div></div></a><a class="pagination-related" href="/posts/840d388d.html" title="云计算方向-2023年金砖大赛山东选拔题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖大赛山东选拔题</div></div><div class="info-2"><div class="info-item-1">A场次题目：OpenStack平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化，弹性分配，集中管理，性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：    设备名称 主机名 接口 ip地址    云服务器1 controller eth0，eth1 私网：192.168.100.10&#x2F;24           私网：192.168.200.10&#x2F;24   云服务器2 compute eth0，eth1 私网：192.168.100.20&#x2F;24        ...</div></div></div></a><a class="pagination-related" href="/posts/c134dd26.html" title="云计算方向-2022年云计算技能大赛样题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算技能大赛样题</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/2c8237f4.html" title="云计算方向-2022年云计算技能国赛私有云套题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算技能国赛私有云套题</div></div><div class="info-2"><div class="info-item-1">第一套私有云运维任务：题目3. OpenStack云平台运维（10分）1.使用提供的云安全框架组件，将提供的OpenStack云平台的安全策略从http优化至https。可能会遇到 mod_ssl 安装不成功的问题，原因是mod_ssl版本不匹配，上传mod_ssl-2.4.6-97.el7.centos.x86_64.rpm ①安装工具包 1yum install -y mod_wsgi httpd mod_ssl  ②修改&#x2F;etc&#x2F;openstack-dashboard&#x2F;local_settings文件 123456vi /etc/openstack-dashboard/local_settings##在DEBUG = False下增加4行USE_SSL = TrueCSRF_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_HTTPONLY =...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">GoldY</div><div class="author-info-description">不经一番寒彻骨，怎得梅花扑鼻香。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuwenjin666"><i class="fab fa-github"></i><span>Github主页</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">联系我V：GoldY_66</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%B8%80-%E7%A7%81%E6%9C%89%E4%BA%91%EF%BC%8830%E5%88%86%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">模块一 私有云（30分）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A11-%E7%A7%81%E6%9C%89%E4%BA%91%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%EF%BC%885%E5%88%86%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">任务1 私有云服务搭建（5分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 基础环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-%E7%A7%81%E6%9C%89%E4%BA%91%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4%EF%BC%8815%E5%88%86"><span class="toc-number">1.1.2.</span> <span class="toc-text">任务2 私有云服务运维（15分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-%E7%A7%81%E6%9C%89%E4%BA%91%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%8810%E5%88%86%EF%BC%89"><span class="toc-number">1.1.3.</span> <span class="toc-text">*任务3 私有云运维开发（10分）*</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%BA%8C-%E5%AE%B9%E5%99%A8%E4%BA%91%EF%BC%8830%E5%88%86%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">模块二 容器云（30分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A11-%E5%AE%B9%E5%99%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%EF%BC%885%E5%88%86%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">任务1 容器云服务搭建（5分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-%E5%AE%B9%E5%99%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4%EF%BC%8815%E5%88%86%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">任务2 容器云服务运维（15分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-%E5%AE%B9%E5%99%A8%E4%BA%91%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%8810%E5%88%86%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">任务3 容器云运维开发（10分）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%B8%89-%E5%85%AC%E6%9C%89%E4%BA%91%EF%BC%8840%E5%88%86%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">模块三 公有云（40分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A11-%E5%85%AC%E6%9C%89%E4%BA%91%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%EF%BC%885%E5%88%86%EF%BC%89"><span class="toc-number">1.3.1.</span> <span class="toc-text">*任务1 公有云服务搭建（5分）*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-%E5%85%AC%E6%9C%89%E4%BA%91%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4%EF%BC%8810%E5%88%86%EF%BC%89"><span class="toc-number">1.3.2.</span> <span class="toc-text">*任务2 公有云服务运维（10分）*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A13-%E5%85%AC%E6%9C%89%E4%BA%91%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%8810%E5%88%86%EF%BC%89"><span class="toc-number">1.3.3.</span> <span class="toc-text">任务3 公有云运维开发（10分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A14-%E8%BE%B9%E7%BC%98%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4%EF%BC%8810%E5%88%86%EF%BC%89"><span class="toc-number">1.3.4.</span> <span class="toc-text">*任务4 边缘计算系统运维（10分）*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A15-%E8%BE%B9%E7%BC%98%E8%AE%A1%E7%AE%97%E4%BA%91%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%EF%BC%885%E5%88%86%EF%BC%89"><span class="toc-number">1.3.5.</span> <span class="toc-text">*任务5 边缘计算云应用开发（5分）*</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1288cce5.html" title="小迪安全--安全开发下篇(4)"><img src="/img/xiao_f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小迪安全--安全开发下篇(4)"/></a><div class="content"><a class="title" href="/posts/1288cce5.html" title="小迪安全--安全开发下篇(4)">小迪安全--安全开发下篇(4)</a><time datetime="2025-06-12T13:17:11.319Z" title="发表于 2025-06-12 21:17:11">2025-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b4ffc751.html" title="小迪安全--安全开发上篇(3)"><img src="/img/xiao_f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小迪安全--安全开发上篇(3)"/></a><div class="content"><a class="title" href="/posts/b4ffc751.html" title="小迪安全--安全开发上篇(3)">小迪安全--安全开发上篇(3)</a><time datetime="2025-06-12T13:08:57.606Z" title="发表于 2025-06-12 21:08:57">2025-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dba72746.html" title="小迪安全--信息打点(2)"><img src="/img/xiao_f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小迪安全--信息打点(2)"/></a><div class="content"><a class="title" href="/posts/dba72746.html" title="小迪安全--信息打点(2)">小迪安全--信息打点(2)</a><time datetime="2025-05-18T02:57:49.848Z" title="发表于 2025-05-18 10:57:49">2025-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-Ansible搭建wordpress"/></a><div class="content"><a class="title" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress">云计算方向-Ansible搭建wordpress</a><time datetime="2025-05-14T02:48:38.000Z" title="发表于 2025-05-14 10:48:38">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"/></a><div class="content"><a class="title" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</a><time datetime="2025-05-14T02:48:37.000Z" title="发表于 2025-05-14 10:48:37">2025-05-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/bottom-bg.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2025 By GoldY</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=yuwenjin666";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="yuwenjin666";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>