<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>云计算方向-2022年全国职业院校技能大赛容器云 | GoldY</title><meta name="author" content="GoldY"><meta name="copyright" content="GoldY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2022 年全国职业院校技能大赛容器云">
<meta property="og:type" content="article">
<meta property="og:title" content="云计算方向-2022年全国职业院校技能大赛容器云">
<meta property="og:url" content="https://www.geekgold.xyz/posts/9bf3df10.html">
<meta property="og:site_name" content="GoldY">
<meta property="og:description" content="2022 年全国职业院校技能大赛容器云">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.geekgold.xyz/img/cloud-com.jpg">
<meta property="article:published_time" content="2025-05-14T02:47:32.000Z">
<meta property="article:modified_time" content="2025-05-14T03:16:03.866Z">
<meta property="article:author" content="GoldY">
<meta property="article:tag" content="云计算">
<meta property="article:tag" content="云计算职业技能大赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.geekgold.xyz/img/cloud-com.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "云计算方向-2022年全国职业院校技能大赛容器云",
  "url": "https://www.geekgold.xyz/posts/9bf3df10.html",
  "image": "https://www.geekgold.xyz/img/cloud-com.jpg",
  "datePublished": "2025-05-14T02:47:32.000Z",
  "dateModified": "2025-05-14T03:16:03.866Z",
  "author": [
    {
      "@type": "Person",
      "name": "GoldY",
      "url": "https://www.geekgold.xyz/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.geekgold.xyz/posts/9bf3df10.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="bing-site-verification" content="E05CD8D6921B8F2AA32324DF2B267557"/><meta name="baidu-site-verification" content="codeva-tCktTl1n17"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '云计算方向-2022年全国职业院校技能大赛容器云',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cloud-com.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.png" alt="Logo"><span class="site-name">GoldY</span></a><a class="nav-page-title" href="/"><span class="site-name">云计算方向-2022年全国职业院校技能大赛容器云</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">云计算方向-2022年全国职业院校技能大赛容器云</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-14T02:47:32.000Z" title="发表于 2025-05-14 10:47:32">2025-05-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-14T03:16:03.866Z" title="更新于 2025-05-14 11:16:03">2025-05-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E6%B1%87%E6%80%BB/">技能大赛汇总</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="【任务-1】容器云平台搭建-5-分"><a href="#【任务-1】容器云平台搭建-5-分" class="headerlink" title="【任务 1】容器云平台搭建[5 分]"></a>【任务 1】容器云平台搭建[5 分]</h2><p><img src="https://img-blog.csdnimg.cn/7f7156ba530246dc8e3dee2963642f03.png" alt="在这里插入图片描述"></p>
<h3 id="【题目-1】平台部署–部署容器云平台-1-5-分"><a href="#【题目-1】平台部署–部署容器云平台-1-5-分" class="headerlink" title="【题目 1】平台部署–部署容器云平台[1.5 分]"></a>【题目 1】平台部署–部署容器云平台[1.5 分]</h3><p>登录OpenStack 私有云平台，使用 CentOS7.9 镜像创建两台云主机，使用 kubeeasy 工具完成Kubernetes 1.22.1 集群的搭建。然后使用 nginx 镜像在 default 命名空间下创建一个名为exam 的Pod，并为该 Pod 设置环境变量 exam，其值为 2022。<br>完成后提交 master 节点的用户名、密码和 IP 到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#两台节点，将提供的安装包 chinaskills_cloud_paas_v2.0.2.iso 上传至 master 节点/root 目录，并解压 到/opt 目录</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># mount -o loop chinaskills_cloud_paas_v2.0.2.iso /mnt/ </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># cp -rfv /mnt/* /opt/ </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># umount /mnt/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#安装 kubeeasy已经依赖</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># mv /opt/kubeeasy /usr/bin/kubeeasy</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># kubeeasy install depend \ --host 10.24.2.10,10.24.2.11 \ --user root \ --password 000000 \ --offline-file /opt/dependencies/base-rpms.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="literal">--host</span>：所有主机节点 IP，如：<span class="number">10.24</span>.<span class="number">1.2</span><span class="literal">-10</span>.<span class="number">24.1</span>.<span class="number">10</span>，中间用“-”隔开，表示 <span class="number">10.24</span>.<span class="number">1.2</span> 到 <span class="number">10.24</span>.<span class="number">1.10</span> 范围内的所有 IP。若 IP 地址不连续，则列出所有节点 IP，用逗号隔开，如： <span class="number">10.24</span>.<span class="number">1.2</span>,<span class="number">10.24</span>.<span class="number">1.7</span>,<span class="number">10.24</span>.<span class="number">1.9</span>。 </span><br><span class="line"><span class="literal">--user</span>：主机登录用户，默认为 root。 </span><br><span class="line"><span class="literal">--password</span>：主机登录密码，所有节点需保持密码一致。 </span><br><span class="line"><span class="literal">--offline-file</span>：离线安装包路径。</span><br><span class="line"></span><br><span class="line"><span class="comment">#配置 SSH 免密钥</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># kubeeasy create ssh-keygen \ --master 10.24.2.10 \ --worker 10.24.2.11 \ --user root --password 000000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#部署 Kubernetes 集群</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">localhost</span> ~]<span class="comment"># kubeeasy install kubernetes \ --master 10.24.2.10 \ --worker 10.24.2.11 \ --user root \ --password 000000 \ --version 1.22.1 \ --offline-file /opt/kubernetes.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看集群信息</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubectl cluster-info </span></span><br><span class="line">Kubernetes control plane is running at https://apiserver.cluster.local:<span class="number">6443</span> CoreDNS is running at https://apiserver.cluster.local:<span class="number">6443</span>/api/v1/namespaces/kube<span class="literal">-system</span>/services/kube<span class="literal">-dns</span>:dns/proxy To further debug and diagnose cluster problems, use <span class="string">&#x27;kubectl cluster-info dump&#x27;</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数解释</span></span><br><span class="line"><span class="literal">--master</span>：Master 节点 IP。 </span><br><span class="line"><span class="literal">--worker</span>：Node 节点 IP，如有多个 Node 节点用逗号隔开。 </span><br><span class="line"><span class="literal">--version</span>：Kubernetes 版本，此处只能为 <span class="number">1.22</span>.<span class="number">1</span>。</span><br></pre></td></tr></table></figure>

<p>1.Kubernetes 集群部署成功得 1 分；<br>2.Pod 创建成功且环境变量设置正确得 0.5 分。</p>
<h3 id="【题目-2】平台部署–部署-Istio-服务网格-0-5-分"><a href="#【题目-2】平台部署–部署-Istio-服务网格-0-5-分" class="headerlink" title="【题目 2】平台部署–部署 Istio 服务网格[0.5 分]"></a>【题目 2】平台部署–部署 Istio 服务网格[0.5 分]</h3><p>1.Kubernetes 集群部署成功得 1 分；<br>2.Pod 创建成功且环境变量设置正确得 0.5 分。</p>
<p>在 Kubernetes 集群上完成 Istio 服务网格环境的安装，然后新建命名空间 exam，为该命名空间开启自动注入 Sidecar。<br>完成后提交 master 节点的用户名、密码和 IP 到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubeeasy add --istio istio</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#https://blog.csdn.net/shida_csdn/article/details/90713235</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubectl create ns exam</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubectl label namespace exam istio-injection=enabled</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.Istio 所有组件运行成功得 0.3 分；<br>2.命名空间 exam 自动注入成功得 0.2 分。</p>
<h3 id="【题目-3】平台部署–部署-KubeVirt-虚拟化-1-分"><a href="#【题目-3】平台部署–部署-KubeVirt-虚拟化-1-分" class="headerlink" title="【题目 3】平台部署–部署 KubeVirt 虚拟化[1 分]"></a>【题目 3】平台部署–部署 KubeVirt 虚拟化[1 分]</h3><p>在 Kubernetes 集群上完成KubeVirt 虚拟化环境的安装。完成后提交 master 节点的用户名、密码和 IP 到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubeeasy add --virt kubevirt</span></span><br></pre></td></tr></table></figure>

<p>1.KubeVirt 所有组件运行成功得 1 分。</p>
<h3 id="【题目-4】平台部署–部署-Harbor-仓库及Helm-包管理工具-1-分"><a href="#【题目-4】平台部署–部署-Harbor-仓库及Helm-包管理工具-1-分" class="headerlink" title="【题目 4】平台部署–部署 Harbor 仓库及Helm 包管理工具[1 分]"></a>【题目 4】平台部署–部署 Harbor 仓库及Helm 包管理工具[1 分]</h3><p>在 master 节点上完成Harbor 镜像仓库及Helm 包管理工具的部署。然后使用 nginx 镜像自定义一个 Chart，Deployment 名称为 nginx，副本数为 1，然后将该 Chart 部署到 default 命名空间下，Release 名称为 web。<br>完成后提交 master 节点的用户名、密码和 IP 到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubeeasy add --registry harbor</span></span><br></pre></td></tr></table></figure>

<p>1.Harbor 仓库部署成功得 0.5 分；<br>2.Helm 工具安装成功得 0.2 分；<br>3.Chart 包部署成功得 0.3 分。</p>
<h3 id="【题目-5】集群管理–备份-ETCD-数据-1-分"><a href="#【题目-5】集群管理–备份-ETCD-数据-1-分" class="headerlink" title="【题目 5】集群管理–备份 ETCD 数据[1 分]"></a>【题目 5】集群管理–备份 ETCD 数据[1 分]</h3><p>Kubernetes 使用 ETCD 来存储集群的实时运行数据，为防止服务器宕机导致 Kubernetes集群数据丢失，请将Kubernetes 集群数据备份到&#x2F;root&#x2F;etcd.db 中。完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/lihongbao80/article/details/<span class="number">126508726</span></span><br></pre></td></tr></table></figure>

<p>1.etcdctl 工具安装成功得 0.2 分；<br>2.ETCD 数据备份成功得 0.8 分。</p>
<h2 id="【任务-2】容器云应用部署：Docker-Compose-编排部署-7-0-分"><a href="#【任务-2】容器云应用部署：Docker-Compose-编排部署-7-0-分" class="headerlink" title="【任务 2】容器云应用部署：Docker Compose 编排部署[7.0 分]"></a>【任务 2】容器云应用部署：Docker Compose 编排部署[7.0 分]</h2><p>Hyperf 是一个高性能、高灵活性的渐进式 PHP 协程框架，内置协程服务器及大量常用的组件，性能较传统基于 PHP-FPM 的框架有质的提升，提供超高性能的同时，也保持着极其灵活的可扩展性。请根据要求完成数据库服务 MariaDB、缓存服务 Redis、微服务 Hyperf 及前端服务Nginx 按照要求进行容器化。</p>
<h3 id="【题目-1】容器化-MariaDB-服务-1-分"><a href="#【题目-1】容器化-MariaDB-服务-1-分" class="headerlink" title="【题目 1】容器化 MariaDB 服务[1 分]"></a>【题目 1】容器化 MariaDB 服务[1 分]</h3><p>编写Dockerfile 文件构建hyperf-mariadb:v1.0 镜像，具体要求如下：（需要用到的软件包：<br>Hyperf.tar.gz）</p>
<p>（1）基础镜像：centos:7.9.2009；<br>（2）完成 MariaDB 服务的安装；<br>（3）声明端口：3306；<br>（4）设置数据库 root 用户的密码为root；<br>（5）将提供的数据库文件 hyperf_admin.sql 导入数据库；<br>（6）设置服务开机自启。<br>完成后构建镜像，并提交master 节点的用户名、密码和 IP 地址到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">没有具体的软件包，同理的代替一下</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#mysql初始化自启动脚本</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># cat mysql_init.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">mysql_install_db <span class="literal">--user</span>=root</span><br><span class="line">mysqld_safe <span class="literal">--user</span>=root &amp;</span><br><span class="line"><span class="built_in">sleep</span> <span class="number">8</span></span><br><span class="line">mysqladmin <span class="literal">-u</span> root password <span class="string">&#x27;root&#x27;</span></span><br><span class="line">mysql <span class="literal">-uroot</span> <span class="literal">-proot</span> <span class="literal">-e</span> <span class="string">&quot;grant all on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;root&#x27;; flush privileges;&quot;</span></span><br><span class="line">mysql <span class="literal">-uroot</span> <span class="literal">-proot</span> <span class="literal">-e</span> <span class="string">&quot; source /opt/pig.sql;source /opt/pig_codegen.sql;source /opt/pig_config.sql; source /opt/pig_job.sql;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#本地yum源</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># cat local.repo</span></span><br><span class="line">[<span class="type">pig</span>]</span><br><span class="line">name=pig</span><br><span class="line">baseurl=file:///root/yum</span><br><span class="line">gpgcheck=<span class="number">0</span></span><br><span class="line">enabled=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># cat Dockerfile-mariadb</span></span><br><span class="line">FROM centos:centos7.<span class="number">9.2009</span></span><br><span class="line">MAINTAINER Chinaskills</span><br><span class="line">RUN <span class="built_in">rm</span> <span class="literal">-rf</span> /etc/yum.repos.d/*</span><br><span class="line"><span class="built_in">COPY</span> local.repo /etc/yum.repos.d/</span><br><span class="line"><span class="built_in">COPY</span> yum /root/yum</span><br><span class="line">ENV LC_ALL en_US.UTF<span class="literal">-8</span></span><br><span class="line">RUN yum <span class="literal">-y</span> install mariadb<span class="literal">-server</span></span><br><span class="line"><span class="built_in">COPY</span> mysql /opt/</span><br><span class="line"><span class="built_in">COPY</span> mysql_init.sh /opt/</span><br><span class="line">RUN bash /opt/mysql_init.sh</span><br><span class="line">EXPOSE <span class="number">3306</span></span><br><span class="line">CMD [<span class="string">&quot;mysqld_safe&quot;</span>,<span class="string">&quot;--user=root&quot;</span>]</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># docker build -t hyperf-mariadb:v1.0 -f Dockerfile-mariadb .</span></span><br></pre></td></tr></table></figure>

<p>1.镜像构建成功得 0.5 分；<br>2.数据库安装且导入数据成功得 0.5 分。</p>
<p>【题目 2】容器化Redis 服务[1 分]</p>
<p>编写 Dockerfile 文件构建 hyperf-redis:v1.0 镜像，具体要求如下：（需要用到的软件包：<br>Hyperf.tar.gz）<br>（1）基础镜像：centos:7.9.2009；<br>（2）安装Redis 服务；<br>（3）关闭保护模式；<br>（4）声明端口：6379；<br>（5）设置服务开机自启。<br>完成后构建镜像，并提交master 节点的用户名、密码和 IP 地址到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># cat Dockerfile-redis</span></span><br><span class="line">FROM centos:centos7.<span class="number">9.2009</span></span><br><span class="line">MAINTAINER Chinaskills</span><br><span class="line">RUN <span class="built_in">rm</span> <span class="literal">-rf</span> /etc/yum.repos.d/*</span><br><span class="line"><span class="built_in">COPY</span> local.repo /etc/yum.repos.d/</span><br><span class="line"><span class="built_in">COPY</span> yum /root/yum</span><br><span class="line">RUN yum <span class="literal">-y</span> install redis</span><br><span class="line">RUN sed <span class="literal">-i</span> <span class="string">&#x27;s/127.0.0.1/0.0.0.0/g&#x27;</span> /etc/redis.conf &amp;&amp; \</span><br><span class="line">   sed <span class="literal">-i</span> <span class="string">&#x27;s/protected-mode yes/protected-mode no/g&#x27;</span> /etc/redis.conf</span><br><span class="line">EXPOSE <span class="number">6379</span></span><br><span class="line">CMD [<span class="string">&quot;/usr/bin/redis-server&quot;</span>,<span class="string">&quot;/etc/redis.conf&quot;</span>]</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># docker build -t  hyperf-redis:v1.0  -f Dockerfile-redis .</span></span><br></pre></td></tr></table></figure>

<p>1.镜像构建成功的 0.5 分；<br>2.Redis 服务安装成功且配置正确得 0.5 分。</p>
<h3 id="【题目-3】容器化Nginx-服务-0-5-分"><a href="#【题目-3】容器化Nginx-服务-0-5-分" class="headerlink" title="【题目 3】容器化Nginx 服务[0.5 分]"></a>【题目 3】容器化Nginx 服务[0.5 分]</h3><p>编写 Dockerfile 文件构建hyperf-nginx:v1.0 镜像，具体要求如下：（需要用到的软件包：<br>Hyperf.tar.gz）<br>（1）基础镜像：centos:7.9.2009；<br>（2）安装nginx 服务；<br>（3）声明端口：80；<br>（4）设置服务开机自启。<br>完成后构建镜像，并提交master 节点的用户名、密码和 IP 地址到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># cat Dockerfile-nginx</span></span><br><span class="line">FROM centos:centos7.<span class="number">9.2009</span></span><br><span class="line">MAINTAINER Chinaskills</span><br><span class="line">RUN <span class="built_in">rm</span> <span class="literal">-rf</span> /etc/yum.repos.d/*</span><br><span class="line"><span class="built_in">COPY</span> local.repo /etc/yum.repos.d/</span><br><span class="line"><span class="built_in">COPY</span> yum /root/yum</span><br><span class="line">RUN yum <span class="literal">-y</span> install nginx</span><br><span class="line">EXPOSE <span class="number">80</span></span><br><span class="line">CMD [<span class="string">&quot;nginx&quot;</span>,<span class="string">&quot;-g&quot;</span>,<span class="string">&quot;daemon off;&quot;</span>]</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">worker</span>-<span class="type">node1</span> <span class="type">Pig</span>]<span class="comment"># docker build -t hyperf-nginx:v1.0 -f Dockerfile-nginx .</span></span><br></pre></td></tr></table></figure>

<p>1.镜像构建成功得 0.3 分；<br>2.Nginx 安装成功且配置正确得 0.2 分。</p>
<h3 id="【题目-4】容器化Hyperf-服务-1-分"><a href="#【题目-4】容器化Hyperf-服务-1-分" class="headerlink" title="【题目 4】容器化Hyperf 服务[1 分]"></a>【题目 4】容器化Hyperf 服务[1 分]</h3><p>编写Dockerfile 文件构建hyperf-service:v1.0 镜像，具体要求如下：（需要用到的软件包：<br>Hyperf.tar.gz）<br>（1）基础镜像：centos:7.9.2009；<br>（2）安装 PHP 及扩展；<br>（3）使用源码编译安装Swoole。<br>完成后构建镜像，并提交master 节点的用户名、密码和 IP 地址到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在这里插入代码片</span><br></pre></td></tr></table></figure>

<p>1.镜像构建成功得 0.5 分；<br>2.PHP 安装成功得 0.2 分；<br>3.Swoole 安装成功得 0.3 分。</p>
<h3 id="【题目-5】编排部署Hyperf-框架-3-5-分"><a href="#【题目-5】编排部署Hyperf-框架-3-5-分" class="headerlink" title="【题目 5】编排部署Hyperf 框架[3.5 分]"></a>【题目 5】编排部署Hyperf 框架[3.5 分]</h3><p>编写&#x2F;root&#x2F;hyperf&#x2F;project&#x2F;docker-compose.yaml 文件，具体要求如下：<br>（1）容器 1 名称：hyperf-mysql；镜像：hyperf-mariadb:v1.0；端口映射：3306:3306；<br>（2）容器 2 名称：hyperf-redis；镜像：hyperf-redis:v1.0；<br>（3）容器 3 名称：hyperf-ui；镜像：hyperf-nginx:v1.0；端口映射：80:8081；<br>（4）容器 4 名称：hyperf-service；镜像：hyperf-service:v1.0。<br>完成后编排部署Hyperf 框架，并提交master 节点的用户名、密码和 IP 地址到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在这里插入代码片</span><br></pre></td></tr></table></figure>

<p>.docker-compose.yaml 文件编排成功得 1.5 分；<br>2.8081 端口访问服务成功得 1 分；<br>3.Hyperf-service 连接数据库和Redis 成功得 1 分。</p>
<h2 id="【任务-3】容器云应用部署：基于-Kubernetes-构建-CICD-8-0-分"><a href="#【任务-3】容器云应用部署：基于-Kubernetes-构建-CICD-8-0-分" class="headerlink" title="【任务 3】容器云应用部署：基于 Kubernetes 构建 CICD[8.0 分]"></a>【任务 3】容器云应用部署：基于 Kubernetes 构建 CICD[8.0 分]</h2><p>该公司决定采用Kubernetes + GitLab CI 来构建 CICD 环境，以缩短新功能开发上线周期，及时满足客户的需求，实现 DevOps 的部分流程，来减轻部署运维的负担，实现可视化容器生命周期管理、应用发布和版本迭代更新，请完成GitLab CI + Kubernetes 的 CICD 环境部署（构建持续集成所需要的所有软件包在软件包 CICD-Runner.tar.gz 中）。CICD 应用系统架构如下：</p>
<h3 id="【题目-1】安装GitLab-环境-1-分"><a href="#【题目-1】安装GitLab-环境-1-分" class="headerlink" title="【题目 1】安装GitLab 环境[1 分]"></a>【题目 1】安装GitLab 环境[1 分]</h3><p>在Kubernetes 集群中新建命名空间gitlab-ci，将GitLab 部署到该命名空间下，Deployment和 Service 名称均为gitlab，以 NodePort 方式将 80 端口对外暴露为 30880，设置 GitLab 服务root 用户的密码为 admin@123，将项目包 demo-2048.tar.gz 导入到 GitLab 中并命名为demo-2048。<br>完成后提交 master 节点的用户名、密码和 IP 地址到答题框。（需要用到的软件包路径<br>CICD-Runner.tar.gz）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># kubectl create ns gitlab-ci</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># vi gitlab.yaml</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: gitlab</span><br><span class="line">  labels:</span><br><span class="line">    app: gitlab</span><br><span class="line">spec:</span><br><span class="line">  <span class="built_in">type</span>: NodePort</span><br><span class="line">  ports:</span><br><span class="line">  - name: http</span><br><span class="line">    port: <span class="number">80</span>                  </span><br><span class="line">    targetPort: <span class="number">80</span></span><br><span class="line">    nodePort: <span class="number">30888</span>                 </span><br><span class="line">  selector:</span><br><span class="line">    app: gitlab</span><br><span class="line"></span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: gitlab</span><br><span class="line">  labels:</span><br><span class="line">    app: gitlab</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: gitlab</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: gitlab</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: gitlab<span class="literal">-admin</span></span><br><span class="line">      containers:</span><br><span class="line">      - name: gitlab</span><br><span class="line">        image: gitlab/gitlab<span class="literal">-ce</span>:latest</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        securityContext: </span><br><span class="line">          runAsUser: <span class="number">0</span>                   </span><br><span class="line">          privileged: true</span><br><span class="line">        env:</span><br><span class="line">        - name: GITLAB_ROOT_PASSWORD</span><br><span class="line">          value: admin@<span class="number">123</span>              </span><br><span class="line">        ports:</span><br><span class="line">        - name: http</span><br><span class="line">          containerPort: <span class="number">80</span></span><br><span class="line">        volumeMounts:</span><br><span class="line">        - mountPath: /etc/gitlab</span><br><span class="line">          name: gitlabhome</span><br><span class="line">        - mountPath: /var/log/gitlab</span><br><span class="line">          name: loghome</span><br><span class="line">        - mountPath: /var/opt/gitlab</span><br><span class="line">          name: opthome</span><br><span class="line">      volumes:</span><br><span class="line">      - name: gitlabhome</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /svc/gitlab/config</span><br><span class="line">      - name: loghome</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /svc/gitlab/gitlab/logs</span><br><span class="line">      - name: opthome</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /svc/gitlab/gitlab/<span class="keyword">data</span></span><br><span class="line"></span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: gitlab<span class="literal">-admin</span></span><br><span class="line">  labels:</span><br><span class="line">    name: gitlab</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: gitlab<span class="literal">-admin</span></span><br><span class="line">  labels:</span><br><span class="line">    name: gitlab</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: gitlab<span class="literal">-admin</span></span><br><span class="line">    namespace: default</span><br><span class="line">roleRef:</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: cluster<span class="literal">-admin</span></span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br></pre></td></tr></table></figure>

<p>1.GitLab 部署正确且能正常访问得 0.5 分；<br>2.项目导入成功得 0.5 分。</p>
<h3 id="【题目-2】部署GitLab-Runner-2-分"><a href="#【题目-2】部署GitLab-Runner-2-分" class="headerlink" title="【题目 2】部署GitLab Runner[2 分]"></a>【题目 2】部署GitLab Runner[2 分]</h3><p>将 GitLab Runner 部署到 gitlab-ci 命名空间下，Release 名称为 gitlab-runner，为 GitLab Runner 创建持久化构建缓存目录&#x2F;home&#x2F;gitlab-runner&#x2F;ci-build-cache 以加速构建速度，并将其注册到 GitLab 中。完成后提交 master 节点的用户名、密码和 IP 地址到答题框。（需要用到的软件包路径<br>CICD-Runner.tar.gz）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考链接；https://www.qikqiak.com/post/gitlab<span class="literal">-runner-install-on-k8s</span>/</span><br></pre></td></tr></table></figure>

<p>1.GitLab Runner 部署成功得 0.5 分；<br>2.GitLab Runner 注册成功得 0.5 分；<br>3.GitLab Runner 持久化配置成功得 1 分。</p>
<h3 id="【题目-3】配置GitLab-1-5-分"><a href="#【题目-3】配置GitLab-1-5-分" class="headerlink" title="【题目 3】配置GitLab[1.5 分]"></a>【题目 3】配置GitLab[1.5 分]</h3><p>将 Kubernetes 集群添加到 demo-2048 项目中，并命名为 kubernetes-agent，项目命名空间选择 gitlab-ci。完成后提交 master 节点的用户名、密码和 IP 地址到答题框。（需要用到的软件包路径CICD-Runner.tar.gz）</p>
<p>1.GitLab Agent 安装成功得 1 分；<br>2.Kubernetes 连接成功得 0.5 分。</p>
<h3 id="【题目-4】构建CICD-3-5-分"><a href="#【题目-4】构建CICD-3-5-分" class="headerlink" title="【题目 4】构建CICD[3.5 分]"></a>【题目 4】构建CICD[3.5 分]</h3><p>编写流水线脚本.gitlab-ci.yml 触发自动构建，具体要求如下：<br>（1）基于镜像 maven:3.6-jdk-8 构建项目的drone 分支；<br>（2）构建镜像的名称：demo:latest；<br>（3）将镜像推送到Harbor 仓库 demo 项目中；<br>（4）将 demo-2048 应用自动发布到Kubernetes 集群 gitlab-ci 命名空间下。<br>完成后提交 master 节点的用户名、密码和 IP 地址到答题框。（需要用到的软件包路径<br>CICD-Runner.tar.gz）</p>
<p>1.项目变异成功得 0.5 分；<br>2.镜像构建成功得 1 分；<br>3.服务发布成功得 1 分；<br>4.服务能正常访问得 1 分。</p>
<h2 id="【任务-4】容器云服务运维：Kubernetes-基于容器的运维-6-分"><a href="#【任务-4】容器云服务运维：Kubernetes-基于容器的运维-6-分" class="headerlink" title="【任务 4】容器云服务运维：Kubernetes 基于容器的运维[6 分]"></a>【任务 4】容器云服务运维：Kubernetes 基于容器的运维[6 分]</h2><h3 id="【题目-1】Pod-管理–创建-Pod-0-5-分"><a href="#【题目-1】Pod-管理–创建-Pod-0-5-分" class="headerlink" title="【题目 1】Pod 管理–创建 Pod[0.5 分]"></a>【题目 1】Pod 管理–创建 Pod[0.5 分]</h3><p>在 default 命名空间下使用nginx:latest 镜像创建一个QoS 类为 Guaranteed 的 Pod，名称为 qos-demo。完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: qos<span class="literal">-demo</span></span><br><span class="line">  namespace: default</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: qos<span class="literal">-demo</span></span><br><span class="line">    image: nginx:latest</span><br><span class="line">    imagePullPolicy: IfNotPresent</span><br><span class="line">    resources:</span><br><span class="line">      limits:</span><br><span class="line">        memory: <span class="string">&quot;200Mi&quot;</span></span><br><span class="line">      requests:</span><br><span class="line">        memory: <span class="string">&quot;100Mi&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.Pod 创建成功得 0.2 分；<br>2.Pod QoS 类型为Guaranteed 得 0.3 分。</p>
<h3 id="【题目-2】安全管理–配置-Pod-安全上下文-0-5-分"><a href="#【题目-2】安全管理–配置-Pod-安全上下文-0-5-分" class="headerlink" title="【题目 2】安全管理–配置 Pod 安全上下文[0.5 分]"></a>【题目 2】安全管理–配置 Pod 安全上下文[0.5 分]</h3><p>使用 busybox 镜像启动一个名为 context-demo 的 Pod，为该 Pod 配置安全上下文，要求容器内以用户 1000 和用户组 3000 来运行所有进程，并在启动时执行“sleep 1h”命令。<br>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: context<span class="literal">-demo</span></span><br><span class="line">spec:</span><br><span class="line">  securityContext:</span><br><span class="line">    runAsUser: <span class="number">1000</span></span><br><span class="line">    runAsGroup: <span class="number">3000</span></span><br><span class="line">    fsGroup: <span class="number">2000</span></span><br><span class="line">  containers:</span><br><span class="line">  - name: context<span class="literal">-demo</span></span><br><span class="line">    image: busybox:latest</span><br><span class="line">    imagePullPolicy: IfNotPresent</span><br><span class="line">    command: [ <span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;sleep 1h&quot;</span> ]</span><br><span class="line">    securityContext:</span><br><span class="line">      allowPrivilegeEscalation: false</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.Pod 安全上下午配置正确得 0.5 分。</p>
<h3 id="【题目-3】CRD-管理–创建自定义资源类型-0-5-分"><a href="#【题目-3】CRD-管理–创建自定义资源类型-0-5-分" class="headerlink" title="【题目 3】CRD 管理–创建自定义资源类型[0.5 分]"></a>【题目 3】CRD 管理–创建自定义资源类型[0.5 分]</h3><p>在 Kubernetes 集群中自定义一种资源类型 Student，API 为 stable.example.com&#x2F;v1，单数形式为 student，复数形式为 students，简写为 stu，作用域为命名空间级，然后在 default 命名空间下创建一个名为 exam 的 Student 对象。完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.资源类型 Student 定义成功的 0.3 分；<br>2.exam 创建成功得 0.2 分。</p>
<h3 id="【题目-4】解析管理–添加主机别名到-Pod-0-5-分"><a href="#【题目-4】解析管理–添加主机别名到-Pod-0-5-分" class="headerlink" title="【题目 4】解析管理–添加主机别名到 Pod[0.5 分]"></a>【题目 4】解析管理–添加主机别名到 Pod[0.5 分]</h3><p>使用 nginx 镜像在 default 命名空间下创建一个名为 nginx 的 Pod，并在 Pod 的&#x2F;etc&#x2F;hosts 中添加 IP 地址 127.0.0.1 与 chinaskills 的解析。<br>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: nginx</span><br><span class="line">spec:</span><br><span class="line">  restartPolicy: Never</span><br><span class="line">  hostAliases:</span><br><span class="line">  - ip: <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">    hostnames:</span><br><span class="line">    - <span class="string">&quot;chinaskills&quot;</span></span><br><span class="line">  containers:</span><br><span class="line">  - name: ngnix</span><br><span class="line">    image: nginx:latest</span><br><span class="line">    imagePullPolicy: IfNotPresent</span><br><span class="line">    command:</span><br><span class="line">    - <span class="built_in">cat</span></span><br><span class="line">    args:</span><br><span class="line">    - <span class="string">&quot;/etc/hosts&quot;</span></span><br></pre></td></tr></table></figure>
<p>1.自定义解析配置正确得 0.5 分。</p>
<h3 id="【题目-5】HPA-管理–创建-HPA-规则-1-分"><a href="#【题目-5】HPA-管理–创建-HPA-规则-1-分" class="headerlink" title="【题目 5】HPA 管理–创建 HPA 规则[1 分]"></a>【题目 5】HPA 管理–创建 HPA 规则[1 分]</h3><p>默认情况下 HPA 是无法调整伸缩灵敏度的，但不同的业务场景对伸缩灵敏度的要求不一样。要求在 default 命名空间下使用 nginx 镜像创建一个名为 web 的 deployment，自定义HPA 的伸缩灵敏度，为该deployment 创建一个名为web 的HPA，扩容时立即新增当前 9 倍数量的副本数，时间窗口为 5s，伸缩范围为 1–1000。例如一开始只有 1 个 Pod，当 CPU 使用率超过 80%时，Pod 数量变化趋势为：1 → 10 → 100 → 1000。<br>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: hap<span class="literal">-nginx-deploy</span></span><br><span class="line">  namespace: default</span><br><span class="line">  labels:</span><br><span class="line">    app: nginx<span class="literal">-demo</span></span><br><span class="line">spec:</span><br><span class="line">  replicas: <span class="number">1</span></span><br><span class="line">  revisionHistoryLimit: <span class="number">4</span></span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: nginx</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: nginx</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: web</span><br><span class="line">        image: nginx</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: <span class="number">80</span>  </span><br><span class="line">        </span><br><span class="line"><span class="comment"># 然后创建Deployment：</span></span><br><span class="line"><span class="variable">$</span> kubectl create <span class="operator">-f</span> hpa<span class="literal">-deploy-demo</span>.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 现在我们来创建一个HPA，可以使用kubectl autoscale命令来创建：</span></span><br><span class="line"><span class="variable">$</span> kubectl autoscale deployment hpa<span class="literal">-nginx-deploy</span> <span class="literal">--cpu-percent</span>=<span class="number">80</span> <span class="literal">--min</span>=<span class="number">1</span> <span class="literal">--max</span>=<span class="number">100</span></span><br><span class="line">deployment <span class="string">&quot;hpa-nginx-deploy&quot;</span> autoscaled</span><br><span class="line">···</span><br><span class="line"><span class="variable">$</span> kubectl get hpa                                                         </span><br><span class="line">NAME        REFERENCE              TARGET    CURRENT   MINPODS   MAXPODS   AGE</span><br><span class="line">hpa<span class="literal">-nginx-deploy</span>   Deployment/hpa<span class="literal">-nginx-deploy</span>   <span class="number">10</span>%       <span class="number">0</span>%        <span class="number">1</span>         <span class="number">10</span>        <span class="number">13</span>s</span><br><span class="line"><span class="comment">#此命令创建了一个关联资源 hpa-nginx-deploy 的HPA，最小的 pod 副本数为1，最大为100。HPA会根据设定的 cpu使用率（80%）动态的增加或者减少pod数量。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#参考https://www.bookstack.cn/read/rancher-2.4.4-zh/2cf7e056a6f83ec4.md</span></span><br></pre></td></tr></table></figure>

<p>1.HPA 创建成功得 0.2 分；<br>2.HPA 伸缩策略配置正确得 0.8 分。</p>
<h3 id="【题目-6】节点亲和性管理–创建硬限制规则的-Pod-0-5-分"><a href="#【题目-6】节点亲和性管理–创建硬限制规则的-Pod-0-5-分" class="headerlink" title="【题目 6】节点亲和性管理–创建硬限制规则的 Pod[0.5 分]"></a>【题目 6】节点亲和性管理–创建硬限制规则的 Pod[0.5 分]</h3><p>在 default 命名空间下使用 nginx 镜像运行一个 Pod， 名称为 nginx， 要求使用requiredDuringSchedulingIgnoredDuringExecution 策略将 Pod 调度到具有“disktype&#x3D;ssd”标签的节点。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">kubectl label node k8s<span class="literal">-worker-node1</span> disktype=ssd</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: nginx</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: nginx</span><br><span class="line">    image: nginx:latest</span><br><span class="line">  affinity:</span><br><span class="line">    nodeAffinity:</span><br><span class="line">      requiredDuringSchedulingIgnoredDuringExecution:   <span class="comment">#硬性要求，最好放在节点包含disktype=ssd节点上</span></span><br><span class="line">        - weight: <span class="number">1</span></span><br><span class="line">          preference:</span><br><span class="line">            matchExpressions:</span><br><span class="line">              - key: disktype</span><br><span class="line">                operator: <span class="keyword">In</span></span><br><span class="line">                values:</span><br><span class="line">                  - ssd</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>完成后提交 master 节点的用户名、密码和 IP 到答题框。<br>1.Pod 调度策略配置正确得 0.5 分。</p>
<h3 id="【题目-7】网络策略管理–创建-Pod-网络策略-0-5-分"><a href="#【题目-7】网络策略管理–创建-Pod-网络策略-0-5-分" class="headerlink" title="【题目 7】网络策略管理–创建 Pod 网络策略[0.5 分]"></a>【题目 7】网络策略管理–创建 Pod 网络策略[0.5 分]</h3><p>创建一个网络策略 network-exam，要求只有 internal 命名空间下的 Pod 可以通过 TCP<br>协议的 8080 端口访问到 mysql 命名空间下的Pod。<br>完成后提交 master 节点的 IP、用户名和密码到答题框。</p>
<p>1.网络策略创建成功得 0.2 分；<br>2.规则配置正确得 0.3 分。</p>
<h3 id="【题目-8】驱逐机制管理–配置节点压力驱逐-0-5-分"><a href="#【题目-8】驱逐机制管理–配置节点压力驱逐-0-5-分" class="headerlink" title="【题目 8】驱逐机制管理–配置节点压力驱逐[0.5 分]"></a>【题目 8】驱逐机制管理–配置节点压力驱逐[0.5 分]</h3><p>设置kubelet 数据存储在&#x2F;apps&#x2F;data&#x2F;kubelet 目录下，并设置当kubelet 的存储空间不足5%， 或者当容器运行时文件系统可用存储空间不足 5%时开始驱逐 Pod。</p>
<p>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。<br>1.节点压力驱逐配置正确得 0.5 分。</p>
<h3 id="【题目-9】流量管理–创建-Ingress-Gateway-0-5-分"><a href="#【题目-9】流量管理–创建-Ingress-Gateway-0-5-分" class="headerlink" title="【题目 9】流量管理–创建 Ingress Gateway[0.5 分]"></a>【题目 9】流量管理–创建 Ingress Gateway[0.5 分]</h3><p>使用提供的软件包 ServiceMesh.tar.gz 将Bookinfo 应用部署到 default 命名空间下，使用Istio Gateway 可以实现应用程序从外部访问， 请为 Bookinfo 应用创建一个名为bookinfo-gateway 的网关，指定所有 HTTP 流量通过 80 端口流入网格，然后将网关绑定到虚拟服务 bookinfo 上。<br>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<p>（2）部署应用程序<br>解压软件包并导入镜像：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># tar -zxf ServiceMesh.tar.gz</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> ~]<span class="comment"># cd ServiceMesh/</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># docker load -i images/image.tar</span></span><br></pre></td></tr></table></figure>
<p>部署应用到Kubernetes集群：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f bookinfo/bookinfo.yaml</span></span><br><span class="line">service/details created</span><br><span class="line">serviceaccount/bookinfo<span class="literal">-details</span> created</span><br><span class="line">deployment.apps/details<span class="literal">-v1</span> created</span><br><span class="line">service/ratings created</span><br><span class="line">serviceaccount/bookinfo<span class="literal">-ratings</span> created</span><br><span class="line">deployment.apps/ratings<span class="literal">-v1</span> created</span><br><span class="line">service/reviews created</span><br><span class="line">serviceaccount/bookinfo<span class="literal">-reviews</span> created</span><br><span class="line">deployment.apps/reviews<span class="literal">-v1</span> created</span><br><span class="line">service/productpage created</span><br><span class="line">serviceaccount/bookinfo<span class="literal">-productpage</span> created</span><br><span class="line">deployment.apps/productpage<span class="literal">-v1</span> created</span><br></pre></td></tr></table></figure>
<p>Gateway配置文件如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat bookinfo-gateway.yaml</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: Gateway</span><br><span class="line">metadata:</span><br><span class="line">name: bookinfo<span class="literal">-gateway</span></span><br><span class="line">spec:</span><br><span class="line">selector:</span><br><span class="line">  istio: ingressgateway <span class="comment"># use istio default controller</span></span><br><span class="line">servers:</span><br><span class="line"> - port:</span><br><span class="line">    number: <span class="number">80</span></span><br><span class="line">    name: http</span><br><span class="line">    protocol: HTTP</span><br><span class="line">  hosts:</span><br><span class="line">   - <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: bookinfo</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line"> - <span class="string">&quot;*&quot;</span></span><br><span class="line">gateways:</span><br><span class="line"> - bookinfo<span class="literal">-gateway</span></span><br><span class="line">http:</span><br><span class="line"> - match:</span><br><span class="line">   - uri:</span><br><span class="line">      exact: /productpage</span><br><span class="line">   - uri:</span><br><span class="line">      prefix: /<span class="keyword">static</span></span><br><span class="line">   - uri:</span><br><span class="line">      exact: /login</span><br><span class="line">   - uri:</span><br><span class="line">      exact: /logout</span><br><span class="line">   - uri:</span><br><span class="line">      prefix: /api/v1/products</span><br><span class="line">  route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: productpage</span><br><span class="line">      port:</span><br><span class="line">        number: <span class="number">9080</span></span><br></pre></td></tr></table></figure>
<p>确认网关创建完成：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f bookinfo-gateway.yaml</span></span><br><span class="line">gateway.networking.istio.io/bookinfo<span class="literal">-gateway</span> created</span><br><span class="line">virtualservice.networking.istio.io/bookinfo created</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl get gateway</span></span><br><span class="line">NAME               AGE</span><br><span class="line">bookinfo<span class="literal">-gateway</span>       <span class="number">32</span>s</span><br></pre></td></tr></table></figure>


<p>1.Bookinfo 应用部署成功得 0.2 分；<br>2.Bookinfo 能通过网关访问得 0.3 分。</p>
<h3 id="【题目-10】服务网格–创建基于用户身份的路由-0-5-分"><a href="#【题目-10】服务网格–创建基于用户身份的路由-0-5-分" class="headerlink" title="【题目 10】服务网格–创建基于用户身份的路由[0.5 分]"></a>【题目 10】服务网格–创建基于用户身份的路由[0.5 分]</h3><p>创建一个名为 reviews 路由，要求来自名为 Jason 的用户的所有流量将被路由到服务<br>reviews:v2。完成后提交 master 节点的用户名、密码和 IP 到答题框。<br>使用Curl工具向Bookinfo应用发送请求产生模拟流量。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat curl.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"> <span class="built_in">curl</span> http://<span class="number">10.24</span>.<span class="number">2.5</span>:<span class="number">22092</span>/productpage &gt;/dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"> <span class="built_in">sleep</span> <span class="number">1</span></span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># chmod +x curl.sh</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># bash curl.sh &amp;</span></span><br><span class="line">[<span class="number">1</span>] <span class="number">2924</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意对应地址</span></span><br></pre></td></tr></table></figure>
<p>编写目标规则配置文件：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat destination-rule-all.yaml</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: DestinationRule</span><br><span class="line">metadata:</span><br><span class="line">name: productpage</span><br><span class="line">spec:</span><br><span class="line">host: productpage</span><br><span class="line">subsets:</span><br><span class="line"> - name: v1</span><br><span class="line">  labels:</span><br><span class="line">    version: v1</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: DestinationRule</span><br><span class="line">metadata:</span><br><span class="line">name: reviews</span><br><span class="line">spec:</span><br><span class="line">host: reviews</span><br><span class="line">subsets:</span><br><span class="line"> - name: v1</span><br><span class="line">  labels:</span><br><span class="line">    version: v1</span><br><span class="line"> - name: v2</span><br><span class="line">  labels:</span><br><span class="line">    version: v2</span><br><span class="line"> - name: v3</span><br><span class="line">  labels:</span><br><span class="line">    version: v3</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: DestinationRule</span><br><span class="line">metadata:</span><br><span class="line">name: ratings</span><br><span class="line">spec:</span><br><span class="line">host: ratings</span><br><span class="line">subsets:</span><br><span class="line"> - name: v1</span><br><span class="line">  labels:</span><br><span class="line">    version: v1</span><br><span class="line"> - name: v2</span><br><span class="line">  labels:</span><br><span class="line">    version: v2</span><br><span class="line"> - name: v2<span class="literal">-mysql</span></span><br><span class="line">  labels:</span><br><span class="line">    version: v2<span class="literal">-mysql</span></span><br><span class="line"> - name: v2<span class="literal">-mysql-vm</span></span><br><span class="line">  labels:</span><br><span class="line">    version: v2<span class="literal">-mysql-vm</span></span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: DestinationRule</span><br><span class="line">metadata:</span><br><span class="line">name: details</span><br><span class="line">spec:</span><br><span class="line">host: details</span><br><span class="line">subsets:</span><br><span class="line"> - name: v1</span><br><span class="line">  labels:</span><br><span class="line">    version: v1</span><br><span class="line"> - name: v2</span><br><span class="line">  labels:</span><br><span class="line">    version: v2</span><br></pre></td></tr></table></figure>
<p>创建默认目标规则：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@k8s<span class="literal">-master-node1</span> ServiceMesh]<span class="comment"># kubectl apply -f destination-rule-all.yaml</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl get destinationrule</span></span><br><span class="line">NAME         HOST       AGE</span><br><span class="line">details         details       <span class="number">21</span>s</span><br><span class="line">productpage     productpage   <span class="number">21</span>s</span><br><span class="line">ratings         ratings       <span class="number">21</span>s</span><br><span class="line">reviews         reviews       <span class="number">21</span>s</span><br><span class="line"></span><br><span class="line"><span class="comment">#重新部署productpage微服务，启用Istio：</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat bookinfo/bookinfo.yaml | istioctl kube-inject -f - | kubectl apply -l app=productpage -f -</span></span><br><span class="line">service/productpage unchanged</span><br><span class="line">deployment.apps/productpage<span class="literal">-v1</span> configured</span><br><span class="line"></span><br><span class="line"><span class="comment">#所有服务启用Istio：</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat bookinfo/bookinfo.yaml | istioctl kube-inject -f - | kubectl apply -l app!=productpage -f -</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#部署v2版本的reviews微服务并开启Istio：</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat bookinfo/reviews-v2.yaml | istioctl kube-inject -f - | kubectl apply -f -</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat bookinfo/reviews-v3.yaml | istioctl kube-inject -f - | kubectl apply -f -</span></span><br></pre></td></tr></table></figure>
<p>请求路由</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl autoscale deployment reviews-v1 --cpu-percent=50 --min=1 --max=10</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl autoscale deployment reviews-v2 --cpu-percent=50 --min=1 --max=10</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl autoscale deployment reviews-v3 --cpu-percent=50 --min=1 --max=10</span></span><br></pre></td></tr></table></figure>
<p>默认请求路由配置文件如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat virtual-service-all-v1.yaml</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: productpage</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line"> - productpage</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: productpage</span><br><span class="line">      subset: v1</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: reviews</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line"> - reviews</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: reviews</span><br><span class="line">      subset: v1</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: ratings</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line"> - ratings</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: ratings</span><br><span class="line">      subset: v1</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: details</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line"> - details</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: details</span><br><span class="line">      subset: v1</span><br></pre></td></tr></table></figure>
<p>配置默认请求路由：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f virtual-service-all-v1.yaml</span></span><br><span class="line">virtualservice.networking.istio.io/productpage created</span><br><span class="line">virtualservice.networking.istio.io/reviews created</span><br><span class="line">virtualservice.networking.istio.io/ratings created</span><br><span class="line">virtualservice.networking.istio.io/details created</span><br></pre></td></tr></table></figure>


<p>1.路由创建成功得 0.2 分；<br>2.用户限制正确得 0.3 分。</p>
<h3 id="【题目-11】服务网格–创建请求路由-0-5-分"><a href="#【题目-11】服务网格–创建请求路由-0-5-分" class="headerlink" title="【题目 11】服务网格–创建请求路由[0.5 分]"></a>【题目 11】服务网格–创建请求路由[0.5 分]</h3><p>在default 命名空间下创建一个名为reviews-route 的虚拟服务，默认情况下，所有的HTTP<br>流量都会被路由到标签为 version:v1 的 reviews 服务的 Pod 上。此外，路径以&#x2F;wpcatalog&#x2F;或<br>&#x2F;consumercatalog&#x2F;开头的HTTP 请求将被重写为&#x2F;newcatalog，并被发送到标签为 version:v2 的<br>Pod 上。完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<p>使用下面的命令把50%的流量从reviews:v1转移到reviews:v3（金丝雀版本）：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat virtual-service-reviews-50-50.yaml</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: reviews</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line">   - reviews</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: reviews</span><br><span class="line">      subset: v1</span><br><span class="line">    weight: <span class="number">50</span></span><br><span class="line">   - destination:</span><br><span class="line">      host: reviews</span><br><span class="line">      subset: v3</span><br><span class="line">    weight: <span class="number">50</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f virtual-service-reviews-50-50.yaml</span></span><br><span class="line">virtualservice.networking.istio.io/reviews configured</span><br></pre></td></tr></table></figure>
<p>假如认为reviews:v3微服务已经稳定，可以通过应用Virtual Service规则将100%的流量路由reviews:v3：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat virtual-service-reviews-v3.yaml</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: reviews</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line">   - reviews</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: reviews</span><br><span class="line">      subset: v3</span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f virtual-service-reviews-v3.yaml</span></span><br><span class="line">virtualservice.networking.istio.io/reviews configured</span><br><span class="line"></span><br><span class="line">初始化默认路由规则，将所有流量路由到服务的v1版本：</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f virtual-service-all-v1.yaml</span></span><br></pre></td></tr></table></figure>
<p>改变reviews服务的流量规则，将v1版本的流量镜像到v2版本：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># cat virtual-service-mirroring.yaml</span></span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">name: reviews</span><br><span class="line">spec:</span><br><span class="line">hosts:</span><br><span class="line">   - reviews</span><br><span class="line">http:</span><br><span class="line"> - route:</span><br><span class="line">   - destination:</span><br><span class="line">      host: reviews</span><br><span class="line">      subset: v1</span><br><span class="line">    weight: <span class="number">100</span></span><br><span class="line">  mirror:</span><br><span class="line">      host: reviews</span><br><span class="line">      subset: v2</span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master</span>-<span class="type">node1</span> <span class="type">ServiceMesh</span>]<span class="comment"># kubectl apply -f virtual-service-mirroring.yaml</span></span><br><span class="line">virtualservice.networking.istio.io/reviews configured</span><br></pre></td></tr></table></figure>
<p>1.请求路由创建成功得 0.2 分；<br>2.路由策略配置正确得 0.3 分。</p>
<h2 id="【任务-5】容器云服务运维：Kubernetes-基于虚拟机的运维-4-0-分"><a href="#【任务-5】容器云服务运维：Kubernetes-基于虚拟机的运维-4-0-分" class="headerlink" title="【任务 5】容器云服务运维：Kubernetes  基于虚拟机的运维[4.0 分]"></a>【任务 5】容器云服务运维：Kubernetes  基于虚拟机的运维[4.0 分]</h2><h3 id="【题目-1】VM-管理–创建-VM-0-5-分"><a href="#【题目-1】VM-管理–创建-VM-0-5-分" class="headerlink" title="【题目 1】VM 管理–创建 VM[0.5 分]"></a>【题目 1】VM 管理–创建 VM[0.5 分]</h3><p>使用镜像 fedora-virt:v1.0 在 default 命名空间下创建一台 vm，名称为 vm-fedora，内存为1G。<br>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#参考官网学习http://kubevirt.io/user-guide/virtual_machines/virtual_machine_instances/</span></span><br><span class="line"></span><br><span class="line">apiVersion: kubevirt.io/v1</span><br><span class="line">kind: VirtualMachine</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    kubevirt.io/vm: vm<span class="literal">-fedora</span></span><br><span class="line">  name: vm<span class="literal">-fedora</span></span><br><span class="line">spec:</span><br><span class="line">  running: false</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        kubevirt.io/vm: vm<span class="literal">-fedora</span></span><br><span class="line">    spec:</span><br><span class="line">      domain:</span><br><span class="line">        resources:</span><br><span class="line">          requests:</span><br><span class="line">            memory: <span class="number">1</span><span class="built_in">Gi</span></span><br><span class="line">        devices:</span><br><span class="line">          disks:</span><br><span class="line">          - name: containerdisk</span><br><span class="line">            disk:</span><br><span class="line">              bus: virtio</span><br><span class="line">      volumes:</span><br><span class="line">      - name: containerdisk</span><br><span class="line">        containerDisk:</span><br><span class="line">          image: fedora<span class="literal">-virt</span>:v1.<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.VM 创建成功得 0.3 分；<br>2.VM 配置正确得 0.2 分。</p>
<h3 id="【题目-2】存储与卷–创建-emptyDisk-卷-1-分"><a href="#【题目-2】存储与卷–创建-emptyDisk-卷-1-分" class="headerlink" title="【题目 2】存储与卷–创建 emptyDisk 卷[1 分]"></a>【题目 2】存储与卷–创建 emptyDisk 卷[1 分]</h3><p>使用镜像 fedora-virt:v1.0 在 default 命名空间下创建一台 vmi，名称为 vmi-fedora，并使用 emptyDisk 卷为 vmi 挂载一块 2G 的磁盘。完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<p>把上题的磁盘改为2G即可</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: kubevirt.io/v1</span><br><span class="line">kind: VirtualMachine</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    kubevirt.io/vm: vm<span class="literal">-fedora</span></span><br><span class="line">  name: vm<span class="literal">-fedora</span></span><br><span class="line">spec:</span><br><span class="line">  running: false</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        kubevirt.io/vm: vm<span class="literal">-fedora</span></span><br><span class="line">    spec:</span><br><span class="line">      domain:</span><br><span class="line">        resources:</span><br><span class="line">          requests:</span><br><span class="line">            memory: <span class="number">2</span><span class="built_in">Gi</span></span><br><span class="line">        devices:</span><br><span class="line">          disks:</span><br><span class="line">          - name: containerdisk</span><br><span class="line">            disk:</span><br><span class="line">              bus: virtio</span><br><span class="line">      volumes:</span><br><span class="line">      - name: containerdisk</span><br><span class="line">        containerDisk:</span><br><span class="line">          image: fedora<span class="literal">-virt</span>:v1.<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>1.VMI 创建成功得 0.4 分；<br>2.卷挂载成功得 0.6 分。</p>
<h3 id="【题目-3】KubeVirt-运维–创建-VMI-1-5-分"><a href="#【题目-3】KubeVirt-运维–创建-VMI-1-5-分" class="headerlink" title="【题目 3】KubeVirt 运维–创建 VMI[1.5 分]"></a>【题目 3】KubeVirt 运维–创建 VMI[1.5 分]</h3><p>将提供的镜像 exam.qcow2 转换为 docker 镜像 exam:v1.0，然后使用镜像 exam:v1.0 镜像在 default 命名空间下创建一台 vmi，名称为 exam，将虚拟机的 80 端口以 NodePort 的方式对外暴露为 30082，并使用数据源在启动时将 VM 的主机名初始化为exam。<br>完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<p>1.qcow2 镜像转化成功得 0.3 分；<br>2.VMI 创建成功得 0.3 分；<br>3.端口暴露成功得 0.3 分；<br>4.服务能正常访问得 0.4 分；<br>5.主机名初始化成功得 0.2 分。</p>
<h3 id="【题目-4】KubeVirt-运维–启用快照-1-分"><a href="#【题目-4】KubeVirt-运维–启用快照-1-分" class="headerlink" title="【题目 4】KubeVirt 运维–启用快照[1 分]"></a>【题目 4】KubeVirt 运维–启用快照[1 分]</h3><p>KubeVirt 支持对 VM 进行快照，请启用KubeVirt 快照管理功能： 完成后提交 master 节点的 IP 地址、用户名和密码到答题框。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 参考官网http://kubevirt.io/user-guide/operations/snapshot_restore_api/</span></span><br></pre></td></tr></table></figure>

<p>1.快照功能启用成功得 1 分。</p>
<h2 id="【任务-6】容器云运维开发：Kubernetes-APIs-运维开发-10-分"><a href="#【任务-6】容器云运维开发：Kubernetes-APIs-运维开发-10-分" class="headerlink" title="【任务 6】容器云运维开发：Kubernetes APIs 运维开发[10 分]"></a>【任务 6】容器云运维开发：Kubernetes APIs 运维开发[10 分]</h2><h3 id="【题目-1】Python-运维开发：基于-Kubernetes-Restful-API-实现-Deployment-创建-2-分"><a href="#【题目-1】Python-运维开发：基于-Kubernetes-Restful-API-实现-Deployment-创建-2-分" class="headerlink" title="【题目 1】Python 运维开发：基于 Kubernetes Restful API 实现 Deployment 创建[2 分]"></a>【题目 1】Python 运维开发：基于 Kubernetes Restful API 实现 Deployment 创建[2 分]</h3><p>在提供的OpenStack 私有云平台上，使用 k8s-python-dev 镜像创建 1 台云主机，云主机类型使用 4vCPU&#x2F;12G 内存&#x2F;100G 硬盘。该主机中已经默认安装了所需的开发环境，登录默认账号密码为“root&#x2F;1DaoYun@2022”。<br>使用Kubernetes Restful API 库，在&#x2F;root 目录下，创建 api_deployment_manager.py 文件， 要求编写 python 代码，代码实现以下任务：<br>（1）编写 Python 程序实现 Deployment 资源的创建。Deployment 配置信息如下。如果同名Deployment 存在，先删除再创建。<br>（2）创建完成后，查询该Deployment 的详细信息，执行结果控制台输出，以yaml 格式展示。<br>创建Deployment 的yaml 的配置如下：</p>
<h2 id="apiVersion-apps-v1-kind-Deployment-metadata-name-nginx-deployment-labels-app-nginx-spec-replicas-3-selector-matchLabels-app-nginxtemplate-metadata-labels-app-nginx-spec-containers-name-nginximage-nginx-1-15-4-ports-containerPort-80"><a href="#apiVersion-apps-v1-kind-Deployment-metadata-name-nginx-deployment-labels-app-nginx-spec-replicas-3-selector-matchLabels-app-nginxtemplate-metadata-labels-app-nginx-spec-containers-name-nginximage-nginx-1-15-4-ports-containerPort-80" class="headerlink" title="apiVersion: apps&#x2F;v1 kind: Deployment metadata:name: nginx-deployment labels:app: nginx spec:replicas: 3 selector:matchLabels: app: nginxtemplate: metadata:labels:app: nginx spec:containers:- name: nginximage: nginx:1.15.4 ports:- containerPort: 80"></a>apiVersion: apps&#x2F;v1 kind: Deployment metadata:<br>name: nginx-deployment labels:<br>app: nginx spec:<br>replicas: 3 selector:<br>matchLabels: app: nginx<br>template: metadata:<br>labels:<br>app: nginx spec:<br>containers:<br>- name: nginx<br>image: nginx:1.15.4 ports:<br>- containerPort: 80</h2><p>1.执行api_deployment_manager.py 脚本，成功创建 deployment 资源，计 1 分；<br>2.检查创建的 deployment 资源，配置信息无误计 1 分。</p>
<h3 id="【题目-2】Python-运维开发：基于-Kubernetes-Python-SDK-实现-Job-创建-1-分"><a href="#【题目-2】Python-运维开发：基于-Kubernetes-Python-SDK-实现-Job-创建-1-分" class="headerlink" title="【题目 2】Python 运维开发：基于 Kubernetes Python SDK 实现 Job 创建[1 分]"></a>【题目 2】Python 运维开发：基于 Kubernetes Python SDK 实现 Job 创建[1 分]</h3><p>在前面已建好的 Kubernetes 开发环境云平台上。使用 Kubernetes python SDK 的“kubernetes”Python 库，在&#x2F;root 目录下，创建 sdk_job_manager.py 文件，要求编写 python 代码，代码实现以下任务：<br>（1）编写 Python 程序实现 Job 资源的创建。Job 配置信息如下。如果同名 Job 存在， 先删除再创建。<br>（2）创建完成后，查询该 Job 的详细信息，执行结果控制台输出，以 json 格式展示。<br>Job 创建 yaml 的信息如下：</p>
<p>apiVersion: batch&#x2F;v1 kind: Job<br>metadata: name: pi<br>spec:<br>template: spec:<br>containers:</p>
<ul>
<li>name: pi image: perl<br>command: [“perl”,	“-Mbignum&#x3D;bpi”, “-wle”, “print bpi(2000)”] restartPolicy: Never<br>backoffLimit: 4</li>
</ul>
<p>1.执行 sdk_job_manager.py 脚本，成功创建job 资源，计 0.5 分；<br>2.查询 job 资源，配置信息无误，计 0.5 分。</p>
<h3 id="【题目-3】Python-运维开发：Pod-资源的-Restful-APIs-HTTP-服务封装-3-分"><a href="#【题目-3】Python-运维开发：Pod-资源的-Restful-APIs-HTTP-服务封装-3-分" class="headerlink" title="【题目 3】Python 运维开发：Pod 资源的 Restful APIs HTTP 服务封装[3 分]"></a>【题目 3】Python 运维开发：Pod 资源的 Restful APIs HTTP 服务封装[3 分]</h3><p>编写 Python 程序实现Pod 资源管理程序，将 Pod 资源管理的封装成Web 服务。</p>
<p>在&#x2F;root 目录下创建pod_server.py 程序，实现Pod 的增删查改等Web 访问操作。http.server 的 host 为 localhost，端口 8889；程序内部实现Kubernetes 认证。<br>提示说明：Python 标准库http.server 模块，提供了HTTP Server 请求封装。需要实现的 Restful API 接口如下：<br>GET &#x2F;pod&#x2F;{name} ，查询指定名称{name}的 Pod；Response 的 Body 以 json 格式输出。<br>POST &#x2F;pod&#x2F;{yamlfilename} 创建 yaml 文件名称为{yamlfilename}的 Pod；Response 的<br>Body 以 json 格式。<br>编码完成后，“手工下载”文件服务器主目录所有*.yaml 文件到 root 目录下，“手动执行”所编写pod_server.py 程序，提交答案进行检测。</p>
<p>1.HTTP 服务成功启动，计 1 分；<br>2.发起指定参数的GET 查询 Pod 请求，成功查询指定名称的 pod 服务，计 1 分；<br>3.发起指定参数的 POST 创建 Pod 请求，成功创建 Pod 服务，计 1 分。</p>
<h3 id="【题目-4】Python-运维开发：Service-资源-Restful-APIs-HTTP-服务封装-4-分"><a href="#【题目-4】Python-运维开发：Service-资源-Restful-APIs-HTTP-服务封装-4-分" class="headerlink" title="【题目 4】Python 运维开发：Service 资源 Restful APIs HTTP 服务封装[4 分]"></a>【题目 4】Python 运维开发：Service 资源 Restful APIs HTTP 服务封装[4 分]</h3><p>编写 Python 程序实现 Service 资源管理程序，将 Service 资源管理的封装成 Web 服务。在&#x2F;root 目录下创建 service_server.py 程序，实现 Service 的增删查改等 Web 访问操作。<br>http.server 的 host 为 localhost，端口 8888；程序内部实现Kubernetes 认证。</p>
<p>提示说明：Python 标准库http.server 模块，提供了HTTP Server 请求封装。需要实现的 Restful API 接口如下：<br>GET &#x2F;services&#x2F;{name}，查询指定名称{name}的 Service；Response 的 Body 以 json 格式输出。<br>POST &#x2F;services&#x2F;{yamlfilename} 创建yaml 文件名称为{yamlfilename}的 Service； Response 的Body 以 json 格式，（手工将文件服务器主目录所有*.yaml 文件下载到 root 目录下）。<br>DELETE &#x2F;services&#x2F;{name}；删除指定名称的 Service；Response 的 Body 以 json 格式。编码完成后，自己手动执行提供 Web HTTP 服务的 service_server.py 程序，提交答案进<br>行检测。</p>
<p>1.HTTP 服务成功启动，计 1 分；<br>2.发起指定参数的 POST 创建 service 请求，成功创建 service 资源，计 1 分；<br>3.发起指定参数的GET 查询 service 请求，成功查询指定名称的 Service，计 1 分；<br>4.发起指定参数的DELETE 删除 service 请求，成功删除指定名称的 Service，计 1 分</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz">GoldY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz/posts/9bf3df10.html">https://www.geekgold.xyz/posts/9bf3df10.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.geekgold.xyz" target="_blank">GoldY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/">云计算职业技能大赛</a></div><div class="post-share"><div class="social-share" data-image="/img/cloud-com.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src="/img/zhifubao.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/6bf8b7d7.html" title="云计算方向-2022年云计算职业技能大赛国赛题"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">云计算方向-2022年云计算职业技能大赛国赛题</div></div><div class="info-2"><div class="info-item-1">第一套【任务 1】私有云服务搭建[10分]【题目 1】基础环境配置[0.5 分]使用提供的用户名密码，登录提供的 OpenStack 私有云平台，在当前租户下，使用CentOS7.9 镜像，创建两台云主机，云主机类型使用 4vCPU&#x2F;12G&#x2F;100G_50G 类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至 controller 和 compute 节点（第二张网卡的网段为 10.10.X.0&#x2F;24，X 为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与 ssh 连接，然后按以下要求配置服务器： （1）设置控制节点主机名为 controller，设置计算节点主机名为 compute；  （2）修改 hosts 文件将 IP 地址映射为主机名； 1231.查看控制节点名字为 controller 正确计 0.2 分2.查看 hosts 文件中有正确的主机名和 IP 映射计 0.2 分3.控制节点正确使用两块网卡计 0.1...</div></div></div></a><a class="pagination-related" href="/posts/2c8237f4.html" title="云计算方向-2022年云计算技能国赛私有云套题"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">云计算方向-2022年云计算技能国赛私有云套题</div></div><div class="info-2"><div class="info-item-1">第一套私有云运维任务：题目3. OpenStack云平台运维（10分）1.使用提供的云安全框架组件，将提供的OpenStack云平台的安全策略从http优化至https。可能会遇到 mod_ssl 安装不成功的问题，原因是mod_ssl版本不匹配，上传mod_ssl-2.4.6-97.el7.centos.x86_64.rpm ①安装工具包 1yum install -y mod_wsgi httpd mod_ssl  ②修改&#x2F;etc&#x2F;openstack-dashboard&#x2F;local_settings文件 123456vi /etc/openstack-dashboard/local_settings##在DEBUG = False下增加4行USE_SSL = TrueCSRF_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_HTTPONLY =...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/6bf8b7d7.html" title="云计算方向-2022年云计算职业技能大赛国赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算职业技能大赛国赛题</div></div><div class="info-2"><div class="info-item-1">第一套【任务 1】私有云服务搭建[10分]【题目 1】基础环境配置[0.5 分]使用提供的用户名密码，登录提供的 OpenStack 私有云平台，在当前租户下，使用CentOS7.9 镜像，创建两台云主机，云主机类型使用 4vCPU&#x2F;12G&#x2F;100G_50G 类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至 controller 和 compute 节点（第二张网卡的网段为 10.10.X.0&#x2F;24，X 为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与 ssh 连接，然后按以下要求配置服务器： （1）设置控制节点主机名为 controller，设置计算节点主机名为 compute；  （2）修改 hosts 文件将 IP 地址映射为主机名； 1231.查看控制节点名字为 controller 正确计 0.2 分2.查看 hosts 文件中有正确的主机名和 IP 映射计 0.2 分3.控制节点正确使用两块网卡计 0.1...</div></div></div></a><a class="pagination-related" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</div></div><div class="info-2"><div class="info-item-1">A场次题目：Openstack 平台部署与运维任务1 私有云平台环境初始化1.初始化操作系统 使用提供的用户名密码，登录竞赛云平台。根据表 1 中的 IP 地址规划，设置各服务器节点的 IP 地址，确保网络正常通信，设置控制节点主机名为 Contro ller，计算节点主机名为 Compute，并修改 hosts 文件将 IP 地址映射为主机名， 关闭防火墙并设置为开机不启动，设置 SELinux 为 Permissive 模式并设置永久 关闭。请查看控制节点和计算节点主机名，使用命令查看 SELinux 状态，使用 head 命令、tail 命令和 cut 命令提取出永久关闭 SELinux 的关键信息。 将以上命令及返回结果提交到答题框  配置host 123456vi /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6...</div></div></div></a><a class="pagination-related" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-Ansible搭建wordpress</div></div><div class="info-2"><div class="info-item-1">一.ansible搭建wordpress基于lamp构建wordpress    master 192.168.200.100 控制节点    node1 192.168.200.101 web服务器   node2 192.168.200.102 mysql服务器   vi &#x2F;etc&#x2F;ansible&#x2F;host 12345678[master]master[web]192.168.200.101node1[database]192.168.200.102node2  vi wordpress.yaml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354---# hosts: 后面可写主机组名或主机名- hosts: all  remote_user: root  # 定义变量  vars:    db_pkgs:      # 以下的-为变量“值”，也就是在引用db_pkgs变量时，可取变量中的值   ...</div></div></div></a><a class="pagination-related" href="/posts/840d388d.html" title="云计算方向-2023年金砖大赛山东选拔题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖大赛山东选拔题</div></div><div class="info-2"><div class="info-item-1">A场次题目：OpenStack平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化，弹性分配，集中管理，性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：    设备名称 主机名 接口 ip地址    云服务器1 controller eth0，eth1 私网：192.168.100.10&#x2F;24           私网：192.168.200.10&#x2F;24   云服务器2 compute eth0，eth1 私网：192.168.100.20&#x2F;24        ...</div></div></div></a><a class="pagination-related" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年GZ075 云计算应用赛项赛题</div></div><div class="info-2"><div class="info-item-1">模块一 私有云（30分）企业首先完成私有云平台搭建和运维，私有云平台提供云主机、云网络、云存储等基础架构云服务，并开发自动化运维程序。 任务1 私有云服务搭建（5分）1.1.1 基础环境配置1.控制节点主机名为controller，设置计算节点主机名为compute； 12345678910#控制节点[root@localhost ~]# hostnamectl set-hostname controller[root@localhost ~]# bash[root@controller ~]##计算节点[root@localhost ~]# hostnamectl set-hostname compute[root@localhost ~]# bash[root@compute ~]#    2.hosts文件将IP地址映射为主机名。 123456#全部节点[root@controller ~]# cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4...</div></div></div></a><a class="pagination-related" href="/posts/2c8237f4.html" title="云计算方向-2022年云计算技能国赛私有云套题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算技能国赛私有云套题</div></div><div class="info-2"><div class="info-item-1">第一套私有云运维任务：题目3. OpenStack云平台运维（10分）1.使用提供的云安全框架组件，将提供的OpenStack云平台的安全策略从http优化至https。可能会遇到 mod_ssl 安装不成功的问题，原因是mod_ssl版本不匹配，上传mod_ssl-2.4.6-97.el7.centos.x86_64.rpm ①安装工具包 1yum install -y mod_wsgi httpd mod_ssl  ②修改&#x2F;etc&#x2F;openstack-dashboard&#x2F;local_settings文件 123456vi /etc/openstack-dashboard/local_settings##在DEBUG = False下增加4行USE_SSL = TrueCSRF_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_HTTPONLY =...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">GoldY</div><div class="author-info-description">不经一番寒彻骨，怎得梅花扑鼻香。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuwenjin666"><i class="fab fa-github"></i><span>Github主页</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">联系我V：GoldY_66</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%90%E4%BB%BB%E5%8A%A1-1%E3%80%91%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA-5-%E5%88%86"><span class="toc-number">1.</span> <span class="toc-text">【任务 1】容器云平台搭建[5 分]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-1%E3%80%91%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E2%80%93%E9%83%A8%E7%BD%B2%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0-1-5-%E5%88%86"><span class="toc-number">1.1.</span> <span class="toc-text">【题目 1】平台部署–部署容器云平台[1.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-2%E3%80%91%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E2%80%93%E9%83%A8%E7%BD%B2-Istio-%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC-0-5-%E5%88%86"><span class="toc-number">1.2.</span> <span class="toc-text">【题目 2】平台部署–部署 Istio 服务网格[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-3%E3%80%91%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E2%80%93%E9%83%A8%E7%BD%B2-KubeVirt-%E8%99%9A%E6%8B%9F%E5%8C%96-1-%E5%88%86"><span class="toc-number">1.3.</span> <span class="toc-text">【题目 3】平台部署–部署 KubeVirt 虚拟化[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-4%E3%80%91%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E2%80%93%E9%83%A8%E7%BD%B2-Harbor-%E4%BB%93%E5%BA%93%E5%8F%8AHelm-%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-1-%E5%88%86"><span class="toc-number">1.4.</span> <span class="toc-text">【题目 4】平台部署–部署 Harbor 仓库及Helm 包管理工具[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-5%E3%80%91%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E2%80%93%E5%A4%87%E4%BB%BD-ETCD-%E6%95%B0%E6%8D%AE-1-%E5%88%86"><span class="toc-number">1.5.</span> <span class="toc-text">【题目 5】集群管理–备份 ETCD 数据[1 分]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%90%E4%BB%BB%E5%8A%A1-2%E3%80%91%E5%AE%B9%E5%99%A8%E4%BA%91%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2%EF%BC%9ADocker-Compose-%E7%BC%96%E6%8E%92%E9%83%A8%E7%BD%B2-7-0-%E5%88%86"><span class="toc-number">2.</span> <span class="toc-text">【任务 2】容器云应用部署：Docker Compose 编排部署[7.0 分]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-1%E3%80%91%E5%AE%B9%E5%99%A8%E5%8C%96-MariaDB-%E6%9C%8D%E5%8A%A1-1-%E5%88%86"><span class="toc-number">2.1.</span> <span class="toc-text">【题目 1】容器化 MariaDB 服务[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-3%E3%80%91%E5%AE%B9%E5%99%A8%E5%8C%96Nginx-%E6%9C%8D%E5%8A%A1-0-5-%E5%88%86"><span class="toc-number">2.2.</span> <span class="toc-text">【题目 3】容器化Nginx 服务[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-4%E3%80%91%E5%AE%B9%E5%99%A8%E5%8C%96Hyperf-%E6%9C%8D%E5%8A%A1-1-%E5%88%86"><span class="toc-number">2.3.</span> <span class="toc-text">【题目 4】容器化Hyperf 服务[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-5%E3%80%91%E7%BC%96%E6%8E%92%E9%83%A8%E7%BD%B2Hyperf-%E6%A1%86%E6%9E%B6-3-5-%E5%88%86"><span class="toc-number">2.4.</span> <span class="toc-text">【题目 5】编排部署Hyperf 框架[3.5 分]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%90%E4%BB%BB%E5%8A%A1-3%E3%80%91%E5%AE%B9%E5%99%A8%E4%BA%91%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2%EF%BC%9A%E5%9F%BA%E4%BA%8E-Kubernetes-%E6%9E%84%E5%BB%BA-CICD-8-0-%E5%88%86"><span class="toc-number">3.</span> <span class="toc-text">【任务 3】容器云应用部署：基于 Kubernetes 构建 CICD[8.0 分]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-1%E3%80%91%E5%AE%89%E8%A3%85GitLab-%E7%8E%AF%E5%A2%83-1-%E5%88%86"><span class="toc-number">3.1.</span> <span class="toc-text">【题目 1】安装GitLab 环境[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-2%E3%80%91%E9%83%A8%E7%BD%B2GitLab-Runner-2-%E5%88%86"><span class="toc-number">3.2.</span> <span class="toc-text">【题目 2】部署GitLab Runner[2 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-3%E3%80%91%E9%85%8D%E7%BD%AEGitLab-1-5-%E5%88%86"><span class="toc-number">3.3.</span> <span class="toc-text">【题目 3】配置GitLab[1.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-4%E3%80%91%E6%9E%84%E5%BB%BACICD-3-5-%E5%88%86"><span class="toc-number">3.4.</span> <span class="toc-text">【题目 4】构建CICD[3.5 分]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%90%E4%BB%BB%E5%8A%A1-4%E3%80%91%E5%AE%B9%E5%99%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4%EF%BC%9AKubernetes-%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84%E8%BF%90%E7%BB%B4-6-%E5%88%86"><span class="toc-number">4.</span> <span class="toc-text">【任务 4】容器云服务运维：Kubernetes 基于容器的运维[6 分]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-1%E3%80%91Pod-%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA-Pod-0-5-%E5%88%86"><span class="toc-number">4.1.</span> <span class="toc-text">【题目 1】Pod 管理–创建 Pod[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-2%E3%80%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E2%80%93%E9%85%8D%E7%BD%AE-Pod-%E5%AE%89%E5%85%A8%E4%B8%8A%E4%B8%8B%E6%96%87-0-5-%E5%88%86"><span class="toc-number">4.2.</span> <span class="toc-text">【题目 2】安全管理–配置 Pod 安全上下文[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-3%E3%80%91CRD-%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B5%84%E6%BA%90%E7%B1%BB%E5%9E%8B-0-5-%E5%88%86"><span class="toc-number">4.3.</span> <span class="toc-text">【题目 3】CRD 管理–创建自定义资源类型[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-4%E3%80%91%E8%A7%A3%E6%9E%90%E7%AE%A1%E7%90%86%E2%80%93%E6%B7%BB%E5%8A%A0%E4%B8%BB%E6%9C%BA%E5%88%AB%E5%90%8D%E5%88%B0-Pod-0-5-%E5%88%86"><span class="toc-number">4.4.</span> <span class="toc-text">【题目 4】解析管理–添加主机别名到 Pod[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-5%E3%80%91HPA-%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA-HPA-%E8%A7%84%E5%88%99-1-%E5%88%86"><span class="toc-number">4.5.</span> <span class="toc-text">【题目 5】HPA 管理–创建 HPA 规则[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-6%E3%80%91%E8%8A%82%E7%82%B9%E4%BA%B2%E5%92%8C%E6%80%A7%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA%E7%A1%AC%E9%99%90%E5%88%B6%E8%A7%84%E5%88%99%E7%9A%84-Pod-0-5-%E5%88%86"><span class="toc-number">4.6.</span> <span class="toc-text">【题目 6】节点亲和性管理–创建硬限制规则的 Pod[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-7%E3%80%91%E7%BD%91%E7%BB%9C%E7%AD%96%E7%95%A5%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA-Pod-%E7%BD%91%E7%BB%9C%E7%AD%96%E7%95%A5-0-5-%E5%88%86"><span class="toc-number">4.7.</span> <span class="toc-text">【题目 7】网络策略管理–创建 Pod 网络策略[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-8%E3%80%91%E9%A9%B1%E9%80%90%E6%9C%BA%E5%88%B6%E7%AE%A1%E7%90%86%E2%80%93%E9%85%8D%E7%BD%AE%E8%8A%82%E7%82%B9%E5%8E%8B%E5%8A%9B%E9%A9%B1%E9%80%90-0-5-%E5%88%86"><span class="toc-number">4.8.</span> <span class="toc-text">【题目 8】驱逐机制管理–配置节点压力驱逐[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-9%E3%80%91%E6%B5%81%E9%87%8F%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA-Ingress-Gateway-0-5-%E5%88%86"><span class="toc-number">4.9.</span> <span class="toc-text">【题目 9】流量管理–创建 Ingress Gateway[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-10%E3%80%91%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E2%80%93%E5%88%9B%E5%BB%BA%E5%9F%BA%E4%BA%8E%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E7%9A%84%E8%B7%AF%E7%94%B1-0-5-%E5%88%86"><span class="toc-number">4.10.</span> <span class="toc-text">【题目 10】服务网格–创建基于用户身份的路由[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-11%E3%80%91%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E2%80%93%E5%88%9B%E5%BB%BA%E8%AF%B7%E6%B1%82%E8%B7%AF%E7%94%B1-0-5-%E5%88%86"><span class="toc-number">4.11.</span> <span class="toc-text">【题目 11】服务网格–创建请求路由[0.5 分]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%90%E4%BB%BB%E5%8A%A1-5%E3%80%91%E5%AE%B9%E5%99%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4%EF%BC%9AKubernetes-%E5%9F%BA%E4%BA%8E%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E8%BF%90%E7%BB%B4-4-0-%E5%88%86"><span class="toc-number">5.</span> <span class="toc-text">【任务 5】容器云服务运维：Kubernetes  基于虚拟机的运维[4.0 分]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-1%E3%80%91VM-%E7%AE%A1%E7%90%86%E2%80%93%E5%88%9B%E5%BB%BA-VM-0-5-%E5%88%86"><span class="toc-number">5.1.</span> <span class="toc-text">【题目 1】VM 管理–创建 VM[0.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-2%E3%80%91%E5%AD%98%E5%82%A8%E4%B8%8E%E5%8D%B7%E2%80%93%E5%88%9B%E5%BB%BA-emptyDisk-%E5%8D%B7-1-%E5%88%86"><span class="toc-number">5.2.</span> <span class="toc-text">【题目 2】存储与卷–创建 emptyDisk 卷[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-3%E3%80%91KubeVirt-%E8%BF%90%E7%BB%B4%E2%80%93%E5%88%9B%E5%BB%BA-VMI-1-5-%E5%88%86"><span class="toc-number">5.3.</span> <span class="toc-text">【题目 3】KubeVirt 运维–创建 VMI[1.5 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-4%E3%80%91KubeVirt-%E8%BF%90%E7%BB%B4%E2%80%93%E5%90%AF%E7%94%A8%E5%BF%AB%E7%85%A7-1-%E5%88%86"><span class="toc-number">5.4.</span> <span class="toc-text">【题目 4】KubeVirt 运维–启用快照[1 分]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%90%E4%BB%BB%E5%8A%A1-6%E3%80%91%E5%AE%B9%E5%99%A8%E4%BA%91%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%9AKubernetes-APIs-%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91-10-%E5%88%86"><span class="toc-number">6.</span> <span class="toc-text">【任务 6】容器云运维开发：Kubernetes APIs 运维开发[10 分]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-1%E3%80%91Python-%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%9A%E5%9F%BA%E4%BA%8E-Kubernetes-Restful-API-%E5%AE%9E%E7%8E%B0-Deployment-%E5%88%9B%E5%BB%BA-2-%E5%88%86"><span class="toc-number">6.1.</span> <span class="toc-text">【题目 1】Python 运维开发：基于 Kubernetes Restful API 实现 Deployment 创建[2 分]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#apiVersion-apps-v1-kind-Deployment-metadata-name-nginx-deployment-labels-app-nginx-spec-replicas-3-selector-matchLabels-app-nginxtemplate-metadata-labels-app-nginx-spec-containers-name-nginximage-nginx-1-15-4-ports-containerPort-80"><span class="toc-number">7.</span> <span class="toc-text">apiVersion: apps&#x2F;v1 kind: Deployment metadata:name: nginx-deployment labels:app: nginx spec:replicas: 3 selector:matchLabels: app: nginxtemplate: metadata:labels:app: nginx spec:containers:- name: nginximage: nginx:1.15.4 ports:- containerPort: 80</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-2%E3%80%91Python-%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%9A%E5%9F%BA%E4%BA%8E-Kubernetes-Python-SDK-%E5%AE%9E%E7%8E%B0-Job-%E5%88%9B%E5%BB%BA-1-%E5%88%86"><span class="toc-number">7.1.</span> <span class="toc-text">【题目 2】Python 运维开发：基于 Kubernetes Python SDK 实现 Job 创建[1 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-3%E3%80%91Python-%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%9APod-%E8%B5%84%E6%BA%90%E7%9A%84-Restful-APIs-HTTP-%E6%9C%8D%E5%8A%A1%E5%B0%81%E8%A3%85-3-%E5%88%86"><span class="toc-number">7.2.</span> <span class="toc-text">【题目 3】Python 运维开发：Pod 资源的 Restful APIs HTTP 服务封装[3 分]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E9%A2%98%E7%9B%AE-4%E3%80%91Python-%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%EF%BC%9AService-%E8%B5%84%E6%BA%90-Restful-APIs-HTTP-%E6%9C%8D%E5%8A%A1%E5%B0%81%E8%A3%85-4-%E5%88%86"><span class="toc-number">7.3.</span> <span class="toc-text">【题目 4】Python 运维开发：Service 资源 Restful APIs HTTP 服务封装[4 分]</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-Ansible搭建wordpress"/></a><div class="content"><a class="title" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress">云计算方向-Ansible搭建wordpress</a><time datetime="2025-05-14T02:48:38.000Z" title="发表于 2025-05-14 10:48:38">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"/></a><div class="content"><a class="title" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</a><time datetime="2025-05-14T02:48:37.000Z" title="发表于 2025-05-14 10:48:37">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年一带一路职业技能大赛云计算(样题)"/></a><div class="content"><a class="title" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)">云计算方向-2023年一带一路职业技能大赛云计算(样题)</a><time datetime="2025-05-14T02:48:35.000Z" title="发表于 2025-05-14 10:48:35">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖大赛"/></a><div class="content"><a class="title" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛">云计算方向-2023年金砖大赛</a><time datetime="2025-05-14T02:48:32.000Z" title="发表于 2025-05-14 10:48:32">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年GZ075 云计算应用赛项赛题"/></a><div class="content"><a class="title" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题">云计算方向-2023年GZ075 云计算应用赛项赛题</a><time datetime="2025-05-14T02:47:38.000Z" title="发表于 2025-05-14 10:47:38">2025-05-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/bottom-bg.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2025 By GoldY</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=yuwenjin666";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="yuwenjin666";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/about'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>