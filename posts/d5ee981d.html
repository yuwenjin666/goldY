<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>云计算方向-2023年一带一路职业技能大赛云计算(样题) | GoldY</title><meta name="author" content="GoldY"><meta name="copyright" content="GoldY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2023年一带一路职业技能大赛云计算(样题)">
<meta property="og:type" content="article">
<meta property="og:title" content="云计算方向-2023年一带一路职业技能大赛云计算(样题)">
<meta property="og:url" content="https://www.geekgold.xyz/posts/d5ee981d.html">
<meta property="og:site_name" content="GoldY">
<meta property="og:description" content="2023年一带一路职业技能大赛云计算(样题)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.geekgold.xyz/img/cloud-com.jpg">
<meta property="article:published_time" content="2025-05-14T02:48:35.000Z">
<meta property="article:modified_time" content="2025-05-14T03:16:03.868Z">
<meta property="article:author" content="GoldY">
<meta property="article:tag" content="云计算">
<meta property="article:tag" content="云计算职业技能大赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.geekgold.xyz/img/cloud-com.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "云计算方向-2023年一带一路职业技能大赛云计算(样题)",
  "url": "https://www.geekgold.xyz/posts/d5ee981d.html",
  "image": "https://www.geekgold.xyz/img/cloud-com.jpg",
  "datePublished": "2025-05-14T02:48:35.000Z",
  "dateModified": "2025-05-14T03:16:03.868Z",
  "author": [
    {
      "@type": "Person",
      "name": "GoldY",
      "url": "https://www.geekgold.xyz/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.geekgold.xyz/posts/d5ee981d.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="bing-site-verification" content="E05CD8D6921B8F2AA32324DF2B267557"/><meta name="baidu-site-verification" content="codeva-tCktTl1n17"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '云计算方向-2023年一带一路职业技能大赛云计算(样题)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cloud-com.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.png" alt="Logo"><span class="site-name">GoldY</span></a><a class="nav-page-title" href="/"><span class="site-name">云计算方向-2023年一带一路职业技能大赛云计算(样题)</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-link"></i><span> 工具链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa fa-cog"></i><span> 渗透工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">云计算方向-2023年一带一路职业技能大赛云计算(样题)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-14T02:48:35.000Z" title="发表于 2025-05-14 10:48:35">2025-05-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-14T03:16:03.868Z" title="更新于 2025-05-14 11:16:03">2025-05-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E6%B1%87%E6%80%BB/">技能大赛汇总</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">14.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>73分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="A模块题目OpenStack平台部署与运维"><a href="#A模块题目OpenStack平台部署与运维" class="headerlink" title="A模块题目OpenStack平台部署与运维"></a>A模块题目OpenStack平台部署与运维</h1><h2 id="任务-1-私有云平台环境初始化（6-分）"><a href="#任务-1-私有云平台环境初始化（6-分）" class="headerlink" title="任务 1 私有云平台环境初始化（6 分）"></a>任务 1 私有云平台环境初始化（6 分）</h2><table>
<thead>
<tr>
<th>IP</th>
<th>主机名</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.157.30</td>
<td>controller</td>
</tr>
<tr>
<td>192.168.157.31</td>
<td>compute</td>
</tr>
</tbody></table>
<h3 id="1-配置主机名"><a href="#1-配置主机名" class="headerlink" title="1.配置主机名"></a>1.配置主机名</h3><p> 把 controller 节点主机名设置为 controller, compute 节点主机名设置为 compute。</p>
<p> 分别在 controller 节点和 compute 节点将 hostname 命令的返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# hostname</span><br><span class="line">controller</span><br><span class="line"></span><br><span class="line">[root@compute ~]# hostname</span><br><span class="line">compute</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname controller</span><br><span class="line"></span><br><span class="line">hostnamectl set-hostname compute</span><br></pre></td></tr></table></figure>

<h3 id="2-配置-hosts-文件"><a href="#2-配置-hosts-文件" class="headerlink" title="2.配置 hosts 文件"></a>2.配置 hosts 文件</h3><p>分别在 controller 节点和 compute 节点修改 hosts 文件将 IP 地址映射为主机名。</p>
<p>请在 controller 节点将 cat &#x2F;etc&#x2F;hosts 命令的返回结果提交到答题框。 【0.5 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.157.30 controller</span><br><span class="line">192.168.157.31 compute</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@compute ~]# <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.157.30 controller</span><br><span class="line">192.168.157.31 compute</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-挂载光盘镜像"><a href="#3-挂载光盘镜像" class="headerlink" title="3.挂载光盘镜像"></a>3.挂载光盘镜像</h3><p>将提供的 CentOS-7-x86_64-DVD-1804.iso 和 bricsskills_cloud_iaas.iso 光盘镜像移动到</p>
<p>controller 节点 &#x2F;root 目录下，然后在 &#x2F;opt 目录下使用命令创建 centos 目录和 iaas 目录，</p>
<p>并将镜像文件 centOS-7-x86_64-DVD-1804.iso 挂载到 &#x2F;opt&#x2F;centos 目录下，将镜像文件</p>
<p>bricsskills_cloud_iaas.iso 挂载到 &#x2F;iaas 目录下。</p>
<p>请在 controller 节点将 ls &#x2F;opt&#x2F;iaas&#x2F;命令的返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight plaintext"><figcaption><span>~]# ls</span><a href="/opt/iaas/">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iaas-repo  images</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将指定的镜像上传至/root目录下</span></span><br><span class="line"><span class="meta prompt_"> #</span><span class="language-bash">挂载</span></span><br><span class="line"> </span><br><span class="line">[root@controller ~]# cat &gt;&gt; /etc/fstab &lt;&lt; EOF</span><br><span class="line">/root/CentOS-7-x86_64-DVD-1804.iso /opt/centos iso9660 defaults 0 0</span><br><span class="line">/root/chinaskills_cloud_iaas.iso /opt/iaas iso9660 defaults 0 0</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h3 id="4-配置-controller-节点-yum-源"><a href="#4-配置-controller-节点-yum-源" class="headerlink" title="4.配置 controller 节点 yum 源"></a>4.配置 controller 节点 yum 源</h3><p>将 controller 节点原有的 yum 源移动到&#x2F;home 目录，</p>
<p>为 controller 节点创建本地 yum 源，</p>
<p>yum 源文件名为 local.repo。</p>
<p>请将 yum list | grep vsftpd 的返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# yum list | grep vsftpd</span><br><span class="line">vsftpd.x86_64                              3.0.2-22.el7                centos</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">mkdir</span> /home/yum</span><br><span class="line">[root@controller ~]# <span class="built_in">mv</span> /etc/yum.repos.d/* /home/yum</span><br><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/yum.repos.d/local.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///opt/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[iaas]</span><br><span class="line">name=iaas</span><br><span class="line">baseurl=file:///opt/iaas/iaas-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[root@controller ~]# yum repolist</span><br></pre></td></tr></table></figure>

<h3 id="5-搭建-ftp-服务器"><a href="#5-搭建-ftp-服务器" class="headerlink" title="5.搭建 ftp 服务器"></a>5.搭建 ftp 服务器</h3><p>在 controller 节点上安装 vsftp 服务, 将&#x2F;opt 目录设为共享，并设置为开机自启动，然后</p>
<p>重启服务生效。</p>
<p>请将 cat &#x2F;etc&#x2F;vsftpd&#x2F;vsftpd.conf |grep &#x2F;opt 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]#  <span class="built_in">cat</span> /etc/vsftpd/vsftpd.conf |grep /opt</span><br><span class="line">anon_root=/opt</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# yum install -y vsftpd</span><br><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/vsftpd/vsftpd.conf</span><br><span class="line"><span class="comment">#添加</span></span><br><span class="line">anon_root=/opt</span><br><span class="line">[root@controller ~]# systemctl <span class="built_in">enable</span> vsftpd --now</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/vsftpd.service to /usr/lib/systemd/system/vsftpd.service.</span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭防火墙及安全策略</span></span><br><span class="line">[root@controller ~]# systemctl stop firewalld &amp;&amp; systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span><br><span class="line">[root@controller ~]# setenforce 0</span><br><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/selinux/config</span><br><span class="line">SELINUX=permissive</span><br><span class="line"></span><br><span class="line">[root@compute ~]# systemctl stop firewalld &amp;&amp; systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span><br><span class="line">[root@compute ~]# setenforce 0</span><br><span class="line">[root@compute ~]# <span class="built_in">cat</span> /etc/selinux/config</span><br><span class="line">SELINUX=permissive</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-配置-compute-节点-yum-源"><a href="#6-配置-compute-节点-yum-源" class="headerlink" title="6.配置 compute 节点 yum 源"></a>6.配置 compute 节点 yum 源</h3><p>将 compute 节点原有的 yum 源移动到&#x2F;home 目录，为 compute 节点创建 ftp 源，yum 源文件</p>
<p>名为 ftp.repo，其中 ftp 服务器为 controller 节点,配置 ftp 源时不要写 IP 地址。</p>
<p> 请将 yum list | grep xiandian 命令的返回结果提交到答题框【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# yum list | grep xiandian</span><br><span class="line">iaas-xiandian.x86_64                       2.4-2                       iaas-0</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# <span class="built_in">mkdir</span> /home/yum</span><br><span class="line">[root@compute ~]# <span class="built_in">mv</span> /etc/yum.repos.d/* /home/yum</span><br><span class="line">[root@compute ~]# <span class="built_in">cat</span> /etc/yum.repos.d/ftp.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=ftp://controller/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[iaas]</span><br><span class="line">name=iaas</span><br><span class="line">baseurl=ftp://controller/iaas/iaas-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[root@compute ~]# yum repolist</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-分区"><a href="#7-分区" class="headerlink" title="7.分区"></a>7.分区</h3><p>在 compute 节点将 vdb 分为两个区分别为 vdb1 和 vdb2,大小自定义。要求分区格式为 gpt,</p>
<p>使用 mkfs.xfs 命令对文件系统格式化。</p>
<p>请将 lsblk -f 命令的返回结果提交到答题框【1 分】</p>
<p><code>虚拟机没有vdb区,使用sdb分区进行代替</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# lsblk -f</span><br><span class="line">NAME            FSTYPE      LABEL           UUID                                   MOUNTPOINT</span><br><span class="line">sda</span><br><span class="line">├─sda1          xfs                         c2b0cad1-cdef-48c6-adb7-5e4eafaf7458   /boot</span><br><span class="line">└─sda2          LVM2_member                 oiioJ7-K5mu-sPhw-R4Rb-S3yH-fWo9-23G9aY</span><br><span class="line">  ├─centos-root xfs                         e78104be-5c62-4102-b730-f03cde9fa24a   /</span><br><span class="line">  └─centos-swap swap                        74991746-7fc7-4936-a835-4f603f2468c8   [SWAP]</span><br><span class="line">sdb</span><br><span class="line">├─sdb1          xfs                         25a1594a-769d-48ac-966c-d59607cd0bb4</span><br><span class="line">└─sdb2          xfs                         c49808f0-0ac0-4848-957d-e0525f1117b3</span><br><span class="line">sdc</span><br><span class="line">sr0             iso9660     CentOS 7 x86_64 2018-05-03-20-55-23-00</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# yum install -y gdisk</span><br><span class="line">[root@compute ~]# gdisk /dev/sdb</span><br><span class="line">GPT fdisk (gdisk) version 0.8.10</span><br><span class="line"></span><br><span class="line">Partition table scan:</span><br><span class="line">  MBR: not present</span><br><span class="line">  BSD: not present</span><br><span class="line">  APM: not present</span><br><span class="line">  GPT: not present</span><br><span class="line"></span><br><span class="line">Creating new GPT entries.</span><br><span class="line"></span><br><span class="line">Command (? <span class="keyword">for</span> <span class="built_in">help</span>): n</span><br><span class="line">Partition number (1-128, default 1):</span><br><span class="line">First sector (34-41943006, default = 2048) or &#123;+-&#125;size&#123;KMGTP&#125;:</span><br><span class="line">Last sector (2048-41943006, default = 41943006) or &#123;+-&#125;size&#123;KMGTP&#125;: +10G</span><br><span class="line">Current <span class="built_in">type</span> is <span class="string">&#x27;Linux filesystem&#x27;</span></span><br><span class="line">Hex code or GUID (L to show codes, Enter = 8300):</span><br><span class="line">Changed <span class="built_in">type</span> of partition to <span class="string">&#x27;Linux filesystem&#x27;</span></span><br><span class="line"></span><br><span class="line">Command (? <span class="keyword">for</span> <span class="built_in">help</span>): n</span><br><span class="line">Partition number (2-128, default 2):</span><br><span class="line">First sector (34-41943006, default = 20973568) or &#123;+-&#125;size&#123;KMGTP&#125;:</span><br><span class="line">Last sector (20973568-41943006, default = 41943006) or &#123;+-&#125;size&#123;KMGTP&#125;: +10G</span><br><span class="line">Last sector (20973568-41943006, default = 41943006) or &#123;+-&#125;size&#123;KMGTP&#125;:</span><br><span class="line">Current <span class="built_in">type</span> is <span class="string">&#x27;Linux filesystem&#x27;</span></span><br><span class="line">Hex code or GUID (L to show codes, Enter = 8300):</span><br><span class="line">Changed <span class="built_in">type</span> of partition to <span class="string">&#x27;Linux filesystem&#x27;</span></span><br><span class="line"></span><br><span class="line">Command (? <span class="keyword">for</span> <span class="built_in">help</span>): w</span><br><span class="line"></span><br><span class="line">Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING</span><br><span class="line">PARTITIONS!!</span><br><span class="line"></span><br><span class="line">Do you want to proceed? (Y/N): y</span><br><span class="line">OK; writing new GUID partition table (GPT) to /dev/sdb.</span><br><span class="line">The operation has completed successfully.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@compute ~]# mkfs.xfs /dev/sdb1</span><br><span class="line">[root@compute ~]# mkfs.xfs /dev/sdb2</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="8-系统调优-脏数据回写"><a href="#8-系统调优-脏数据回写" class="headerlink" title="8.系统调优-脏数据回写"></a>8.系统调优-脏数据回写</h3><p>Linux 系统内存中会存在脏数据，一般系统默认脏数据占用内存 30%时会回写磁盘，修</p>
<p>改系统配置文件，要求将回写磁盘的大小调整为 60%。</p>
<p>在 controller 节点请将 sysctl -p 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# sysctl -p</span><br><span class="line">vm.dirty_ratio = 60</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/sysctl.conf</span><br><span class="line">vm.dirty_ratio = 60</span><br></pre></td></tr></table></figure>

<h2 id="任务-2-OpenStack-搭建任务（8-分）"><a href="#任务-2-OpenStack-搭建任务（8-分）" class="headerlink" title="任务 2 OpenStack 搭建任务（8 分）"></a>任务 2 OpenStack 搭建任务（8 分）</h2><h3 id="1-修改脚本文件"><a href="#1-修改脚本文件" class="headerlink" title="1.修改脚本文件"></a>1.修改脚本文件</h3><p>在 controller 节点和 compute 节点分别安装 iaas-xiandian 软件包，修改脚本文件基本变</p>
<p>量（脚本文件为&#x2F;etc&#x2F;xiandian&#x2F;openrc.sh），修改完成后使用命令生效该脚本文件。</p>
<p>在 controller 节点请将 echo $INTERFACE_NAME 命令的返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">echo</span> <span class="variable">$INTERFACE_NAME</span></span><br><span class="line">eth36</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#controller节点与compute节点做法相同</span></span><br><span class="line"><span class="comment">#只修改interface_ip和INTERFACE_NAME  即可</span></span><br><span class="line"></span><br><span class="line">[root@controller ~]# yum install -y iaas-xiandian</span><br><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/xiandian/openrc.sh</span><br><span class="line"><span class="comment">#--------------------system Config--------------------##</span></span><br><span class="line"><span class="comment">#Controller Server Manager IP. example:x.x.x.x</span></span><br><span class="line">HOST_IP=192.168.157.30</span><br><span class="line"></span><br><span class="line"><span class="comment">#Controller HOST Password. example:000000</span></span><br><span class="line">HOST_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Controller Server hostname. example:controller</span></span><br><span class="line">HOST_NAME=controller</span><br><span class="line"></span><br><span class="line"><span class="comment">#Compute Node Manager IP. example:x.x.x.x</span></span><br><span class="line">HOST_IP_NODE=192.168.157.31</span><br><span class="line"></span><br><span class="line"><span class="comment">#Compute HOST Password. example:000000</span></span><br><span class="line">HOST_PASS_NODE=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Compute Node hostname. example:compute</span></span><br><span class="line">HOST_NAME_NODE=compute</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Chrony Config-------------------##</span></span><br><span class="line"><span class="comment">#Controller network segment IP.  example:x.x.0.0/16(x.x.x.0/24)</span></span><br><span class="line">network_segment_IP=192.168.157,0/24</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Rabbit Config ------------------##</span></span><br><span class="line"><span class="comment">#user for rabbit. example:openstack</span></span><br><span class="line">RABBIT_USER=openstack</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for rabbit user .example:000000</span></span><br><span class="line">RABBIT_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------MySQL Config---------------------##</span></span><br><span class="line"><span class="comment">#Password for MySQL root user . exmaple:000000</span></span><br><span class="line">DB_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Keystone Config------------------##</span></span><br><span class="line"><span class="comment">#Password for Keystore admin user. exmaple:000000</span></span><br><span class="line">DOMAIN_NAME=demo</span><br><span class="line">ADMIN_PASS=000000</span><br><span class="line">DEMO_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Mysql keystore user. exmaple:000000</span></span><br><span class="line">KEYSTONE_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Glance Config--------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql glance user. exmaple:000000</span></span><br><span class="line">GLANCE_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore glance user. exmaple:000000</span></span><br><span class="line">GLANCE_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Nova Config----------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql nova user. exmaple:000000</span></span><br><span class="line">NOVA_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore nova user. exmaple:000000</span></span><br><span class="line">NOVA_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Neturon Config-------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql neutron user. exmaple:000000</span></span><br><span class="line">NEUTRON_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore neutron user. exmaple:000000</span></span><br><span class="line">NEUTRON_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#metadata secret for neutron. exmaple:000000</span></span><br><span class="line">METADATA_SECRET=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Tunnel Network Interface. example:x.x.x.x</span></span><br><span class="line">INTERFACE_IP=192.168.157.30</span><br><span class="line"></span><br><span class="line"><span class="comment">#External Network Interface. example:eth1</span></span><br><span class="line">INTERFACE_NAME=eth36</span><br><span class="line"></span><br><span class="line"><span class="comment">#External Network The Physical Adapter. example:provider</span></span><br><span class="line">Physical_NAME=provider</span><br><span class="line"></span><br><span class="line"><span class="comment">#First Vlan ID in VLAN RANGE for VLAN Network. exmaple:101</span></span><br><span class="line">minvlan=101</span><br><span class="line"></span><br><span class="line"><span class="comment">#Last Vlan ID in VLAN RANGE for VLAN Network. example:200</span></span><br><span class="line">maxvlan=200</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Cinder Config--------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql cinder user. exmaple:000000</span></span><br><span class="line">CINDER_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore cinder user. exmaple:000000</span></span><br><span class="line">CINDER_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Cinder Block Disk. example:md126p3</span></span><br><span class="line">BLOCK_DISK=sdb1</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Swift Config---------------------##</span></span><br><span class="line"><span class="comment">#Password for Keystore swift user. exmaple:000000</span></span><br><span class="line">SWIFT_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#The NODE Object Disk for Swift. example:md126p4.</span></span><br><span class="line">OBJECT_DISK=sdb2</span><br><span class="line"></span><br><span class="line"><span class="comment">#The NODE IP for Swift Storage Network. example:x.x.x.x.</span></span><br><span class="line">STORAGE_LOCAL_NET_IP=192.168.157.31</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Heat Config----------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql heat user. exmaple:000000</span></span><br><span class="line">HEAT_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore heat user. exmaple:000000</span></span><br><span class="line">HEAT_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Zun Config-----------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql Zun user. exmaple:000000</span></span><br><span class="line">ZUN_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore Zun user. exmaple:000000</span></span><br><span class="line">ZUN_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Mysql Kuryr user. exmaple:000000</span></span><br><span class="line">KURYR_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore Kuryr user. exmaple:000000</span></span><br><span class="line">KURYR_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Ceilometer Config----------------##</span></span><br><span class="line"><span class="comment">#Password for Gnocchi ceilometer user. exmaple:000000</span></span><br><span class="line">CEILOMETER_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore ceilometer user. exmaple:000000</span></span><br><span class="line">CEILOMETER_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------AODH Config----------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql AODH user. exmaple:000000</span></span><br><span class="line">AODH_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore AODH user. exmaple:000000</span></span><br><span class="line">AODH_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Barbican Config----------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql Barbican user. exmaple:000000</span></span><br><span class="line">BARBICAN_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore Barbican user. exmaple:000000</span></span><br><span class="line">BARBICAN_PASS=000000</span><br><span class="line"></span><br><span class="line">root@controller ~]# <span class="built_in">source</span> /etc/xiandian/openrc.sh</span><br></pre></td></tr></table></figure>

<h3 id="2-修改脚本文件"><a href="#2-修改脚本文件" class="headerlink" title="2.修改脚本文件"></a>2.修改脚本文件</h3><p>在 compute 节点配置&#x2F;etc&#x2F;xiandian&#x2F;openrc.sh 文件，根据环境情况修改参数，块存储服务</p>
<p>的后端使用第二块硬盘的第一个分区，生效该参数文件。</p>
<p>请将 echo $INTERFACE_IP&amp;&amp; echo $BLOCK_DISK 命令的返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]#  <span class="built_in">echo</span> <span class="variable">$INTERFACE_IP</span>&amp;&amp; <span class="built_in">echo</span> <span class="variable">$BLOCK_DISK</span></span><br><span class="line">192.168.157.31</span><br><span class="line">sdb1</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# <span class="built_in">cat</span> /etc/xiandian/openrc.sh</span><br><span class="line"><span class="comment">#--------------------system Config--------------------##</span></span><br><span class="line"><span class="comment">#Controller Server Manager IP. example:x.x.x.x</span></span><br><span class="line">HOST_IP=192.168.157.30</span><br><span class="line"></span><br><span class="line"><span class="comment">#Controller HOST Password. example:000000</span></span><br><span class="line">HOST_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Controller Server hostname. example:controller</span></span><br><span class="line">HOST_NAME=controller</span><br><span class="line"></span><br><span class="line"><span class="comment">#Compute Node Manager IP. example:x.x.x.x</span></span><br><span class="line">HOST_IP_NODE=192.168.157.31</span><br><span class="line"></span><br><span class="line"><span class="comment">#Compute HOST Password. example:000000</span></span><br><span class="line">HOST_PASS_NODE=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Compute Node hostname. example:compute</span></span><br><span class="line">HOST_NAME_NODE=compute</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Chrony Config-------------------##</span></span><br><span class="line"><span class="comment">#Controller network segment IP.  example:x.x.0.0/16(x.x.x.0/24)</span></span><br><span class="line">network_segment_IP=192.168.157,0/24</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Rabbit Config ------------------##</span></span><br><span class="line"><span class="comment">#user for rabbit. example:openstack</span></span><br><span class="line">RABBIT_USER=openstack</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for rabbit user .example:000000</span></span><br><span class="line">RABBIT_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------MySQL Config---------------------##</span></span><br><span class="line"><span class="comment">#Password for MySQL root user . exmaple:000000</span></span><br><span class="line">DB_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Keystone Config------------------##</span></span><br><span class="line"><span class="comment">#Password for Keystore admin user. exmaple:000000</span></span><br><span class="line">DOMAIN_NAME=demo</span><br><span class="line">ADMIN_PASS=000000</span><br><span class="line">DEMO_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Mysql keystore user. exmaple:000000</span></span><br><span class="line">KEYSTONE_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Glance Config--------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql glance user. exmaple:000000</span></span><br><span class="line">GLANCE_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore glance user. exmaple:000000</span></span><br><span class="line">GLANCE_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Nova Config----------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql nova user. exmaple:000000</span></span><br><span class="line">NOVA_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore nova user. exmaple:000000</span></span><br><span class="line">NOVA_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Neturon Config-------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql neutron user. exmaple:000000</span></span><br><span class="line">NEUTRON_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore neutron user. exmaple:000000</span></span><br><span class="line">NEUTRON_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#metadata secret for neutron. exmaple:000000</span></span><br><span class="line">METADATA_SECRET=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Tunnel Network Interface. example:x.x.x.x</span></span><br><span class="line">INTERFACE_IP=192.168.157.31</span><br><span class="line"></span><br><span class="line"><span class="comment">#External Network Interface. example:eth1</span></span><br><span class="line">INTERFACE_NAME=eth37</span><br><span class="line"></span><br><span class="line"><span class="comment">#External Network The Physical Adapter. example:provider</span></span><br><span class="line">Physical_NAME=provider</span><br><span class="line"></span><br><span class="line"><span class="comment">#First Vlan ID in VLAN RANGE for VLAN Network. exmaple:101</span></span><br><span class="line">minvlan=101</span><br><span class="line"></span><br><span class="line"><span class="comment">#Last Vlan ID in VLAN RANGE for VLAN Network. example:200</span></span><br><span class="line">maxvlan=200</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Cinder Config--------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql cinder user. exmaple:000000</span></span><br><span class="line">CINDER_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore cinder user. exmaple:000000</span></span><br><span class="line">CINDER_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Cinder Block Disk. example:md126p3</span></span><br><span class="line">BLOCK_DISK=sdb1</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Swift Config---------------------##</span></span><br><span class="line"><span class="comment">#Password for Keystore swift user. exmaple:000000</span></span><br><span class="line">SWIFT_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#The NODE Object Disk for Swift. example:md126p4.</span></span><br><span class="line">OBJECT_DISK=sdb2</span><br><span class="line"></span><br><span class="line"><span class="comment">#The NODE IP for Swift Storage Network. example:x.x.x.x.</span></span><br><span class="line">STORAGE_LOCAL_NET_IP=192.168.157.31</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Heat Config----------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql heat user. exmaple:000000</span></span><br><span class="line">HEAT_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore heat user. exmaple:000000</span></span><br><span class="line">HEAT_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Zun Config-----------------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql Zun user. exmaple:000000</span></span><br><span class="line">ZUN_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore Zun user. exmaple:000000</span></span><br><span class="line">ZUN_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Mysql Kuryr user. exmaple:000000</span></span><br><span class="line">KURYR_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore Kuryr user. exmaple:000000</span></span><br><span class="line">KURYR_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Ceilometer Config----------------##</span></span><br><span class="line"><span class="comment">#Password for Gnocchi ceilometer user. exmaple:000000</span></span><br><span class="line">CEILOMETER_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore ceilometer user. exmaple:000000</span></span><br><span class="line">CEILOMETER_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------AODH Config----------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql AODH user. exmaple:000000</span></span><br><span class="line">AODH_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore AODH user. exmaple:000000</span></span><br><span class="line">AODH_PASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------Barbican Config----------------##</span></span><br><span class="line"><span class="comment">#Password for Mysql Barbican user. exmaple:000000</span></span><br><span class="line">BARBICAN_DBPASS=000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#Password for Keystore Barbican user. exmaple:000000</span></span><br><span class="line">BARBICAN_PASS=000000</span><br><span class="line"></span><br><span class="line">[root@compute ~]# <span class="built_in">source</span> /etc/xiandian/openrc.sh</span><br></pre></td></tr></table></figure>

<h3 id="3-安装-openstack-包"><a href="#3-安装-openstack-包" class="headerlink" title="3.安装 openstack 包"></a>3.安装 openstack 包</h3><p>分别在 controller 节点和 compute 节点执行 iaas-pre-host.sh 文件(不需要重启云主机)。</p>
<p>在 controller 节点请将 openstack –version 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack --version</span><br><span class="line">openstack 3.14.3</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-pre-host.sh</span><br><span class="line">[root@compute ~]# iaas-pre-host.sh</span><br></pre></td></tr></table></figure>

<h3 id="4-搭建数据库组件"><a href="#4-搭建数据库组件" class="headerlink" title="4. 搭建数据库组件"></a>4. 搭建数据库组件</h3><p>在 controller 节点执行 iaas-install-mysql.sh 脚本，会自行安装 mariadb、memcached、</p>
<p>rabbitmq 等服务和完成相关配置。执行完成后修改配置文件将缓存 CACHESIZE 修改为 128,</p>
<p>并重启相应服务。</p>
<p>请将 ps aux|grep memcached 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# ps aux|grep memcached</span><br><span class="line">memcach+  15901  0.1  0.0 443040  2164 ?        Ssl  09:15   0:00 /usr/bin/memcached -p 11211 -u memcached -m 128 -c 1024 -l 127.0.0.1,::1,controller</span><br><span class="line">root      15919  0.0  0.0 112704   960 pts/0    S+   09:15   0:00 grep --color=auto memcached</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-mysql.sh</span><br><span class="line">[root@controller ~]# rpm -qc memcached</span><br><span class="line">/etc/sysconfig/memcached</span><br><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/sysconfig/memcached</span><br><span class="line">PORT=<span class="string">&quot;11211&quot;</span></span><br><span class="line">USER=<span class="string">&quot;memcached&quot;</span></span><br><span class="line">MAXCONN=<span class="string">&quot;1024&quot;</span></span><br><span class="line">CACHESIZE=<span class="string">&quot;128&quot;</span></span><br><span class="line">OPTIONS=<span class="string">&quot;-l 127.0.0.1,::1,controller&quot;</span></span><br><span class="line">[root@controller ~]# systemctl restart memcached</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-搭建认证服务组件"><a href="#5-搭建认证服务组件" class="headerlink" title="5.搭建认证服务组件"></a>5.搭建认证服务组件</h3><p>在 controller 节点执行 iaas-install-keystone.sh 脚本，会自行安装 keystone 服务和完成相</p>
<p>关配置。使用 openstack 命令，创建一个名为 tom 的账户，密码为 tompassword123,邮箱为</p>
<p><a href="mailto:&#116;&#x6f;&#109;&#64;&#101;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#46;&#99;&#x6f;&#x6d;">&#116;&#x6f;&#109;&#64;&#101;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#46;&#99;&#x6f;&#x6d;</a>。</p>
<p>请将 openstack user list 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack user list</span><br><span class="line">+----------------------------------+-------+</span><br><span class="line">| ID                               | Name  |</span><br><span class="line">+----------------------------------+-------+</span><br><span class="line">| 0a22a2d4f3964cfbbbd6474dc92cca01 | admin |</span><br><span class="line">| 196d426492be403b8fbaa4b0c0f8e2a9 | tom   |</span><br><span class="line">| 314971684b4d4345b5aa43b2dd55339f | demo  |</span><br><span class="line">+----------------------------------+-------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-keystone.sh</span><br><span class="line">[root@controller ~]# <span class="built_in">source</span> /etc/keystone/admin-openrc.sh</span><br><span class="line">[root@controller ~]# openstack user create tom --password tompassword123 --email tom@example.com --domain demo</span><br><span class="line">+---------------------+----------------------------------+</span><br><span class="line">| Field               | Value                            |</span><br><span class="line">+---------------------+----------------------------------+</span><br><span class="line">| domain_id           | ed6f7dc2006d4010bd9194ebc576d9e9 |</span><br><span class="line">| email               | tom@example.com                  |</span><br><span class="line">| enabled             | True                             |</span><br><span class="line">| <span class="built_in">id</span>                  | 196d426492be403b8fbaa4b0c0f8e2a9 |</span><br><span class="line">| name                | tom                              |</span><br><span class="line">| options             | &#123;&#125;                               |</span><br><span class="line">| password_expires_at | None                             |</span><br><span class="line">+---------------------+----------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-搭建镜像服务组件"><a href="#6-搭建镜像服务组件" class="headerlink" title="6.搭建镜像服务组件"></a>6.搭建镜像服务组件</h3><p>在 controller 节点执行 iaas-install-glance.sh 脚本，会自行安装 glance 服务和完成相关</p>
<p>配 置 。 完 成 后 使 用 openstack 命 令 , 创 建 一 个 名 为 cirros 的 镜 像 ， 镜 像 文 件 使 用</p>
<p>cirros-0.3.4-x86_64-disk.img。</p>
<p>请将 openstack image show cirros 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]#  openstack image show cirros</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| Field            | Value                                                |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| checksum         | 443b7623e27ecf03dc9e01ee93f67afe                     |</span><br><span class="line">| container_format | bare                                                 |</span><br><span class="line">| created_at       | 2023-03-13T13:29:50Z                                 |</span><br><span class="line">| disk_format      | qcow2                                                |</span><br><span class="line">| file             | /v2/images/4219d1cb-5238-4720-a7be-167f9b158a9b/file |</span><br><span class="line">| <span class="built_in">id</span>               | 4219d1cb-5238-4720-a7be-167f9b158a9b                 |</span><br><span class="line">| min_disk         | 0                                                    |</span><br><span class="line">| min_ram          | 0                                                    |</span><br><span class="line">| name             | cirros                                               |</span><br><span class="line">| owner            | 1a99aaa6a1024d84a00a779c4d186b44                     |</span><br><span class="line">| protected        | False                                                |</span><br><span class="line">| schema           | /v2/schemas/image                                    |</span><br><span class="line">| size             | 12716032                                             |</span><br><span class="line">| status           | active                                               |</span><br><span class="line">| tags             |                                                      |</span><br><span class="line">| updated_at       | 2023-03-13T13:29:50Z                                 |</span><br><span class="line">| virtual_size     | None                                                 |</span><br><span class="line">| visibility       | shared                                               |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-glance.sh</span><br><span class="line">[root@controller ~]# openstack image create --disk-format qcow2 --container bare --file /root/cirros-0.4.0-x86_64-disk.img  cirros</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| Field            | Value                                                |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| checksum         | 443b7623e27ecf03dc9e01ee93f67afe                     |</span><br><span class="line">| container_format | bare                                                 |</span><br><span class="line">| created_at       | 2023-03-13T13:29:50Z                                 |</span><br><span class="line">| disk_format      | qcow2                                                |</span><br><span class="line">| file             | /v2/images/4219d1cb-5238-4720-a7be-167f9b158a9b/file |</span><br><span class="line">| <span class="built_in">id</span>               | 4219d1cb-5238-4720-a7be-167f9b158a9b                 |</span><br><span class="line">| min_disk         | 0                                                    |</span><br><span class="line">| min_ram          | 0                                                    |</span><br><span class="line">| name             | cirros                                               |</span><br><span class="line">| owner            | 1a99aaa6a1024d84a00a779c4d186b44                     |</span><br><span class="line">| protected        | False                                                |</span><br><span class="line">| schema           | /v2/schemas/image                                    |</span><br><span class="line">| size             | 12716032                                             |</span><br><span class="line">| status           | active                                               |</span><br><span class="line">| tags             |                                                      |</span><br><span class="line">| updated_at       | 2023-03-13T13:29:50Z                                 |</span><br><span class="line">| virtual_size     | None                                                 |</span><br><span class="line">| visibility       | shared                                               |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">[root@controller ~]#  openstack image show cirros</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| Field            | Value                                                |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| checksum         | 443b7623e27ecf03dc9e01ee93f67afe                     |</span><br><span class="line">| container_format | bare                                                 |</span><br><span class="line">| created_at       | 2023-03-13T13:29:50Z                                 |</span><br><span class="line">| disk_format      | qcow2                                                |</span><br><span class="line">| file             | /v2/images/4219d1cb-5238-4720-a7be-167f9b158a9b/file |</span><br><span class="line">| <span class="built_in">id</span>               | 4219d1cb-5238-4720-a7be-167f9b158a9b                 |</span><br><span class="line">| min_disk         | 0                                                    |</span><br><span class="line">| min_ram          | 0                                                    |</span><br><span class="line">| name             | cirros                                               |</span><br><span class="line">| owner            | 1a99aaa6a1024d84a00a779c4d186b44                     |</span><br><span class="line">| protected        | False                                                |</span><br><span class="line">| schema           | /v2/schemas/image                                    |</span><br><span class="line">| size             | 12716032                                             |</span><br><span class="line">| status           | active                                               |</span><br><span class="line">| tags             |                                                      |</span><br><span class="line">| updated_at       | 2023-03-13T13:29:50Z                                 |</span><br><span class="line">| virtual_size     | None                                                 |</span><br><span class="line">| visibility       | shared                                               |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-搭建计算服务组件"><a href="#7-搭建计算服务组件" class="headerlink" title="7.搭建计算服务组件"></a>7.搭建计算服务组件</h3><p>在 controller 节点执行 iaas-install-nova-controller.sh，compute 节点执行</p>
<p>iaas-install-nova-compute.sh，会自行安装 nova 服务和完成相关配置。使用 nova 命令创建一</p>
<p>个名为 t,ID 为 5，内存为 2048MB,磁盘容量为 10GB,vCPU 数量为 2 的云主机类型。</p>
<p>在 controller 节点请将 nova flavor-show t 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@controller ~]# nova flavor-show t</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| Property                   | Value |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| OS-FLV-DISABLED:disabled   | False |</span><br><span class="line">| OS-FLV-EXT-DATA:ephemeral  | 0     |</span><br><span class="line">| description                | -     |</span><br><span class="line">| disk                       | 10    |</span><br><span class="line">| extra_specs                | &#123;&#125;    |</span><br><span class="line">| <span class="built_in">id</span>                         | 5     |</span><br><span class="line">| name                       | t     |</span><br><span class="line">| os-flavor-access:is_public | True  |</span><br><span class="line">| ram                        | 2048  |</span><br><span class="line">| rxtx_factor                | 1.0   |</span><br><span class="line">| swap                       |       |</span><br><span class="line">| vcpus                      | 2     |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-nova-controller.sh</span><br><span class="line">[root@compute ~]# iaas-install-nova-compute.sh</span><br><span class="line">[root@controller ~]# nova flavor-create  t 5  2048 10 2</span><br><span class="line">+----+------+-----------+------+-----------+------+-------+-------------+-----------+-------------+</span><br><span class="line">| ID | Name | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public | Description |</span><br><span class="line">+----+------+-----------+------+-----------+------+-------+-------------+-----------+-------------+</span><br><span class="line">| 5  | t    | 2048      | 10   | 0         |      | 2     | 1.0         | True      | -           |</span><br><span class="line">+----+------+-----------+------+-----------+------+-------+-------------+-----------+-------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="8-搭建网络组件并初始化网络"><a href="#8-搭建网络组件并初始化网络" class="headerlink" title="8.搭建网络组件并初始化网络"></a>8.搭建网络组件并初始化网络</h3><p>在 controller 节点执行 iaas-install-neutron-controller.sh,compute 节点执行</p>
<p>iaas-install-neutron-compute.sh，会自行安装 neutron 服务并完成配置。创建云主机外部网</p>
<p>络 ext-net，子网为 ext-subnet，云主机浮动 IP 可用网段为 192.168.10.100~192.168.10.200，</p>
<p>网关为 192.168.100.1。</p>
<p>在 controller 节点请将 openstack subnet show ext-subnet 命令的返回结果提交到答题</p>
<p>框。【1 分】</p>
<blockquote>
<p>注意 本宿主机环境为192.168.157.0&#x2F;24网段  网关应为192.168.157.2</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack subnet show ext-subnet</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| allocation_pools  | 192.168.10.100-192.168.10.200        |</span><br><span class="line">| cidr              | 192.168.10.0/24                      |</span><br><span class="line">| created_at        | 2023-03-13T13:58:58Z                 |</span><br><span class="line">| description       |                                      |</span><br><span class="line">| dns_nameservers   |                                      |</span><br><span class="line">| enable_dhcp       | True                                 |</span><br><span class="line">| gateway_ip        | 192.168.100.1                        |</span><br><span class="line">| host_routes       |                                      |</span><br><span class="line">| <span class="built_in">id</span>                | 3b4ffa33-6d24-46d5-aa23-e44e8ce86b26 |</span><br><span class="line">| ip_version        | 4                                    |</span><br><span class="line">| ipv6_address_mode | None                                 |</span><br><span class="line">| ipv6_ra_mode      | None                                 |</span><br><span class="line">| name              | ext-subnet                           |</span><br><span class="line">| network_id        | d1a6df4b-3af0-4ed6-b402-3b9eae05af8e |</span><br><span class="line">| project_id        | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| revision_number   | 0                                    |</span><br><span class="line">| segment_id        | None                                 |</span><br><span class="line">| service_types     |                                      |</span><br><span class="line">| subnetpool_id     | None                                 |</span><br><span class="line">| tags              |                                      |</span><br><span class="line">| updated_at        | 2023-03-13T13:58:58Z                 |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-neutron-controller.sh</span><br><span class="line">[root@computer ~]# iaas-install-neutron-compute.sh</span><br><span class="line">[root@controller ~]# openstack network create --external --provider-physical-network provider --provider-network-type flat ext-net</span><br><span class="line">+---------------------------+--------------------------------------+</span><br><span class="line">| Field                     | Value                                |</span><br><span class="line">+---------------------------+--------------------------------------+</span><br><span class="line">| admin_state_up            | UP                                   |</span><br><span class="line">| availability_zone_hints   |                                      |</span><br><span class="line">| availability_zones        |                                      |</span><br><span class="line">| created_at                | 2023-03-13T13:55:36Z                 |</span><br><span class="line">| description               |                                      |</span><br><span class="line">| dns_domain                | None                                 |</span><br><span class="line">| <span class="built_in">id</span>                        | d1a6df4b-3af0-4ed6-b402-3b9eae05af8e |</span><br><span class="line">| ipv4_address_scope        | None                                 |</span><br><span class="line">| ipv6_address_scope        | None                                 |</span><br><span class="line">| is_default                | False                                |</span><br><span class="line">| is_vlan_transparent       | None                                 |</span><br><span class="line">| mtu                       | 1500                                 |</span><br><span class="line">| name                      | ext-net                              |</span><br><span class="line">| port_security_enabled     | True                                 |</span><br><span class="line">| project_id                | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| provider:network_type     | flat                                 |</span><br><span class="line">| provider:physical_network | provider                             |</span><br><span class="line">| provider:segmentation_id  | None                                 |</span><br><span class="line">| qos_policy_id             | None                                 |</span><br><span class="line">| revision_number           | 5                                    |</span><br><span class="line">| router:external           | External                             |</span><br><span class="line">| segments                  | None                                 |</span><br><span class="line">| shared                    | False                                |</span><br><span class="line">| status                    | ACTIVE                               |</span><br><span class="line">| subnets                   |                                      |</span><br><span class="line">| tags                      |                                      |</span><br><span class="line">| updated_at                | 2023-03-13T13:55:36Z                 |</span><br><span class="line">+---------------------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# openstack subnet create --network ext-net --subnet-range 192.168.10.0/24  --gateway 192.168.100.1 --allocation-pool start=192.168.10.100,end=192.168.10.200 --dhcp ext-subnet</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| allocation_pools  | 192.168.10.100-192.168.10.200        |</span><br><span class="line">| cidr              | 192.168.10.0/24                      |</span><br><span class="line">| created_at        | 2023-03-13T13:58:58Z                 |</span><br><span class="line">| description       |                                      |</span><br><span class="line">| dns_nameservers   |                                      |</span><br><span class="line">| enable_dhcp       | True                                 |</span><br><span class="line">| gateway_ip        | 192.168.100.1                        |</span><br><span class="line">| host_routes       |                                      |</span><br><span class="line">| <span class="built_in">id</span>                | 3b4ffa33-6d24-46d5-aa23-e44e8ce86b26 |</span><br><span class="line">| ip_version        | 4                                    |</span><br><span class="line">| ipv6_address_mode | None                                 |</span><br><span class="line">| ipv6_ra_mode      | None                                 |</span><br><span class="line">| name              | ext-subnet                           |</span><br><span class="line">| network_id        | d1a6df4b-3af0-4ed6-b402-3b9eae05af8e |</span><br><span class="line">| project_id        | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| revision_number   | 0                                    |</span><br><span class="line">| segment_id        | None                                 |</span><br><span class="line">| service_types     |                                      |</span><br><span class="line">| subnetpool_id     | None                                 |</span><br><span class="line">| tags              |                                      |</span><br><span class="line">| updated_at        | 2023-03-13T13:58:58Z                 |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="9-搭建图形化界面"><a href="#9-搭建图形化界面" class="headerlink" title="9.搭建图形化界面"></a>9.搭建图形化界面</h3><p>在 controller 节点执行 iaas-install-dashboard.sh 脚本，会自行安装 dashboard 服务并完</p>
<p>成配置。请修改 nova 配置文件，使之能通过公网 IP 访问 dashboard 首页。</p>
<p>在 controller 节点请将 curl <a target="_blank" rel="noopener" href="http://eip/dashboard">http://EIP/dashboard</a> –L 命令的返回结果提交到答题框。</p>
<p>【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-dashboard.sh </span><br><span class="line">[root@controller ~]# vi /etc/nova/nova.conf</span><br><span class="line"><span class="comment">#公共IP的网络主机</span></span><br><span class="line">--routing_source_ip=192.168.1.50</span><br><span class="line"><span class="comment">#高效网络</span></span><br><span class="line">--multi_host=<span class="literal">true</span></span><br><span class="line"><span class="comment">#公网网卡</span></span><br><span class="line">--public_interface=eth0</span><br></pre></td></tr></table></figure>

<h2 id="任务-3-OpenStack-运维任务（13-分）"><a href="#任务-3-OpenStack-运维任务（13-分）" class="headerlink" title="任务 3 OpenStack 运维任务（13 分）"></a><strong>任务 3 OpenStack 运维任务（13 分）</strong></h2><p>某公司构建了一套内部私有云系统，这套私有云系统将为公司内部提供计算服务。你将作为该私有云的维护人员，请完成以下运维工作。</p>
<h3 id="1-安全组管理"><a href="#1-安全组管理" class="headerlink" title="1.安全组管理"></a>1.安全组管理</h3><p>使用命令创建名称为 group_web 的安全组该安全组的描述为” Custom security group”，</p>
<p>用 openstack 命令为安全组添加 icmp 规则和 ssh 规则允许任意 ip 地址访问 web,完成后查看</p>
<p>该安全组的详细信息.</p>
<p>将 openstack security group show group_web 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack security group show group_web</span><br><span class="line">+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Field           | Value                                                                                                                                                                                                                                            |</span><br><span class="line">+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| created_at      | 2023-03-13T15:07:06Z                                                                                                                                                                                                                             |</span><br><span class="line">| description     | Custom security group                                                                                                                                                                                                                            |</span><br><span class="line">| <span class="built_in">id</span>              | 1ba95444-9ba2-4036-84a7-fc67f09f323f                                                                                                                                                                                                             |</span><br><span class="line">| name            | group_web                                                                                                                                                                                                                                        |</span><br><span class="line">| project_id      | 1a99aaa6a1024d84a00a779c4d186b44                                                                                                                                                                                                                 |</span><br><span class="line">| revision_number | 5                                                                                                                                                                                                                                                |</span><br><span class="line">| rules           | created_at=<span class="string">&#x27;2023-03-13T16:03:49Z&#x27;</span>, direction=<span class="string">&#x27;ingress&#x27;</span>, ethertype=<span class="string">&#x27;IPv4&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;b92db258-8484-4082-94f4-51ec184f30c0&#x27;</span>, port_range_max=<span class="string">&#x27;80&#x27;</span>, port_range_min=<span class="string">&#x27;80&#x27;</span>, protocol=<span class="string">&#x27;tcp&#x27;</span>, remote_ip_prefix=<span class="string">&#x27;0.0.0.0/0&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T16:03:49Z&#x27;</span>   |</span><br><span class="line">|                 | created_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span>, direction=<span class="string">&#x27;egress&#x27;</span>, ethertype=<span class="string">&#x27;IPv6&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;aea10bda-7c20-45e6-a802-940dd0a6761b&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span>                                                                                            |</span><br><span class="line">|                 | created_at=<span class="string">&#x27;2023-03-13T16:19:18Z&#x27;</span>, direction=<span class="string">&#x27;ingress&#x27;</span>, ethertype=<span class="string">&#x27;IPv4&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;35d48cca-f4b6-499e-9b06-50e763a695f0&#x27;</span>, port_range_max=<span class="string">&#x27;443&#x27;</span>, port_range_min=<span class="string">&#x27;443&#x27;</span>, protocol=<span class="string">&#x27;tcp&#x27;</span>, remote_ip_prefix=<span class="string">&#x27;0.0.0.0/0&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T16:19:18Z&#x27;</span> |</span><br><span class="line">|                 | created_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span>, direction=<span class="string">&#x27;egress&#x27;</span>, ethertype=<span class="string">&#x27;IPv4&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;81eef3e3-5804-4323-b05f-2b0357e25ae3&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span>                                                                                            |</span><br><span class="line">|                 | created_at=<span class="string">&#x27;2023-03-13T16:03:14Z&#x27;</span>, direction=<span class="string">&#x27;ingress&#x27;</span>, ethertype=<span class="string">&#x27;IPv4&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;7f53e52f-5fbe-452c-b704-4232cfafd7d8&#x27;</span>, protocol=<span class="string">&#x27;icmp&#x27;</span>, remote_ip_prefix=<span class="string">&#x27;0.0.0.0/0&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T16:03:14Z&#x27;</span>                                            |</span><br><span class="line">| updated_at      | 2023-03-13T16:19:18Z                                                                                                                                                                                                                             |</span><br><span class="line">+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack security group create group_web --description <span class="string">&quot;Custom security group&quot;</span></span><br><span class="line">+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Field           | Value                                                                                                                                                 |</span><br><span class="line">+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| created_at      | 2023-03-13T15:07:06Z                                                                                                                                  |</span><br><span class="line">| description     | Custom security group                                                                                                                                 |</span><br><span class="line">| <span class="built_in">id</span>              | 1ba95444-9ba2-4036-84a7-fc67f09f323f                                                                                                                  |</span><br><span class="line">| name            | group_web                                                                                                                                             |</span><br><span class="line">| project_id      | 1a99aaa6a1024d84a00a779c4d186b44                                                                                                                      |</span><br><span class="line">| revision_number | 2                                                                                                                                                     |</span><br><span class="line">| rules           | created_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span>, direction=<span class="string">&#x27;egress&#x27;</span>, ethertype=<span class="string">&#x27;IPv4&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;81eef3e3-5804-4323-b05f-2b0357e25ae3&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span> |</span><br><span class="line">|                 | created_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span>, direction=<span class="string">&#x27;egress&#x27;</span>, ethertype=<span class="string">&#x27;IPv6&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;aea10bda-7c20-45e6-a802-940dd0a6761b&#x27;</span>, updated_at=<span class="string">&#x27;2023-03-13T15:07:06Z&#x27;</span> |</span><br><span class="line">| updated_at      | 2023-03-13T15:07:06Z                                                                                                                                  |</span><br><span class="line">+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">[root@controller ~]# openstack security group rule create group_web --protocol icmp --ingress</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| created_at        | 2023-03-13T16:03:14Z                 |</span><br><span class="line">| description       |                                      |</span><br><span class="line">| direction         | ingress                              |</span><br><span class="line">| ether_type        | IPv4                                 |</span><br><span class="line">| <span class="built_in">id</span>                | 7f53e52f-5fbe-452c-b704-4232cfafd7d8 |</span><br><span class="line">| name              | None                                 |</span><br><span class="line">| port_range_max    | None                                 |</span><br><span class="line">| port_range_min    | None                                 |</span><br><span class="line">| project_id        | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| protocol          | icmp                                 |</span><br><span class="line">| remote_group_id   | None                                 |</span><br><span class="line">| remote_ip_prefix  | 0.0.0.0/0                            |</span><br><span class="line">| revision_number   | 0                                    |</span><br><span class="line">| security_group_id | 1ba95444-9ba2-4036-84a7-fc67f09f323f |</span><br><span class="line">| updated_at        | 2023-03-13T16:03:14Z                 |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# openstack security group rule create group_web --protocol tcp --ingress --dst-port 80:80</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| created_at        | 2023-03-13T16:03:49Z                 |</span><br><span class="line">| description       |                                      |</span><br><span class="line">| direction         | ingress                              |</span><br><span class="line">| ether_type        | IPv4                                 |</span><br><span class="line">| <span class="built_in">id</span>                | b92db258-8484-4082-94f4-51ec184f30c0 |</span><br><span class="line">| name              | None                                 |</span><br><span class="line">| port_range_max    | 80                                   |</span><br><span class="line">| port_range_min    | 80                                   |</span><br><span class="line">| project_id        | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| protocol          | tcp                                  |</span><br><span class="line">| remote_group_id   | None                                 |</span><br><span class="line">| remote_ip_prefix  | 0.0.0.0/0                            |</span><br><span class="line">| revision_number   | 0                                    |</span><br><span class="line">| security_group_id | 1ba95444-9ba2-4036-84a7-fc67f09f323f |</span><br><span class="line">| updated_at        | 2023-03-13T16:03:49Z                 |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# openstack security group rule create group_web --protocol tcp --ingress --dst-port 443:443</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| created_at        | 2023-03-13T16:19:18Z                 |</span><br><span class="line">| description       |                                      |</span><br><span class="line">| direction         | ingress                              |</span><br><span class="line">| ether_type        | IPv4                                 |</span><br><span class="line">| <span class="built_in">id</span>                | 35d48cca-f4b6-499e-9b06-50e763a695f0 |</span><br><span class="line">| name              | None                                 |</span><br><span class="line">| port_range_max    | 443                                  |</span><br><span class="line">| port_range_min    | 443                                  |</span><br><span class="line">| project_id        | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| protocol          | tcp                                  |</span><br><span class="line">| remote_group_id   | None                                 |</span><br><span class="line">| remote_ip_prefix  | 0.0.0.0/0                            |</span><br><span class="line">| revision_number   | 0                                    |</span><br><span class="line">| security_group_id | 1ba95444-9ba2-4036-84a7-fc67f09f323f |</span><br><span class="line">| updated_at        | 2023-03-13T16:19:18Z                 |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-项目管理"><a href="#2-项目管理" class="headerlink" title="2.项目管理"></a>2.项目管理</h3><p>在 keystone 中创建 shop 项目添加描述为”Hello shop”，完成后使用 openstack 命令禁用</p>
<p>该项目，然后使用 openstack 命令查看该项目的详细信息。</p>
<p>请将 openstack project show shop 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack project show shop</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| Field       | Value                            |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| description | Hello shop                       |</span><br><span class="line">| domain_id   | ed6f7dc2006d4010bd9194ebc576d9e9 |</span><br><span class="line">| enabled     | False                            |</span><br><span class="line">| <span class="built_in">id</span>          | 6896ca6270aa429aa22908123b5cfb65 |</span><br><span class="line">| is_domain   | False                            |</span><br><span class="line">| name        | shop                             |</span><br><span class="line">| parent_id   | ed6f7dc2006d4010bd9194ebc576d9e9 |</span><br><span class="line">| tags        | []                               |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack project create shop --description <span class="string">&quot;Hello shop&quot;</span> --domain demo</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| Field       | Value                            |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line">| description | Hello shop                       |</span><br><span class="line">| domain_id   | ed6f7dc2006d4010bd9194ebc576d9e9 |</span><br><span class="line">| enabled     | True                             |</span><br><span class="line">| <span class="built_in">id</span>          | 6896ca6270aa429aa22908123b5cfb65 |</span><br><span class="line">| is_domain   | False                            |</span><br><span class="line">| name        | shop                             |</span><br><span class="line">| parent_id   | ed6f7dc2006d4010bd9194ebc576d9e9 |</span><br><span class="line">| tags        | []                               |</span><br><span class="line">+-------------+----------------------------------+</span><br><span class="line"></span><br><span class="line">[root@controller ~]# openstack project  <span class="built_in">set</span>  shop --<span class="built_in">disable</span></span><br></pre></td></tr></table></figure>

<h3 id="3-用户管理"><a href="#3-用户管理" class="headerlink" title="3.用户管理"></a>3.用户管理</h3><p>使用 nova 命令查看 admin 租户的当前配额值，将 admin 租户的实例配额提升到 13。</p>
<p>请将 nova quota-class-show admin 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# nova quota-class-show admin</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| Quota                | Limit |</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| instances            | 10    |</span><br><span class="line">| cores                | 20    |</span><br><span class="line">| ram                  | 51200 |</span><br><span class="line">| metadata_items       | 128   |</span><br><span class="line">| key_pairs            | 100   |</span><br><span class="line">| server_groups        | 13    |</span><br><span class="line">| server_group_members | 10    |</span><br><span class="line">+----------------------+-------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# nova quota-class-show admin</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| Quota                | Limit |</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| instances            | 10    |</span><br><span class="line">| cores                | 20    |</span><br><span class="line">| ram                  | 51200 |</span><br><span class="line">| metadata_items       | 128   |</span><br><span class="line">| key_pairs            | 100   |</span><br><span class="line">| server_groups        | 10    |</span><br><span class="line">| server_group_members | 10    |</span><br><span class="line">+----------------------+-------+</span><br><span class="line">[root@controller ~]# nova quota-class-update --server-groups 13 admin</span><br></pre></td></tr></table></figure>

<h3 id="4-镜像管理"><a href="#4-镜像管理" class="headerlink" title="4.镜像管理"></a>4.镜像管理</h3><p>登 录 controller 节 点 ，使用 glance 相 关 命 令 上 传 镜 像 ， 源 使 用</p>
<p>CentOS_7.5_x86_64_XD.qcow2，名字为 centos7.5，修改这个镜像为共享状态，并设置最小</p>
<p>磁盘为 5G。</p>
<p>请将 glance image-list 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# glance image-list</span><br><span class="line">+--------------------------------------+-----------+</span><br><span class="line">| ID                                   | Name      |</span><br><span class="line">+--------------------------------------+-----------+</span><br><span class="line">| 29383c02-103a-4d28-ad42-24419970ed79 | centos7.5 |</span><br><span class="line">| 4219d1cb-5238-4720-a7be-167f9b158a9b | cirros    |</span><br><span class="line">+--------------------------------------+-----------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# glance image-create --name centos7.5  --min-disk 5 --disk-format qcow2 --file /opt/iaas/images/CentOS_7.5_x86_64_XD.qcow2  --container-format bare</span><br><span class="line">+------------------+--------------------------------------+</span><br><span class="line">| Property         | Value                                |</span><br><span class="line">+------------------+--------------------------------------+</span><br><span class="line">| checksum         | 3d3e9c954351a4b6953fd156f0c29f5c     |</span><br><span class="line">| container_format | bare                                 |</span><br><span class="line">| created_at       | 2023-03-13T16:47:13Z                 |</span><br><span class="line">| disk_format      | qcow2                                |</span><br><span class="line">| <span class="built_in">id</span>               | 29383c02-103a-4d28-ad42-24419970ed79 |</span><br><span class="line">| min_disk         | 5                                    |</span><br><span class="line">| min_ram          | 0                                    |</span><br><span class="line">| name             | centos7.5                            |</span><br><span class="line">| owner            | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| protected        | False                                |</span><br><span class="line">| size             | 510459904                            |</span><br><span class="line">| status           | active                               |</span><br><span class="line">| tags             | []                                   |</span><br><span class="line">| updated_at       | 2023-03-13T16:47:17Z                 |</span><br><span class="line">| virtual_size     | None                                 |</span><br><span class="line">| visibility       | shared                               |</span><br><span class="line">+------------------+--------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-后端配置文件管理"><a href="#5-后端配置文件管理" class="headerlink" title="5.后端配置文件管理"></a>5.后端配置文件管理</h3><p>请修改 glance 后端配置文件，将项目的映像存储限制为 10GB,完成后重启 glance 服务。</p>
<p>请将 cat &#x2F;etc&#x2F;glance&#x2F;glance-api.conf |grep user_storage 命令的返回结果提交到答题框。【1分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/glance/glance-api.conf |grep user_storage</span><br><span class="line">user_storage_quota = 10GB</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">cat</span> /etc/glance/glance-api.conf |grep user_storage</span><br><span class="line">user_storage_quota = 10GB</span><br><span class="line"></span><br><span class="line">[root@controller ~]# systemctl restart openstack-glance-api</span><br></pre></td></tr></table></figure>

<h3 id="6-存储服务管理"><a href="#6-存储服务管理" class="headerlink" title="6.存储服务管理"></a>6.存储服务管理</h3><p>在 controller 节点执行 iaas-install-cinder-controller.sh, compute 节点执行</p>
<p>iaas-install-cinder-compute.sh，在 controller 和 compute 节点上会自行安装 cinder 服务并</p>
<p>完成配置。创建一个名为 lvm 的卷类型，创建该类型规格键值对，要求 lvm 卷类型对应 cinder</p>
<p>后端驱动 lvm 所管理的存储资源,名字 lvm_test，大小 1G 的云硬盘并查询该云硬盘的详细信</p>
<p>息。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cinder show lvm_test</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| Property                       | Value                                |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| attached_servers               | []                                   |</span><br><span class="line">| attachment_ids                 | []                                   |</span><br><span class="line">| availability_zone              | nova                                 |</span><br><span class="line">| bootable                       | <span class="literal">false</span>                                |</span><br><span class="line">| consistencygroup_id            | None                                 |</span><br><span class="line">| created_at                     | 2023-03-13T19:49:41.000000           |</span><br><span class="line">| description                    | None                                 |</span><br><span class="line">| encrypted                      | False                                |</span><br><span class="line">| <span class="built_in">id</span>                             | 255ef0a6-1d74-4b82-b930-6ae575aca172 |</span><br><span class="line">| metadata                       |                                      |</span><br><span class="line">| migration_status               | None                                 |</span><br><span class="line">| multiattach                    | False                                |</span><br><span class="line">| name                           | lvm_test                             |</span><br><span class="line">| os-vol-host-attr:host          | compute@lvm#LVM                      |</span><br><span class="line">| os-vol-mig-status-attr:migstat | None                                 |</span><br><span class="line">| os-vol-mig-status-attr:name_id | None                                 |</span><br><span class="line">| os-vol-tenant-attr:tenant_id   | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| replication_status             | None                                 |</span><br><span class="line">| size                           | 1                                    |</span><br><span class="line">| snapshot_id                    | None                                 |</span><br><span class="line">| source_volid                   | None                                 |</span><br><span class="line">| status                         | available                            |</span><br><span class="line">| updated_at                     | 2023-03-13T19:49:42.000000           |</span><br><span class="line">| user_id                        | 0a22a2d4f3964cfbbbd6474dc92cca01     |</span><br><span class="line">| volume_type                    | lvm                                  |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack volume <span class="built_in">type</span> create  lvm</span><br><span class="line">+-------------+--------------------------------------+</span><br><span class="line">| Field       | Value                                |</span><br><span class="line">+-------------+--------------------------------------+</span><br><span class="line">| description | None                                 |</span><br><span class="line">| <span class="built_in">id</span>          | b3872aa9-91df-4b82-a575-9c2e22458ea9 |</span><br><span class="line">| is_public   | True                                 |</span><br><span class="line">| name        | lvm                                  |</span><br><span class="line">+-------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# openstack volume <span class="built_in">type</span> <span class="built_in">set</span>  --property volume_backend_name=LVM lvm</span><br><span class="line">[root@controller ~]# openstack volume create --<span class="built_in">type</span> lvm --size 1 lvm_test</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">| Field               | Value                                |</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">| attachments         | []                                   |</span><br><span class="line">| availability_zone   | nova                                 |</span><br><span class="line">| bootable            | <span class="literal">false</span>                                |</span><br><span class="line">| consistencygroup_id | None                                 |</span><br><span class="line">| created_at          | 2023-03-13T19:49:41.000000           |</span><br><span class="line">| description         | None                                 |</span><br><span class="line">| encrypted           | False                                |</span><br><span class="line">| <span class="built_in">id</span>                  | 255ef0a6-1d74-4b82-b930-6ae575aca172 |</span><br><span class="line">| migration_status    | None                                 |</span><br><span class="line">| multiattach         | False                                |</span><br><span class="line">| name                | lvm_test                             |</span><br><span class="line">| properties          |                                      |</span><br><span class="line">| replication_status  | None                                 |</span><br><span class="line">| size                | 1                                    |</span><br><span class="line">| snapshot_id         | None                                 |</span><br><span class="line">| source_volid        | None                                 |</span><br><span class="line">| status              | creating                             |</span><br><span class="line">| <span class="built_in">type</span>                | lvm                                  |</span><br><span class="line">| updated_at          | None                                 |</span><br><span class="line">| user_id             | 0a22a2d4f3964cfbbbd6474dc92cca01     |</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhaopei123/p/12982526.html">参考链接</a></p>
<h3 id="7-数据库管理"><a href="#7-数据库管理" class="headerlink" title="7.数据库管理"></a>7.数据库管理</h3><p>请使用数据库命令将所有数据库进行备份,备份文件名为 openstack.sql，完成后使用命令</p>
<p>查看文件属性其中文件大小以 mb 显示。</p>
<p>请将 du -h openstack.sql 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# <span class="built_in">du</span> openstack.sql -h</span><br><span class="line">1.6M    openstack.sql</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# mysqldump -uroot -p000000 --all-databases &gt; openstack.sql</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_51486343/article/details/113702736">参考文档</a></p>
<h3 id="8-数据库管理"><a href="#8-数据库管理" class="headerlink" title="8.数据库管理"></a>8.数据库管理</h3><p>进入数据库，创建本地用户 examuser，密码为 000000，然后查询 mysql 数据库中的</p>
<p>user 表的 user,host,password 字段。然后赋予这个用户所有数据库的“查询”“删除”“更新”“创</p>
<p>建”的权限。</p>
<p>请将 select user,host,password from user ;命令的返回结果提交到答题框【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [mysql]&gt;  <span class="keyword">select</span> user,host,password from user;</span><br><span class="line">+----------+------------+-------------------------------------------+</span><br><span class="line">| user     | host       | password                                  |</span><br><span class="line">+----------+------------+-------------------------------------------+</span><br><span class="line">| root     | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| root     | controller | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| root     | 127.0.0.1  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| root     | ::1        | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| keystone | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| keystone | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| glance   | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| glance   | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| nova     | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| nova     | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| neutron  | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| neutron  | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| cinder   | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| cinder   | %          | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">| examuser | localhost  | *032197AE5731D4664921A6CCAC7CFCE6A0698693 |</span><br><span class="line">+----------+------------+-------------------------------------------+</span><br><span class="line">15 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# mysql -uroot -p</span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 400</span><br><span class="line">Server version: 10.1.20-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; create user examuser@localhost identified by <span class="string">&#x27;000000&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; grant <span class="keyword">select</span>,delete,update,create on *.* to examuser@localhost ;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; flush privileges</span><br><span class="line">    -&gt; ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="9-存储管理"><a href="#9-存储管理" class="headerlink" title="9.存储管理"></a>9.存储管理</h3><p>请使用 openstack 命令创建一个名为 test 的 cinder 卷，卷大小为 5G。完成后使用 cinder</p>
<p>命令列出卷列表并查看 test 卷的详细信息。</p>
<p>请将 cinder list 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cinder list</span><br><span class="line">+--------------------------------------+-----------+----------+------+-------------+----------+-------------+</span><br><span class="line">| ID                                   | Status    | Name     | Size | Volume Type | Bootable | Attached to |</span><br><span class="line">+--------------------------------------+-----------+----------+------+-------------+----------+-------------+</span><br><span class="line">| 255ef0a6-1d74-4b82-b930-6ae575aca172 | available | lvm_test | 1    | lvm         | <span class="literal">false</span>    |             |</span><br><span class="line">| 893a1d99-297d-4cf0-8a01-7e637d6ab086 | available | <span class="built_in">test</span>     | 5    | -           | <span class="literal">false</span>    |             |</span><br><span class="line">+--------------------------------------+-----------+----------+------+-------------+----------+-------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack volume create --size 5 <span class="built_in">test</span></span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">| Field               | Value                                |</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">| attachments         | []                                   |</span><br><span class="line">| availability_zone   | nova                                 |</span><br><span class="line">| bootable            | <span class="literal">false</span>                                |</span><br><span class="line">| consistencygroup_id | None                                 |</span><br><span class="line">| created_at          | 2023-03-13T20:08:38.000000           |</span><br><span class="line">| description         | None                                 |</span><br><span class="line">| encrypted           | False                                |</span><br><span class="line">| <span class="built_in">id</span>                  | 893a1d99-297d-4cf0-8a01-7e637d6ab086 |</span><br><span class="line">| migration_status    | None                                 |</span><br><span class="line">| multiattach         | False                                |</span><br><span class="line">| name                | <span class="built_in">test</span>                                 |</span><br><span class="line">| properties          |                                      |</span><br><span class="line">| replication_status  | None                                 |</span><br><span class="line">| size                | 5                                    |</span><br><span class="line">| snapshot_id         | None                                 |</span><br><span class="line">| source_volid        | None                                 |</span><br><span class="line">| status              | creating                             |</span><br><span class="line">| <span class="built_in">type</span>                | None                                 |</span><br><span class="line">| updated_at          | None                                 |</span><br><span class="line">| user_id             | 0a22a2d4f3964cfbbbd6474dc92cca01     |</span><br><span class="line">+---------------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# cinder show <span class="built_in">test</span></span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| Property                       | Value                                |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| attached_servers               | []                                   |</span><br><span class="line">| attachment_ids                 | []                                   |</span><br><span class="line">| availability_zone              | nova                                 |</span><br><span class="line">| bootable                       | <span class="literal">false</span>                                |</span><br><span class="line">| consistencygroup_id            | None                                 |</span><br><span class="line">| created_at                     | 2023-03-13T20:08:38.000000           |</span><br><span class="line">| description                    | None                                 |</span><br><span class="line">| encrypted                      | False                                |</span><br><span class="line">| <span class="built_in">id</span>                             | 893a1d99-297d-4cf0-8a01-7e637d6ab086 |</span><br><span class="line">| metadata                       |                                      |</span><br><span class="line">| migration_status               | None                                 |</span><br><span class="line">| multiattach                    | False                                |</span><br><span class="line">| name                           | <span class="built_in">test</span>                                 |</span><br><span class="line">| os-vol-host-attr:host          | compute@lvm#LVM                      |</span><br><span class="line">| os-vol-mig-status-attr:migstat | None                                 |</span><br><span class="line">| os-vol-mig-status-attr:name_id | None                                 |</span><br><span class="line">| os-vol-tenant-attr:tenant_id   | 1a99aaa6a1024d84a00a779c4d186b44     |</span><br><span class="line">| replication_status             | None                                 |</span><br><span class="line">| size                           | 5                                    |</span><br><span class="line">| snapshot_id                    | None                                 |</span><br><span class="line">| source_volid                   | None                                 |</span><br><span class="line">| status                         | available                            |</span><br><span class="line">| updated_at                     | 2023-03-13T20:08:39.000000           |</span><br><span class="line">| user_id                        | 0a22a2d4f3964cfbbbd6474dc92cca01     |</span><br><span class="line">| volume_type                    | None                                 |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-存储管理"><a href="#10-存储管理" class="headerlink" title="10.存储管理"></a>10.存储管理</h3><p>为了减缓来自实例的数据访问速度的变慢，OpenStack Block Storage 支持对卷数据复制</p>
<p>带宽的速率限制。请修改 cinder 后端配置文件将卷复制带宽限制为最高 100 MiB&#x2F;s。</p>
<p>请将 cat &#x2F;etc&#x2F;cinder&#x2F;cinder.conf |grep volume_copy 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]#  <span class="built_in">cat</span> /etc/cinder/cinder.conf |grep volume_copy</span><br><span class="line"><span class="comment">#volume_copy_blkio_cgroup_name = cinder-volume-copy</span></span><br><span class="line">volume_copy_bps_limit = 100MiB/s</span><br><span class="line"><span class="comment">#volume_copy_blkio_cgroup_name = cinder-volume-copy</span></span><br><span class="line"><span class="comment">#volume_copy_bps_limit = 0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]#  <span class="built_in">cat</span> /etc/cinder/cinder.conf |grep volume_copy</span><br><span class="line"><span class="comment">#volume_copy_blkio_cgroup_name = cinder-volume-copy</span></span><br><span class="line">volume_copy_bps_limit = 100MiB/s</span><br><span class="line"><span class="comment">#volume_copy_blkio_cgroup_name = cinder-volume-copy</span></span><br><span class="line"><span class="comment">#volume_copy_bps_limit = 0</span></span><br></pre></td></tr></table></figure>

<h3 id="11-存储管理"><a href="#11-存储管理" class="headerlink" title="11.存储管理"></a>11.存储管理</h3><p>在controller节点执行 iaas-install-swift-controller.sh, compute </p>
<p>节点执行iaas-install-swift-compute.sh,在controller和compute节点上会自行安装 swift 服务并完成配</p>
<p>置。创建一个名为 file 的容器。</p>
<p>请将 swift stat file 命令的返回结果提交到答题框【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# swift <span class="built_in">stat</span> file</span><br><span class="line">               Account: AUTH_1a99aaa6a1024d84a00a779c4d186b44</span><br><span class="line">             Container: file</span><br><span class="line">               Objects: 0</span><br><span class="line">                 Bytes: 0</span><br><span class="line">              Read ACL:</span><br><span class="line">             Write ACL:</span><br><span class="line">               Sync To:</span><br><span class="line">              Sync Key:</span><br><span class="line">         Accept-Ranges: bytes</span><br><span class="line">      X-Storage-Policy: Policy-0</span><br><span class="line">         Last-Modified: Mon, 13 Mar 2023 20:21:50 GMT</span><br><span class="line">           X-Timestamp: 1678738909.17978</span><br><span class="line">            X-Trans-Id: tx6951e04bf6c546429752b-00640f85e4</span><br><span class="line">          Content-Type: application/json; charset=utf-8</span><br><span class="line">X-Openstack-Request-Id: tx6951e04bf6c546429752b-00640f85e4</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-swift-controller.sh</span><br><span class="line">[root@compute ~]# iaas-install-swift-compute.sh</span><br><span class="line">[root@controller ~]# swift post file</span><br></pre></td></tr></table></figure>

<h3 id="12-存储管理"><a href="#12-存储管理" class="headerlink" title="12.存储管理"></a>12.存储管理</h3><p>用 swift 命令，把 cirros-0.3.4-x86_64-disk.img 上传到 file 容器中。</p>
<p>请将 swift list file 命令的返回结果提交到答题框【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# swift list file</span><br><span class="line">cirros-0.4.0-x86_64-disk.img</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# swift upload file cirros-0.4.0-x86_64-disk.img</span><br><span class="line">cirros-0.4.0-x86_64-disk.img</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="13-添加控制节点资源到云平台"><a href="#13-添加控制节点资源到云平台" class="headerlink" title="13.添加控制节点资源到云平台"></a>13.添加控制节点资源到云平台</h3><p>修改openrc.sh中的内容，然后在controller节点执行iaas-install-nova-compute.sh，把controller</p>
<p>节点的资源添加到云平台。</p>
<p>请将 openstack compute service list 命令的返回结果提交到答题框【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack compute service list</span><br><span class="line">+----+------------------+------------+----------+---------+-------+----------------------------+</span><br><span class="line">| ID | Binary           | Host       | Zone     | Status  | State | Updated At                 |</span><br><span class="line">+----+------------------+------------+----------+---------+-------+----------------------------+</span><br><span class="line">|  1 | nova-scheduler   | controller | internal | enabled | up    | 2023-03-13T20:29:11.000000 |</span><br><span class="line">|  2 | nova-conductor   | controller | internal | enabled | up    | 2023-03-13T20:29:03.000000 |</span><br><span class="line">|  4 | nova-consoleauth | controller | internal | enabled | up    | 2023-03-13T20:29:07.000000 |</span><br><span class="line">|  7 | nova-compute     | compute    | nova     | enabled | up    | 2023-03-13T20:29:11.000000 |</span><br><span class="line">|  8 | nova-compute     | controller | nova     | enabled | up    | 2023-03-13T20:29:08.000000 |</span><br><span class="line">+----+------------------+------------+----------+---------+-------+----------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改配置文件</span></span><br><span class="line">HOST_IP_NODE=192.168.157.30</span><br><span class="line">OST_NAME_NODE=controller</span><br><span class="line"></span><br><span class="line">[root@controller ~]# iaas-install-nova-compute.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">###可能弹出认证</span></span><br><span class="line"><span class="built_in">yes</span></span><br><span class="line">000000</span><br></pre></td></tr></table></figure>

<h2 id="任务四-OpenStack-架构任务（3-分）"><a href="#任务四-OpenStack-架构任务（3-分）" class="headerlink" title="任务四 OpenStack 架构任务（3 分）"></a>任务四 OpenStack 架构任务（3 分）</h2><p>公司内部拥有一套私有云系统，为了调试该私有云，需要编写一些测试用脚本进行功能</p>
<p>性测试，作为公司私有云维护人员请你完成以下工作。</p>
<p>1.请使用 openstack 命令创建一个浮动 IP 地址，完成后使用 openstack 命令查看该浮动</p>
<p>IP 的 id，请编写一个名为 floating_show.sh 的脚本，该脚本$1 变量为浮动 ip 的 id，对接 neutron</p>
<p>服务端点获取该浮动 IP 的详细信息。脚本使用 curl 向 api 端点传递参数，为了兼容性考虑不</p>
<p>得出现 openstack 命令。</p>
<p>请将 floating_show.sh 中*部分替换为正常内容并提交到答题框【1.5 分】</p>
<p>2.请编写脚本 floating_delete.sh，完成浮动 IP 的删除。设置一个$1 变量，当用户向$1 传递</p>
<p>一个浮动 IP 的 id，即可完成该浮动 IP 的删除。脚本使用 curl 向 api 端点传递参数，为了兼</p>
<p>容性考虑不得出现 openstack 命令。</p>
<p>请将 floating_show.sh 中*部分替换为正常内容并提交到答题框【1.5 分】</p>
<h1 id="B-模块题目：容器的编排与运维"><a href="#B-模块题目：容器的编排与运维" class="headerlink" title="B 模块题目：容器的编排与运维"></a><strong>B</strong> 模块题目：容器的编排与运维</h1><table>
<thead>
<tr>
<th>ip</th>
<th>hostname</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.157.40</td>
<td>master</td>
</tr>
<tr>
<td>192.168.157.41</td>
<td>node1</td>
</tr>
<tr>
<td>192.168.157.42</td>
<td>node2</td>
</tr>
<tr>
<td>192.168.157.43</td>
<td>harbor</td>
</tr>
</tbody></table>
<h2 id="任务-1-容器云平台环境初始化（10-分）"><a href="#任务-1-容器云平台环境初始化（10-分）" class="headerlink" title="任务 1 容器云平台环境初始化（10 分）"></a><strong>任务 1 容器云平台环境初始化（10 分）</strong></h2><h3 id="1-容器云平台的初始化"><a href="#1-容器云平台的初始化" class="headerlink" title="1.容器云平台的初始化"></a>1.容器云平台的初始化</h3><p>master 节点主机名设置为 master、node1 节点主机名设置为 node1、node2 节点主机名设</p>
<p>置为 node2、harbor 节点主机名设置为 harbor,所有节点关闭 swap，并配置 hosts 映射。</p>
<p>请在 master 节点将 free –m 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7805         202         127          11        7475        7238</span><br><span class="line">Swap:             0           0           0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改主机名</span></span><br><span class="line"> <span class="comment">## master</span></span><br><span class="line">[root@localhost ~]# hostnamectl  set-hostname master</span><br><span class="line">  <span class="comment">##node1</span></span><br><span class="line">[root@localhost ~]# hostnamectl  set-hostname node1</span><br><span class="line">  <span class="comment">##node2 </span></span><br><span class="line">[root@localhost ~]# hostnamectl  set-hostname node2</span><br><span class="line">  <span class="comment">## harbor</span></span><br><span class="line">[root@localhost ~]# hostnamectl  set-hostname harbor</span><br><span class="line"></span><br><span class="line"><span class="comment">#所有节点</span></span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.157.40 master</span><br><span class="line">192.168.157.41 node1</span><br><span class="line">192.168.157.42 node2</span><br><span class="line">192.168.157.43 harbor</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# swapoff -a</span><br><span class="line">[root@localhost ~]# <span class="built_in">cat</span> /etc/fstab</span><br><span class="line"><span class="comment">#/dev/mapper/centos-swap swap                    swap    defaults        0 0</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Yum-源数据的持久化挂载"><a href="#2-Yum-源数据的持久化挂载" class="headerlink" title="2.Yum 源数据的持久化挂载"></a>2.Yum 源数据的持久化挂载</h3><p>将提供的 CentOS-7-x86_64-DVD-1804.iso 和 bricsskills_cloud_paas.iso 光盘镜像文件移</p>
<p>动到 master 节点 &#x2F;root 目录下，然后在 &#x2F;opt 目录下使用命令创建 centos 目录和 paas 目录，</p>
<p>并将镜像文件 CentOS-7-x86_64-DVD-1804.iso 永久挂载到 centos 目录下，将镜像文件</p>
<p>chinaskills_cloud_paas.iso 永久挂载到 &#x2F;opt&#x2F;paas 目录下。</p>
<p>请在 master 节点将 df -h 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# df -h</span><br><span class="line">文件系统                 容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/centos-root   44G   14G   31G   32% /</span><br><span class="line">devtmpfs                 3.8G     0  3.8G    0% /dev</span><br><span class="line">tmpfs                    3.9G     0  3.9G    0% /dev/shm</span><br><span class="line">tmpfs                    3.9G   12M  3.8G    1% /run</span><br><span class="line">tmpfs                    3.9G     0  3.9G    0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1               1014M  142M  873M   14% /boot</span><br><span class="line">tmpfs                    781M     0  781M    0% /run/user/0</span><br><span class="line">/dev/loop0               4.2G  4.2G     0  100% /opt/centos</span><br><span class="line">/dev/loop1               8.7G  8.7G     0  100% /opt/paas</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##将指定的文件上传到root</span></span><br><span class="line"></span><br><span class="line">[root@master ~]# <span class="built_in">mkdir</span> /opt/centos</span><br><span class="line">[root@master ~]# <span class="built_in">mkdir</span> /opt/paas</span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/fstab</span><br><span class="line">/root/CentOS-7-x86_64-DVD-1804.iso /opt/centos iso9660 defaults 0 0</span><br><span class="line">/root/bricsskills_cloud_paas.iso /opt/paas iso9660 defaults 0 0</span><br><span class="line">[root@master ~]# mount -a</span><br><span class="line">mount: /dev/loop0 写保护，将以只读方式挂载</span><br><span class="line">mount: /dev/loop1 写保护，将以只读方式挂载</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-Yum-源的编写"><a href="#3-Yum-源的编写" class="headerlink" title="3.Yum 源的编写"></a>3.Yum 源的编写</h3><p>在 master 节点首先将系统自带的 yum 源移动到&#x2F;home 目录，然后为 master 节点配置本</p>
<p>地 yum 源，yum 源文件名为 local.repo。</p>
<p>请将 yum list | grep docker 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# yum list | grep docker</span><br><span class="line">docker-ce.x86_64                        3:19.03.13-3.el7               paas</span><br><span class="line">docker-ce-cli.x86_64                    1:19.03.13-3.el7               paas</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# <span class="built_in">mv</span> /etc/yum.repos.d/* /home/</span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/yum.repos.d/local.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=file:///opt/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[paas]</span><br><span class="line">name=paas</span><br><span class="line">baseurl=file:///opt/paas/kubernetes-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-Yum-源的编写"><a href="#4-Yum-源的编写" class="headerlink" title="4.Yum 源的编写"></a>4.Yum 源的编写</h3><p>在 master 节点安装 ftp 服务，将 ftp 共享目录设置为 &#x2F;opt&#x2F;。</p>
<p>请将 curl -l ftp:&#x2F;&#x2F;云主机 IP 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# curl -l ftp://192.168.157.40</span><br><span class="line">centos</span><br><span class="line">paas</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#关闭防火墙及安全策略 全部节点</span></span><br><span class="line">[root@master ~]# systemctl stop firewalld &amp;&amp; systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span><br><span class="line">[root@master ~]# setenforce 0</span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/selinux/config</span><br><span class="line">SELINUX=permissive</span><br><span class="line"></span><br><span class="line">[root@master ~]# yum install -y vsftpd</span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/vsftpd/vsftpd.conf</span><br><span class="line">anon_root=/opt</span><br><span class="line"></span><br><span class="line">[root@master ~]# systemctl <span class="built_in">enable</span> vsftpd --now</span><br></pre></td></tr></table></figure>

<h3 id="5-Yum-源的编写"><a href="#5-Yum-源的编写" class="headerlink" title="5.Yum 源的编写"></a>5.Yum 源的编写</h3><p>为 node1 节点和 node2 节点分别配置 ftp 源，yum 源文件名称为 ftp.repo，其中 ftp 服务</p>
<p>器地址为 master 节点,配置 ftp 源时不要写 IP 地址，配置之后，两台机器都安装 kubectl 包作</p>
<p>为安装测试。</p>
<p>在 node1 节点请将 yum list | grep kubectl 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# yum list | grep kubectl</span><br><span class="line">kubectl.x86_64                          1.18.1-0                       paas                                                                                  </span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@localhost ~]# <span class="built_in">mv</span> /etc/yum.repos.d/* /home</span><br><span class="line">[root@localhost ~]# <span class="built_in">cat</span> /etc/yum.repos.d/ftp.repo</span><br><span class="line">[centos]</span><br><span class="line">name=centos</span><br><span class="line">baseurl=ftp://master/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">[paas]</span><br><span class="line">name=paas</span><br><span class="line">baseurl=ftp://master/paas/kubernetes-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-设置时间同步服务器"><a href="#6-设置时间同步服务器" class="headerlink" title="6.设置时间同步服务器"></a>6.设置时间同步服务器</h3><p>在 master 节点上部署 chrony 服务器，允许其它节点同步时间，启动服务并设置为开机</p>
<p>自启动；在其他节点上指定 master 节点为上游 NTP 服务器，重启服务并设为开机自启动。</p>
<p>在 node1 节点将 chronyc sources 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# chronyc sources</span><br><span class="line">210 Number of sources = 1</span><br><span class="line">MS Name/IP address         Stratum Poll Reach LastRx Last sample</span><br><span class="line">===============================================================================</span><br><span class="line">^* master                       11   6    17    36  -1673ns[  -15us] +/-  453us</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/chrony.conf</span><br><span class="line"><span class="comment">#server 0.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 1.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 2.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 3.centos.pool.ntp.org iburst</span></span><br><span class="line">server master iburst</span><br><span class="line">.....</span><br><span class="line"><span class="built_in">local</span> stratum 10</span><br><span class="line">allow 192.168.157.0/24</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#其他节点</span></span><br><span class="line">[root@node1 ~]# <span class="built_in">cat</span> /etc/chrony.conf</span><br><span class="line"><span class="comment">#server 0.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 1.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 2.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 3.centos.pool.ntp.org iburst</span></span><br><span class="line">server master iburst</span><br><span class="line"></span><br><span class="line"><span class="comment">#重启服务(全部节点)</span></span><br><span class="line">[root@node1 ~]# systemctl restart chronyd</span><br><span class="line">[root@node1 ~]# chronyc sources</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-设置免密登录"><a href="#7-设置免密登录" class="headerlink" title="7.设置免密登录"></a>7.设置免密登录</h3><p>为四台服务器设置免密登录，保证服务器之间能够互相免密登录。</p>
<p>在 master 节点将 ssh node1 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# ssh node1</span><br><span class="line">Last login: Mon Mar 13 23:49:45 2023 from 192.168.157.1</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# ssh-keygen</span><br><span class="line">-&gt; 直接回车即可</span><br><span class="line">[root@master ~]# ssh-copy-id root@node1</span><br><span class="line">[root@master ~]# ssh-copy-id root@node2</span><br><span class="line">[root@master ~]# ssh-copy-id root@harbor</span><br></pre></td></tr></table></figure>

<h2 id="任务-2-k8s-搭建任务（15-分）"><a href="#任务-2-k8s-搭建任务（15-分）" class="headerlink" title="任务 2 k8s 搭建任务（15 分）"></a><strong>任务 2 k8s 搭建任务（15 分）</strong></h2><h3 id="1-安装-docker-应用"><a href="#1-安装-docker-应用" class="headerlink" title="1.安装 docker 应用"></a>1.安装 docker 应用</h3><p>在所有节点上安装 dokcer-ce,并设置为开机自启动。</p>
<p>在 master 节点请将 docker version 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# docker version</span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           19.03.13</span><br><span class="line"> API version:       1.40</span><br><span class="line"> Go version:        go1.13.15</span><br><span class="line"> Git commit:        4484c46d9d</span><br><span class="line"> Built:             Wed Sep 16 17:03:45 2020</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Experimental:      <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          19.03.13</span><br><span class="line">  API version:      1.40 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.13.15</span><br><span class="line">  Git commit:       4484c46d9d</span><br><span class="line">  Built:            Wed Sep 16 17:02:21 2020</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     <span class="literal">false</span></span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.3.7</span><br><span class="line">  GitCommit:        8fba4e9a7d01810a393d5d25a3621dc101981175</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.0.0-rc10</span><br><span class="line">  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.18.0</span><br><span class="line">  GitCommit:        fec3683</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##所有节点</span></span><br><span class="line">[root@master ~]# yum install -y docker-ce</span><br><span class="line">[root@master ~]# systemctl <span class="built_in">enable</span> docker --now</span><br></pre></td></tr></table></figure>

<h3 id="2-安装-docker-应用"><a href="#2-安装-docker-应用" class="headerlink" title="2.安装 docker 应用"></a>2.安装 docker 应用</h3><p>所有节点配置阿里云镜像加速地址(<a target="_blank" rel="noopener" href="https://5twf62k1.mirror.aliyuncs.com)并把启动引擎/">https://5twf62k1.mirror.aliyuncs.com)并把启动引擎</a></p>
<p>设置为 systemd，配置成功重启 docker 服务。</p>
<p>请将 json 文件中的内容提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# <span class="built_in">cat</span> /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://5twf62k1.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line">  <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://5twf62k1.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line">  <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.vgroupdriver=systemd&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@node1 ~]# systemctl restart docker</span><br></pre></td></tr></table></figure>

<h3 id="3-安装-docker-compose"><a href="#3-安装-docker-compose" class="headerlink" title="3.安装 docker-compose"></a>3.安装 docker-compose</h3><p>在 Harbor 节点创建目录&#x2F;opt&#x2F;paas,并把 bricsskills_cloud_paas.iso，挂载到&#x2F;opt&#x2F;paas 目录下，</p>
<p>使 用 &#x2F;opt&#x2F;paas&#x2F;docker-compose&#x2F;v1.25.5-docker-compose-Linux-x86_64 </p>
<p>文 件 安 装docker-compose。安装完成后执行 docker-compose version 命令。</p>
<p>请将 docker-compose version 命令返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@localhost paas]# docker-compose version</span><br><span class="line">docker-compose version 1.25.5, build 8a1c60f6</span><br><span class="line">docker-py version: 4.1.0</span><br><span class="line">CPython version: 3.7.5</span><br><span class="line">OpenSSL version: OpenSSL 1.1.0l  10 Sep 2019</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在 Harbor 节点创建目录/opt/paas,并把 bricsskills_cloud_paas.iso，挂载到/opt/paas 目录下</span></span><br><span class="line">[root@harbor paas]# <span class="built_in">cp</span> -p v1.25.5-docker-compose-Linux-x86_64 /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<h3 id="4-搭建-horbor-仓库"><a href="#4-搭建-horbor-仓库" class="headerlink" title="4.搭建 horbor 仓库"></a>4.搭建 horbor 仓库</h3><p>在 Harbor 节点使用&#x2F;opt&#x2F;paas&#x2F;harbor&#x2F; harbor-offline-installer-v2.1.0.tgz 离线安装包，安装</p>
<p>harbor 仓库，并修改各节点默认 docker 仓库为 harbor 仓库地址。</p>
<p>在 master 节点请将 docker login harbor private ip 命令的返回结果提交到答题框。【1</p>
<p>分</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# docker login 192.168.157.43</span><br><span class="line">Username: admin</span><br><span class="line">Password:</span><br><span class="line">Error response from daemon: Get http://harbor/v2/: dial tcp 192.168.157.43:80: connect: connection refused</span><br><span class="line">[root@master ~]# docker login harbor</span><br><span class="line">Username: admin</span><br><span class="line">Password:</span><br><span class="line">WARNING! Your password will be stored unencrypted <span class="keyword">in</span> /root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br><span class="line"></span><br><span class="line">Login Succeeded</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#所有节点添加harbor地址</span></span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://5twf62k1.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line">  <span class="string">&quot;insecure-registries&quot;</span>: [<span class="string">&quot;192.168.157.43&quot;</span>],</span><br><span class="line">  <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#解压压缩包</span></span><br><span class="line">[root@harbor paas]# tar -zxvf harbor-offline-installer-v2.1.0.tgz</span><br><span class="line">[root@harbor harbor]# <span class="built_in">cp</span> -p harbor.yml.tmpl harbor.yml</span><br><span class="line">hostname: 192.168.157.43</span><br><span class="line"><span class="comment">#https:</span></span><br><span class="line">  <span class="comment"># https port for harbor, default is 443</span></span><br><span class="line"><span class="comment">#  port: 443</span></span><br><span class="line">  <span class="comment"># The path of cert and key files for nginx</span></span><br><span class="line"><span class="comment">#  certificate: /your/certificate/path</span></span><br><span class="line"><span class="comment">#  private_key: /your/private/key/path</span></span><br><span class="line"></span><br><span class="line">[root@harbor harbor]# ./prepare</span><br><span class="line">[root@harbor harbor]# ./install.sh</span><br></pre></td></tr></table></figure>

<h3 id="5-上传-docker-镜像"><a href="#5-上传-docker-镜像" class="headerlink" title="5.上传 docker 镜像"></a>5.上传 docker 镜像</h3><p>在 master 节点使用命令将&#x2F;opt&#x2F;paas&#x2F;images 目录下所有镜像导入本地。然后使用</p>
<p>&#x2F;opt&#x2F;paas&#x2F;k8s_image_push.sh 将所有镜像上传至 docker 仓库。</p>
<p>在master 节点请将 docker images | grep wordpress命令的返回结果提交到答题框。【1分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master paas]# docker images | grep wordpress</span><br><span class="line">wordpress                                                         latest              1b83fad37165        2 years ago         546MB</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master images]# <span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">ls</span> /opt/paas/images|grep tar); <span class="keyword">do</span>   docker load -i /opt/paas/images/<span class="variable">$i</span>; <span class="keyword">done</span></span><br><span class="line">[root@master images]# ../k8s_image_push.sh</span><br></pre></td></tr></table></figure>

<h3 id="6-安装-kubeadm-工具"><a href="#6-安装-kubeadm-工具" class="headerlink" title="6.安装 kubeadm 工具"></a>6.安装 kubeadm 工具</h3><p>在 master 节点、node1 节点、node2 节点分别安装 Kubeadm 工具并设置为开机自启动。</p>
<p>在 master 节点请将 kubeadm version 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master images]# kubeadm version</span><br><span class="line">kubeadm version: &amp;version.Info&#123;Major:<span class="string">&quot;1&quot;</span>, Minor:<span class="string">&quot;18&quot;</span>, GitVersion:<span class="string">&quot;v1.18.1&quot;</span>, GitCommit:<span class="string">&quot;7879fc12a63337efff607952a323df90cdc7a335&quot;</span>, GitTreeState:<span class="string">&quot;clean&quot;</span>, BuildDate:<span class="string">&quot;2020-04-08T17:36:32Z&quot;</span>, GoVersion:<span class="string">&quot;go1.13.9&quot;</span>, Compiler:<span class="string">&quot;gc&quot;</span>, Platform:<span class="string">&quot;linux/amd64&quot;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master images]# yum install -y kubeadm kubelet kubectl</span><br><span class="line">[root@master images]# systemctl <span class="built_in">enable</span> kubelet --now</span><br></pre></td></tr></table></figure>

<h3 id="7-初始化-master-节点"><a href="#7-初始化-master-节点" class="headerlink" title="7.初始化 master 节点"></a>7.初始化 master 节点</h3><p>使用 kubeadm 命令生成 yaml 文件，并修改 yaml 文件，设置 kubernetes 虚拟内部网段地</p>
<p>址为 10.244.0.0&#x2F;16，通过该 yaml 文件初始化 master 节点，然后使用 kube-flannel.yaml 完成</p>
<p>控制节点初始化设置。</p>
<p>在 master 节点的 kube-flannel.yaml 执行前将 kubectl get nodes 命令的返回结果提交</p>
<p>到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# kubectl get nodes</span><br><span class="line">NAME     STATUS     ROLES    AGE     VERSION</span><br><span class="line">master   NotReady   master   5m57s   v1.18.1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成yaml文件</span></span><br><span class="line">[root@master ~]# kubeadm config <span class="built_in">print</span> init-defaults  &gt; kubeadm-config.yaml</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta2</span><br><span class="line">bootstrapTokens:</span><br><span class="line">- <span class="built_in">groups</span>:</span><br><span class="line">  - system:bootstrappers:kubeadm:default-node-token</span><br><span class="line">  token: abcdef.0123456789abcdef</span><br><span class="line">  ttl: 24h0m0s</span><br><span class="line">  usages:</span><br><span class="line">  - signing</span><br><span class="line">  - authentication</span><br><span class="line">kind: InitConfiguration</span><br><span class="line">localAPIEndpoint:</span><br><span class="line">  advertiseAddress: 192.168.200.3     <span class="comment"># 本机IP</span></span><br><span class="line">  bindPort: 6443</span><br><span class="line">nodeRegistration:</span><br><span class="line">  criSocket: /var/run/dockershim.sock</span><br><span class="line">  name: master1        <span class="comment"># 本主机名</span></span><br><span class="line">  taints:</span><br><span class="line">  - effect: NoSchedule</span><br><span class="line">    key: node-role.kubernetes.io/master</span><br><span class="line">---</span><br><span class="line">apiServer:</span><br><span class="line">  timeoutForControlPlane: 4m0s</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta2</span><br><span class="line">certificatesDir: /etc/kubernetes/pki</span><br><span class="line">clusterName: kubernetes</span><br><span class="line">controlPlaneEndpoint: <span class="string">&quot;192.168.200.16:16443&quot;</span>    <span class="comment"># 虚拟IP和haproxy端口</span></span><br><span class="line">controllerManager: &#123;&#125;</span><br><span class="line">dns:</span><br><span class="line">  <span class="built_in">type</span>: CoreDNS</span><br><span class="line">etcd:</span><br><span class="line">  <span class="built_in">local</span>:</span><br><span class="line">    dataDir: /var/lib/etcd</span><br><span class="line">imageRepository: k8s.gcr.io    <span class="comment"># 镜像仓库源要根据自己实际情况修改</span></span><br><span class="line">kind: ClusterConfiguration</span><br><span class="line">kubernetesVersion: v1.18.2     <span class="comment"># k8s版本</span></span><br><span class="line">networking:</span><br><span class="line">  dnsDomain: cluster.local</span><br><span class="line">  podSubnet: <span class="string">&quot;10.244.0.0/16&quot;</span></span><br><span class="line">  serviceSubnet: 10.96.0.0/12</span><br><span class="line">scheduler: &#123;&#125;</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: kubeproxy.config.k8s.io/v1alpha1</span><br><span class="line">kind: KubeProxyConfiguration</span><br><span class="line">featureGates:</span><br><span class="line">  SupportIPVSProxyMode: <span class="literal">true</span></span><br><span class="line">mode: ipvs</span><br><span class="line"></span><br><span class="line">[root@master ~]# kubeadm init --config kubeadm-config.yaml</span><br><span class="line"></span><br><span class="line">[root@master ~]# <span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">[root@master ~]# <span class="built_in">sudo</span> <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">[root@master ~]# <span class="built_in">sudo</span> <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="8-删除污点"><a href="#8-删除污点" class="headerlink" title="8.删除污点"></a>8.删除污点</h3><p>使用命令删除 master 节点的污点，使得 Pod 也可以调度到 master 节点上。</p>
<p>在 master 节点请将 kubectl get nodes -o yaml master | grep -A10 spec 命令的返回结果提</p>
<p>交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@master paas]#  kubectl get nodes -o yaml master | grep -A10 spec</span><br><span class="line">      f:spec:</span><br><span class="line">        f:taints: &#123;&#125;</span><br><span class="line">    manager: kube-controller-manager</span><br><span class="line">    operation: Update</span><br><span class="line">    <span class="keyword">time</span>: <span class="string">&quot;2023-03-14T05:56:43Z&quot;</span></span><br><span class="line">  name: master</span><br><span class="line">  resourceVersion: <span class="string">&quot;2383&quot;</span></span><br><span class="line">  selfLink: /api/v1/nodes/master</span><br><span class="line">  uid: abca28aa-3941-436f-ad5f-db5e12cbcaab</span><br><span class="line">spec:</span><br><span class="line">  taints:</span><br><span class="line">  - effect: NoSchedule</span><br><span class="line">    key: node.kubernetes.io/not-ready</span><br><span class="line">  - effect: NoExecute</span><br><span class="line">    key: node.kubernetes.io/not-ready</span><br><span class="line">    timeAdded: <span class="string">&quot;2023-03-14T05:56:43Z&quot;</span></span><br><span class="line">status:</span><br><span class="line">  addresses:</span><br><span class="line">  - address: 192.168.157.40</span><br><span class="line">    <span class="built_in">type</span>: InternalIP</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master paas]# kubectl taint nodes master node-role.kubernetes.io/master-</span><br></pre></td></tr></table></figure>

<h3 id="9-安装-kubernetes-网络插件"><a href="#9-安装-kubernetes-网络插件" class="headerlink" title="9.安装 kubernetes 网络插件"></a>9.安装 kubernetes 网络插件</h3><p>使用 kube-flannel.yaml 安装 kubernetes 网络插件，安装完成后使用命令查看节点状态。</p>
<p>在 master 节点请将 kubectl get nodes 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@master yaml]# kubectl get nodes</span><br><span class="line">NAME     STATUS   ROLES    AGE   VERSION</span><br><span class="line">master   Ready    master   15m   v1.18.1</span><br><span class="line">root@master paas]# <span class="built_in">cd</span> yaml/</span><br><span class="line">[root@master yaml]# <span class="built_in">ls</span></span><br><span class="line">dashboard  flannel</span><br><span class="line">[root@master yaml]# kubectl apply -f flannel/kube-flannel.yaml</span><br></pre></td></tr></table></figure>

<h3 id="10-给-kubernetes-创建证书。"><a href="#10-给-kubernetes-创建证书。" class="headerlink" title="10.给 kubernetes 创建证书。"></a>10.给 kubernetes 创建证书。</h3><p> 在 master 节点请将 kubectl get csr 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master paas]# kubectl get csr</span><br><span class="line">NAME        AGE   SIGNERNAME                                    REQUESTOR            CONDITION</span><br><span class="line">csr-w6k9j   16m   kubernetes.io/kube-apiserver-client-kubelet   system:node:master   Approved,Issued</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="11-kubernetes-图形化界面的安装"><a href="#11-kubernetes-图形化界面的安装" class="headerlink" title="11.kubernetes 图形化界面的安装"></a>11.kubernetes 图形化界面的安装</h3><p>使用 recommended.yaml 和 dashboard-adminuser.yaml 安装 kubernetes dashboard 界面，</p>
<p>完成后查看首页。</p>
<p>请将 kubectl get pod,svc -n kubernetes-dashboard 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> dashboard-certs</span><br><span class="line"><span class="built_in">cd</span> dashboard-certs/</span><br><span class="line"></span><br><span class="line">kubectl create namespace kubernetes-dashboard</span><br><span class="line">openssl genrsa -out dashboard.key 2048</span><br><span class="line">openssl req -days 36000 -new -out dashboard.csr -key dashboard.key -subj <span class="string">&#x27;/CN=dashboard-cert&#x27;</span></span><br><span class="line">openssl x509 -req -<span class="keyword">in</span> dashboard.csr -signkey dashboard.key -out dashboard.crt</span><br><span class="line">kubectl create secret generic kubernetes-dashboard-certs --from-file=dashboard.key --from-file=dashboard.crt -n kubernetes-dashboard</span><br><span class="line"></span><br><span class="line"><span class="comment">##安装dashboard</span></span><br><span class="line">kubectl apply -f recommended.yaml </span><br><span class="line"><span class="comment">#查看状态</span></span><br><span class="line">kubectl get pod,svc -n kubernetes-dashboard</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"> kubectl apply -f dashboard-adminuser.yaml </span><br><span class="line"> </span><br><span class="line"> <span class="comment">#获取token</span></span><br></pre></td></tr></table></figure>

<h3 id="12-扩展计算节点"><a href="#12-扩展计算节点" class="headerlink" title="12.扩展计算节点"></a>12.扩展计算节点</h3><p>在 node1 节点和 node2 节点分别使用 kubeadm config 命令生成 yaml 文件，并通过 yaml</p>
<p>文件将 node 节点加入 kubernetes 集群。完成后在 master 节点上查看所有节点状态。在 master 节点请将 kubectl get nodes 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# kubectl get nodes</span><br><span class="line">NAME     STATUS   ROLES    AGE    VERSION</span><br><span class="line">master   Ready    master   5d9h   v1.19.0</span><br><span class="line">node1    Ready    &lt;none&gt;   5d9h   v1.19.0</span><br><span class="line">node2    Ready    &lt;none&gt;   5d9h   v1.19.0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubeadm config <span class="built_in">print</span> join-defaults &gt; kubeadm-config.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">##然后把相应token修改即可</span></span><br></pre></td></tr></table></figure>





<h2 id="任务-3-EFK-日志平台构建（15-分）"><a href="#任务-3-EFK-日志平台构建（15-分）" class="headerlink" title="任务 3 EFK 日志平台构建（15 分）"></a><strong>任务 3 EFK 日志平台构建（15 分）</strong></h2><h3 id="1-导入镜像"><a href="#1-导入镜像" class="headerlink" title="1.导入镜像"></a>1.导入镜像</h3><p>将提供的 efk-img.tar.gz 压缩包中的镜像导入到 master 节点，并使用命令将镜像上传至</p>
<p>haboor 镜像仓库中。</p>
<p>在master节点将docker images | grep elasticsearch命令的返回结果提交到答题框。【1分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="2-NFS-配置网段访问"><a href="#2-NFS-配置网段访问" class="headerlink" title="2.NFS 配置网段访问"></a>2.NFS 配置网段访问</h3><p>在 master 节点、node1 节点、node2 节点分别安装 nfs 服务， </p>
<p>master 节点作为服务端，把&#x2F;data&#x2F;volume1 目录作为共享目录，只允许 192.168.10 网段访问。</p>
<p>在 master 节点，将 showmount –e 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# showmount -e</span><br><span class="line">Export list <span class="keyword">for</span> master:</span><br><span class="line">/data/volume1 192.168.157.0/24</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#所有节点</span></span><br><span class="line">[root@node1 ~]# yum install -y nfs-utils</span><br><span class="line">[root@master ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/volume1 192.168.157.0/24(rw)</span><br></pre></td></tr></table></figure>

<h3 id="3-RBAC-配置"><a href="#3-RBAC-配置" class="headerlink" title="3.RBAC 配置"></a>3.RBAC 配置</h3><p>在 master 节点，编写 sa.yaml，创建名称为 nfs-provisioner 的 SA 账号。</p>
<p>将 kubectl get serviceaccounts -n kube-logging 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master rbac]# kubectl get serviceaccounts -n kube-logging</span><br><span class="line">NAME              SECRETS   AGE</span><br><span class="line">default           1         23s</span><br><span class="line">nfs-provisioner   1         14s</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@master ~]# <span class="built_in">mkdir</span> rbac</span><br><span class="line">[root@master ~]# <span class="built_in">cd</span> rbac/</span><br><span class="line">[root@master rbac]# vi sa.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: nfs-client-provisioner</span><br><span class="line">  namespace: kube-logging</span><br><span class="line">[root@master rbac]# kubectl create ns  kube-logging</span><br><span class="line">[root@master rbac]# kubectl apply -f sa.yaml</span><br></pre></td></tr></table></figure>

<h3 id="4-RBAC-配置"><a href="#4-RBAC-配置" class="headerlink" title="4.RBAC 配置"></a>4.RBAC 配置</h3><p>编写 rbac.yaml ，对创建的 sa 账号进行 RBAC 授权，基于 yaml 文件创建完成后使用命令分别查看 sa 账号和 rbac 授权信息。</p>
<p>将 kubectl get roles.rbac.authorization.k8s.io 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@master rbac]# kubectl get roles.rbac.authorization.k8s.io</span><br><span class="line">NAME                     CREATED AT</span><br><span class="line">leader-nfs-provisioner   2023-03-14T09:04:04Z</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">kind: ClusterRole</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: nfs-client-provisioner-runner</span><br><span class="line">rules:</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;nodes&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;persistentvolumes&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;delete&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;persistentvolumeclaims&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;update&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;storage.k8s.io&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;storageclasses&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;events&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line">---</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: run-nfs-client-provisioner</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: nfs-client-provisioner</span><br><span class="line">    namespace: kube-logging</span><br><span class="line">roleRef:</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: nfs-client-provisioner-runner</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">---</span><br><span class="line">kind: Role</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: leader-locking-nfs-client-provisioner</span><br><span class="line">  namespace: kube-logging</span><br><span class="line">rules:</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;endpoints&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line">---</span><br><span class="line">kind: RoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: leader-locking-nfs-client-provisioner</span><br><span class="line">  namespace: kube-logging</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: nfs-client-provisioner</span><br><span class="line">    namespace: kube-logging</span><br><span class="line">roleRef:</span><br><span class="line">  kind: Role</span><br><span class="line">  name: leader-locking-nfs-client-provisioner</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br></pre></td></tr></table></figure>



<h3 id="5-StorageClass-动态绑定"><a href="#5-StorageClass-动态绑定" class="headerlink" title="5.StorageClass 动态绑定"></a>5.StorageClass 动态绑定</h3><p>编写 nfs-deploy.yaml 文件，基于 nfs-client-provisioner 镜像创建 nfs-provisioner 的</p>
<p>deployment 对象，绑定 nfs 服务端的共享目录。</p>
<p>将 kubectl get pods 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master rbac]# kubectl get pod</span><br><span class="line">nfs-deploy-754d9b668c-chhqx       2/2     Running       1          9s</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# <span class="built_in">cat</span> nfs-deployment.yaml</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: nfs-client-provisioner</span><br><span class="line">  labels:</span><br><span class="line">    app: nfs-client-provisioner</span><br><span class="line">  namespace: kube-logging</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  strategy:</span><br><span class="line">    <span class="built_in">type</span>: Recreate</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: nfs-client-provisioner</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: nfs-client-provisioner</span><br><span class="line">    spec:</span><br><span class="line">      nodeName: master   <span class="comment">#设置在master节点运行</span></span><br><span class="line">      serviceAccountName: nfs-client-provisioner</span><br><span class="line">      containers:</span><br><span class="line">        - name: nfs-client-provisioner</span><br><span class="line">          image: quay.io/external_storage/nfs-client-provisioner:latest</span><br><span class="line">          imagePullPolicy: IfNotPresent</span><br><span class="line">          volumeMounts:</span><br><span class="line">            - name: nfs-client-root</span><br><span class="line">              mountPath: /persistentvolumes</span><br><span class="line">          <span class="built_in">env</span>:</span><br><span class="line">            - name: PROVISIONER_NAME</span><br><span class="line">              value: k8s/nfs-subdir-external-provisioner</span><br><span class="line">            - name: NFS_SERVER</span><br><span class="line">              value: 192.168.157.10</span><br><span class="line">            - name: NFS_PATH</span><br><span class="line">              value: /data/volume1</span><br><span class="line">      volumes:</span><br><span class="line">        - name: nfs-client-root</span><br><span class="line">          nfs:</span><br><span class="line">            server: 192.168.157.10  <span class="comment"># NFS SERVER_IP</span></span><br><span class="line">            path: /data/volume1</span><br></pre></td></tr></table></figure>

<h3 id="6-StorageClass-动态绑定"><a href="#6-StorageClass-动态绑定" class="headerlink" title="6.StorageClass 动态绑定"></a>6.StorageClass 动态绑定</h3><p>编写 storageclass.yaml 文件，创建 storageclass 动态绑定 nfs-provisioner，完成后查看</p>
<p>nfs-provisioner 的 pod 及 storageclasses 对象。</p>
<p>将 kubectl get storageclasses.storage.k8s.io 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master rbac]#  kubectl get storageclasses.storage.k8s.io</span><br><span class="line">NAME                   PROVISIONER                           RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE</span><br><span class="line">nfs-deploy (default)   k8s/nfs-subdir-external-provisioner   Delete          Immediate           <span class="literal">true</span>                   22m</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# <span class="built_in">cat</span> storageclass.yml</span><br><span class="line">apiVersion: storage.k8s.io/v1</span><br><span class="line">kind: StorageClass</span><br><span class="line">metadata:</span><br><span class="line">  name: managed-nfs-storage</span><br><span class="line">provisioner: k8s/nfs-subdir-external-provisioner <span class="comment"># or choose another name, must match deployment&#x27;s env PROVISIONER_NAME&#x27;</span></span><br><span class="line">allowVolumeExpansion: <span class="literal">true</span></span><br><span class="line">parameters:</span><br><span class="line">  archiveOnDelete: <span class="string">&quot;false&quot;</span> <span class="comment"># 设置为&quot;false&quot;时删除PVC不会保留数据,&quot;true&quot;则保留数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-通过-statefulset-创建-elasticsearch-集群"><a href="#7-通过-statefulset-创建-elasticsearch-集群" class="headerlink" title="7.通过 statefulset 创建 elasticsearch 集群"></a>7.通过 statefulset 创建 elasticsearch 集群</h3><p>编写 es-statefulset.yaml，通过 yaml 文件构建 elasticsearch 的 statefulset 集群，集群中有</p>
<p>3 个副本名字分别为 es-cluster-0、es-cluster-1、es-cluster-2，并且使用上述 storageclass 提供</p>
<p>的存储，使用 elasticsearch:7.2.0 镜像，并且声明 9200 端口为 api 端口，9300 端口为内部访</p>
<p>问 端 口 ， 并 且 添 加 busybox 的 初 始 化 容 器 对 elasticsearch 的 数 据 目 录</p>
<p>&#x2F;usr&#x2F;share&#x2F;elasticsearch&#x2F;data 进行授权操作。</p>
<p>将 kubectl get pods 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@master nfs]# kubectl get pod</span><br><span class="line">NAME                     READY   STATUS    RESTARTS   AGE</span><br><span class="line">es-cluster-0             1/1     Running   0          2m29s</span><br><span class="line">es-cluster-1             1/1     Running   0          112s</span><br><span class="line">es-cluster-2             1/1     Running   0          105s</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# <span class="built_in">cat</span> es-statefulset.yaml</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: StatefulSet</span><br><span class="line">metadata:</span><br><span class="line">  name: es-cluster</span><br><span class="line">spec:</span><br><span class="line">  serviceName: elasticsearch</span><br><span class="line">  replicas: 3</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: elasticsearch</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: elasticsearch</span><br><span class="line">    spec:</span><br><span class="line">      initContainers:</span><br><span class="line">      - name: increase-vm-max-map</span><br><span class="line">        image: busybox</span><br><span class="line">        <span class="built_in">command</span>: [<span class="string">&quot;sysctl&quot;</span>, <span class="string">&quot;-w&quot;</span>, <span class="string">&quot;vm.max_map_count=262144&quot;</span>]</span><br><span class="line">        securityContext:</span><br><span class="line">          privileged: <span class="literal">true</span></span><br><span class="line">      - name: <span class="built_in">chmod</span> file</span><br><span class="line">        image: busybox</span><br><span class="line">        <span class="built_in">command</span>: [<span class="string">&quot;sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;chown 1000:1000 /usr/share/elasticsearch/data&quot;</span>]</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: es-pvc</span><br><span class="line">          mountPath: /usr/share/elasticsearch/data</span><br><span class="line">      - name: increase-fd-ulimit</span><br><span class="line">        image: busybox</span><br><span class="line">        <span class="built_in">command</span>: [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;ulimit -n 65536&quot;</span>]</span><br><span class="line">        securityContext:</span><br><span class="line">          privileged: <span class="literal">true</span></span><br><span class="line">      containers:</span><br><span class="line">      - name: elasticsearch</span><br><span class="line">        image: elasticsearch:7.2.0</span><br><span class="line">        ports:</span><br><span class="line">        - name: db</span><br><span class="line">          containerPort: 9200</span><br><span class="line">        - name: int</span><br><span class="line">          containerPort: 9300</span><br><span class="line">        resources:</span><br><span class="line">          limits:</span><br><span class="line">            cpu: 1000m</span><br><span class="line">          requests:</span><br><span class="line">            cpu: 1000m</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: es-pvc</span><br><span class="line">          mountPath: /usr/share/elasticsearch/data</span><br><span class="line">        <span class="built_in">env</span>:</span><br><span class="line">        - name: cluster.name</span><br><span class="line">          value: k8s-logs</span><br><span class="line">        - name: node.name</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              fieldPath: metadata.name</span><br><span class="line">        - name: cluster.initial_master_nodes</span><br><span class="line">          value: <span class="string">&quot;es-cluster-0,es-cluster-1,es-cluster-2&quot;</span></span><br><span class="line">        - name: discovery.zen.minimum_master_nodes</span><br><span class="line">          value: <span class="string">&quot;2&quot;</span></span><br><span class="line">        - name: discovery.seed_hosts</span><br><span class="line">          value: <span class="string">&quot;elasticsearch&quot;</span></span><br><span class="line">        - name: ES_JAVA_OPTS</span><br><span class="line">          value: <span class="string">&quot;-Xms512m -Xmx512m&quot;</span></span><br><span class="line">        - name: network.host</span><br><span class="line">          value: <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">  volumeClaimTemplates:</span><br><span class="line">  - metadata:</span><br><span class="line">      name: es-pvc</span><br><span class="line">      labels:</span><br><span class="line">        app: elasticsearch</span><br><span class="line">    spec:</span><br><span class="line">      accessModes: [ <span class="string">&quot;ReadWriteMany&quot;</span> ]</span><br><span class="line">      storageClassName: <span class="string">&quot;managed-nfs-storage&quot;</span></span><br><span class="line">      resources:</span><br><span class="line">        requests:</span><br><span class="line">          storage: 10Gi</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="8-创建-headless-service"><a href="#8-创建-headless-service" class="headerlink" title="8.创建 headless service"></a>8.创建 headless service</h3><p>编写 es-svc.yaml 文件，为 elasticsearch 的 pod 创建一个 headless service，并在 service</p>
<p>中声明 9200 和 9300 端口。</p>
<p>将 kubectl get svc 命令的返回结果提交到答题框。【2 分】</p>
<p>es-svc.yaml</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# kubectl get svc</span><br><span class="line">NAME            TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)             AGE</span><br><span class="line">elasticsearch   ClusterIP   None         &lt;none&gt;        9200/TCP,9300/TCP   17s</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# <span class="built_in">cat</span> es-svc.yaml</span><br><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: elasticsearch</span><br><span class="line">  labels:</span><br><span class="line">    app: elasticsearch</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    app: elasticsearch</span><br><span class="line">  clusterIP: None</span><br><span class="line">  ports:</span><br><span class="line">    - port: 9200</span><br><span class="line">      name: api</span><br><span class="line">    - port: 9300</span><br><span class="line">      name: int</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="9-Kibana-可视化-UI-界面部署"><a href="#9-Kibana-可视化-UI-界面部署" class="headerlink" title="9.Kibana 可视化 UI 界面部署"></a>9.Kibana 可视化 UI 界面部署</h3><p>编写 kibana.yaml，通过该文件创建 deployment 和 service，其中 deployment 基于</p>
<p>kibana:7.2.0 镜像创建并通过环境变量 ELASTICSEARCH_URL 指定 elasticsearch 服务地址；</p>
<p>service 代理 kibana 的 pod 服务，并且使用 NodePort 类型。创建成功后在浏览器访问 Kibana</p>
<p>的 UI 界面。</p>
<p>将 kubectl get svc 命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# kubectl get svc</span><br><span class="line">NAME            TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)             AGE</span><br><span class="line">elasticsearch   ClusterIP   None             &lt;none&gt;        9200/TCP,9300/TCP   12m</span><br><span class="line">kibana          NodePort    10.104.107.171   &lt;none&gt;        5601:30601/TCP      82s</span><br><span class="line">kubernetes      ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP             5d7h</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[root@master nfs]# <span class="built_in">cat</span> kibana.yml</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: kibana</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kibana</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: kibana</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: kibana</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: kibana</span><br><span class="line">        image: kibana:7.2.0</span><br><span class="line">        resources:</span><br><span class="line">          limits:</span><br><span class="line">            cpu: 2</span><br><span class="line">            memory: 2Gi</span><br><span class="line">          requests:</span><br><span class="line">            cpu: 0.5</span><br><span class="line">            memory: 500Mi</span><br><span class="line">        <span class="built_in">env</span>:</span><br><span class="line">          - name: ELASTICSEARCH_HOSTS</span><br><span class="line">            value: http://elasticsearch.default:9200</span><br><span class="line">          - name: ELASTICSEARCH_URL</span><br><span class="line">            value: http://elasticsearch.default:9200</span><br><span class="line">          - name: I18N_LOCALE</span><br><span class="line">            value: zh-CN</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 5601</span><br><span class="line">          name: ui</span><br><span class="line">          protocol: TCP</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: kibana</span><br><span class="line">spec:</span><br><span class="line">  <span class="built_in">type</span>: NodePort</span><br><span class="line">  ports:</span><br><span class="line">  - port: 5601</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: ui</span><br><span class="line">    nodePort: 30601</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: kibana</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-Fluentd-组件部署"><a href="#10-Fluentd-组件部署" class="headerlink" title="10.Fluentd 组件部署"></a>10.Fluentd 组件部署</h3><p>编写 fluentd.yaml，通过 yaml 文件创建 DaemonSet 控制器部署 fluentd 服务，并在该文</p>
<p>件中同时编写相关的 sa 账号和 rbac 内容，创建成功后保证可以正确采集容器内的日志。</p>
<p>将 kubectl get pods 命令的返回结果提交到答题框。【2 分】</p>
<h1 id="C-模块题目：企业级应用的自动化部署和运维"><a href="#C-模块题目：企业级应用的自动化部署和运维" class="headerlink" title="C 模块题目：企业级应用的自动化部署和运维"></a><strong>C</strong> 模块题目：企业级应用的自动化部署和运维</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###环境</span></span><br><span class="line">192.168.157.20 ansible-control ansible</span><br><span class="line">192.168.157.21 ansible-compute1 host1</span><br><span class="line">192.168.157.22 ansible-compute2 host2</span><br><span class="line">192.168.157.23 ansible-compute3</span><br></pre></td></tr></table></figure>



<h2 id="任务-1-企业级应用的自动化部署（10-分）"><a href="#任务-1-企业级应用的自动化部署（10-分）" class="headerlink" title="任务 1 企业级应用的自动化部署（10 分）"></a><strong>任务 1 企业级应用的自动化部署（10 分）</strong></h2><h3 id="1-Ansible-自动化运维工具部署主从数据库"><a href="#1-Ansible-自动化运维工具部署主从数据库" class="headerlink" title="1.Ansible 自动化运维工具部署主从数据库"></a>1.Ansible 自动化运维工具部署主从数据库</h3><p>（1）修改主机名 ansible 节点主机名为 ansible,host1 节点主机名为 host1,host2 节点主机名为</p>
<p>host2,请使用提供的软件包在 ansible 节点安装 ansible。</p>
<p>将 ansible –version 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]#  ansible --version</span><br><span class="line">ansible 2.9.27</span><br><span class="line">  config file = /etc/ansible/ansible.cfg</span><br><span class="line">  configured module search path = [u<span class="string">&#x27;/root/.ansible/plugins/modules&#x27;</span>, u<span class="string">&#x27;/usr/share/ansible/plugins/modules&#x27;</span>]</span><br><span class="line">  ansible python module location = /usr/lib/python2.7/site-packages/ansible</span><br><span class="line">  executable location = /usr/bin/ansible</span><br><span class="line">  python version = 2.7.5 (default, Apr 11 2018, 07:36:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置主机名(其他节点同理)</span></span><br><span class="line">hostnamectl set-hostname ansible</span><br><span class="line"><span class="comment">#安装依赖</span></span><br><span class="line">[root@ansible ~]# yum install -y jinja2 PyYAML cryptography</span><br><span class="line"></span><br><span class="line">[root@ansible ~]# rpm -ivh ansible-2.4.6.0-1.el7.ans.noarch.rpm</span><br><span class="line"></span><br><span class="line">[root@ansible ~]# ansible --version</span><br></pre></td></tr></table></figure>

<p>（2）配置主机清单文件，创建 mysql 主机组，mysql 主机组内添加 host1 和 host2 主机；创</p>
<p>建 mysql1 主机组，mysql1 组内添加 host1 主机；创建 mysql2 主机组，mysql2 组内添加 host2</p>
<p>主机，并配置免密登录。</p>
<p>将 ansible all -m ping 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]# ansible all -m ping</span><br><span class="line">host2 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">host1 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[[root@ansible ~]# <span class="built_in">cat</span> /etc/ansible/hosts</span><br><span class="line">[mysql]</span><br><span class="line">host1</span><br><span class="line">host2</span><br><span class="line">[mysql1]</span><br><span class="line">host1</span><br><span class="line">[mysql2]</span><br><span class="line">host2</span><br><span class="line"></span><br><span class="line"><span class="comment">##设置免密登录</span></span><br><span class="line">[root@ansible ~]# ssh-keygen</span><br><span class="line"></span><br><span class="line">[root@ansible ~]# ssh-copy-id <span class="built_in">test</span>@192.168.157.20</span><br><span class="line">[root@ansible ~]# ssh-copy-id <span class="built_in">test</span>@192.168.157.21</span><br><span class="line">[root@ansible ~]# ssh-copy-id <span class="built_in">test</span>@192.168.157.22</span><br></pre></td></tr></table></figure>

<p>（3）mysql 主机组内所有主机安装 mariadb 数据库，启动数据库并设置为开机自启动。</p>
<p>在 host1 节点将 systemctl status mariadb 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@host1 ~]# systemctl status mariadb</span><br><span class="line">● mariadb.service - MariaDB database server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Thu 2023-03-16 01:04:32 EDT; 56min ago</span><br><span class="line">  Process: 992 ExecStartPost=/usr/libexec/mariadb-wait-ready <span class="variable">$MAINPID</span> (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 897 ExecStartPre=/usr/libexec/mariadb-prepare-db-dir %n (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 990 (mysqld_safe)</span><br><span class="line">   CGroup: /system.slice/mariadb.service</span><br><span class="line">           ├─ 990 /bin/sh /usr/bin/mysqld_safe --basedir=/usr</span><br><span class="line">           └─1259 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --log-error=/var/log/mariadb/mariadb.log...</span><br><span class="line"></span><br><span class="line">Mar 16 01:04:30 ansible-compute1 systemd[1]: Starting MariaDB database server...</span><br><span class="line">Mar 16 01:04:30 ansible-compute1 mariadb-prepare-db-dir[897]: Database MariaDB is probably initialized <span class="keyword">in</span> /var/lib/mysql already, nothing is <span class="keyword">done</span>.</span><br><span class="line">Mar 16 01:04:30 ansible-compute1 mariadb-prepare-db-dir[897]: If this is not the <span class="keyword">case</span>, make sure the /var/lib/mysql is empty before running mariadb-...db-dir.</span><br><span class="line">Mar 16 01:04:30 ansible-compute1 mysqld_safe[990]: 230316 01:04:30 mysqld_safe Logging to <span class="string">&#x27;/var/log/mariadb/mariadb.log&#x27;</span>.</span><br><span class="line">Mar 16 01:04:30 ansible-compute1 mysqld_safe[990]: 230316 01:04:30 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql</span><br><span class="line">Mar 16 01:04:32 ansible-compute1 systemd[1]: Started MariaDB database server.</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show <span class="keyword">in</span> full.</span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]# <span class="built_in">cat</span> mysql.yaml</span><br><span class="line">---</span><br><span class="line">- name: install mariadb</span><br><span class="line">  hosts: mysql</span><br><span class="line">  tasks:</span><br><span class="line">  - name: install mariadb</span><br><span class="line">    yum: name=mariadb-server state=present</span><br><span class="line">  - name: start mariadb</span><br><span class="line">    service: name=mariadb state=started enabled=<span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line">[root@ansible ~]# ansible-playbook  mysql.yaml</span><br></pre></td></tr></table></figure>

<p>（4）编写一名称为 mariadb.sh 的 shell 脚本，该脚本具有完成 mariadb 数据库的初始化功能</p>
<p>(要求数据库用户名为 root,密码为 123456)，通过 ansible 对应模块执行 mariadb.sh 完成对</p>
<p>mysql 主机组下的所有节点进行数据库初始化。</p>
<p>在 node1 节点，将 mysql -uroot -p123456 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@host1 ~]#  mysql -uroot -p123456</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 3</span><br><span class="line">Server version: 5.5.68-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]# <span class="built_in">cat</span> mariadb.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">mysqladmin -u root password <span class="string">&quot;123456&quot;</span></span><br><span class="line">[root@ansible ~]# <span class="built_in">cat</span> mysql-sh.yaml</span><br><span class="line">---</span><br><span class="line">- name: init mariadb</span><br><span class="line">  hosts: mysql</span><br><span class="line">  tasks:</span><br><span class="line">    - name: init mariadb</span><br><span class="line">      script: /root/mariadb.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（5）创建主机变量，所有主机组中 host1 节点创建变量 id&#x3D;20,hots2 节点创建变量 id&#x3D;30。</p>
<p>将 cat &#x2F;etc&#x2F;ansible&#x2F;hosts | grep id 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]#  <span class="built_in">cat</span> /etc/ansible/hosts | grep <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span>=20</span><br><span class="line"><span class="built_in">id</span>=30</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]# <span class="built_in">cat</span> /etc/ansible/hosts</span><br><span class="line">[mysql]</span><br><span class="line">host1</span><br><span class="line">host2</span><br><span class="line">[mysql1]</span><br><span class="line">host1</span><br><span class="line">[mysql2]</span><br><span class="line">host2</span><br><span class="line">[mysql1:vars]</span><br><span class="line"><span class="built_in">id</span>=20</span><br><span class="line">[mysql2:vars]</span><br><span class="line"><span class="built_in">id</span>=30</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（6）根据 mysql 配置文件创建 mysql 的 Janja2 模板文件命名为 my.cnf.j2,编写 mariadb.yaml</p>
<p>文件实现主从数据库的配置和权限设置。</p>
<p>在 ansible 节点通过 cat mariadb.yaml 命令查看文件内容返回结果提交到答题框，在 host2</p>
<p>节点进入数据库将 show slave status \G 命令的返回结果提交到答题框。【1 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show slave status \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting <span class="keyword">for</span> master to send event</span><br><span class="line">                  Master_Host: 192.168.157.21</span><br><span class="line">                  Master_User: user</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.000001</span><br><span class="line">          Read_Master_Log_Pos: 524</span><br><span class="line">               Relay_Log_File: ansible-compute2-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 808</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000001</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">          Replicate_Ignore_DB:</span><br><span class="line">           Replicate_Do_Table:</span><br><span class="line">       Replicate_Ignore_Table:</span><br><span class="line">      Replicate_Wild_Do_Table:</span><br><span class="line">  Replicate_Wild_Ignore_Table:</span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error:</span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 524</span><br><span class="line">              Relay_Log_Space: 1113</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File:</span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File:</span><br><span class="line">           Master_SSL_CA_Path:</span><br><span class="line">              Master_SSL_Cert:</span><br><span class="line">            Master_SSL_Cipher:</span><br><span class="line">               Master_SSL_Key:</span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error:</span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error:</span><br><span class="line">  Replicate_Ignore_Server_Ids:</span><br><span class="line">             Master_Server_Id: 20</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> my.cnf.j2</span><br><span class="line">[mysqld]</span><br><span class="line">log_bin=mysql-bin</span><br><span class="line">server_id=&#123;&#123; <span class="built_in">id</span> &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ansible ~]# <span class="built_in">cat</span> mariadb.yaml</span><br><span class="line">---</span><br><span class="line">- name: config mariadb</span><br><span class="line">  hosts: mysql1,mysql2</span><br><span class="line">  tasks:</span><br><span class="line">  - name: config my.cnf</span><br><span class="line">    template: src=my.cnf.j2 dest=/etc/my.cnf</span><br><span class="line">  - name: restart mariadb</span><br><span class="line">    service: name=mariadb state=restarted enabled=<span class="built_in">yes</span></span><br><span class="line">  - name: grant user</span><br><span class="line">    shell: mysql -uroot -p123456 -e <span class="string">&quot;grant all privileges on *.* to root@&#x27;%&#x27; identified by &#x27;123456&#x27;;&quot;</span></span><br><span class="line">    when: inventory_hostname <span class="keyword">in</span> groups.mysql1</span><br><span class="line">  - name: master create user</span><br><span class="line">    shell: mysql -uroot -p123456 -e <span class="string">&quot;grant replication slave on *.* to &#x27;user&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27;;&quot;</span></span><br><span class="line">    when: inventory_hostname <span class="keyword">in</span> groups.mysql1</span><br><span class="line">  - name: node</span><br><span class="line">    shell: mysql -uroot -p123456 -e <span class="string">&quot;change master to master_host=&#x27;192.168.157.21&#x27;,master_user=&#x27;user&#x27;,master_password=&#x27;123456&#x27;;&quot;</span></span><br><span class="line">    when: inventory_hostname <span class="keyword">in</span> groups.mysql2</span><br><span class="line">  - name: start slave</span><br><span class="line">    shell: mysql -uroot -p123456 -e <span class="string">&quot;start slave;&quot;</span></span><br><span class="line">    when: inventory_hostname <span class="keyword">in</span> groups.mysql2</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="2-Ansible-自动化运维工具部署-zookeeper-集群"><a href="#2-Ansible-自动化运维工具部署-zookeeper-集群" class="headerlink" title="2.Ansible 自动化运维工具部署 zookeeper 集群"></a>2.Ansible 自动化运维工具部署 zookeeper 集群</h3><p>zookeeper 是一个分布式服务框架，是 Apache Hadoop 的一个子项目，主要是用来解决</p>
<p>分布式应用中经常遇到的一些数据管理问题，如：统一命名服务、状态同步服务、集群管理、</p>
<p>分布式应用配置项的管理等。gpmall 商城系统中用到了 kafka 消息队列，kafka 集群的搭建</p>
<p>依赖 zookeeper 集群来进行元数据的管理。</p>
<p>（1）编写主机清单文件，创建 zookeeper 主机组，zookeeper 主机组内添加 ansible、host1</p>
<p>和 host2 主机，分别创建主机变量 zk_id&#x3D;私有 IP 最后一个数字。</p>
<p>将 ansible all -a “id”命令的返回结果提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@ansible ~]# ansible all -a <span class="string">&quot;id&quot;</span></span><br><span class="line">ansible | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line">host1 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line">host2 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible ~]# <span class="built_in">cat</span> /etc/ansible/hosts</span><br><span class="line">[zookeeper]</span><br><span class="line">ansible zk_id=1</span><br><span class="line">host1 zk_id=2</span><br><span class="line">host2 zk_id=3</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（2）在 ansible 节点，使用提供的 zookeeper-3.4.14.tar.gz 软件包，编写 zookeeper.yaml 文件,</p>
<p>实现 zookeeper 集群搭建，创建任务清单实现 zookeeper 安装包批量解压、通过 Janja2 模板</p>
<p>文件配置 zookeeper、创建 zookeeper 的 myid 文件和批量启动 zookeeper 功能。在三个节点</p>
<p>相应的目录使用.&#x2F;zkServer.sh status 命令查看三个 Zookeeper 节点的状态。</p>
<p>在 ansible 主机上将 cat zookeeper.yaml 命令结果提交到答题框，将 jps 命令的返回结果</p>
<p>提交到答题框。【2 分】</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible zookeeper]# jps</span><br><span class="line">7620 Jps</span><br><span class="line">7574 QuorumPeerMain</span><br><span class="line"></span><br><span class="line">[root@ansible zookeeper]# <span class="built_in">cat</span> zookeeper.yaml</span><br><span class="line">---</span><br><span class="line">- hosts: zookeeper</span><br><span class="line">  tasks:</span><br><span class="line">  - name: install inneed</span><br><span class="line">    yum: name=java-1.8.0-openjdk* state=present</span><br><span class="line">  - name: tar zookeeper</span><br><span class="line">    copy: src=/root/zookeeper-3.4.14.tar.gz dest=/opt/</span><br><span class="line">  - name: tar zookeeper</span><br><span class="line">    shell: tar zxvf /opt/zookeeper-3.4.14.tar.gz -C /opt</span><br><span class="line">  - name: copy</span><br><span class="line">    copy: src=zoo.cfg dest=/opt/zookeeper-3.4.14/conf/</span><br><span class="line">  - name: create file</span><br><span class="line">    file: path=/tmp/zookeeper state=directory</span><br><span class="line">  - name: copy j2id</span><br><span class="line">    template: src=myid.j2 dest=/tmp/zookeeper/myid</span><br><span class="line">  - name: start zk</span><br><span class="line">    shell: <span class="string">&quot;/opt/zookeeper-3.4.14/bin/zkServer.sh start&quot;</span></span><br></pre></td></tr></table></figure>

<p>解法:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@ansible zookeeper]# <span class="built_in">cat</span> zoo.cfg</span><br><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/tmp/zookeeper</span><br><span class="line">clientPort=2181</span><br><span class="line">server.1=ansible:2888:3888</span><br><span class="line">server.2=host1:2888:3888</span><br><span class="line">server.3=host2:2888:3888</span><br><span class="line"></span><br><span class="line">[root@ansible zookeeper]# <span class="built_in">cat</span> myid.j2</span><br><span class="line">&#123;&#123;  zk_id &#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>任务 2 应用商城系统部署【10 分】</strong></p>
<p>1.在 ansible 节点，使用提供的 gpmall-cluster 软件包，完成集群应用系统部署。部署完成后，</p>
<p>进行登录，最后使用 curl 命令去获取商城首页的返回信息，</p>
<p>先将 netstat –ntpl 命令的返回结果提交到答题框，然后将 curl -l <a target="_blank" rel="noopener" href="http://eip/">http://EIP:80</a> 命令的返回</p>
<p>结果提交到答题框。【10 分】</p>
<p><img src="C:\Users\user\AppData\Roaming\Typora\typora-user-images\image-20230316200644461.png" alt="image-20230316200644461"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在controller节点进行操作</span></span><br><span class="line">将文件包进行上传,目前已完成mariadb,zookeeper部署</span><br><span class="line"></span><br><span class="line">[root@ansible ~]# <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.157.20 ansible-control ansible</span><br><span class="line">192.168.157.21 ansible-compute1 host1</span><br><span class="line">192.168.157.22 ansible-compute2 host2</span><br><span class="line">192.168.157.23 ansible-compute3</span><br><span class="line">127.0.0.1 mysql.mall</span><br><span class="line">127.0.0.1 redis.mall</span><br><span class="line">127.0.0.1 zk1.mall</span><br><span class="line">127.0.0.1 kafka1.mall</span><br><span class="line"></span><br><span class="line"><span class="comment">##配置kafka</span></span><br><span class="line"><span class="built_in">cd</span> kafka_2.11-1.1.1</span><br><span class="line">[root@ansible ~]# <span class="built_in">cd</span> kafka_2.11-1.1.1</span><br><span class="line">[root@ansible kafka_2.11-1.1.1]# <span class="built_in">ls</span></span><br><span class="line">bin  config  libs  LICENSE  NOTICE  site-docs</span><br><span class="line">[root@ansible kafka_2.11-1.1.1]# <span class="built_in">cd</span> bin/</span><br><span class="line">[root@ansible bin]# ./kafka-server-start.sh ../config/server.properties</span><br><span class="line"></span><br><span class="line"><span class="comment">#配置redis</span></span><br><span class="line"><span class="comment"># yum install -y redis </span></span><br><span class="line"><span class="comment"># sed -i &#x27;s/bind 127.0.0.1/#bind 127.0.0.1/g&#x27; /etc/redis.conf</span></span><br><span class="line"><span class="comment"># sed -i &#x27;s/protected-mode yes/protected-mode no/g&#x27; /etc/redis.conf</span></span><br><span class="line"><span class="comment"># redis-server etc/redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置mariadb</span></span><br><span class="line">mysql -u root -p123456 -e <span class="string">&quot;grant all on *.* to &#x27;root&#x27;@&#x27;% identified by &#x27;123456&#x27;;&quot;</span></span><br><span class="line">mysql -u root -p123456 -e <span class="string">&#x27;create database gpmall default character set=utf8;&#x27;</span></span><br><span class="line">mysql -u root -p123456 -e <span class="string">&quot;user gpmall;source/root/gpmall.sql&quot;</span></span><br><span class="line">  <span class="comment">##修改端口</span></span><br><span class="line">[root@ansible bin]# <span class="built_in">cat</span> /etc/my.cnf</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port=8066</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置nginx</span></span><br><span class="line"><span class="comment">#  vi /etc/nginx/conf.d/default.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#charset koi8-r;</span></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">    location /user &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8082;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /shopping &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8081;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /cashier &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8083;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    root           html;</span></span><br><span class="line">    <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">    <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">    <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">    <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">    <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">    <span class="comment">#    deny  all;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">systemctl <span class="built_in">enable</span> nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># rm -rf /usr/share/nginx/html/*</span></span><br><span class="line"><span class="comment"># cp -rvf dist/* /usr/share/nginx/html/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#启动jar包</span></span><br><span class="line"><span class="built_in">nohup</span> java -jar user-provider-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line"><span class="built_in">nohup</span> java -jar shopping-provider-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line"><span class="built_in">nohup</span> java -jar gpmall-shopping-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line"><span class="built_in">nohup</span> java -jar gpmall-user-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz">GoldY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.geekgold.xyz/posts/d5ee981d.html">https://www.geekgold.xyz/posts/d5ee981d.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.geekgold.xyz" target="_blank">GoldY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/">云计算职业技能大赛</a></div><div class="post-share"><div class="social-share" data-image="/img/cloud-com.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src="/img/zhifubao.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">云计算方向-2023年金砖大赛</div></div><div class="info-2"><div class="info-item-1">A模块题目：OpenStack 平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化、弹性分配、集中管理、性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表： 表1 IP地址规划    设备名称 主机名 接口 IP地址    云服务器1 controller eth0 公网IP: 私网IP:192.168.100.&#x2F;24     eth1 私网IP:192.168.200. *&#x2F;24   云服务器2 compute eth0 公网IP: 私网IP:192.168.100. *&#x2F;24     eth1 私网IP:192.168.200....</div></div></div></a><a class="pagination-related" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img class="cover" src="/img/cloud-com.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</div></div><div class="info-2"><div class="info-item-1">A场次题目：Openstack 平台部署与运维任务1 私有云平台环境初始化1.初始化操作系统 使用提供的用户名密码，登录竞赛云平台。根据表 1 中的 IP 地址规划，设置各服务器节点的 IP 地址，确保网络正常通信，设置控制节点主机名为 Contro ller，计算节点主机名为 Compute，并修改 hosts 文件将 IP 地址映射为主机名， 关闭防火墙并设置为开机不启动，设置 SELinux 为 Permissive 模式并设置永久 关闭。请查看控制节点和计算节点主机名，使用命令查看 SELinux 状态，使用 head 命令、tail 命令和 cut 命令提取出永久关闭 SELinux 的关键信息。 将以上命令及返回结果提交到答题框  配置host 123456vi /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/6bf8b7d7.html" title="云计算方向-2022年云计算职业技能大赛国赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算职业技能大赛国赛题</div></div><div class="info-2"><div class="info-item-1">第一套【任务 1】私有云服务搭建[10分]【题目 1】基础环境配置[0.5 分]使用提供的用户名密码，登录提供的 OpenStack 私有云平台，在当前租户下，使用CentOS7.9 镜像，创建两台云主机，云主机类型使用 4vCPU&#x2F;12G&#x2F;100G_50G 类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至 controller 和 compute 节点（第二张网卡的网段为 10.10.X.0&#x2F;24，X 为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与 ssh 连接，然后按以下要求配置服务器： （1）设置控制节点主机名为 controller，设置计算节点主机名为 compute；  （2）修改 hosts 文件将 IP 地址映射为主机名； 1231.查看控制节点名字为 controller 正确计 0.2 分2.查看 hosts 文件中有正确的主机名和 IP 映射计 0.2 分3.控制节点正确使用两块网卡计 0.1...</div></div></div></a><a class="pagination-related" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</div></div><div class="info-2"><div class="info-item-1">A场次题目：Openstack 平台部署与运维任务1 私有云平台环境初始化1.初始化操作系统 使用提供的用户名密码，登录竞赛云平台。根据表 1 中的 IP 地址规划，设置各服务器节点的 IP 地址，确保网络正常通信，设置控制节点主机名为 Contro ller，计算节点主机名为 Compute，并修改 hosts 文件将 IP 地址映射为主机名， 关闭防火墙并设置为开机不启动，设置 SELinux 为 Permissive 模式并设置永久 关闭。请查看控制节点和计算节点主机名，使用命令查看 SELinux 状态，使用 head 命令、tail 命令和 cut 命令提取出永久关闭 SELinux 的关键信息。 将以上命令及返回结果提交到答题框  配置host 123456vi /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6...</div></div></div></a><a class="pagination-related" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-Ansible搭建wordpress</div></div><div class="info-2"><div class="info-item-1">一.ansible搭建wordpress基于lamp构建wordpress    master 192.168.200.100 控制节点    node1 192.168.200.101 web服务器   node2 192.168.200.102 mysql服务器   vi &#x2F;etc&#x2F;ansible&#x2F;host 12345678[master]master[web]192.168.200.101node1[database]192.168.200.102node2  vi wordpress.yaml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354---# hosts: 后面可写主机组名或主机名- hosts: all  remote_user: root  # 定义变量  vars:    db_pkgs:      # 以下的-为变量“值”，也就是在引用db_pkgs变量时，可取变量中的值   ...</div></div></div></a><a class="pagination-related" href="/posts/840d388d.html" title="云计算方向-2023年金砖大赛山东选拔题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年金砖大赛山东选拔题</div></div><div class="info-2"><div class="info-item-1">A场次题目：OpenStack平台部署与运维业务场景： 某企业拟使用OpenStack搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT资源池化，弹性分配，集中管理，性能优化以及统一安全认证等。系统结构如下图： 企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：    设备名称 主机名 接口 ip地址    云服务器1 controller eth0，eth1 私网：192.168.100.10&#x2F;24           私网：192.168.200.10&#x2F;24   云服务器2 compute eth0，eth1 私网：192.168.100.20&#x2F;24        ...</div></div></div></a><a class="pagination-related" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2023年GZ075 云计算应用赛项赛题</div></div><div class="info-2"><div class="info-item-1">模块一 私有云（30分）企业首先完成私有云平台搭建和运维，私有云平台提供云主机、云网络、云存储等基础架构云服务，并开发自动化运维程序。 任务1 私有云服务搭建（5分）1.1.1 基础环境配置1.控制节点主机名为controller，设置计算节点主机名为compute； 12345678910#控制节点[root@localhost ~]# hostnamectl set-hostname controller[root@localhost ~]# bash[root@controller ~]##计算节点[root@localhost ~]# hostnamectl set-hostname compute[root@localhost ~]# bash[root@compute ~]#    2.hosts文件将IP地址映射为主机名。 123456#全部节点[root@controller ~]# cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4...</div></div></div></a><a class="pagination-related" href="/posts/2c8237f4.html" title="云计算方向-2022年云计算技能国赛私有云套题"><img class="cover" src="/img/cloud-com.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">云计算方向-2022年云计算技能国赛私有云套题</div></div><div class="info-2"><div class="info-item-1">第一套私有云运维任务：题目3. OpenStack云平台运维（10分）1.使用提供的云安全框架组件，将提供的OpenStack云平台的安全策略从http优化至https。可能会遇到 mod_ssl 安装不成功的问题，原因是mod_ssl版本不匹配，上传mod_ssl-2.4.6-97.el7.centos.x86_64.rpm ①安装工具包 1yum install -y mod_wsgi httpd mod_ssl  ②修改&#x2F;etc&#x2F;openstack-dashboard&#x2F;local_settings文件 123456vi /etc/openstack-dashboard/local_settings##在DEBUG = False下增加4行USE_SSL = TrueCSRF_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_SECURE = True		##原文中有，去掉注释即可SESSION_COOKIE_HTTPONLY =...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">GoldY</div><div class="author-info-description">不经一番寒彻骨，怎得梅花扑鼻香。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuwenjin666"><i class="fab fa-github"></i><span>Github主页</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">联系我V：GoldY_66</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#A%E6%A8%A1%E5%9D%97%E9%A2%98%E7%9B%AEOpenStack%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%BF%90%E7%BB%B4"><span class="toc-number">1.</span> <span class="toc-text">A模块题目OpenStack平台部署与运维</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-1-%E7%A7%81%E6%9C%89%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%886-%E5%88%86%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">任务 1 私有云平台环境初始化（6 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AE%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.配置主机名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE-hosts-%E6%96%87%E4%BB%B6"><span class="toc-number">1.1.2.</span> <span class="toc-text">2.配置 hosts 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8C%82%E8%BD%BD%E5%85%89%E7%9B%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.1.3.</span> <span class="toc-text">3.挂载光盘镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%85%8D%E7%BD%AE-controller-%E8%8A%82%E7%82%B9-yum-%E6%BA%90"><span class="toc-number">1.1.4.</span> <span class="toc-text">4.配置 controller 节点 yum 源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%90%AD%E5%BB%BA-ftp-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.1.5.</span> <span class="toc-text">5.搭建 ftp 服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E9%85%8D%E7%BD%AE-compute-%E8%8A%82%E7%82%B9-yum-%E6%BA%90"><span class="toc-number">1.1.6.</span> <span class="toc-text">6.配置 compute 节点 yum 源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%88%86%E5%8C%BA"><span class="toc-number">1.1.7.</span> <span class="toc-text">7.分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98-%E8%84%8F%E6%95%B0%E6%8D%AE%E5%9B%9E%E5%86%99"><span class="toc-number">1.1.8.</span> <span class="toc-text">8.系统调优-脏数据回写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-2-OpenStack-%E6%90%AD%E5%BB%BA%E4%BB%BB%E5%8A%A1%EF%BC%888-%E5%88%86%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">任务 2 OpenStack 搭建任务（8 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.修改脚本文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.修改脚本文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85-openstack-%E5%8C%85"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.安装 openstack 包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%90%AD%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.4.</span> <span class="toc-text">4. 搭建数据库组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%90%AD%E5%BB%BA%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.搭建认证服务组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%90%AD%E5%BB%BA%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.6.</span> <span class="toc-text">6.搭建镜像服务组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%90%AD%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.7.</span> <span class="toc-text">7.搭建计算服务组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%90%AD%E5%BB%BA%E7%BD%91%E7%BB%9C%E7%BB%84%E4%BB%B6%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E7%BD%91%E7%BB%9C"><span class="toc-number">1.2.8.</span> <span class="toc-text">8.搭建网络组件并初始化网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2"><span class="toc-number">1.2.9.</span> <span class="toc-text">9.搭建图形化界面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-3-OpenStack-%E8%BF%90%E7%BB%B4%E4%BB%BB%E5%8A%A1%EF%BC%8813-%E5%88%86%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">任务 3 OpenStack 运维任务（13 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%89%E5%85%A8%E7%BB%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.安全组管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.项目管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%95%9C%E5%83%8F%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.4.</span> <span class="toc-text">4.镜像管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.5.</span> <span class="toc-text">5.后端配置文件管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.6.</span> <span class="toc-text">6.存储服务管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.7.</span> <span class="toc-text">7.数据库管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.8.</span> <span class="toc-text">8.数据库管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.9.</span> <span class="toc-text">9.存储管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.10.</span> <span class="toc-text">10.存储管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.11.</span> <span class="toc-text">11.存储管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.12.</span> <span class="toc-text">12.存储管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E6%B7%BB%E5%8A%A0%E6%8E%A7%E5%88%B6%E8%8A%82%E7%82%B9%E8%B5%84%E6%BA%90%E5%88%B0%E4%BA%91%E5%B9%B3%E5%8F%B0"><span class="toc-number">1.3.13.</span> <span class="toc-text">13.添加控制节点资源到云平台</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E5%9B%9B-OpenStack-%E6%9E%B6%E6%9E%84%E4%BB%BB%E5%8A%A1%EF%BC%883-%E5%88%86%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">任务四 OpenStack 架构任务（3 分）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#B-%E6%A8%A1%E5%9D%97%E9%A2%98%E7%9B%AE%EF%BC%9A%E5%AE%B9%E5%99%A8%E7%9A%84%E7%BC%96%E6%8E%92%E4%B8%8E%E8%BF%90%E7%BB%B4"><span class="toc-number">2.</span> <span class="toc-text">B 模块题目：容器的编排与运维</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-1-%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8810-%E5%88%86%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">任务 1 容器云平台环境初始化（10 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.容器云平台的初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Yum-%E6%BA%90%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E6%8C%82%E8%BD%BD"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.Yum 源数据的持久化挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Yum-%E6%BA%90%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.1.3.</span> <span class="toc-text">3.Yum 源的编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Yum-%E6%BA%90%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.1.4.</span> <span class="toc-text">4.Yum 源的编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Yum-%E6%BA%90%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.1.5.</span> <span class="toc-text">5.Yum 源的编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.1.6.</span> <span class="toc-text">6.设置时间同步服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%AE%BE%E7%BD%AE%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95"><span class="toc-number">2.1.7.</span> <span class="toc-text">7.设置免密登录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-2-k8s-%E6%90%AD%E5%BB%BA%E4%BB%BB%E5%8A%A1%EF%BC%8815-%E5%88%86%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">任务 2 k8s 搭建任务（15 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85-docker-%E5%BA%94%E7%94%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.安装 docker 应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85-docker-%E5%BA%94%E7%94%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.安装 docker 应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85-docker-compose"><span class="toc-number">2.2.3.</span> <span class="toc-text">3.安装 docker-compose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%90%AD%E5%BB%BA-horbor-%E4%BB%93%E5%BA%93"><span class="toc-number">2.2.4.</span> <span class="toc-text">4.搭建 horbor 仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%B8%8A%E4%BC%A0-docker-%E9%95%9C%E5%83%8F"><span class="toc-number">2.2.5.</span> <span class="toc-text">5.上传 docker 镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%AE%89%E8%A3%85-kubeadm-%E5%B7%A5%E5%85%B7"><span class="toc-number">2.2.6.</span> <span class="toc-text">6.安装 kubeadm 工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%88%9D%E5%A7%8B%E5%8C%96-master-%E8%8A%82%E7%82%B9"><span class="toc-number">2.2.7.</span> <span class="toc-text">7.初始化 master 节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%88%A0%E9%99%A4%E6%B1%A1%E7%82%B9"><span class="toc-number">2.2.8.</span> <span class="toc-text">8.删除污点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%AE%89%E8%A3%85-kubernetes-%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6"><span class="toc-number">2.2.9.</span> <span class="toc-text">9.安装 kubernetes 网络插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%BB%99-kubernetes-%E5%88%9B%E5%BB%BA%E8%AF%81%E4%B9%A6%E3%80%82"><span class="toc-number">2.2.10.</span> <span class="toc-text">10.给 kubernetes 创建证书。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-kubernetes-%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.11.</span> <span class="toc-text">11.kubernetes 图形化界面的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E6%89%A9%E5%B1%95%E8%AE%A1%E7%AE%97%E8%8A%82%E7%82%B9"><span class="toc-number">2.2.12.</span> <span class="toc-text">12.扩展计算节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-3-EFK-%E6%97%A5%E5%BF%97%E5%B9%B3%E5%8F%B0%E6%9E%84%E5%BB%BA%EF%BC%8815-%E5%88%86%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">任务 3 EFK 日志平台构建（15 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AF%BC%E5%85%A5%E9%95%9C%E5%83%8F"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.导入镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-NFS-%E9%85%8D%E7%BD%AE%E7%BD%91%E6%AE%B5%E8%AE%BF%E9%97%AE"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.NFS 配置网段访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-RBAC-%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.3.</span> <span class="toc-text">3.RBAC 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-RBAC-%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.4.</span> <span class="toc-text">4.RBAC 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-StorageClass-%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A"><span class="toc-number">2.3.5.</span> <span class="toc-text">5.StorageClass 动态绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-StorageClass-%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A"><span class="toc-number">2.3.6.</span> <span class="toc-text">6.StorageClass 动态绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E9%80%9A%E8%BF%87-statefulset-%E5%88%9B%E5%BB%BA-elasticsearch-%E9%9B%86%E7%BE%A4"><span class="toc-number">2.3.7.</span> <span class="toc-text">7.通过 statefulset 创建 elasticsearch 集群</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%88%9B%E5%BB%BA-headless-service"><span class="toc-number">2.3.8.</span> <span class="toc-text">8.创建 headless service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-Kibana-%E5%8F%AF%E8%A7%86%E5%8C%96-UI-%E7%95%8C%E9%9D%A2%E9%83%A8%E7%BD%B2"><span class="toc-number">2.3.9.</span> <span class="toc-text">9.Kibana 可视化 UI 界面部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-Fluentd-%E7%BB%84%E4%BB%B6%E9%83%A8%E7%BD%B2"><span class="toc-number">2.3.10.</span> <span class="toc-text">10.Fluentd 组件部署</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#C-%E6%A8%A1%E5%9D%97%E9%A2%98%E7%9B%AE%EF%BC%9A%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E5%92%8C%E8%BF%90%E7%BB%B4"><span class="toc-number">3.</span> <span class="toc-text">C 模块题目：企业级应用的自动化部署和运维</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-1-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%EF%BC%8810-%E5%88%86%EF%BC%89"><span class="toc-number">3.1.</span> <span class="toc-text">任务 1 企业级应用的自动化部署（10 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Ansible-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7%E9%83%A8%E7%BD%B2%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.Ansible 自动化运维工具部署主从数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Ansible-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7%E9%83%A8%E7%BD%B2-zookeeper-%E9%9B%86%E7%BE%A4"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.Ansible 自动化运维工具部署 zookeeper 集群</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-Ansible搭建wordpress"/></a><div class="content"><a class="title" href="/posts/944d69ee.html" title="云计算方向-Ansible搭建wordpress">云计算方向-Ansible搭建wordpress</a><time datetime="2025-05-14T02:48:38.000Z" title="发表于 2025-05-14 10:48:38">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题"/></a><div class="content"><a class="title" href="/posts/a182640a.html" title="云计算方向-2023年金砖一带一路职业技能大赛云计算赛题">云计算方向-2023年金砖一带一路职业技能大赛云计算赛题</a><time datetime="2025-05-14T02:48:37.000Z" title="发表于 2025-05-14 10:48:37">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年一带一路职业技能大赛云计算(样题)"/></a><div class="content"><a class="title" href="/posts/d5ee981d.html" title="云计算方向-2023年一带一路职业技能大赛云计算(样题)">云计算方向-2023年一带一路职业技能大赛云计算(样题)</a><time datetime="2025-05-14T02:48:35.000Z" title="发表于 2025-05-14 10:48:35">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年金砖大赛"/></a><div class="content"><a class="title" href="/posts/a8884406.html" title="云计算方向-2023年金砖大赛">云计算方向-2023年金砖大赛</a><time datetime="2025-05-14T02:48:32.000Z" title="发表于 2025-05-14 10:48:32">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题"><img src="/img/cloud-com.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="云计算方向-2023年GZ075 云计算应用赛项赛题"/></a><div class="content"><a class="title" href="/posts/cc6b9ff2.html" title="云计算方向-2023年GZ075 云计算应用赛项赛题">云计算方向-2023年GZ075 云计算应用赛项赛题</a><time datetime="2025-05-14T02:47:38.000Z" title="发表于 2025-05-14 10:47:38">2025-05-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/bottom-bg.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2025 By GoldY</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-ashen-rho.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=yuwenjin666";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="yuwenjin666";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/about'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>